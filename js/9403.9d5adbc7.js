(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[9403],{66684:function(t,e,s){var n=s(96763);
/*!
 * @kirtandesai/ol-geocoder - v5.0.3
 * A geocoder extension compatible with OpenLayers v7.
 * https://github.com/kirtan-desai/ol-geocoder
 * Built: Thu Nov 17 2022 14:58:35 GMT-0500 (Eastern Standard Time)
 */!function(e,n){t.exports=n(s(10972),s(29276),s(49700),s(82986),s(54602),s(44294),s(86717),s(89718))}(0,(function(t,e,s,r,o,i,a,l){"use strict";function c(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u=c(t),d=c(e),p=c(s),h=c(r),m=c(o),g=c(i),y=c(a),f=c(l),x="gcd-container",w="gcd-button-control",v="gcd-input-query",b="gcd-input-reset",E={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},_={containerId:x,buttonControlId:w,inputQueryId:v,inputResetId:b,cssClasses:E};const A=Object.freeze({__proto__:null,containerId:x,buttonControlId:w,inputQueryId:v,inputResetId:b,cssClasses:E,default:_}),S="addresschosen",C="nominatim",T="reverse",k="glass-button",$="text-input",j="osm",P="mapquest",M="photon",q="bing",I="opencage",L={provider:j,placeholder:"Search for an address",featureStyle:null,targetType:k,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,autoCompleteTimeout:200,debug:!1};function O(t,e="Assertion failed"){if(!t){if("undefined"!=typeof Error)throw new Error(e);throw e}}function N(t){const e=function(){if("performance"in window==0&&(window.performance={}),"now"in window.performance==0){let t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=()=>Date.now()-t}return window.performance.now()}().toString(36);return t?t+e:e}function F(t){return/^\d+$/u.test(t)}function R(t,e,s){if(Array.isArray(t))return void t.forEach((t=>R(t,e)));const n=Array.isArray(e)?e:e.split(/\s+/u);let r=n.length;for(;r--;)V(t,n[r])||H(t,n[r],s)}function G(t,e,s){if(Array.isArray(t))return void t.forEach((t=>G(t,e,s)));const n=Array.isArray(e)?e:e.split(/\s+/u);let r=n.length;for(;r--;)V(t,n[r])&&Q(t,n[r],s)}function V(t,e){return t.classList?t.classList.contains(e):B(e).test(t.className)}function D(t,e){return t.replace(/\{\s*([\w-]+)\s*\}/gu,((t,s)=>{const n=void 0===e[s]?"":e[s];return String(n).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}))}function U(t,e){let s;if(Array.isArray(t)){if(s=document.createElement(t[0]),t[1].id&&(s.id=t[1].id),t[1].classname&&(s.className=t[1].classname),t[1].attr){const{attr:e}=t[1];if(Array.isArray(e)){let t=-1;for(;++t<e.length;)s.setAttribute(e[t].name,e[t].value)}else s.setAttribute(e.name,e.value)}}else s=document.createElement(t);s.innerHTML=e;const n=document.createDocumentFragment();for(;s.childNodes[0];)n.append(s.childNodes[0]);return s.append(n),s}function B(t){return new RegExp(`(^|\\s+) ${t} (\\s+|$)`,"u")}function H(t,e,s){t.classList?t.classList.add(e):t.className=`${t.className} ${e}`.trim(),s&&F(s)&&window.setTimeout((()=>Q(t,e)),s)}function Q(t,e,s){t.classList?t.classList.remove(e):t.className=t.className.replace(B(e)," ").trim(),s&&F(s)&&window.setTimeout((()=>H(t,e)),s)}const X=A.cssClasses;class W{constructor(t){this.options=t,this.els=this.createControl()}createControl(){let t,e,s;return this.options.targetType===$?(e=`${X.namespace} ${X.inputText.container}`,t=U(["div",{id:A.containerId,classname:e}],W.input),s={container:t,control:t.querySelector(`.${X.inputText.control}`),input:t.querySelector(`.${X.inputText.input}`),reset:t.querySelector(`.${X.inputText.reset}`),result:t.querySelector(`.${X.inputText.result}`)}):(e=`${X.namespace} ${X.glass.container}`,t=U(["div",{id:A.containerId,classname:e}],W.glass),s={container:t,control:t.querySelector(`.${X.glass.control}`),button:t.querySelector(`.${X.glass.button}`),input:t.querySelector(`.${X.glass.input}`),reset:t.querySelector(`.${X.glass.reset}`),result:t.querySelector(`.${X.glass.result}`)}),s.input.placeholder=this.options.placeholder,s}}W.glass=`\n  <div class="${X.glass.control} ${X.olControl}">\n    <button type="button" id="${A.buttonControlId}" class="${X.glass.button}"></button>\n    <input type="text" id="${A.inputQueryId}" class="${X.glass.input}" autocomplete="off" placeholder="Search ...">\n    <a id="${A.inputResetId}" class="${X.glass.reset} ${X.hidden}"></a>\n  </div>\n  <ul class="${X.glass.result}"></ul>\n`,W.input=`\n  <div class="${X.inputText.control}">\n    <input type="text" id="${A.inputQueryId}" class="${X.inputText.input}" autocomplete="off" placeholder="Search ...">\n    <span class="${X.inputText.icon}"></span>\n    <button type="button" id="${A.inputResetId}" class="${X.inputText.reset} ${X.hidden}"></button>\n  </div>\n  <ul class="${X.inputText.result}"></ul>\n`;class Y{constructor(){this.settings={url:"https://photon.komoot.io/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}}getParameters(t){return t.lang=t.lang.toLowerCase(),{url:this.settings.url,params:{q:t.query,limit:t.limit||this.settings.params.limit,lang:this.settings.langs.includes(t.lang)?t.lang:this.settings.params.lang}}}handleResponse(t){return 0===t.features.length?[]:t.features.map((t=>({lon:t.geometry.coordinates[0],lat:t.geometry.coordinates[1],address:{name:t.properties.name,postcode:t.properties.postcode,city:t.properties.city,state:t.properties.state,country:t.properties.country},original:{formatted:t.properties.name,details:t.properties}})))}}class z{constructor(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}getParameters(t){return{url:this.settings.url,params:{q:t.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:t.limit||this.settings.params.limit,countrycodes:t.countrycodes||this.settings.params.countrycodes,"accept-language":t.lang||this.settings.params["accept-language"]}}}handleResponse(t){return 0===t.length?[]:t.map((t=>({lon:t.lon,lat:t.lat,bbox:t.boundingbox,address:{name:t.display_name,road:t.address.road||"",houseNumber:t.address.house_number||"",postcode:t.address.postcode,city:t.address.city||t.address.town,state:t.address.state,country:t.address.country},original:{formatted:t.display_name,details:t.address}})))}}class J{constructor(){this.settings={url:"https://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}getParameters(t){return{url:this.settings.url,params:{q:t.query,key:t.key,format:"json",addressdetails:1,limit:t.limit||this.settings.params.limit,countrycodes:t.countrycodes||this.settings.params.countrycodes,"accept-language":t.lang||this.settings.params["accept-language"]}}}handleResponse(t){return 0===t.length?[]:t.map((t=>({lon:t.lon,lat:t.lat,address:{name:t.address.neighbourhood||"",road:t.address.road||"",postcode:t.address.postcode,city:t.address.city||t.address.town,state:t.address.state,country:t.address.country},original:{formatted:t.display_name,details:t.address}})))}}class K{constructor(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}}getParameters(t){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:t.query,key:t.key,includeNeighborhood:t.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:t.maxResults||this.settings.params.maxResults}}}handleResponse(t){const{resources:e}=t.resourceSets[0];return 0===e.length?[]:e.map((t=>({lon:t.point.coordinates[1],lat:t.point.coordinates[0],address:{name:t.name},original:{formatted:t.address.formattedAddress,details:t.address}})))}}class Z{constructor(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}}getParameters(t){return{url:this.settings.url,params:{q:t.query,key:t.key,limit:t.limit||this.settings.params.limit,countrycode:t.countrycodes||this.settings.params.countrycodes}}}handleResponse(t){return 0===t.results.length?[]:t.results.map((t=>({lon:t.geometry.lng,lat:t.geometry.lat,address:{name:t.components.house_number||"",road:t.components.road||"",postcode:t.components.postcode,city:t.components.city||t.components.town,state:t.components.state,country:t.components.country},original:{formatted:t.formatted,details:t.components}})))}}function tt(t){return new Promise(((e,s)=>{const n=function(t,e){return e&&"object"==typeof e&&(t+=(/\?/u.test(t)?"&":"?")+et(e)),t}(t.url,t.data),r={method:"GET",mode:"cors",credentials:"same-origin"};t.jsonp?function(t,e,s){const{head:n}=document,r=document.createElement("script"),o=`f${Math.round(Math.random()*Date.now())}`;r.setAttribute("src",`${t+(t.indexOf("?")>0?"&":"?")+e}=${o}`),window[o]=t=>{window[o]=void 0,setTimeout((()=>n.removeChild(r)),0),s(t)},n.append(r)}(n,t.callbackName,e):fetch(n,r).then((t=>t.json())).then(e).catch(s)}))}function et(t){return Object.keys(t).reduce(((e,s)=>(e.push("object"==typeof t[s]?et(t[s]):`${encodeURIComponent(s)}=${encodeURIComponent(t[s])}`),e)),[]).join("&")}const st=A.cssClasses;class nt{constructor(t,e){this.Base=t,this.layerName=N("geocoder-layer-"),this.layer=new h.default({name:this.layerName,source:new m.default}),this.options=t.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=e,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()}setListeners(){let t,e;const s=t=>{t.stopPropagation(),V(this.els.control,st.glass.expanded)?this.collapse():this.expand()};this.els.input.addEventListener("keypress",(t=>{const e=t.target.value.trim();(t.key?"Enter"===t.key:t.which?13===t.which:t.keyCode&&13===t.keyCode)&&(t.preventDefault(),this.query(e))}),!1),this.els.input.addEventListener("click",(t=>t.stopPropagation()),!1),this.els.input.addEventListener("input",(s=>{const n=s.target.value.trim();0!==n.length?G(this.els.reset,st.hidden):R(this.els.reset,st.hidden),this.options.autoComplete&&n!==e&&(e=n,t&&clearTimeout(t),t=setTimeout((()=>{n.length>=this.options.autoCompleteMinLength&&this.query(n)}),this.options.autoCompleteTimeout))}),!1),this.els.reset.addEventListener("click",(t=>{this.els.input.focus(),this.els.input.value="",this.lastQuery="",R(this.els.reset,st.hidden),this.clearResults()}),!1),this.options.targetType===k&&this.els.button.addEventListener("click",s,!1)}query(t){this.provider||(this.provider=this.newProvider());const e=this.provider.getParameters({query:t,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery===t&&this.els.result.firstChild)return;this.lastQuery=t,this.clearResults(),R(this.els.reset,st.spin);const s={url:e.url,data:e.params};e.callbackName&&(s.jsonp=!0,s.callbackName=e.callbackName),tt(s).then((t=>{this.options.debug&&n.info(t),G(this.els.reset,st.spin);const e=this.provider.handleResponse(t);e&&(this.createList(e),this.listenMapClick())})).catch((t=>{G(this.els.reset,st.spin);const e=U("li","<h5>Error! No internet connection?</h5>");this.els.result.append(e)}))}createList(t){const e=this.els.result;t.forEach((t=>{let s;s=this.options.provider===j?`<span class="${st.road}">${t.address.name}</span>`:this.addressTemplate(t.address);const n=U("li",`<a href="#">${s}</a>`);n.addEventListener("click",(e=>{e.preventDefault(),this.chosen(t,s,t.address,t.original)}),!1),e.append(n)}))}chosen(t,e,s,n){const r=this.Base.getMap(),o=[Number.parseFloat(t.lon),Number.parseFloat(t.lat)],i=r.getView().getProjection(),a=f.default.transform(o,"EPSG:4326",i);let{bbox:l}=t;l&&(l=f.default.transformExtent([l[2],l[1],l[3],l[0]],"EPSG:4326",i));const c={formatted:e,details:s,original:n};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:S,address:c,coordinate:a,bbox:l,place:t});else{l?r.getView().fit(l,{duration:500}):function(t,e,s=500,n=2.388657133911758){t.getView().animate({duration:s,resolution:n},{duration:s,center:e})}(r,a);const e=this.createFeature(a,c);this.Base.dispatchEvent({type:S,address:c,feature:e,coordinate:a,bbox:l,place:t})}}createFeature(t){const e=new y.default(new g.default(t));return this.addLayer(),e.setStyle(this.options.featureStyle),e.setId(N("geocoder-ft-")),this.getSource().addFeature(e),e}addressTemplate(t){const e=[];return t.name&&e.push(['<span class="',st.road,'">{name}</span>'].join("")),(t.road||t.building||t.house_number)&&e.push(['<span class="',st.road,'">{building} {road} {house_number}</span>'].join("")),(t.city||t.town||t.village)&&e.push(['<span class="',st.city,'">{postcode} {city} {town} {village}</span>'].join("")),(t.state||t.country)&&e.push(['<span class="',st.country,'">{state} {country}</span>'].join("")),D(e.join("<br>"),t)}newProvider(){switch(this.options.provider){case j:return new z;case P:return new J;case M:return new Y;case q:return new K;case I:return new Z;default:return this.options.provider}}expand(){G(this.els.input,st.spin),R(this.els.control,st.glass.expanded),window.setTimeout((()=>this.els.input.focus()),100),this.listenMapClick()}collapse(){this.els.input.value="",this.els.input.blur(),R(this.els.reset,st.hidden),G(this.els.control,st.glass.expanded),this.clearResults()}listenMapClick(){if(this.registeredListeners.mapClick)return;const t=this,e=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,e.addEventListener("click",{handleEvent(s){t.clearResults(!0),e.removeEventListener(s.type,this,!1),t.registeredListeners.mapClick=!1}},!1)}clearResults(t){t&&this.options.targetType===k?this.collapse():function(t){for(;t.firstChild;)t.firstChild.remove()}(this.els.result)}getSource(){return this.layer.getSource()}addLayer(){let t=!1;const e=this.Base.getMap();e.getLayers().forEach((e=>{e===this.layer&&(t=!0)})),t||e.addLayer(this.layer)}}class rt extends u.default{constructor(t=C,e={}){let s,n;O("string"==typeof t,"@param `type` should be string!"),O(t===C||t===T,`@param 'type' should be '${C}'\n      or '${T}'!`),O("object"==typeof e,"@param `options` should be object!"),L.featureStyle=[new d.default({image:new p.default({scale:.7,src:"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png"})})];const r=new W(e);if(t===C&&(s=r.els.container),super({element:s}),!(this instanceof rt))return new rt;this.options=function(t,e){const s={};return Object.keys(t).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=t[e])})),Object.keys(e).forEach((t=>{Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])})),s}(L,e),this.container=s,t===C&&(n=new nt(this,r.els),this.layer=n.layer)}getLayer(){return this.layer}getSource(){return this.getLayer().getSource()}setProvider(t){this.options.provider=t}setProviderKey(t){this.options.key=t}}return rt}))},31660:(t,e,s)=>{"use strict";s.d(e,{A:()=>p});var n=s(66684),r=s.n(n);class o{constructor(t,e=!1){this.url=t,this.geojson=e}getParameters(t){return{url:this.url,params:{q:t.query,format:"json",limit:10,"accept-language":"en",polygon_geojson:this.geojson?1:0,polygon_threshold:.001}}}handleResponse(t){return 0===t.length?[]:t.filter((t=>["boundary","geological","leisure","natural","place","water","waterway"].includes(t.class))).map((t=>({lon:t.lon,lat:t.lat,bbox:t.boundingbox,address:{name:t.display_name},original:{formatted:t.display_name,details:t.address,geojson:t.geojson}})))}}const i={methods:{addGeocoder(t,e=!1){if(!this.$config.geocoder)return;const s={provider:new o(this.$config.geocoder,e),placeholder:"Search for ...",keepOpen:!0,preventDefault:!0},n=new(r())("nominatim",s);n.on("addresschosen",(s=>{if(e)t(s.place?.original?.geojson,s);else if(s.place.bbox){let e=s.place.bbox.map((t=>parseFloat(t))),n={west:e[2],east:e[3],north:e[1],south:e[0]};t(n,s)}else t(null,s)})),this.map.addControl(n)}}},a=i;var l,c,u=s(81656),d=(0,u.A)(a,l,c,!1,null,null,null);const p=d.exports},3075:(t,e,s)=>{"use strict";s.d(e,{A:()=>v});var n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:t.id}},[e("ProgressControl",{ref:"progress",attrs:{map:t.map}}),e("UserLocationControl",{attrs:{map:t.map}}),e("TextControl",{attrs:{text:t.help,map:t.map}})],1)},r=[],o=s(66451),i=s(31660),a=s(95104),l=s(2566),c=s(73926),u=s(89718),d=s(70915),p=s(29276),h=s(55193),m=s(953),g=s(13628);const y={name:"MapAreaSelect",mixins:[o.A,i.A,a.A],components:{TextControl:h.A},props:{value:{type:[Object,Array],default:()=>null},showMaxExtent:{type:[Object,Array],default:()=>null}},data(){return{interaction:null,extent:this.toExtent(this.value)}},computed:{returnAsObject(){return!Array.isArray(this.value)},projectedExtent(){return this.extent?(0,u.transformExtent)(this.extent,"EPSG:4326",this.map.getView().getProjection()):null},outerArea(){if(!this.showMaxExtent)return null;let{west:t,east:e,north:s,south:n}=this.showMaxExtent;return{type:"Polygon",coordinates:[[[-180,90],[-180,-90],[180,-90],[180,90],[-180,90]],[[t,s],[t,n],[e,n],[e,s],[t,s]]]}},bbox(){return l.A.extentToBBox(this.extent)},help(){return this.extent?"Click inside the bounding box to remove it.":"Click on the map to add a bounding box."}},methods:{update(t){t.extent?this.extent=(0,u.transformExtent)(t.extent,this.map.getView().getProjection(),"EPSG:4326"):this.extent=null,this.$emit("input",this.returnAsObject?this.bbox:this.extent)},async renderMap(){let t=!1!==l.A.isBboxInWebMercator(this.bbox);if(await this.createMap(t?"EPSG:3857":"EPSG:4326"),this.addBasemaps(),this.addGeocoder((t=>{if(!t)return;let e=this.toExtent(t);e=(0,u.transformExtent)(e,"EPSG:4326",this.map.getView().getProjection()),this.interaction.setExtent(e),this.fitMap()})),this.showMaxExtent){const t=new p["default"]({fill:new g.A({color:"#00000099"}),stroke:new m.A({width:0,color:"#00000000"})});this.addGeoJson(this.outerArea,!1,"unsupported area",t);let e=this.toExtent(this.showMaxExtent);e=(0,u.transformExtent)(e,"EPSG:4326",this.map.getView().getProjection()),this.map.getView().fit(e,this.getFitOptions(1))}let e=t=>{if(!this.editable)return!1;if("singleclick"===t.type){if(!this.extent){let e=this.map.getSize().map((t=>.2*t)),s=this.map.getView().calculateExtent(e),n=[s[2]-s[0],s[3]-s[1]],r=[t.coordinate[0]-n[0],t.coordinate[1]-n[1],t.coordinate[0]+n[0],t.coordinate[1]+n[1]];return this.interaction.setExtent(r),!1}(0,d.Rj)(this.projectedExtent,...t.coordinate)&&(this.interaction.setExtent(null),this.interaction.vertexOverlay_.getSource().clear(),this.interaction.vertexFeature_=null)}else if(this.interaction.handlingDownUpSequence||this.interaction.snapToVertex_(t.pixel,t.map))return!0;return!1};this.interaction=new c.A({extent:this.projectedExtent,condition:e,boxStyle:(0,p.createDefaultStyle)(),pixelTolerance:15}),this.editable&&this.interaction.on("extentchanged",this.update),this.map.addInteraction(this.interaction),this.fitMap()},fitMap(){if(this.projectedExtent){var t=this.getFitOptions(this.editable?10:33);this.map.getView().fit(this.projectedExtent,t)}}}},f=y;var x=s(81656),w=(0,x.A)(f,n,r,!1,null,null,null);const v=w.exports},55193:(t,e,s)=>{"use strict";s.d(e,{A:()=>u});var n=function(){var t=this,e=t._self._c;return t.texts.length>0?e("div",{staticClass:"ol-unselectable ol-control value",class:{pointer:t.texts.length>1},on:{click:t.toggle}},[t._v(t._s(t.current))]):t._e()},r=[],o=s(23634);const i={name:"TextControl",mixins:[o.A],data(){return{i:0}},computed:{texts(){return Array.isArray(this.text)?this.text:"string"===typeof this.text&&this.text.length>0?[this.text]:[]},current(){return 0===this.texts.length?"":this.texts[this.i%this.text.length]}},props:{text:{text:[String,Array],default:""}},methods:{toggle(){this.i++}}},a=i;var l=s(81656),c=(0,l.A)(a,n,r,!1,null,"52fec35a",null);const u=c.exports},34862:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>u});var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"step choose-bbox"},[e("p",[t._v("Please select the area of interest which you want to download data for. You can add or remove a bounding box by clicking into the map.")]),e("MapAreaSelect",{staticClass:"map",attrs:{show:t.showMap,value:t.value,showMaxExtent:t.max},on:{input:t.update}})],1)},r=[],o=s(3075);const i={name:"ChooseBoundingBox",components:{MapAreaSelect:o.A},props:{value:{type:Object,default:null},max:{type:Object,default:null}},data(){return{showMap:!0}},mounted(){window.setTimeout((()=>this.showMap=!0),1e3)},methods:{update(t){this.$emit("input",t)}}},a=i;var l=s(81656),c=(0,l.A)(a,n,r,!1,null,"61a75ac8",null);const u=c.exports},73926:(t,e,s)=>{"use strict";s.d(e,{A:()=>A});var n=s(1685),r=s(86717),o=s(73445),i=s(44294),a=s(21409),l=s(82986),c=s(54602),u=s(58704),d=s(70915),p=s(6933),h=s(29276),m=s(34142),g=s(89718);const y={EXTENTCHANGED:"extentchanged"};class f extends n.Ay{constructor(t){super(y.EXTENTCHANGED),this.extent=t}}class x extends a.A{constructor(t){t=t||{},super(t),this.on,this.once,this.un,this.condition_=t.condition?t.condition:u.Gk,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,t||(t={}),this.extentOverlay_=new l["default"]({source:new c["default"]({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:w(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new l["default"]({source:new c["default"]({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:v(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&this.setExtent(t.extent)}snapToVertex_(t,e){const s=e.getCoordinateFromPixelInternal(t),n=function(t,e){return(0,p.$x)(s,t)-(0,p.$x)(s,e)},r=this.getExtentInternal();if(r){const o=_(r);o.sort(n);const i=o[0];let a=(0,p.sG)(s,i);const l=e.getPixelFromCoordinateInternal(a);if((0,p.Io)(t,l)<=this.pixelTolerance_){const t=e.getPixelFromCoordinateInternal(i[0]),s=e.getPixelFromCoordinateInternal(i[1]),n=(0,p.hG)(l,t),r=(0,p.hG)(l,s),o=Math.sqrt(Math.min(n,r));return this.snappedToVertex_=o<=this.pixelTolerance_,this.snappedToVertex_&&(a=n>r?i[1]:i[0]),a}}return null}handlePointerMove_(t){const e=t.pixel,s=t.map;let n=this.snapToVertex_(e,s);n||(n=s.getCoordinateFromPixelInternal(e)),this.createOrUpdatePointerFeature_(n)}createOrUpdateExtentFeature_(t){let e=this.extentFeature_;return e?t?e.setGeometry((0,m.VY)(t)):e.setGeometry(void 0):(e=t?new r["default"]((0,m.VY)(t)):new r["default"]({}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e}createOrUpdatePointerFeature_(t){let e=this.vertexFeature_;if(e){const s=e.getGeometry();s.setCoordinates(t)}else e=new r["default"](new i["default"](t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e);return e}handleEvent(t){return!t.originalEvent||!this.condition_(t)||(t.type!=o.A.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),super.handleEvent(t),!1)}handleDownEvent(t){const e=t.pixel,s=t.map,n=this.getExtentInternal();let r=this.snapToVertex_(e,s);const o=function(t){let e=null,s=null;return t[0]==n[0]?e=n[2]:t[0]==n[2]&&(e=n[0]),t[1]==n[1]?s=n[3]:t[1]==n[3]&&(s=n[1]),null!==e&&null!==s?[e,s]:null};if(r&&n){const t=r[0]==n[0]||r[0]==n[2]?r[0]:null,e=r[1]==n[1]||r[1]==n[3]?r[1]:null;null!==t&&null!==e?this.pointerHandler_=b(o(r)):null!==t?this.pointerHandler_=E(o([t,n[1]]),o([t,n[3]])):null!==e&&(this.pointerHandler_=E(o([n[0],e]),o([n[2],e])))}else r=s.getCoordinateFromPixelInternal(e),this.setExtent([r[0],r[1],r[0],r[1]]),this.pointerHandler_=b(r);return!0}handleDragEvent(t){if(this.pointerHandler_){const e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}}handleUpEvent(t){this.pointerHandler_=null;const e=this.getExtentInternal();return e&&0!==(0,d.UG)(e)||this.setExtent(null),!1}setMap(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),super.setMap(t)}getExtent(){return(0,g.toUserExtent)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new f(this.extent_))}}function w(){const t=(0,h.createEditingStyle)();return function(e,s){return t["Polygon"]}}function v(){const t=(0,h.createEditingStyle)();return function(e,s){return t["Point"]}}function b(t){return function(e){return(0,d.Tr)([t,e])}}function E(t,e){return t[0]==e[0]?function(s){return(0,d.Tr)([t,[s[0],e[1]]])}:t[1]==e[1]?function(s){return(0,d.Tr)([t,[e[0],s[1]]])}:null}function _(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}const A=x}}]);
//# sourceMappingURL=9403.9d5adbc7.js.map