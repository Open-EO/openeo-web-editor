"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[8659],{68457:(t,e,i)=>{i.d(e,{Z:()=>s});var r=i(10044),o=i(65561),n=function(t){t=t||{},t.className=(t.className||"")+" ol-text-button",o.Z.call(this,t)};(0,r.Z)(n,o.Z);const s=n},50164:(t,e,i)=>{i.d(e,{Z:()=>s});var r=i(10044),o=i(65561),n=function(t){t=t||{};var e=this;this.interaction_=t.interaction,this.interaction_&&(this.interaction_.setActive(t.active),this.interaction_.on("change:active",(function(){e.setActive(e.interaction_.getActive())}))),t.toggleFn&&(t.onToggle=t.toggleFn),t.handleClick=function(){e.toggle(),t.onToggle&&t.onToggle.call(e,e.getActive())},t.className=(t.className||"")+" ol-toggle",o.Z.call(this,t),this.set("title",t.title),this.set("autoActivate",t.autoActivate),t.bar&&this.setSubBar(t.bar),this.setActive(t.active),this.setDisable(t.disable)};(0,r.Z)(n,o.Z),n.prototype.setMap=function(t){!t&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),o.Z.prototype.setMap.call(this,t),t&&(this.interaction_&&t.addInteraction(this.interaction_),this.subbar_&&t.addControl(this.subbar_))},n.prototype.getSubBar=function(){return this.subbar_},n.prototype.setSubBar=function(t){var e=this.getMap();e&&this.subbar_&&e.removeControl(this.subbar_),this.subbar_=t,t&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),e&&e.addControl(this.subbar_))},n.prototype.getDisable=function(){var t=this.element.querySelector("button");return t&&t.disabled},n.prototype.setDisable=function(t){this.getDisable()!=t&&(this.element.querySelector("button").disabled=t,t&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!t,disable:t}))},n.prototype.getActive=function(){return this.element.classList.contains("ol-active")},n.prototype.toggle=function(){this.getActive()?this.setActive(!1):this.setActive(!0)},n.prototype.setActive=function(t){this.interaction_&&this.interaction_.setActive(t),this.subbar_&&this.subbar_.setActive(t),this.getActive()!==t&&(t?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!t,active:t}))},n.prototype.setInteraction=function(t){this.interaction_=t},n.prototype.getInteraction=function(){return this.interaction_};const s=n},55517:(t,e,i)=>{i.d(e,{CT:()=>u,bj:()=>d,pJ:()=>_,wE:()=>p});var r,o=i(92083),n=i(7403),s=i(32562),a=i(2033),h=i(57276),c=i(28641),l=i(25108),u=function(t,e){var i=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(i*i+r*r)},d=function(t,e){return t[0]==e[0]&&t[1]==e[1]},p=function(t,e){var i,r,o,n,s,a,h,c,l,p,_,f,g,y=[],v=t.length-1,m=v,C=d(t[0],t[v]);C||(_=t[0],f=t[1],g=[_[0]+(f[1]-_[1])/u(_,f)*e,_[1]-(f[0]-_[0])/u(_,f)*e],y.push(g),t.push(t[v]),v++,m--);for(var w=0;w<m;w++)_=t[w],f=t[(w+1)%v],g=t[(w+2)%v],i=(f[1]-_[1])/(f[0]-_[0]),r=(g[1]-f[1])/(g[0]-f[0]),Math.abs(i-r)>1e-10&&(o=Math.sqrt((f[0]-_[0])*(f[0]-_[0])+(f[1]-_[1])*(f[1]-_[1])),n=Math.sqrt((g[0]-f[0])*(g[0]-f[0])+(g[1]-f[1])*(g[1]-f[1])),s=_[0]+e*(f[1]-_[1])/o,a=f[0]+e*(g[1]-f[1])/n,h=_[1]-e*(f[0]-_[0])/o,c=f[1]-e*(g[0]-f[0])/n,l=(r*a-i*s+h-c)/(r-i),p=(i*r*(a-s)+r*h-i*c)/(r-i),f[0]-_[0]==0&&(l=f[0]+e*(f[1]-_[1])/Math.abs(f[1]-_[1]),p=r*l-r*a+c),g[0]-f[0]==0&&(l=g[0]+e*(g[1]-f[1])/Math.abs(g[1]-f[1]),p=i*l-i*s+h),y.push([l,p]));return C?y.push(y[0]):(t.pop(),_=t[t.length-1],f=t[t.length-2],g=[_[0]-(f[1]-_[1])/u(_,f)*e,_[1]+(f[0]-_[0])/u(_,f)*e],y.push(g)),y},_=function(t,e){for(var i=0;i<e.length-1;i++){var r=e[i],o=e[i+1];if(d(t,r)||d(t,o))return{index:1,segment:[r,o]};var n=u(r,o),s=[(o[0]-r[0])/n,(o[1]-r[1])/n],a=u(r,t),h=[(t[0]-r[0])/a,(t[1]-r[1])/a];if(Math.abs(s[0]*h[1]-s[1]*h[0])<1e-10)return{index:1,segment:[r,o]}}return{index:-1}};(function(){function t(t,e){var i;for(let r=t.length-1;r>0;r--)(t[r][0]>e&&t[r-1][0]<e||t[r][0]<e&&t[r-1][0]>e)&&(i=[e,(e-t[r][0])/(t[r-1][0]-t[r][0])*(t[r-1][1]-t[r][1])+t[r][1]],t.splice(r,0,i))}function e(t,e){var i;for(let r=t.length-1;r>0;r--)(t[r][1]>e&&t[r-1][1]<e||t[r][1]<e&&t[r-1][1]>e)&&(i=[(e-t[r][1])/(t[r-1][1]-t[r][1])*(t[r-1][0]-t[r][0])+t[r][0],e],t.splice(r,0,i))}r=function(i,r){var o="Polygon"===r.getType();if(!o&&"MultiPolygon"!==r.getType())return null;var n=r.getCoordinates();return o&&(n=[n]),n.forEach((function(r){r.forEach((function(r){t(r,i[0]),t(r,i[2]),e(r,i[1]),e(r,i[3])}))})),n.forEach((function(t){t.forEach((function(t){t.forEach((function(t){t[0]<i[0]?t[0]=i[0]:t[0]>i[2]&&(t[0]=i[2]),t[1]<i[1]?t[1]=i[1]:t[1]>i[3]&&(t[1]=i[3])}))}))})),o?new a.ZP(n[0]):new s.Z(n)}})();var f=function(t,e,i,r){var o=[];!1!==r&&o.push(t);var n=u(t,e);if(n){var s=Math.round(n/i);if(s>1)for(var a=(e[0]-t[0])/s,h=(e[1]-t[1])/s,c=1;c<s;c++)o.push([t[0]+a*c,t[1]+h*c])}return o.push(e),o};o.Z.prototype.sampleAt=function(t){for(var e=this.getCoordinates(),i=[],r=1;r<e.length;r++)i=i.concat(f(e[r-1],e[r],t,1===r));return new o.Z(i)},n.Z.prototype.sampleAt=function(t){var e=this.getCoordinates(),i=[];return e.forEach((function(e){for(var r=[],o=1;o<e.length;o++)r=r.concat(f(e[o-1],e[o],t,1===o));i.push(r)})),new n.Z(i)},a.ZP.prototype.sampleAt=function(t){var e=this.getCoordinates(),i=[];return e.forEach((function(e){for(var r=[],o=1;o<e.length;o++)r=r.concat(f(e[o-1],e[o],t,1===o));i.push(r)})),new a.ZP(i)},s.Z.prototype.sampleAt=function(t){var e=this.getCoordinates(),i=[];return e.forEach((function(e){var r=[];i.push(r),e.forEach((function(e){for(var i=[],o=1;o<e.length;o++)i=i.concat(f(e[o-1],e[o],t,1===o));r.push(i)}))})),new s.Z(i)},h.Z.prototype.intersection=function(t,e){if(t.sampleAt){var i=(0,c.f3)(this.getCenter().concat(this.getCenter()),this.getRadius());t=r(i,t),t=t.simplify(e);var o=this.getCenter(),n=this.getRadius(),h=t.sampleAt(e).getCoordinates();switch(t.getType()){case"Polygon":h=[h];case"MultiPolygon":var d=!1,p=[];return h.forEach((function(t){var e=[];p.push(e),t.forEach((function(t){var i=[];e.push(i),t.forEach((function(t){var e=u(o,t);e>n?(d=!0,i.push([o[0]+n/e*(t[0]-o[0]),o[1]+n/e*(t[1]-o[1])])):i.push(t)}))}))})),d?"Polygon"===t.getType()?new a.ZP(p[0]):new s.Z(p):t}}else l.warn("[ol/geom/Circle~intersection] Unsupported geometry type: "+t.getType());return t}},31002:(t,e,i)=>{var r=i(55517),o=i(92083);o.Z.prototype.splitAt=function(t,e){var i;if(!t)return[this];if(e||(e=1e-10),t.length&&t[0].length){var n=[this];for(i=0;i<t.length;i++){for(var s=[],a=0;a<n.length;a++){var h=n[a].splitAt(t[i],e);s=s.concat(h)}n=s}return n}if((0,r.bj)(t,this.getFirstCoordinate())||(0,r.bj)(t,this.getLastCoordinate()))return[this];var c=this.getCoordinates(),l=[c[0]],u=[];for(i=0;i<c.length-1;i++)if(!(0,r.bj)(c[i],c[i+1])){if((0,r.bj)(t,c[i+1]))l.push(c[i+1]),u.push(new o.Z(l)),l=[];else if(!(0,r.bj)(t,c[i])){var d,p,_=!1;c[i][0]==c[i+1][0]?(d=(c[i][1]-t[1])/(c[i][1]-c[i+1][1]),_=c[i][0]==t[0]&&0<d&&d<=1):c[i][1]==c[i+1][1]?(d=(c[i][0]-t[0])/(c[i][0]-c[i+1][0]),_=c[i][1]==t[1]&&0<d&&d<=1):(d=(c[i][0]-t[0])/(c[i][0]-c[i+1][0]),p=(c[i][1]-t[1])/(c[i][1]-c[i+1][1]),_=Math.abs(d-p)<=e&&0<d&&d<=1),_&&(l.push(t),u.push(new o.Z(l)),l=[t])}l.push(c[i+1])}return l.length>1&&u.push(new o.Z(l)),u.length?u:[this]}},61806:(t,e,i)=>{i.d(e,{Z:()=>a});var r=i(10044),o=i(7517),n=i(22556),s=function(t){o.Z.call(this,t),this.on("select",function(t){this.getFeatures().clear(),this.delete(t.selected)}.bind(this))};(0,r.Z)(s,o.Z),s.prototype._getSources=function(t){if(!this.getMap())return[];t||(t=this.getMap().getLayers());var e=[];return t.forEach(function(t){t.getLayers?e=e.concat(this._getSources(t.getLayers())):t.getSource&&t.getSource()instanceof n.Z&&e.push(t.getSource())}.bind(this)),e},s.prototype.delete=function(t){if(t&&(t.length||t.getLength())){this.dispatchEvent({type:"deletestart",features:t});var e=[];this._getSources().forEach((function(i){try{t.forEach((function(t){i.removeFeature(t),e.push(t)}))}catch(r){}})),this.dispatchEvent({type:"deleteend",features:e})}};const a=s},60900:(t,e,i)=>{i.d(e,{Z:()=>l});var r=i(10044),o=i(2033),n=i(32562),s=i(67538),a=i(35010),h=i(7517),c=function(t){t||(t={});var e=this;this._select=new h.Z({style:t.style}),this._select.setActive(!1);var i,r=t.geometryFunction;if(i=r?function(t,i){return i=e._geometryFn(t,i),r(t,i)}:function(t,i){return e._geometryFn(t,i)},t.type="Polygon",t.geometryFunction=i,a.ZP.call(this,t),t.layers&&("function"===typeof t.layers?this.layers_=t.layers:t.layers.indexOf&&(this.layers_=function(e){return t.layers.indexOf(e)>=0})),"function"===typeof t.featureFilter)this._features=t.featureFilter;else if(t.featureFilter){var o=t.featureFilter;this._features=function(t){return o.indexOf?!!o[o.indexOf(t)]:!!o.item(o.getArray().indexOf(t))}}else this._features=function(){return!0};this.on("drawstart",this._startDrawing.bind(this)),this.on("drawend",this._finishDrawing.bind(this))};(0,r.Z)(c,a.ZP),c.prototype.setMap=function(t){this.getMap()&&this.getMap().removeInteraction(this._select),t&&t.addInteraction(this._select),a.ZP.prototype.setMap.call(this,t)},c.prototype.setActive=function(t){this._select.getFeatures().clear(),a.ZP.prototype.setActive.call(this,t)},c.prototype.removeLastPoint=function(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&a.ZP.prototype.removeLastPoint.call(this)},c.prototype.getPolygon=function(){return this._polygon},c.prototype._startDrawing=function(t){var e=this.getMap();this._feature=t.feature;var i=t.feature.getGeometry().getCoordinates()[0][0];this._current=null,e.forEachFeatureAtPixel(e.getPixelFromCoordinate(i),function(t,e){if(!this._current&&this._features(t,e)){var r=t.getGeometry();if("Polygon"===r.getType()&&r.intersectsCoordinate(i))this._polygonIndex=!1,this._polygon=r,this._current=t;else if("MultiPolygon"===r.getType()&&r.intersectsCoordinate(i))for(var o,n=0;o=r.getPolygon(n);n++)if(o.intersectsCoordinate(i)){this._polygonIndex=n,this._polygon=o,this._current=t;break}}}.bind(this),{layerFilter:this.layers_}),this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))},c.prototype._finishDrawing=function(t){t.hole=t.feature,t.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var e=t.hole.getGeometry().getCoordinates()[0];if(e.length>3)if(!1!==this._polygonIndex){for(var i,r=t.feature.getGeometry(),o=new n.Z([]),a=0;i=r.getPolygon(a);a++)a===this._polygonIndex?(i.appendLinearRing(new s.Z(e)),o.appendPolygon(i)):o.appendPolygon(i);t.feature.setGeometry(o)}else this.getPolygon().appendLinearRing(new s.Z(e));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()},c.prototype._geometryFn=function(t,e){var i=t[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(i)||(this.lastOKCoord=[i[0],i[1]]),t[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),e?e.setCoordinates([t[0].concat([t[0][0]])]):e=new o.ZP(t),e};const l=c},11308:(t,e,i)=>{i.d(e,{Z:()=>f});var r=i(10044),o=i(47182),n=i(11110),s=i(78714),a=i(92371),h=i(22556),c=i(57276),l=i(2033),u=i(60188),d=i(92083),p=i(81090),_=function(t){t||(t={}),this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.maxCircleCoordinates_=t.maxCircleCoordinates||100,this.features_=t.features,this.source_=t.source,this.conditionFn_=t.condition,this.squareFn_=t.squareCondition,this.centeredFn_=t.centerCondition,this.canRotate_=!1!==t.canRotate,this.geometryName_=t.geometryName,this.setSides(t.sides);var e=(0,n.Z)(!0);this.sketch_=new s.Z,this.overlayLayer_=new a.Z({source:new h.Z({features:this.sketch_,useSpatialIndex:!1}),name:"DrawRegular overlay",displayInLayerSwitcher:!1,style:t.style||e}),o.ZP.call(this,{handleEvent:this.handleEvent_})};(0,r.Z)(_,o.ZP),_.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),o.ZP.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},_.prototype.setActive=function(t){this.reset(),o.ZP.prototype.setActive.call(this,t)},_.prototype.reset=function(){this.overlayLayer_.getSource().clear(),this.started_=!1},_.prototype.setSides=function(t){t=parseInt(t),this.sides_=t>2?t:0},_.prototype.canRotate=function(t){return!0!==t&&!1!==t||(this.canRotate_=t),this.canRotate_},_.prototype.getSides=function(){return this.sides_},_.prototype.startAngle={default:Math.PI/2,3:-Math.PI/2,4:Math.PI/4},_.prototype.getGeom_=function(){if(this.overlayLayer_.getSource().clear(),!this.center_)return!1;var t;if(this.coord_){var e,i,r,o,n,s=this.center_,a=this.coord_;if(!this.sides_&&this.square_&&!this.centered_)return s=[(a[0]+s[0])/2,(a[1]+s[1])/2],e=[a[0]-s[0],a[1]-s[1]],r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=new c.Z(s,r,"XY"),n=this.getMap().getPixelFromCoordinate(s),i=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),i=Math.min(this.maxCircleCoordinates_,Math.round(i/3)),(0,l.Bb)(o,i,0);var h=this.canRotate_&&this.centered_&&this.square_;if(e=[a[0]-s[0],a[1]-s[1]],this.square_&&!h){var d=Math.max(Math.abs(e[0]),Math.abs(e[1]));a=[s[0]+(e[0]>0?d:-d),s[1]+(e[1]>0?d:-d)]}if(r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),r>0){var p;if(o=new c.Z(s,r,"XY"),p=h?Math.atan2(e[1],e[0]):this.startAngle[this.sides_]||this.startAngle["default"],this.sides_?t=(0,l.Bb)(o,this.sides_,p):(n=this.getMap().getPixelFromCoordinate(this.center_),i=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),i=Math.min(this.maxCircleCoordinates_,Math.round(i/(this.centered_?3:5))),t=(0,l.Bb)(o,i,0)),h)return t;var _=t.getExtent();s=this.centered_?[2*this.center_[0]-this.coord_[0],2*this.center_[1]-this.coord_[1]]:this.center_;var f=(s[0]-a[0])/(_[0]-_[2]),g=(s[1]-a[1])/(_[1]-_[3]);if(this.square_){var y=Math.min(Math.abs(f),Math.abs(g));f=Math.sign(f)*y,g=Math.sign(g)*y}var v=[s[0]-_[0]*f,s[1]-_[1]*g];return t.applyTransform((function(t,e,i){for(var r=0;r<t.length;r+=i)e[r]=t[r]*f+v[0],e[r+1]=t[r+1]*g+v[1];return e})),t}}return new u.Z(this.center_)},_.prototype.drawSketch_=function(t){if(this.overlayLayer_.getSource().clear(),t){this.square_=this.squareFn_?this.squareFn_(t):t.originalEvent.shiftKey,this.centered_=this.centeredFn_?this.centeredFn_(t):t.originalEvent.metaKey||t.originalEvent.ctrlKey;var e=this.getGeom_();if(e){var i=this.feature_;return"Polygon"===e.getType()&&i.getGeometry().setCoordinates(e.getCoordinates()),this.overlayLayer_.getSource().addFeature(i),this.coord_&&this.square_&&(this.canRotate_&&this.centered_&&this.coord_||!this.sides_&&!this.centered_)&&this.overlayLayer_.getSource().addFeature(new p.Z(new d.Z([this.center_,this.coord_]))),i}}},_.prototype.drawPoint_=function(t,e){e||this.overlayLayer_.getSource().clear(),this.overlayLayer_.getSource().addFeature(new p.Z(new u.Z(t)))},_.prototype.handleEvent_=function(t){var e,i;switch(this._eventTime=new Date,t.type){case"pointerdown":if(this.conditionFn_&&!this.conditionFn_(t))break;this.downPx_=t.pixel,this.start_(t);var r=500;this._longTouch=!1,setTimeout(function(){this._longTouch=new Date-this._eventTime>.9*r,this._longTouch&&this.handleMoveEvent_(t)}.bind(this),r);break;case"pointerup":this.started_&&this.coord_&&(e=this.downPx_[0]-t.pixel[0],i=this.downPx_[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_&&("pointermove"==this.lastEvent||"keydown"==this.lastEvent?this.end_(t):(e=this.upPx_[0]-t.pixel[0],i=this.upPx_[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_?this.end_(t):(this.handleMoveEvent_(t),this.drawPoint_(t.coordinate,!0))))),this.upPx_=t.pixel;break;case"pointerdrag":if(this.started_){var o=this.getMap().getPixelFromCoordinate(this.center_);e=o[0]-t.pixel[0],i=o[1]-t.pixel[1],e*e+i*i<=this.squaredClickTolerance_&&this.reset()}return!this._longTouch;case"pointermove":this.started_&&(e=this.downPx_[0]-t.pixel[0],i=this.downPx_[1]-t.pixel[1],e*e+i*i>this.squaredClickTolerance_&&(this.handleMoveEvent_(t),this.lastEvent=t.type));break;default:if(this.lastEvent=t.type,this.started_&&"dblclick"===t.type)return!1;break}return!0},_.prototype.finishDrawing=function(){this.started_&&this.coord_&&this.end_({pixel:this.upPx_,coordinate:this.coord_})},_.prototype.handleMoveEvent_=function(t){if(this.started_){this.coord_=t.coordinate,this.coordPx_=t.pixel;var e=this.drawSketch_(t);this.dispatchEvent({type:"drawing",feature:e,pixel:t.pixel,startCoordinate:this.center_,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}else this.drawPoint_(t.coordinate)},_.prototype.start_=function(t){if(this.started_)this.coord_=t.coordinate;else{this.started_=!0,this.center_=t.coordinate,this.coord_=null;var e=this.feature_=new p.Z({});e.setGeometryName(this.geometryName_),e.setGeometry(new l.ZP([[t.coordinate,t.coordinate,t.coordinate]])),this.drawSketch_(t),this.dispatchEvent({type:"drawstart",feature:e,pixel:t.pixel,coordinate:t.coordinate})}},_.prototype.end_=function(t){if(this.coord_=t.coordinate,this.started_=!1,!this.coord_||this.center_[0]===this.coord_[0]&&this.center_[1]===this.coord_[1])this.dispatchEvent({type:"drawcancel",feature:null,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_});else{var e=this.feature_;e.setGeometry(this.getGeom_()),this.source_?this.source_.addFeature(e):this.features_&&this.features_.push(e),this.dispatchEvent({type:"drawend",feature:e,pixel:t.pixel,coordinate:t.coordinate,square:this.square_,centered:this.centered_})}this.center_=this.coord_=null,this.drawSketch_()};const f=_},43179:(t,e,i)=>{i.d(e,{Z:()=>C});var r=i(10044),o=i(14515),n=i(47539),s=i(58958),a=i(22556),h=i(51345),c=i(30283),l=i(92371),u=i(60188),d=i(81090),p=i(92083),_=i(47182),f=i(55517),g=i(28641),y=i(98683),v=(i(31002),i(25108)),m=function(t){var e,i;t||(t={}),o.Z.call(this,{handleEvent:function(t){switch(t.type){case"pointerdown":return e=this.handleDownEvent(t),i=e||this._deleteCondition(t),!e;case"pointerup":return e=!1,this.handleUpEvent(t);case"pointerdrag":return!e||this.handleDragEvent(t);case"pointermove":return!!e||this.handleMoveEvent(t);case"singleclick":case"click":return!i;default:return!0}}}),this.snapDistance_=t.pixelTolerance||10,this.tolerance_=1e-10,this.cursor_=t.cursor,this.sources_=t.sources?t.sources instanceof Array?t.sources:[t.sources]:[],t.source&&this.sources_.push(t.source),t.features&&this.sources_.push(new a.Z({features:t.features})),this.filterSplit_=t.filter||function(){return!0},this._condition=t.condition||y.Xp,this._deleteCondition=t.deleteCondition||y.Ko,this._insertVertexCondition=t.insertVertexCondition||y.Bx;var r=function(){return[new n.ZP({image:new c.Z({radius:6,fill:new h.Z({color:[0,153,255,1]}),stroke:new s.Z({color:"#FFF",width:1.25})})})]};t.style&&(r="function"===typeof t.style?t.style:function(){return t.style}),this.overlayLayer_=new l.Z({source:new a.Z({useSpatialIndex:!1}),name:"Modify overlay",displayInLayerSwitcher:!1,style:r,wrapX:t.wrapX})};(0,r.Z)(m,o.Z),m.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),_.ZP.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},m.prototype.setActive=function(t){_.ZP.prototype.setActive.call(this,t),this.overlayLayer_&&this.overlayLayer_.getSource().clear()},m.prototype.setFilter=function(t){"function"===typeof t?this.filterSplit_=t:void 0===t&&(this.filterSplit_=function(){return!0})},m.prototype.getClosestFeature=function(t){for(var e,i,r=this.snapDistance_+1,o=0;o<this.sources_.length;o++){var n=this.sources_[o];if(e=n.getClosestFeatureToCoordinate(t.coordinate),e&&this.filterSplit_(e)){var s=e.getGeometry().getClosestPoint(t.coordinate),a=(0,f.CT)(t.coordinate,s)/t.frameState.viewState.resolution;a<r&&(r=a,i=s);break}}if(r>this.snapDistance_)return this.currentFeature&&this.dispatchEvent({type:"select",selected:[],deselected:[this.currentFeature]}),this.currentFeature=null,!1;var h=this.getNearestCoord(i,e.getGeometry());if(h){h=h.coord;var c=this.getMap().getPixelFromCoordinate(h);return(0,f.CT)(t.pixel,c)<this.snapDistance_&&(i=h),this.currentFeature!==e&&this.dispatchEvent({type:"select",selected:[e],deselected:[this.currentFeature]}),this.currentFeature=e,{source:n,feature:e,coord:i}}},m.prototype.getNearestCoord=function(t,e){var i,r,o,n,s;switch(e.getType()){case"Point":return{coord:e.getCoordinates(),dist:(0,f.CT)(e.getCoordinates(),t)};case"MultiPoint":return this.getNearestCoord(t,new p.Z(e.getCoordinates()));case"LineString":case"LinearRing":var a;s=Number.MAX_VALUE;var h=e.getCoordinates();for(i=0;i<h.length;i++)a=(0,f.CT)(t,h[i]),a<s&&(s=a,n=h[i]);return{coord:n,dist:s};case"MultiLineString":var c=e.getLineStrings();for(n=!1,s=Number.MAX_VALUE,i=0;r=c[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<s&&(n=o,s=o.dist,n.ring=i);return n;case"Polygon":var l=e.getLinearRings();for(n=!1,s=Number.MAX_VALUE,i=0;r=l[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<s&&(n=o,s=o.dist,n.ring=i);return n;case"MultiPolygon":var u=e.getPolygons();for(n=!1,s=Number.MAX_VALUE,i=0;r=u[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<s&&(n=o,s=o.dist,n.poly=i);return n;case"GeometryCollection":var d=e.getGeometries();for(n=!1,s=Number.MAX_VALUE,i=0;r=d[i];i++)o=this.getNearestCoord(t,r),o&&o.dist<s&&(n=o,s=o.dist,n.geom=i);return n;default:return!1}},m.prototype.getArcs=function(t,e){var i,r,o,n,s,a=!1;switch(t.getType()){case"Point":(0,f.bj)(e,t.getCoordinates())&&(a={geom:t,type:t.getType(),coord1:[],coord2:[],node:!0});break;case"MultiPoint":for(i=t.getCoordinates(),r=0;r<i.length;r++)if((0,f.bj)(e,i[r])){a={geom:t,type:t.getType(),index:r,coord1:[],coord2:[],node:!0};break}break;case"LinearRing":case"LineString":var h=t.getClosestPoint(e);if((0,f.CT)(h,e)<1.5*this.tolerance_){var c;if("LinearRing"===t.getType()?(s=new p.Z(t.getCoordinates()),c=s.splitAt(e,this.tolerance_)):c=t.splitAt(e,this.tolerance_),c.length>2){for(i=c[1].getCoordinates(),r=2;o=c[r];r++){var l=o.getCoordinates();l.shift(),i=i.concat(l)}c=[c[0],new p.Z(i)]}if(2===c.length){var u=c[0].getCoordinates(),d=c[1].getCoordinates(),_=u.length+d.length-1;u.pop(),d.shift(),a={geom:t,type:t.getType(),coord1:u,coord2:d,node:t.getCoordinates().length===_,closed:!1}}else if(1===c.length){o=c[0].getCoordinates();var g=(0,f.bj)(o[0],e),y=(0,f.bj)(o[o.length-1],e);g?(o.shift(),y&&o.pop(),a={geom:t,type:t.getType(),coord1:[],coord2:o,node:!0,closed:y}):y&&(o.pop(),a={geom:t,type:t.getType(),coord1:o,coord2:[],node:!0,closed:!1})}}break;case"MultiLineString":var m=t.getLineStrings();for(r=0;n=m[r];r++)if(a=this.getArcs(n,e),a){a.geom=t,a.type=t.getType(),a.lstring=r;break}break;case"Polygon":var C=t.getLinearRings();for(r=0;n=C[r];r++)if(a=this.getArcs(n,e),a){a.geom=t,a.type=t.getType(),a.index=r;break}break;case"MultiPolygon":var w=t.getPolygons();for(r=0;n=w[r];r++)if(a=this.getArcs(n,e),a){a.geom=t,a.type=t.getType(),a.poly=r;break}break;case"GeometryCollection":for(s=t.getGeometries(),r=0;n=s[r];r++)if(a=this.getArcs(n,e),a){a.geom=t,a.g=r,a.typeg=a.type,a.type=t.getType();break}break;default:v.error("ol/interaction/ModifyFeature "+t.getType()+" not supported!");break}return a},m.prototype.handleDownEvent=function(t){if(!this.getActive())return!1;var e=this.getClosestFeature(t);if(e&&(this._condition(t)||this._deleteCondition(t))){var i=[];return this.arcs=[],this.sources_.forEach(function(t){var r=(0,g.f3)((0,g.hI)([e.coord]),this.tolerance_);i=i.concat(i,t.getFeaturesInExtent(r))}.bind(this)),this._modifiedFeatures=[],i.forEach(function(i){var r=this.getArcs(i.getGeometry(),e.coord);r&&(this._insertVertexCondition(t)||r.node)&&(r.feature=i,this._modifiedFeatures.push(i),this.arcs.push(r))}.bind(this)),!this._modifiedFeatures.length||(this._deleteCondition(t)?!this._removePoint(e,t):(this.dispatchEvent({type:"modifystart",coordinate:e.coord,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.handleDragEvent({coordinate:e.coord,originalEvent:t.originalEvent}),!0))}return!1},m.prototype.getModifiedFeatures=function(){return this._modifiedFeatures||[]},m.prototype.removePoint=function(){this._removePoint({},{})},m.prototype._getModification=function(t){var e=t.coord1.concat(t.coord2);switch(t.type){case"LineString":if(t.closed&&e.push(e[0]),e.length>1&&t.geom.getCoordinates().length!=e.length)return t.coords=e,!0;break;case"MultiLineString":if(t.closed&&e.push(e[0]),e.length>1){var i=t.geom.getCoordinates();if(i[t.lstring].length!=e.length)return i[t.lstring]=e,t.coords=i,!0}break;case"Polygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates(),i[t.index].length!=e.length))return i[t.index]=e,t.coords=i,!0;break;case"MultiPolygon":if(t.closed&&e.push(e[0]),e.length>3&&(i=t.geom.getCoordinates(),i[t.poly][t.index].length!=e.length))return i[t.poly][t.index]=e,t.coords=i,!0;break;case"GeometryCollection":t.type=t.typeg;var r=t.geom,o=r.getGeometries();t.geom=o[t.g];var n=this._getModification(t);return r.setGeometries(o),t.geom=r,t.type="GeometryCollection",n;default:break}return!1},m.prototype._removePoint=function(t,e){if(!this.arcs)return!1;this.overlayLayer_.getSource().clear();var i=!1;return this.arcs.forEach(function(t){i=i||this._getModification(t)}.bind(this)),i&&(this.dispatchEvent({type:"modifystart",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures}),this.arcs.forEach(function(t){if("GeometryCollection"===t.geom.getType()){if(t.coords){var e=t.geom.getGeometries();e[t.g].setCoordinates(t.coords),t.geom.setGeometries(e)}}else t.coords&&t.geom.setCoordinates(t.coords)}.bind(this)),this.dispatchEvent({type:"modifyend",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures})),this.arcs=[],i},m.prototype.handleUpEvent=function(t){return!!this.getActive()&&(!this.arcs||!this.arcs.length||(this.overlayLayer_.getSource().clear(),this.dispatchEvent({type:"modifyend",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.arcs=[],!0))},m.prototype.setArcCoordinates=function(t,e){var i;switch(t.type){case"Point":t.geom.setCoordinates(e[0]);break;case"MultiPoint":i=t.geom.getCoordinates(),i[t.index]=e[0],t.geom.setCoordinates(i);break;case"LineString":t.geom.setCoordinates(e);break;case"MultiLineString":i=t.geom.getCoordinates(),i[t.lstring]=e,t.geom.setCoordinates(i);break;case"Polygon":i=t.geom.getCoordinates(),i[t.index]=e,t.geom.setCoordinates(i);break;case"MultiPolygon":i=t.geom.getCoordinates(),i[t.poly][t.index]=e,t.geom.setCoordinates(i);break;case"GeometryCollection":t.type=t.typeg;var r=t.geom,o=r.getGeometries();t.geom=o[t.g],this.setArcCoordinates(t,e),r.setGeometries(o),t.geom=r,t.type="GeometryCollection";break}},m.prototype.handleDragEvent=function(t){if(!this.getActive())return!1;if(!this.arcs)return!0;this.overlayLayer_.getSource().clear();var e=new d.Z(new u.Z(t.coordinate));return this.overlayLayer_.getSource().addFeature(e),!this.arcs.length||(this.arcs.forEach(function(e){var i=e.coord1.concat([t.coordinate],e.coord2);e.closed&&i.push(t.coordinate),this.setArcCoordinates(e,i)}.bind(this)),this.dispatchEvent({type:"modifying",coordinate:t.coordinate,originalEvent:t.originalEvent,features:this._modifiedFeatures}),!0)},m.prototype.handleMoveEvent=function(t){if(!this.getActive())return!1;this.overlayLayer_.getSource().clear();var e=this.getClosestFeature(t);if(e){var i=new d.Z(new u.Z(e.coord));this.overlayLayer_.getSource().addFeature(i)}var r=t.map.getTargetElement();this.cursor_&&(e?r.style.cursor!=this.cursor_&&(this.previousCursor_=r.style.cursor,r.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(r.style.cursor=this.previousCursor_,this.previousCursor_=void 0))},m.prototype.getCurrentFeature=function(){return this.currentFeature};const C=m},2884:(t,e,i)=>{i.d(e,{Z:()=>l});var r=i(10044),o=i(14515),n=i(92083),s=i(2033),a=i(55517),h=i(11110),c=function(t){t||(t={}),o.Z.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this._filter=t.filter,this.features_=t.features,this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this.set("duplicate",t.duplicate),this.source_=t.source,this._style="function"===typeof t.style?t.style:function(){return t.style?t.style:(0,h.Z)(!0)},this.previousCursor_=!1};(0,r.Z)(c,o.Z),c.prototype.setMap=function(t){o.Z.prototype.setMap.call(this,t)},c.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t.pixel,(function(i,r){var o;if(e._filter&&!e._filter(i,r))return!1;if(e.layers_){for(var n=0;n<e.layers_.length;n++)if(e.layers_[n]===r){o=i;break}}else e.features_?e.features_.forEach((function(t){t===i&&(o=i)})):o=i;var s=o.getGeometry().getType();if(o&&/Polygon|LineString/.test(s)){if("Polygon"===s&&o.getGeometry().getCoordinates().length>1)return!1;var a=o.getGeometry().getClosestPoint(t.coordinate),h=a[0]-t.coordinate[0],c=a[1]-t.coordinate[1],l=Math.sqrt(h*h+c*c)/t.frameState.viewState.resolution;return l<5&&{feature:o,hit:a,coordinates:o.getGeometry().getCoordinates(),geom:o.getGeometry().clone(),geomType:s}}return!1}),{hitTolerance:5})},c.prototype.handleDownEvent_=function(t){return this.current_=this.getFeatureAtPixel_(t),!!this.current_&&(this.currentStyle_=this.current_.feature.getStyle(),this.source_&&(this.get("duplicate")||t.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.current_.feature.setStyle(this._style(this.current_.feature)),this.source_.addFeature(this.current_.feature)):(this.current_.feature.setStyle(this._style(this.current_.feature)),this._modifystart=!0),this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0)},c.prototype.handleDragEvent_=function(t){this._modifystart&&(this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),this._modifystart=!1);var e,i,r,o,h=this.current_.geom.getClosestPoint(t.coordinate),c=(0,a.CT)(h,t.coordinate);switch(this.current_.geomType){case"Polygon":if(e=(0,a.pJ)(h,this.current_.coordinates[0]).segment,e){i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],r=[t.coordinate[0]-h[0],t.coordinate[1]-h[1]],i[0]*r[1]-i[1]*r[0]>0&&(c=-c),o=[];for(var l=0;l<this.current_.coordinates.length;l++)o.push((0,a.wE)(this.current_.coordinates[l],0==l?c:-c));this.current_.feature.setGeometry(new s.ZP(o))}break;case"LineString":e=(0,a.pJ)(h,this.current_.coordinates).segment,e&&(i=[e[1][0]-e[0][0],e[1][1]-e[0][1]],r=[t.coordinate[0]-h[0],t.coordinate[1]-h[1]],i[0]*r[1]-i[1]*r[0]>0&&(c=-c),o=(0,a.wE)(this.current_.coordinates,c),this.current_.feature.setGeometry(new n.Z(o)));break;default:break}this.dispatchEvent({type:"offsetting",feature:this.current_.feature,offset:c,segment:[h,t.coordinate],coordinate:t.coordinate})},c.prototype.handleUpEvent_=function(t){this._modifystart||this.dispatchEvent({type:"offsetend",feature:this.current_.feature,coordinate:t.coordinate}),this.current_.feature.setStyle(this.currentStyle_),this.current_=!1},c.prototype.handleMoveEvent_=function(t){var e=this.getFeatureAtPixel_(t);e?(!1===this.previousCursor_&&(this.previousCursor_=t.map.getTargetElement().style.cursor),t.map.getTargetElement().style.cursor="pointer"):(t.map.getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=!1)};const l=c},65310:(t,e,i)=>{i.d(e,{Z:()=>g});var r=i(10044),o=i(47182),n=i(47539),s=i(58958),a=i(22556),h=i(51345),c=i(30283),l=i(92371),u=i(60188),d=i(81090),p=i(92083),_=i(55517),f=(i(31002),function(t){t||(t={}),o.ZP.call(this,{handleEvent:function(t){switch(t.type){case"singleclick":return this.handleDownEvent(t);case"pointermove":return this.handleMoveEvent(t);default:return!0}}}),this.snapDistance_=t.snapDistance||25,this.tolerance_=t.tolerance||1e-10,this.cursor_=t.cursor,this.setSources(t.sources),t.features&&this.sources_.push(new a.Z({features:t.features})),this.filterSplit_=t.filter||function(){return!0};var e=[255,255,255,1],i=[0,153,255,1],r=3,u=new h.Z({color:"rgba(255,255,255,0.4)"}),d=new s.Z({color:"#3399CC",width:1.25}),p=[new n.ZP({image:new c.Z({fill:u,stroke:d,radius:5}),fill:u,stroke:d})],_=[new n.ZP({stroke:new s.Z({color:e,width:r+2})}),new n.ZP({image:new c.Z({radius:2*r,fill:new h.Z({color:i}),stroke:new s.Z({color:e,width:r/2})}),stroke:new s.Z({color:i,width:r})})];t.sketchStyle&&(p=t.sketchStyle instanceof Array?t.sketchStyle:[t.sketchStyle]),t.featureStyle&&(_=t.featureStyle instanceof Array?t.featureStyle:[t.featureStyle]),this.overlayLayer_=new l.Z({source:new a.Z({useSpatialIndex:!1}),name:"Split overlay",displayInLayerSwitcher:!1,style:function(t){return t._sketch_?p:_}})});(0,r.Z)(f,o.ZP),f.prototype.setMap=function(t){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),o.ZP.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t)},f.prototype.getSources=function(){if(!this.sources_&&this.getMap()){var t=[];function e(i){i.forEach((function(i){i.getVisible()&&(i.getSource&&i.getSource()instanceof a.Z?t.unshift(i.getSource()):i.getLayers&&e(i.getLayers()))}))}return e(this.getMap().getLayers()),t}return this.sources_||[]},f.prototype.setSources=function(t){this.sources_=!!t&&(t instanceof Array?t||!1:[t])},f.prototype.getClosestFeature=function(t){var e,i,r,o,n=this.snapDistance_+1;if(this.getSources().forEach((function(s){var a=s.getClosestFeatureToCoordinate(t.coordinate);if(a&&a.getGeometry().splitAt){var h=a.getGeometry().getClosestPoint(t.coordinate),c=new p.Z([t.coordinate,h]),l=c.getLength()/t.frameState.viewState.resolution;l<n&&(e=s,n=l,i=a,o=c,r=h)}})),n>this.snapDistance_)return!1;var s=this.getNearestCoord(r,i.getGeometry().getCoordinates()),a=this.getMap().getPixelFromCoordinate(s);return(0,_.CT)(t.pixel,a)<this.snapDistance_&&(r=s),{source:e,feature:i,coord:r,link:o}},f.prototype.getNearestCoord=function(t,e){for(var i,r,o=Number.MAX_VALUE,n=0;n<e.length;n++)i=(0,_.CT)(t,e[n]),i<o&&(o=i,r=e[n]);return r},f.prototype.handleDownEvent=function(t){var e=this.getClosestFeature(t);if(e){var i=this;i.overlayLayer_.getSource().clear();var r,o=e.feature.getGeometry().splitAt(e.coord,this.tolerance_);if(o.length>1){var n=[];for(r=0;r<o.length;r++){var s=e.feature.clone();s.setGeometry(o[r]),n.push(s)}for(i.dispatchEvent({type:"beforesplit",original:e.feature,features:n}),e.source.dispatchEvent({type:"beforesplit",original:e.feature,features:n}),e.source.removeFeature(e.feature),r=0;r<n.length;r++)e.source.addFeature(n[r]);i.dispatchEvent({type:"aftersplit",original:e.feature,features:n}),e.source.dispatchEvent({type:"aftersplit",original:e.feature,features:n})}}return!1},f.prototype.handleMoveEvent=function(t){var e=t.map;this.overlayLayer_.getSource().clear();var i,r,o=this.getClosestFeature(t);o&&this.filterSplit_(o.feature)?(this.overlayLayer_.getSource().addFeature(o.feature),i=new d.Z(new u.Z(o.coord)),i._sketch_=!0,this.overlayLayer_.getSource().addFeature(i),r=new d.Z(o.link),r._sketch_=!0,this.overlayLayer_.getSource().addFeature(r),this.dispatchEvent({type:"pointermove",coordinate:t.coordinate,frameState:t.frameState,originalEvent:t.originalEvent,map:t.map,pixel:t.pixel,feature:o.feature,linkGeometry:o.link})):this.dispatchEvent(t);var n=e.getTargetElement();this.cursor_&&(o?n.style.cursor!=this.cursor_&&(this.previousCursor_=n.style.cursor,n.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0))};const g=f},73159:(t,e,i)=>{i.d(e,{Z:()=>w});var r=i(10044),o=i(47539),n=i(58958),s=i(22556),a=i(51345),h=i(92371),c=i(60188),l=i(81090),u=i(78714),d=i(14515),p=i(35393),_=i(2033),f=i(28641),g=i(62706),y=function(t){t||(t={});var e=this;this.selection_=new u.Z,this.handles_=new u.Z,this.overlayLayer_=new h.Z({source:new s.Z({features:this.handles_,useSpatialIndex:!1,wrapX:!1}),name:"Transform overlay",displayInLayerSwitcher:!1,style:function(t){return e.style[(t.get("handle")||"default")+(t.get("constraint")||"")+(t.get("option")||"")]}}),d.Z.call(this,{handleDownEvent:this.handleDownEvent_,handleDragEvent:this.handleDragEvent_,handleMoveEvent:this.handleMoveEvent_,handleUpEvent:this.handleUpEvent_}),this.features_=t.features,"function"===typeof t.filter&&(this._filter=t.filter),this.layers_=t.layers?t.layers instanceof Array?t.layers:[t.layers]:null,this._handleEvent=t.condition||function(){return!0},this.addFn_=t.addCondition||function(){return!1},this.setPointRadius(t.pointRadius),this.set("translateFeature",!1!==t.translateFeature),this.set("translate",!1!==t.translate),this.set("translateBBox",!0===t.translateBBox),this.set("stretch",!1!==t.stretch),this.set("scale",!1!==t.scale),this.set("rotate",!1!==t.rotate),this.set("keepAspectRatio",t.keepAspectRatio||function(t){return t.originalEvent.shiftKey}),this.set("modifyCenter",t.modifyCenter||function(t){return t.originalEvent.metaKey||t.originalEvent.ctrlKey}),this.set("noFlip",t.noFlip||!1),this.set("selection",!1!==t.selection),this.set("hitTolerance",t.hitTolerance||0),this.set("enableRotatedTransform",t.enableRotatedTransform||!1),this.set("keepRectangle",t.keepRectangle||!1),this.on("propertychange",(function(){this.drawSketch_()})),this.setDefaultStyle()};function v(t,e){var i=(t[0]*e[0]+t[1]*e[1])/(e[0]*e[0]+e[1]*e[1]);return[e[0]*i,e[1]*i]}function m(t,e){return[e[0]-t[0],e[1]-t[1]]}function C(t,e){return[t[0]+e[0],t[1]+e[1]]}(0,r.Z)(y,d.Z),y.prototype.Cursors={default:"auto",select:"pointer",translate:"move",rotate:"move",rotate0:"move",scale:"nesw-resize",scale1:"nwse-resize",scale2:"nesw-resize",scale3:"nwse-resize",scalev:"ew-resize",scaleh1:"ns-resize",scalev2:"ew-resize",scaleh3:"ns-resize"},y.prototype.setMap=function(t){var e=this.getMap();if(e){var i=e.getTargetElement();e.removeLayer(this.overlayLayer_),this.previousCursor_&&i&&(i.style.cursor=this.previousCursor_),this.previousCursor_=void 0}d.Z.prototype.setMap.call(this,t),this.overlayLayer_.setMap(t),null===t&&this.select(null),null!==t&&(this.isTouch=/touch/.test(t.getViewport().className),this.setDefaultStyle())},y.prototype.setActive=function(t){this.select(null),this.overlayLayer_.setVisible(t),d.Z.prototype.setActive.call(this,t)},y.prototype.setDefaultStyle=function(t){t=t||{};var e=t.pointStroke||new n.Z({color:[255,0,0,1],width:1}),i=t.stroke||new n.Z({color:[255,0,0,1],width:1,lineDash:[4,4]}),r=t.fill||new a.Z({color:[255,0,0,.01]}),s=t.pointFill||new a.Z({color:[255,255,255,.8]}),h=new p.Z({fill:s,stroke:e,radius:this.isTouch?12:6,displacement:this.isTouch?[24,-24]:[12,-12],points:15});h.setDisplacement||(h.getAnchor()[0]=this.isTouch?-10:-5);var c=new p.Z({fill:s,stroke:e,radius:this.isTouch?16:8,points:4,angle:Math.PI/4}),l=new p.Z({fill:s,stroke:e,radius:this.isTouch?12:6,points:4,angle:Math.PI/4});function u(t,e,i){return[new o.ZP({image:t,stroke:e,fill:i})]}this.style={default:u(c,i,r),translate:u(c,e,s),rotate:u(h,e,s),rotate0:u(c,e,s),scale:u(c,e,s),scale1:u(c,e,s),scale2:u(c,e,s),scale3:u(c,e,s),scalev:u(l,e,s),scaleh1:u(l,e,s),scalev2:u(l,e,s),scaleh3:u(l,e,s)},this.drawSketch_()},y.prototype.setStyle=function(t,e){if(e){this.style[t]=e instanceof Array?e:[e];for(var i=0;i<this.style[t].length;i++){var r=this.style[t][i].getImage();r&&("rotate"==t&&(r.getAnchor()[0]=-5),this.isTouch&&r.setScale(1.8));var o=this.style[t][i].getText();o&&("rotate"==t&&o.setOffsetX(this.isTouch?14:7),this.isTouch&&o.setScale(1.8))}this.drawSketch_()}},y.prototype.getFeatureAtPixel_=function(t){var e=this;return this.getMap().forEachFeatureAtPixel(t,(function(t,i){var r=!1;if(!i){if(t===e.bbox_)return!!e.get("translateBBox")&&{feature:t,handle:"translate",constraint:"",option:""};if(e.handles_.forEach((function(e){e===t&&(r=!0)})),r)return{feature:t,handle:t.get("handle"),constraint:t.get("constraint"),option:t.get("option")}}if(!e.get("selection"))return e.selection_.getArray().some((function(e){return t===e}))?{feature:t}:null;if(e._filter)return e._filter(t,i)?{feature:t}:null;if(e.layers_){for(var o=0;o<e.layers_.length;o++)if(e.layers_[o]===i)return{feature:t};return null}return e.features_?(e.features_.forEach((function(e){e===t&&(r=!0)})),r?{feature:t}:null):{feature:t}}),{hitTolerance:this.get("hitTolerance")})||{}},y.prototype.getGeometryRotateToZero_=function(t,e){var i=t.getGeometry(),r=this.getMap().getView().getRotation();if(0===r||!this.get("enableRotatedTransform"))return e?i.clone():i;var o=i.clone();return o.rotate(-1*r,this.getMap().getView().getCenter()),o},y.prototype._isRectangle=function(t){if(this.get("keepRectangle")&&"Polygon"===t.getType()){var e=t.getCoordinates()[0];return 5===e.length}return!1},y.prototype.drawSketch_=function(t){var e,i,r,o=this.selection_.item(0)&&this._isRectangle(this.selection_.item(0).getGeometry());if(this.overlayLayer_.getSource().clear(),this.selection_.getLength()){var n,s=this.getMap().getView().getRotation(),a=this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();o&&(n=this.getGeometryRotateToZero_(this.selection_.item(0)).getCoordinates()[0].slice(0,4),n.unshift(n[3])),a=(0,f.f3)(a,0),this.selection_.forEach(function(t){var e=this.getGeometryRotateToZero_(t).getExtent();(0,f.l7)(a,e)}.bind(this));var h=1===this.selection_.getLength()?this._pointRadius(this.selection_.item(0)):0;if(!h||h instanceof Array||(h=[h,h]),!0===t)this.ispt_||(this.overlayLayer_.getSource().addFeature(new l.Z({geometry:new c.Z(this.center_),handle:"rotate0"})),r=(0,_.oJ)(a),this.get("enableRotatedTransform")&&0!==s&&r.rotate(s,this.getMap().getView().getCenter()),i=this.bbox_=new l.Z(r),this.overlayLayer_.getSource().addFeature(i));else{if(this.ispt_){var u=this.getMap().getPixelFromCoordinate([a[0],a[1]]);if(u){var d=h&&h[0]||10,p=h&&h[1]||10;a=(0,f.hI)([this.getMap().getCoordinateFromPixel([u[0]-d,u[1]-p]),this.getMap().getCoordinateFromPixel([u[0]+d,u[1]+p])])}}r=o?new _.ZP([n]):(0,_.oJ)(a),this.get("enableRotatedTransform")&&0!==s&&r.rotate(s,this.getMap().getView().getCenter()),i=this.bbox_=new l.Z(r);var g=[],y=r.getCoordinates()[0];if(!this.ispt_||h){if(g.push(i),!this.iscircle_&&!this.ispt_&&this.get("stretch")&&this.get("scale"))for(e=0;e<y.length-1;e++)i=new l.Z({geometry:new c.Z([(y[e][0]+y[e+1][0])/2,(y[e][1]+y[e+1][1])/2]),handle:"scale",constraint:e%2?"h":"v",option:e}),g.push(i);if(this.get("scale"))for(e=0;e<y.length-1;e++)i=new l.Z({geometry:new c.Z(y[e]),handle:"scale",option:e}),g.push(i);this.get("translate")&&!this.get("translateFeature")&&(i=new l.Z({geometry:new c.Z([(y[0][0]+y[2][0])/2,(y[0][1]+y[2][1])/2]),handle:"translate"}),g.push(i))}!this.iscircle_&&this.get("rotate")&&(i=new l.Z({geometry:new c.Z(y[3]),handle:"rotate"}),g.push(i)),this.overlayLayer_.getSource().addFeatures(g)}}},y.prototype.select=function(t,e){if(!t)return this.selection_.clear(),void this.drawSketch_();if(t.getGeometry&&t.getGeometry()){if(e)this.selection_.push(t);else{var i=this.selection_.getArray().indexOf(t);this.selection_.removeAt(i)}this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:t,features:this.selection_})}},y.prototype.setSelection=function(t){this.selection_.clear(),t.forEach(function(t){this.selection_.push(t)}.bind(this)),this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",features:this.selection_})},y.prototype.watchFeatures_=function(){this._featureListeners&&this._featureListeners.forEach((function(t){(0,g.B)(t)})),this._featureListeners=[],this.selection_.forEach(function(t){this._featureListeners.push(t.on("change",function(){this.isUpdating_||this.drawSketch_()}.bind(this)))}.bind(this))},y.prototype.handleDownEvent_=function(t){if(this._handleEvent(t,this.selection_)){var e=this.getFeatureAtPixel_(t.pixel),i=e.feature;if(this.selection_.getLength()&&this.selection_.getArray().indexOf(i)>=0&&(this.ispt_&&this.get("translate")||this.get("translateFeature"))&&(e.handle="translate"),e.handle){this.mode_=e.handle,this.opt_=e.option,this.constraint_=e.constraint;var r=this.getMap().getView().getRotation();this.coordinate_=t.coordinate,this.pixel_=t.pixel,this.geoms_=[],this.rotatedGeoms_=[];for(var o,n=(0,f.lJ)(),s=(0,f.lJ)(),a=0;o=this.selection_.item(a);a++)if(this.geoms_.push(o.getGeometry().clone()),n=(0,f.l7)(n,o.getGeometry().getExtent()),this.get("enableRotatedTransform")&&0!==r){var h=this.getGeometryRotateToZero_(o,!0);this.rotatedGeoms_.push(h),s=(0,f.l7)(s,h.getExtent())}if(this.extent_=(0,_.oJ)(n).getCoordinates()[0],this.get("enableRotatedTransform")&&0!==r&&(this.rotatedExtent_=(0,_.oJ)(s).getCoordinates()[0]),"rotate"===this.mode_){this.center_=this.getCenter()||(0,f.qg)(n);var c=t.map.getTargetElement();c.style.cursor=this.Cursors.rotate0,this.previousCursor_=c.style.cursor}else this.center_=(0,f.qg)(n);return this.angle_=Math.atan2(this.center_[1]-t.coordinate[1],this.center_[0]-t.coordinate[0]),this.dispatchEvent({type:this.mode_+"start",feature:this.selection_.item(0),features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!0}if(this.get("selection")){if(i){this.addFn_(t)||this.selection_.clear();var l=this.selection_.getArray().indexOf(i);l<0?this.selection_.push(i):this.selection_.removeAt(l)}else this.selection_.clear();return this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:i,features:this.selection_,pixel:t.pixel,coordinate:t.coordinate}),!1}}},y.prototype.getFeatures=function(){return this.selection_},y.prototype.getCenter=function(){return this.get("center")},y.prototype.setCenter=function(t){return this.set("center",t)},y.prototype.handleDragEvent_=function(t){if(this._handleEvent(t,this.features_)){var e,i,r,o,n=this.getMap().getView().getRotation(),s=[this.coordinate_[0],this.coordinate_[1]],a=[t.coordinate[0],t.coordinate[1]];switch(this.isUpdating_=!0,this.mode_){case"rotate":var h=Math.atan2(this.center_[1]-a[1],this.center_[0]-a[0]);if(!this.ispt)for(e=0,r;r=this.selection_.item(e);e++)o=this.geoms_[e].clone(),o.rotate(h-this.angle_,this.center_),"Circle"==o.getType()&&o.setCenterAndRadius(o.getCenter(),o.getRadius()),r.setGeometry(o);this.drawSketch_(!0),this.dispatchEvent({type:"rotating",feature:this.selection_.item(0),features:this.selection_,angle:h-this.angle_,pixel:t.pixel,coordinate:t.coordinate});break;case"translate":var l=a[0]-s[0],u=a[1]-s[1];for(e=0,r;r=this.selection_.item(e);e++)r.getGeometry().translate(l,u);this.handles_.forEach((function(t){t.getGeometry().translate(l,u)})),this.coordinate_=t.coordinate,this.dispatchEvent({type:"translating",feature:this.selection_.item(0),features:this.selection_,delta:[l,u],pixel:t.pixel,coordinate:t.coordinate});break;case"scale":var d=this.center_;if(this.get("modifyCenter")(t)){var p=this.extent_;this.get("enableRotatedTransform")&&0!==n&&(p=this.rotatedExtent_),d=p[(Number(this.opt_)+2)%4]}var _=1==this.geoms_.length&&this._isRectangle(this.geoms_[0]),f=this.constraint_,g=this.opt_,y=this.coordinate_,w=t.coordinate;if(this.get("enableRotatedTransform")&&0!==n){var E=new c.Z(this.coordinate_);E.rotate(-1*n,d),y=E.getCoordinates();var k=new c.Z(t.coordinate);k.rotate(-1*n,d),w=k.getCoordinates()}var b=(w[0]-d[0])/(y[0]-d[0]),P=(w[1]-d[1])/(y[1]-d[1]),x=[w[0]-y[0],w[1]-y[1]];if(this.get("enableRotatedTransform")&&0!==n){var S=new c.Z(d);S.rotate(-1*n,this.getMap().getView().getCenter()),d=S.getCoordinates()}for(this.get("noFlip")&&(b<0&&(b=-b),P<0&&(P=-P)),this.constraint_?"h"==this.constraint_?b=1:P=1:this.get("keepAspectRatio")(t)&&(b=P=Math.min(b,P)),e=0,r;r=this.selection_.item(e);e++)o=0!==n&&this.get("enableRotatedTransform")?this.rotatedGeoms_[e].clone():this.geoms_[e].clone(),o.applyTransform((function(t,e,r){if(r<2)return e;if(_){var n=[[6],[0,8],[2],[4]],s=[t[0],t[1]],a=[t[2],t[3]],h=[t[4],t[5]],c=[t[6],t[7]],l=[t[8],t[9]];if(f){var u=g%2===0?m(s,a):m(c,s),p=v(x,u),y=g+1<n.length?g+1:0,E=[...n[g],...n[y]];for(i=0;i<t.length;i+=r)e[i]=E.includes(i)?t[i]+p[0]:t[i],e[i+1]=E.includes(i)?t[i+1]+p[1]:t[i+1]}else{var k,S;switch(g){case 0:x=m(c,w),k=v(x,m(h,c)),S=v(x,m(s,c)),[e[0],e[1]]=C(s,k),[e[4],e[5]]=C(h,S),[e[6],e[7]]=C(c,x),[e[8],e[9]]=C(l,k);break;case 1:x=m(s,w),k=v(x,m(c,s)),S=v(x,m(a,s)),[e[0],e[1]]=C(s,x),[e[2],e[3]]=C(a,k),[e[6],e[7]]=C(c,S),[e[8],e[9]]=C(l,x);break;case 2:x=m(a,w),k=v(x,m(s,a)),S=v(x,m(h,a)),[e[0],e[1]]=C(s,S),[e[2],e[3]]=C(a,x),[e[4],e[5]]=C(h,k),[e[8],e[9]]=C(l,S);break;case 3:x=m(h,w),k=v(x,m(a,h)),S=v(x,m(c,h)),[e[2],e[3]]=C(a,S),[e[4],e[5]]=C(h,x),[e[6],e[7]]=C(c,k);break}}}else for(i=0;i<t.length;i+=r)1!=b&&(e[i]=d[0]+(t[i]-d[0])*b),1!=P&&(e[i+1]=d[1]+(t[i+1]-d[1])*P);return"Circle"==o.getType()&&o.setCenterAndRadius(o.getCenter(),o.getRadius()),e})),this.get("enableRotatedTransform")&&0!==n&&o.rotate(n,this.getMap().getView().getCenter()),r.setGeometry(o);this.drawSketch_(),this.dispatchEvent({type:"scaling",feature:this.selection_.item(0),features:this.selection_,scale:[b,P],pixel:t.pixel,coordinate:t.coordinate});break;default:break}this.isUpdating_=!1}},y.prototype.handleMoveEvent_=function(t){if(this._handleEvent(t,this.features_)&&!this.mode_){var e=this.getFeatureAtPixel_(t.pixel),i=t.map.getTargetElement();if(e.feature){var r=e.handle?this.Cursors[(e.handle||"default")+(e.constraint||"")+(e.option||"")]:this.Cursors.select;void 0===this.previousCursor_&&(this.previousCursor_=i.style.cursor),i.style.cursor=r}else void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_),this.previousCursor_=void 0}},y.prototype.handleUpEvent_=function(t){if("rotate"===this.mode_){var e=t.map.getTargetElement();e.style.cursor=this.Cursors.default,this.previousCursor_=void 0}return this.dispatchEvent({type:this.mode_+"end",feature:this.selection_.item(0),features:this.selection_,oldgeom:this.geoms_[0],oldgeoms:this.geoms_}),this.drawSketch_(),this.mode_=null,!1},y.prototype.getFeatures=function(){return this.selection_},y.prototype.setPointRadius=function(t){this._pointRadius="function"===typeof t?t:function(){return t}};const w=y},4143:(t,e,i)=>{i.d(e,{Z:()=>u});var r=i(10044),o=i(78714),n=i(47182),s=i(92371),a=i(62706),h=i(22556);(function(){var t=h.Z.prototype.clear;h.Z.prototype.clear=function(e){this.dispatchEvent({type:"clearstart"}),t.call(this,e),this.dispatchEvent({type:"clearend"})}})();var c=i(25108),l=function(t){t||(t={}),n.ZP.call(this,{handleEvent:function(){return!0}}),this._layers=t.layers,this._undoStack=new o.Z,this._redoStack=new o.Z,this._undo=[],this._redo=[],this._undoStack.on("add",function(t){void 0===t.element.level?(t.element.level=this._level,t.element.level||(t.element.view={center:this.getMap().getView().getCenter(),zoom:this.getMap().getView().getZoom()},this._undo.push(t.element))):t.element.level||this._undo.push(this._redo.shift()),t.element.level||this.dispatchEvent({type:"stack:add",action:t.element}),this._reduce()}.bind(this)),this._undoStack.on("remove",function(t){t.element.level||(this._doShift?this._undo.shift():this._undo.length&&this._redo.push(this._undo.pop()),this._doClear||this.dispatchEvent({type:"stack:remove",action:t.element,shift:this._doShift}))}.bind(this)),this._block=0,this._level=0,this._doShift=!1,this._record=!0,this._defs={}};(0,r.Z)(l,n.ZP),l.prototype.define=function(t,e,i){this._defs[t]={undo:e,redo:i}},l.prototype.length=function(t){return"redo"===t?this._redo.length:this._undo.length},l.prototype.setMaxLength=function(t){t=parseInt(t),t&&t<0&&(t=0),this.set("maxLength",t),this._reduce()},l.prototype.size=function(t){return"redo"===t?this._redoStack.getLength():this._undoStack.getLength()},l.prototype.setMaxSize=function(t){t=parseInt(t),t&&t<0&&(t=0),this.set("maxSize",t),this._reduce()},l.prototype._reduce=function(){if(this.get("maxLength"))while(this.length()>this.get("maxLength"))this.shift();if(this.get("maxSize"))while(this.length()>1&&this.size()>this.get("maxSize"))this.shift()},l.prototype.getStack=function(t){return"redo"===t?this._redo:this._undo},l.prototype.push=function(t,e,i){return this._defs[t]?(this._undoStack.push({type:t,name:i,custom:!0,prop:e}),!0):(c.warn('[UndoRedoInteraction]: "'+t+'" is not defined.'),!1)},l.prototype.shift=function(){this._doShift=!0;var t=this._undoStack.removeAt(0);if(this._doShift=!1,"blockstart"===t.type){t=this._undoStack.item(0);while(this._undoStack.getLength()&&t.level>0)this._undoStack.removeAt(0),t=this._undoStack.item(0)}},l.prototype.setActive=function(t){n.ZP.prototype.setActive.call(this,t),this._record=t},l.prototype.setMap=function(t){this._mapListener&&this._mapListener.forEach((function(t){(0,a.B)(t)})),this._mapListener=[],n.ZP.prototype.setMap.call(this,t),t&&(this._mapListener.push(t.on("undoblockstart",this.blockStart.bind(this))),this._mapListener.push(t.on("undoblockend",this.blockEnd.bind(this)))),this._watchSources(),this._watchInteractions()},l.prototype._watchSources=function(){var t=this.getMap();this._sourceListener&&this._sourceListener.forEach((function(t){(0,a.B)(t)})),this._sourceListener=[];var e=this;function i(t,r){return r||(r=[]),t.forEach((function(t){t instanceof s.Z?(!e._layers||e._layers.indexOf(t)>=0)&&r.push(t):t.getLayers&&i(t.getLayers(),r)})),r}if(t){var r=i(t.getLayers());r.forEach(function(t){var e=t.getSource();this._sourceListener.push(e.on(["addfeature","removefeature"],this._onAddRemove.bind(this))),this._sourceListener.push(e.on("clearstart",function(){this.blockStart("clear")}.bind(this))),this._sourceListener.push(e.on("clearend",this.blockEnd.bind(this)))}.bind(this)),this._sourceListener.push(t.getLayers().on(["add","remove"],this._watchSources.bind(this)))}},l.prototype._watchInteractions=function(){var t=this.getMap();this._interactionListener&&this._interactionListener.forEach((function(t){(0,a.B)(t)})),this._interactionListener=[],t&&(t.getInteractions().forEach(function(t){this._interactionListener.push(t.on(["setattributestart","modifystart","rotatestart","translatestart","scalestart","deletestart","deleteend","beforesplit","aftersplit"],this._onInteraction.bind(this)))}.bind(this)),this._interactionListener.push(t.getInteractions().on(["add","remove"],this._watchInteractions.bind(this))))},l.prototype._onAddRemove=function(t){this._record&&(this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:t.type,source:t.target,feature:t.feature}))},l.prototype._onInteraction=function(t){var e=this._onInteraction[t.type];e&&e.call(this,t)},l.prototype._onInteraction.setattributestart=function(t){this.blockStart(t.target.get("name")||"setattribute");var e=Object.assign({},t.properties);t.features.forEach(function(t){var i={};for(var r in e)i[r]=t.get(r);this._undoStack.push({type:"changeattribute",feature:t,newProperties:e,oldProperties:i})}.bind(this)),this.blockEnd()},l.prototype._onInteraction.rotatestart=l.prototype._onInteraction.translatestart=l.prototype._onInteraction.scalestart=l.prototype._onInteraction.modifystart=function(t){this.blockStart(t.type.replace(/start$/,"")),t.features.forEach(function(t){this._undoStack.push({type:"changegeometry",feature:t,oldGeom:t.getGeometry().clone()})}.bind(this)),this.blockEnd()},l.prototype.blockStart=function(t){this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:"blockstart",name:t}),this._level++},l.prototype._onInteraction.beforesplit=function(){var t=this._undoStack.getLength();t>2&&"blockend"===this._undoStack.item(t-1).type&&"changegeometry"===this._undoStack.item(t-2).type?this._undoStack.pop():this.blockStart("split")},l.prototype._onInteraction.deletestart=function(){this.blockStart("delete")},l.prototype.blockEnd=function(){this._undoStack.push({type:"blockend"}),this._level--},l.prototype._onInteraction.aftersplit=l.prototype._onInteraction.deleteend=l.prototype.blockEnd,l.prototype._handleDo=function(t,e){if(this.getActive()){if(this._record=!1,t.custom)this._defs[t.type]?e?this._defs[t.type].undo(t.prop):this._defs[t.type].redo(t.prop):c.warn('[UndoRedoInteraction]: "'+t.type+'" is not defined.');else switch(t.type){case"addfeature":e?t.source.removeFeature(t.feature):t.source.addFeature(t.feature);break;case"removefeature":e?t.source.addFeature(t.feature):t.source.removeFeature(t.feature);break;case"changegeometry":var i=t.feature.getGeometry();t.feature.setGeometry(t.oldGeom),t.oldGeom=i;break;case"changeattribute":var r=t.newProperties,o=t.oldProperties;for(var n in o)void 0===o?t.feature.unset(n):t.feature.set(n,o[n]);t.oldProperties=r,t.newProperties=o;break;case"blockstart":this._block+=e?-1:1;break;case"blockend":this._block+=e?1:-1;break;default:c.warn('[UndoRedoInteraction]: "'+t.type+'" is not defined.')}this._block<0&&(this._block=0),this._block&&(e?this.undo():this.redo()),this._record=!0,this.dispatchEvent({type:e?"undo":"redo",action:t})}},l.prototype.undo=function(){var t=this._undoStack.item(this._undoStack.getLength()-1);t&&(this._redoStack.push(t),this._undoStack.pop(),this._handleDo(t,!0))},l.prototype.redo=function(){var t=this._redoStack.item(this._redoStack.getLength()-1);t&&(this._undoStack.push(t),this._redoStack.pop(),this._handleDo(t,!1))},l.prototype.clear=function(){this._doClear=!0,this._undo.length=this._redo.length=0,this._undoStack.clear(),this._redoStack.clear(),this._doClear=!1,this.dispatchEvent({type:"stack:clear"})},l.prototype.hasUndo=function(){return this._undoStack.getLength()},l.prototype.hasRedo=function(){return this._redoStack.getLength()};const u=l},11110:(t,e,i)=>{i.d(e,{Z:()=>h});var r,o=i(47539),n=i(30283),s=i(58958),a=i(51345);(function(){var t=[255,255,255,1],e=[0,153,255,1],i=3,h=[new o.ZP({stroke:new s.Z({color:t,width:i+2})}),new o.ZP({image:new n.Z({radius:2*i,fill:new a.Z({color:e}),stroke:new s.Z({color:t,width:i/2})}),stroke:new s.Z({color:e,width:i}),fill:new a.Z({color:[255,255,255,.5]})})];r=function(t){if(!0===t)return h;t=t||{};var e=new a.Z({color:t.fillColor||"rgba(255,255,255,0.4)"}),i=new s.Z({color:t.color||"#3399CC",width:1.25}),r=new o.ZP({image:new n.Z({fill:e,stroke:i,radius:5}),fill:e,stroke:i});return[r]}})();const h=r},57276:(t,e,i)=>{i.d(e,{Z:()=>c});var r=i(72967),o=i(28641),n=i(41931),s=i(76442),a=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),h=function(t){function e(e,i,r){var o=t.call(this)||this;if(void 0!==r&&void 0===i)o.setFlatCoordinates(r,e);else{var n=i||0;o.setCenterAndRadius(e,n,r)}return o}return a(e,t),e.prototype.clone=function(){var t=new e(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},e.prototype.closestPointXY=function(t,e,i,r){var o=this.flatCoordinates,n=t-o[0],s=e-o[1],a=n*n+s*s;if(a<r){if(0===a)for(var h=0;h<this.stride;++h)i[h]=o[h];else{var c=this.getRadius()/Math.sqrt(a);i[0]=o[0]+c*n,i[1]=o[1]+c*s;for(h=2;h<this.stride;++h)i[h]=o[h]}return i.length=this.stride,a}return r},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,r=t-i[0],o=e-i[1];return r*r+o*o<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return(0,o.T9)(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return"Circle"},e.prototype.intersectsExtent=function(t){var e=this.getExtent();if((0,o.kK)(t,e)){var i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||(t[1]<=i[1]&&t[3]>=i[1]||(0,o.H6)(t,this.intersectsCoordinate.bind(this)))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],r=t.slice();r[e]=r[0]+i;for(var o=1;o<e;++o)r[e+o]=t[o];this.setFlatCoordinates(this.layout,r),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,o=(0,n.IG)(r,0,t,this.stride);r[o++]=r[0]+e;for(var s=1,a=this.stride;s<a;++s)r[o++]=r[s];r.length=o,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var i=this.getCenter(),r=this.getStride();this.setCenter((0,s.U1)(i,0,i.length,r,t,e,i)),this.changed()},e.prototype.translate=function(t,e){var i=this.getCenter(),r=this.getStride();this.setCenter((0,s.Iu)(i,0,i.length,r,t,e,i)),this.changed()},e}(r.ZP);h.prototype.transform;const c=h},35010:(t,e,i)=>{i.d(e,{ZP:()=>G});var r=i(57276),o=i(291),n=i(85487),s=i(81090),a=i(2450),h=i(54049),c=i(92083),l=i(48630),u=i(92217),d=i(7403),p=i(36259),_=i(32562),f=i(60188),g=i(14515),y=i(2033),v=i(92371),m=i(22556),C=i(36885),w=i(98683),E=i(47539),k=i(63432),b=i(72967),P=i(91900),x=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),S={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},Z={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},T=function(t){function e(e,i){var r=t.call(this,e)||this;return r.feature=i,r}return x(e,t),e}(o.ZP),L=function(t){function e(e){var i=this,o=e;o.stopDown||(o.stopDown=C.Dv),i=t.call(this,o)||this,i.on,i.once,i.un,i.shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.pointerType_,i.freehand_=!1,i.source_=e.source?e.source:null,i.features_=e.features?e.features:null,i.snapTolerance_=e.snapTolerance?e.snapTolerance:12,i.type_=e.type,i.mode_=M(i.type_),i.stopClick_=!!e.stopClick,i.minPoints_=e.minPoints?e.minPoints:i.mode_===S.POLYGON?3:2,i.maxPoints_=i.mode_===S.CIRCLE?2:e.maxPoints?e.maxPoints:1/0,i.finishCondition_=e.finishCondition?e.finishCondition:C.uX,i.geometryLayout_=e.geometryLayout?e.geometryLayout:a.Z.XY;var n=e.geometryFunction;if(!n){var s,l=i.mode_;if(l===S.CIRCLE)n=function(t,e,i){var o=e||new r.Z([NaN,NaN]),n=(0,k.Vs)(t[0],i),s=(0,P.bI)(n,(0,k.Vs)(t[t.length-1],i));o.setCenterAndRadius(n,Math.sqrt(s),this.geometryLayout_);var a=(0,k.Cs)();return a&&o.transform(i,a),o};else l===S.POINT?s=f.Z:l===S.LINE_STRING?s=c.Z:l===S.POLYGON&&(s=y.ZP),n=function(t,e,i){return e?l===S.POLYGON?t[0].length?e.setCoordinates([t[0].concat([t[0][0]])],this.geometryLayout_):e.setCoordinates([],this.geometryLayout_):e.setCoordinates(t,this.geometryLayout_):e=new s(t,this.geometryLayout_),e}}return i.geometryFunction_=n,i.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,i.overlay_=new v.Z({source:new m.Z({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:F(),updateWhileInteracting:!0}),i.geometryName_=e.geometryName,i.condition_=e.condition?e.condition:w.rM,i.freehandCondition_,e.freehand?i.freehandCondition_=w.Bx:i.freehandCondition_=e.freehandCondition?e.freehandCondition:w.vY,i.addChangeListener(h.Z.ACTIVE,i.updateState_),i}return x(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===n.Z.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!==S.POINT&&this.freehandCondition_(e);var i=e.type===u.Z.POINTERMOVE,r=!0;if(!this.freehand_&&this.lastDragTime_&&e.type===u.Z.POINTERDRAG){var o=Date.now();o-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&e.type===u.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===u.Z.POINTERDOWN?r=!1:i&&this.getPointerCount()<2?(r=e.type===u.Z.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===u.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e)):e.type===u.Z.DBLCLICK&&(r=!1),t.prototype.handleEvent.call(this,e)&&r},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new l.Z(u.Z.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)},e.prototype.handleUpEvent=function(t){var e=!0;if(0===this.getPointerCount())if(this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t),this.shouldHandle_){var i=!this.finishCoordinate_;i&&this.startDrawing_(t.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&this.mode_!==S.POINT||(this.atFinish_(t.pixel)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing();return!e&&this.stopClick_&&t.preventDefault(),e},e.prototype.handlePointerMove_=function(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,r=e[0]-i[0],o=e[1]-i[1],n=r*r+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?this.modifyDrawing_(t.coordinate):this.createOrUpdateSketchPoint_(t.coordinate.slice())},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,r=[this.finishCoordinate_],o=this.mode_;if(o===S.POINT)e=!0;else if(o===S.CIRCLE)e=2===this.sketchCoords_.length;else if(o===S.LINE_STRING)i=this.sketchCoords_.length>this.minPoints_;else if(o===S.POLYGON){var n=this.sketchCoords_;i=n[0].length>this.minPoints_,r=[n[0][0],n[0][n[0].length-2]]}if(i)for(var s=this.getMap(),a=0,h=r.length;a<h;a++){var c=r[a],l=s.getPixelFromCoordinate(c),u=t[0]-l[0],d=t[1]-l[1],p=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(u*u+d*d)<=p,e){this.finishCoordinate_=c;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){if(this.sketchPoint_){var e=this.sketchPoint_.getGeometry();e.setCoordinates(t)}else this.sketchPoint_=new s.Z(new f.Z(t)),this.updateSketchFeatures_()},e.prototype.createOrUpdateCustomSketchLine_=function(t){this.sketchLine_||(this.sketchLine_=new s.Z);var e=t.getLinearRing(0),i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new c.Z(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))},e.prototype.startDrawing_=function(t){var e=this.getMap().getView().getProjection(),i=(0,b.tP)(this.geometryLayout_);while(t.length<i)t.push(0);this.finishCoordinate_=t,this.mode_===S.POINT?this.sketchCoords_=t.slice():this.mode_===S.POLYGON?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new s.Z(new c.Z(this.sketchLineCoords_)));var r=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new s.Z,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(r),this.updateSketchFeatures_(),this.dispatchEvent(new T(Z.DRAWSTART,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,r=this.getMap(),o=this.sketchFeature_.getGeometry(),n=r.getView().getProjection(),s=(0,b.tP)(this.geometryLayout_);while(t.length<s)t.push(0);if(this.mode_===S.POINT?i=this.sketchCoords_:this.mode_===S.POLYGON?(e=this.sketchCoords_[0],i=e[e.length-1],this.atFinish_(r.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(e=this.sketchCoords_,i=e[e.length-1]),i[0]=t[0],i[1]=t[1],this.geometryFunction_(this.sketchCoords_,o,n),this.sketchPoint_){var a=this.sketchPoint_.getGeometry();a.setCoordinates(t)}if("Polygon"===o.getType()&&this.mode_!==S.POLYGON)this.createOrUpdateCustomSketchLine_(o);else if(this.sketchLineCoords_){var h=this.sketchLine_.getGeometry();h.setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,r=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection(),n=this.mode_;n===S.LINE_STRING||n===S.CIRCLE?(this.finishCoordinate_=t.slice(),i=this.sketchCoords_,i.length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),this.geometryFunction_(i,r,o)):n===S.POLYGON&&(i=this.sketchCoords_[0],i.length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(t.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r,o)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),r=this.mode_;if(r===S.LINE_STRING||r===S.CIRCLE){if(t=this.sketchCoords_,t.splice(-2,1),t.length>=2){this.finishCoordinate_=t[t.length-2].slice();var o=this.finishCoordinate_.slice();t[t.length-1]=o,this.createOrUpdateSketchPoint_(o)}this.geometryFunction_(t,e,i),"Polygon"===e.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(r===S.POLYGON){t=this.sketchCoords_[0],t.splice(-2,1);var n=this.sketchLine_.getGeometry();if(t.length>=2){o=t[t.length-2].slice();t[t.length-1]=o,this.createOrUpdateSketchPoint_(o)}n.setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,i)}1===t.length&&this.abortDrawing(),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===S.LINE_STRING?(e.pop(),this.geometryFunction_(e,i,r)):this.mode_===S.POLYGON&&(e[0].pop(),this.geometryFunction_(e,i,r),e=i.getCoordinates()),"MultiPoint"===this.type_?t.setGeometry(new p.Z([e])):"MultiLineString"===this.type_?t.setGeometry(new d.Z([e])):"MultiPolygon"===this.type_&&t.setGeometry(new _.Z([e])),this.dispatchEvent(new T(Z.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t},e.prototype.abortDrawing=function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new T(Z.DRAWABORT,t))},e.prototype.appendCoordinates=function(t){var e,i=this.mode_,r=!this.sketchFeature_;if(r&&this.startDrawing_(t[0]),i===S.LINE_STRING||i===S.CIRCLE)e=this.sketchCoords_;else{if(i!==S.POLYGON)return;e=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}r&&e.shift(),e.pop();for(var o=0;o<t.length;o++)this.addToDrawing_(t[o]);var n=t[t.length-1];this.addToDrawing_(n),this.modifyDrawing_(n)},e.prototype.extend=function(t){var e=t.getGeometry(),i=e;this.sketchFeature_=t,this.sketchCoords_=i.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.sketchPoint_=new s.Z(new f.Z(r)),this.updateSketchFeatures_(),this.dispatchEvent(new T(Z.DRAWSTART,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)},e}(g.Z);function F(){var t=(0,E.Ly)();return function(e,i){return t[e.getGeometry().getType()]}}function M(t){switch(t){case"Point":case"MultiPoint":return S.POINT;case"LineString":case"MultiLineString":return S.LINE_STRING;case"Polygon":case"MultiPolygon":return S.POLYGON;case"Circle":return S.CIRCLE;default:throw new Error("Invalid type: "+t)}}const G=L},92420:(t,e,i)=>{i.d(e,{Z:()=>P});var r=i(291),o=i(81090),n=i(92217),s=i(60188),a=i(14515),h=i(92371),c=i(22556),l=i(98683),u=i(28641),d=i(91900),p=i(47539),_=i(2033),f=i(63432),g=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),y={EXTENTCHANGED:"extentchanged"},v=function(t){function e(e){var i=t.call(this,y.EXTENTCHANGED)||this;return i.extent=e,i}return g(e,t),e}(r.ZP),m=function(t){function e(e){var i=this,r=e||{};return i=t.call(this,r)||this,i.on,i.once,i.un,i.condition_=r.condition?r.condition:l.Bx,i.extent_=null,i.pointerHandler_=null,i.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.snappedToVertex_=!1,i.extentFeature_=null,i.vertexFeature_=null,e||(e={}),i.extentOverlay_=new h.Z({source:new c.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:C(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.vertexOverlay_=new h.Z({source:new c.Z({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:w(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&i.setExtent(e.extent),i}return g(e,t),e.prototype.snapToVertex_=function(t,e){var i=e.getCoordinateFromPixelInternal(t),r=function(t,e){return(0,d.Bs)(i,t)-(0,d.Bs)(i,e)},o=this.getExtentInternal();if(o){var n=b(o);n.sort(r);var s=n[0],a=(0,d.oL)(i,s),h=e.getPixelFromCoordinateInternal(a);if((0,d.TE)(t,h)<=this.pixelTolerance_){var c=e.getPixelFromCoordinateInternal(s[0]),l=e.getPixelFromCoordinateInternal(s[1]),u=(0,d.bI)(h,c),p=(0,d.bI)(h,l),_=Math.sqrt(Math.min(u,p));return this.snappedToVertex_=_<=this.pixelTolerance_,this.snappedToVertex_&&(a=u>p?s[1]:s[0]),a}}return null},e.prototype.handlePointerMove_=function(t){var e=t.pixel,i=t.map,r=this.snapToVertex_(e,i);r||(r=i.getCoordinateFromPixelInternal(e)),this.createOrUpdatePointerFeature_(r)},e.prototype.createOrUpdateExtentFeature_=function(t){var e=this.extentFeature_;return e?t?e.setGeometry((0,_.oJ)(t)):e.setGeometry(void 0):(e=t?new o.Z((0,_.oJ)(t)):new o.Z({}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e},e.prototype.createOrUpdatePointerFeature_=function(t){var e=this.vertexFeature_;if(e){var i=e.getGeometry();i.setCoordinates(t)}else e=new o.Z(new s.Z(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e);return e},e.prototype.handleEvent=function(e){return!e.originalEvent||!this.condition_(e)||(e.type!=n.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),t.prototype.handleEvent.call(this,e),!1)},e.prototype.handleDownEvent=function(t){var e=t.pixel,i=t.map,r=this.getExtentInternal(),o=this.snapToVertex_(e,i),n=function(t){var e=null,i=null;return t[0]==r[0]?e=r[2]:t[0]==r[2]&&(e=r[0]),t[1]==r[1]?i=r[3]:t[1]==r[3]&&(i=r[1]),null!==e&&null!==i?[e,i]:null};if(o&&r){var s=o[0]==r[0]||o[0]==r[2]?o[0]:null,a=o[1]==r[1]||o[1]==r[3]?o[1]:null;null!==s&&null!==a?this.pointerHandler_=E(n(o)):null!==s?this.pointerHandler_=k(n([s,r[1]]),n([s,r[3]])):null!==a&&(this.pointerHandler_=k(n([r[0],a]),n([r[2],a])))}else o=i.getCoordinateFromPixelInternal(e),this.setExtent([o[0],o[1],o[0],o[1]]),this.pointerHandler_=E(o);return!0},e.prototype.handleDragEvent=function(t){if(this.pointerHandler_){var e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}},e.prototype.handleUpEvent=function(t){this.pointerHandler_=null;var e=this.getExtentInternal();return e&&0!==(0,u.bg)(e)||this.setExtent(null),!1},e.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getExtent=function(){return(0,f.Fj)(this.getExtentInternal(),this.getMap().getView().getProjection())},e.prototype.getExtentInternal=function(){return this.extent_},e.prototype.setExtent=function(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new v(this.extent_))},e}(a.Z);function C(){var t=(0,p.Ly)();return function(e,i){return t["Polygon"]}}function w(){var t=(0,p.Ly)();return function(e,i){return t["Point"]}}function E(t){return function(e){return(0,u.hI)([t,e])}}function k(t,e){return t[0]==e[0]?function(i){return(0,u.hI)([t,[i[0],e[1]]])}:t[1]==e[1]?function(i){return(0,u.hI)([t,[e[0],i[1]]])}:null}function b(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}const P=m},6002:(t,e,i)=>{i.d(e,{Z:()=>C});var r=i(42071),o=i(85487),n=i(14515),s=i(39781),a=i(22796),h=i(36885),c=i(28641),l=i(91900),u=i(2033),d=i(63432),p=i(74187),_=i(69374),f=i(65818),g=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function y(t){return t.feature?t.feature:t.element?t.element:void 0}var v=[],m=function(t){function e(e){var i=this,r=e||{},o=r;return o.handleDownEvent||(o.handleDownEvent=h.uX),o.stopDown||(o.stopDown=h.Dv),i=t.call(this,o)||this,i.source_=r.source?r.source:null,i.vertex_=void 0===r.vertex||r.vertex,i.edge_=void 0===r.edge||r.edge,i.features_=r.features?r.features:null,i.featuresListenerKeys_=[],i.featureChangeListenerKeys_={},i.indexedFeaturesExtents_={},i.pendingFeatures_={},i.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.rBush_=new s.Z,i.GEOMETRY_SEGMENTERS_={Point:i.segmentPointGeometry_.bind(i),LineString:i.segmentLineStringGeometry_.bind(i),LinearRing:i.segmentLineStringGeometry_.bind(i),Polygon:i.segmentPolygonGeometry_.bind(i),MultiPoint:i.segmentMultiPointGeometry_.bind(i),MultiLineString:i.segmentMultiLineStringGeometry_.bind(i),MultiPolygon:i.segmentMultiPolygonGeometry_.bind(i),GeometryCollection:i.segmentGeometryCollectionGeometry_.bind(i),Circle:i.segmentCircleGeometry_.bind(i)},i}return g(e,t),e.prototype.addFeature=function(t,e){var i=void 0===e||e,r=(0,p.sq)(t),n=t.getGeometry();if(n){var s=this.GEOMETRY_SEGMENTERS_[n.getType()];if(s){this.indexedFeaturesExtents_[r]=n.getExtent((0,c.lJ)());var a=[];if(s(a,n),1===a.length)this.rBush_.insert((0,c.hI)(a[0]),{feature:t,segment:a[0]});else if(a.length>1){var h=a.map((function(t){return(0,c.hI)(t)})),l=a.map((function(e){return{feature:t,segment:e}}));this.rBush_.load(h,l)}}}i&&(this.featureChangeListenerKeys_[r]=(0,f.oL)(t,o.Z.CHANGE,this.handleFeatureChange_,this))},e.prototype.forEachFeatureAdd_=function(t){this.addFeature(t)},e.prototype.forEachFeatureRemove_=function(t){this.removeFeature(t)},e.prototype.getFeatures_=function(){var t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t},e.prototype.handleEvent=function(e){var i=this.snapTo(e.pixel,e.coordinate,e.map);return i&&(e.coordinate=i.vertex.slice(0,2),e.pixel=i.vertexPixel),t.prototype.handleEvent.call(this,e)},e.prototype.handleFeatureAdd_=function(t){var e=y(t);this.addFeature(e)},e.prototype.handleFeatureRemove_=function(t){var e=y(t);this.removeFeature(e)},e.prototype.handleFeatureChange_=function(t){var e=t.target;if(this.handlingDownUpSequence){var i=(0,p.sq)(e);i in this.pendingFeatures_||(this.pendingFeatures_[i]=e)}else this.updateFeature_(e)},e.prototype.handleUpEvent=function(t){var e=(0,_.KX)(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},e.prototype.removeFeature=function(t,e){var i=void 0===e||e,r=(0,p.sq)(t),o=this.indexedFeaturesExtents_[r];if(o){var n=this.rBush_,s=[];n.forEachInExtent(o,(function(e){t===e.feature&&s.push(e)}));for(var a=s.length-1;a>=0;--a)n.remove(s[a])}i&&((0,f.bN)(this.featureChangeListenerKeys_[r]),delete this.featureChangeListenerKeys_[r])},e.prototype.setMap=function(e){var i=this.getMap(),o=this.featuresListenerKeys_,n=this.getFeatures_();i&&(o.forEach(f.bN),o.length=0,n.forEach(this.forEachFeatureRemove_.bind(this))),t.prototype.setMap.call(this,e),e&&(this.features_?o.push((0,f.oL)(this.features_,r.Z.ADD,this.handleFeatureAdd_,this),(0,f.oL)(this.features_,r.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&o.push((0,f.oL)(this.source_,a.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,f.oL)(this.source_,a.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),n.forEach(this.forEachFeatureAdd_.bind(this)))},e.prototype.snapTo=function(t,e,i){var r=i.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),o=i.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_]),n=(0,c.hI)([r,o]),s=this.rBush_.getInExtent(n),a=s.length;if(0===a)return null;var h,u=i.getView().getProjection(),p=(0,d.Vs)(e,u),_=1/0,f=this.pixelTolerance_*this.pixelTolerance_,g=function(){if(h){var e=i.getPixelFromCoordinate(h),r=(0,l.bI)(t,e);if(r<=f)return{vertex:h,vertexPixel:[Math.round(e[0]),Math.round(e[1])]}}return null};if(this.vertex_){for(var y=0;y<a;++y){var m=s[y];"Circle"!==m.feature.getGeometry().getType()&&m.segment.forEach((function(t){var e=(0,d.Vs)(t,u),i=(0,l.bI)(p,e);i<_&&(h=t,_=i)}))}var C=g();if(C)return C}if(this.edge_){for(y=0;y<a;++y){var w=null;m=s[y];if("Circle"===m.feature.getGeometry().getType()){var E=m.feature.getGeometry(),k=(0,d.Cs)();k&&(E=E.clone().transform(k,u)),w=(0,d.lO)((0,l.Ed)(p,E),u)}else{var b=m.segment,P=b[0],x=b[1];x&&(v[0]=(0,d.Vs)(P,u),v[1]=(0,d.Vs)(x,u),w=(0,l.oL)(p,v))}if(w){var S=(0,l.bI)(p,w);S<_&&(h=w,_=S)}}C=g();if(C)return C}return null},e.prototype.updateFeature_=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},e.prototype.segmentCircleGeometry_=function(t,e){var i=this.getMap().getView().getProjection(),r=e,o=(0,d.Cs)();o&&(r=r.clone().transform(o,i));var n=(0,u.Bb)(r);o&&n.transform(i,o);for(var s=n.getCoordinates()[0],a=0,h=s.length-1;a<h;++a)t.push(s.slice(a,a+2))},e.prototype.segmentGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),r=0;r<i.length;++r){var o=this.GEOMETRY_SEGMENTERS_[i[r].getType()];o&&o(t,i[r])}},e.prototype.segmentLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,o=i.length-1;r<o;++r)t.push(i.slice(r,r+2))},e.prototype.segmentMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,o=i.length;r<o;++r)for(var n=i[r],s=0,a=n.length-1;s<a;++s)t.push(n.slice(s,s+2))},e.prototype.segmentMultiPointGeometry_=function(t,e){e.getCoordinates().forEach((function(e){t.push([e])}))},e.prototype.segmentMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,o=i.length;r<o;++r)for(var n=i[r],s=0,a=n.length;s<a;++s)for(var h=n[s],c=0,l=h.length-1;c<l;++c)t.push(h.slice(c,c+2))},e.prototype.segmentPointGeometry_=function(t,e){t.push([e.getCoordinates()])},e.prototype.segmentPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),r=0,o=i.length;r<o;++r)for(var n=i[r],s=0,a=n.length-1;s<a;++s)t.push(n.slice(s,s+2))},e}(n.Z);const C=m}}]);
//# sourceMappingURL=8659.42491fb3.js.map