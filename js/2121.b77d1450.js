(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[2121],{89518:(t,e,r)=>{"use strict";r.d(e,{Z:()=>l});var i=r(88775);const n={props:{map:{type:Object}},data(){return{control:null}},mounted(){this.control=new i.Z({element:this.$el})},watch:{map(t){t&&this.map.addControl(this.control)}},methods:{getControl(){return this.control}}},o=n;var a,s,u=r(1001),h=(0,u.Z)(o,a,s,!1,null,null,null);const l=h.exports},24832:(t,e,r)=>{"use strict";r.d(e,{Z:()=>_});var i=r(58661),n=r(37787),o=r(28641),a=r(98683),s=r(43086),u=r(7517),h=r(92371),l=r(22556);const c={mixins:[n.Z],methods:{addGeoJson(t,e=!1,r="GeoJSON",i=!0){let n;n=t instanceof l.Z?t:this.createGeoJsonSource(t,this.map.getView().getProjection());let s=new h.Z({title:r,source:n});!i&&this.removeLayerFill&&this.removeLayerFill(s),this.map.addLayer(s);let c=n.getExtent();if((0,o.xb)(c)||this.map.getView().fit(c,this.getFitOptions()),e){var f=new u.Z({hitTolerance:5,multi:!1,condition:a.Kf,layers:[s]});f.on("select",this.onSelect),this.map.addInteraction(f)}return s},onSelect(t){if(t.selected.length>0){let e=t.selected[0],r=i.Z.omitFromObject(e.getProperties(),["geometry"]),n=e.getId()||"Feature Properties";this.emit("showDataModal",r,n)}},createGeoJsonSource(t,e){let r=[];return i.Z.detectGeoJson(t)&&(r=(new s.Z).readFeatures(t,{featureProjection:e})),new l.Z({features:r,wrapX:!1})}}},f=c;var d,p,m=r(1001),g=(0,m.Z)(f,d,p,!1,null,null,null);const _=g.exports},12766:(t,e,r)=>{"use strict";r.d(e,{Z:()=>C});var i=r(37787),n=r(58661),o=(r(71827),r(70097)),a=r(37494),s=r(35743),u=r(54399),h=r(86850),l=r(63432),c=r(29619),f=r(35574),d=r(41666),p=r(54680),m=r(87158),g=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"ol-unselectable ol-progress-control"},[e("div",{staticClass:"progress-bar"},[e("div",{staticClass:"progress-bar-inner",style:{width:t.percent}})]),e("div",{staticClass:"progress-label"},[t._v(t._s(t.label))])])},_=[],T=r(89518);const v={name:"ProgressControl",mixins:[T.Z],data(){return{loading:0,loaded:0}},computed:{show(){return this.loading>0&&this.loaded<=this.loading},percent(){return(this.loaded/this.loading*100).toFixed(1)+"%"},label(){return"Loading Tiles ("+this.percent+")"}},methods:{addLoading(){this.loading++,this.update()},addLoaded(){this.loaded++,this.update()},update(){this.loading===this.loaded&&(this.loading=0,this.loaded=0),this.loading===this.loaded&&(this.loading=0,this.loaded=0)}}},x=v;var E=r(1001),y=(0,E.Z)(x,g,_,!1,null,"1da4d958",null);const R=y.exports;let S=1;const L={components:{ProgressControl:R},mixins:[i.Z],props:{show:{type:Boolean,default:!0},editable:{type:Boolean,default:!0},removableLayers:{type:Boolean,default:!1}},data(){return{map:null,id:"map_"+S++}},watch:{async show(){await this.showMap()}},computed:{...n.Z.mapState(["userLocation","locationZoom"])},async mounted(){await this.showMap()},methods:{async showMap(){this.show&&(await this.$nextTick(),await this.renderMap())},async createMap(t="EPSG:3857"){let e,r={showFullExtent:!0};if("string"===typeof t?r.projection=await f.Z.get(t):t instanceof c.Z?r.projection=t:t instanceof h.ZP?e=t:n.Z.isObject(t)&&(r=t),e||(e=new h.ZP(r),e.getCenter()||e.setCenter((0,l.mi)([this.userLocation[1],this.userLocation[0]],e.getProjection())),e.getZoom()||e.setZoom(this.locationZoom)),null!==this.map)return this.map.updateSize(),void this.map.render();var i=[new o.Z,new a.Z],d={target:this.id,view:e};this.editable?d.controls=(0,s.ce)().extend(i):(d.interactions=[],d.controls=i),this.map=new u.Z(d),this.listen("windowResized",this.updateMapSize);let p=this.map.getLayers();p.on("add",(t=>{let e=t.element,r=e.get("events");for(let i in r)this.map.on(i,r[i])})),p.on("remove",(t=>{let e=t.element,r=e.get("events");for(let i in r)this.map.un(i,r[i])}))},addLayerSwitcher(){this.map.addControl(new m.Z({trash:this.removableLayers}))},addBasemaps(){let t={opaque:!0,attributionsCollapsible:!1,wrapX:!1},e=[];if(Array.isArray(this.$config.basemaps)){let r=!1;for(let i of this.$config.basemaps){let n=new p.Z(Object.assign({},t,i)),o=new d.Z({source:this.trackTileProgress(n),baseLayer:!0,title:i.title,noSwitcherDelete:!0,visible:!r});e.push(o),this.map.addLayer(o),r=!0}}return e},onShow(){this.listen("windowResized",this.updateMapSize)},onHide(){this.unlisten("windowResized")},async renderMap(){await this.createMap(),this.addBasemaps()},async updateMapSize(){this.map&&(await this.$nextTick(),this.map.updateSize())},addLayerToMap(t){t.set("userLayer",!0),this.map.addLayer(t)},removeLayerFromMap(t){let e=this.getLayerFromMap(t);e&&this.map.removeLayer(e)},getLayerFromMap(t){let e=this.map.getLayers().getArray();for(let r of e)if(r.get("id")===t)return r;return null},getVisibleLayers(){let t=[],e=this.map.getLayers().getArray();for(let r of e)r.get("userLayer")&&r.getVisible()&&t.push(r);return t},getFitOptions(t=25){let e={};var r=this.map.getSize();return e.padding=r&&t>0?[r[0]*t/100,r[1]*t/100,r[0]*t/100,r[1]*t/100]:[30,30,30,30],e},trackTileProgress(t){return this.$refs.progress&&(t.on("tileloadstart",(()=>{this.$refs.progress.addLoading()})),t.on("tileloadend",(()=>{this.$refs.progress.addLoaded()})),t.on("tileloaderror",(()=>{this.$refs.progress.addLoaded()}))),t},fromLonLat(t){return(0,l.mi)(t,this.map.getView().getProjection())}}},A=L;var b,M,w=(0,E.Z)(A,b,M,!1,null,null,null);const C=w.exports},82582:function(t){!function(e,r){t.exports=r()}(0,(function(){"use strict";function t(t,i,n,o,a){!function t(r,i,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,u=i-n+1,h=Math.log(s),l=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*l*(s-l)/s)*(u-s/2<0?-1:1),f=Math.max(n,Math.floor(i-u*l/s+c)),d=Math.min(o,Math.floor(i+(s-u)*l/s+c));t(r,i,f,d,a)}var p=r[i],m=n,g=o;for(e(r,n,i),a(r[o],p)>0&&e(r,n,o);m<g;){for(e(r,m,g),m++,g--;a(r[m],p)<0;)m++;for(;a(r[g],p)>0;)g--}0===a(r[n],p)?e(r,n,g):e(r,++g,o),g<=i&&(n=g+1),i<=g&&(o=g-1)}}(t,i,n||0,o||t.length-1,a||r)}function e(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function r(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function n(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,r,i,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var o=e;o<r;o++){var a=t.children[o];s(n,t.leaf?i(a):a)}return n}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,r,i,n,o){for(var a=[r,i];a.length;)if(!((i=a.pop())-(r=a.pop())<=n)){var s=r+Math.ceil((i-r)/n/2)*n;t(e,s,r,i,o),a.push(r,s,s,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,r=[];if(!d(t,e))return r;for(var i=this.toBBox,n=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?i(a):a;d(t,s)&&(e.leaf?r.push(a):f(t,s)?this._all(a,r):n.push(a))}e=n.pop()}return r},i.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var r=[];e;){for(var i=0;i<e.children.length;i++){var n=e.children[i],o=e.leaf?this.toBBox(n):n;if(d(t,o)){if(e.leaf||f(t,o))return!0;r.push(n)}}e=r.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=p([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var r,i,o,a=this.data,s=this.toBBox(t),u=[],h=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],r=h.pop(),o=!0),a.leaf){var l=n(t,a.children,e);if(-1!==l)return a.children.splice(l,1),u.push(a),this._condense(u),this}o||a.leaf||!f(a,s)?i?(r++,a=i.children[r],o=!1):a=null:(u.push(a),h.push(r),r=0,i=a,a=a.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},i.prototype._build=function(t,e,r,i){var n,a=r-e+1,s=this._maxEntries;if(a<=s)return o(n=p(t.slice(e,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(n=p([])).leaf=!1,n.height=i;var u=Math.ceil(a/s),h=u*Math.ceil(Math.sqrt(s));m(t,e,r,h,this.compareMinX);for(var l=e;l<=r;l+=h){var c=Math.min(l+h-1,r);m(t,l,c,u,this.compareMinY);for(var f=l;f<=c;f+=u){var d=Math.min(f+u-1,c);n.children.push(this._build(t,f,d,i-1))}}return o(n,this.toBBox),n},i.prototype._chooseSubtree=function(t,e,r,i){for(;i.push(e),!e.leaf&&i.length-1!==r;){for(var n=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],h=l(u),c=(f=t,d=u,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-h);c<o?(o=c,n=h<n?h:n,a=u):c===o&&h<n&&(n=h,a=u)}e=a||e.children[0]}var f,d;return e},i.prototype._insert=function(t,e,r){var i=r?t:this.toBBox(t),n=[],o=this._chooseSubtree(i,this.data,e,n);for(o.children.push(t),s(o,i);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(i,n,e)},i.prototype._split=function(t,e){var r=t[e],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var a=this._chooseSplitIndex(r,n,i),s=p(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,o(r,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},i.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,r){for(var i,n,o,s,u,h,c,f=1/0,d=1/0,p=e;p<=r-e;p++){var m=a(t,0,p,this.toBBox),g=a(t,p,r,this.toBBox),_=(n=m,o=g,s=void 0,u=void 0,h=void 0,c=void 0,s=Math.max(n.minX,o.minX),u=Math.max(n.minY,o.minY),h=Math.min(n.maxX,o.maxX),c=Math.min(n.maxY,o.maxY),Math.max(0,h-s)*Math.max(0,c-u)),T=l(m)+l(g);_<f?(f=_,i=p,d=T<d?T:d):_===f&&T<d&&(d=T,i=p)}return i||r-e},i.prototype._chooseSplitAxis=function(t,e,r){var i=t.leaf?this.compareMinX:u,n=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,n)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,r,i){t.children.sort(i);for(var n=this.toBBox,o=a(t,0,e,n),u=a(t,r-e,r,n),h=c(o)+c(u),l=e;l<r-e;l++){var f=t.children[l];s(o,t.leaf?n(f):f),h+=c(o)}for(var d=r-e-1;d>=e;d--){var p=t.children[d];s(u,t.leaf?n(p):p),h+=c(u)}return h},i.prototype._adjustParentBBoxes=function(t,e,r){for(var i=r;i>=0;i--)s(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,r=void 0;e>=0;e--)0===t[e].children.length?e>0?(r=t[e-1].children).splice(r.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},i}))},98634:(t,e,r)=>{"use strict";function i(t,e,r,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=r,i):[t,e,r]}function n(t,e,r){return t+"/"+e+"/"+r}function o(t){return n(t[0],t[1],t[2])}function a(t){return t.split("/").map(Number)}function s(t){return(t[1]<<t[0])+t[2]}function u(t,e){var r=t[0],i=t[1],n=t[2];if(e.getMinZoom()>r||r>e.getMaxZoom())return!1;var o=e.getFullTileRange(r);return!o||o.containsXY(i,n)}r.d(e,{T9:()=>i,Ul:()=>a,km:()=>o,lg:()=>n,tE:()=>u,vp:()=>s})},57248:(t,e,r)=>{"use strict";r.d(e,{Cf:()=>l,Tl:()=>m,X$:()=>h,dl:()=>f});var i=r(8738),n=r(58375),o=r(94768),a=r(63432),s=r(28641),u=r(4307);function h(t){var e=t.getDefaultTileGrid();return e||(e=p(t),t.setDefaultTileGrid(e)),e}function l(t,e,r){var i=e[0],n=t.getTileCoordCenter(e),o=m(r);if((0,s.b8)(o,n))return e;var a=(0,s.dz)(o),u=Math.ceil((o[0]-n[0])/a);return n[0]+=a*u,t.getTileCoordForCoordAndZ(n,i)}function c(t,e,r,n){var o=void 0!==n?n:"top-left",a=d(t,e,r);return new i.Z({extent:t,origin:(0,s.g0)(t,o),resolutions:a,tileSize:r})}function f(t){var e=t||{},r=e.extent||(0,a.U2)("EPSG:3857").getExtent(),n={extent:r,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:d(r,e.maxZoom,e.tileSize,e.maxResolution)};return new i.Z(n)}function d(t,e,r,i){for(var n=void 0!==e?e:o.e,a=(0,s.Cr)(t),h=(0,s.dz)(t),l=(0,u.Pq)(void 0!==r?r:o.S),c=i>0?i:Math.max(h/l[0],a/l[1]),f=n+1,d=new Array(f),p=0;p<f;++p)d[p]=c/Math.pow(2,p);return d}function p(t,e,r,i){var n=m(t);return c(n,e,r,i)}function m(t){t=(0,a.U2)(t);var e=t.getExtent();if(!e){var r=180*a.Wm[n.ZP.DEGREES]/t.getMetersPerUnit();e=(0,s.T9)(-r,-r,r,r)}return e}},8738:(t,e,r)=>{"use strict";r.d(e,{Z:()=>m});var i=r(2519),n=r(94768),o=r(99515),a=r(33983),s=r(28641),u=r(98634),h=r(63746),l=r(65537),c=r(4307),f=[0,0,0],d=5,p=function(){function t(t){var e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,(0,o.h)((0,l.pT)(this.resolutions_,(function(t,e){return e-t}),!0),17),!t.origins)for(var r=0,a=this.resolutions_.length-1;r<a;++r)if(e){if(this.resolutions_[r]/this.resolutions_[r+1]!==e){e=void 0;break}}else e=this.resolutions_[r]/this.resolutions_[r+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,(0,o.h)(this.origins_.length==this.resolutions_.length,20));var u=t.extent;void 0===u||this.origin_||this.origins_||(this.origin_=(0,s.rL)(u)),(0,o.h)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,(0,o.h)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:n.S,(0,o.h)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==u?u:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){var r=new i.Z(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(u){var n=this.getTileRangeForExtentAndZ(u,e);r.minX=Math.max(n.minX,r.minX),r.maxX=Math.min(n.maxX,r.maxX),r.minY=Math.max(n.minY,r.minY),r.maxY=Math.min(n.maxY,r.maxY)}return r}),this):u&&this.calculateTileRanges_(u)}return t.prototype.forEachTileCoord=function(t,e,r){for(var i=this.getTileRangeForExtentAndZ(t,e),n=i.minX,o=i.maxX;n<=o;++n)for(var a=i.minY,s=i.maxY;a<=s;++a)r([e,n,a])},t.prototype.forEachTileCoordParentTileRange=function(t,e,r,n){var o,a,s,u=null,h=t[0]-1;2===this.zoomFactor_?(a=t[1],s=t[2]):u=this.getTileCoordExtent(t,n);while(h>=this.minZoom){if(2===this.zoomFactor_?(a=Math.floor(a/2),s=Math.floor(s/2),o=(0,i.T)(a,a,s,s,r)):o=this.getTileRangeForExtentAndZ(u,h,r),e(h,o))return!0;--h}return!1},t.prototype.getExtent=function(){return this.extent_},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},t.prototype.getResolution=function(t){return this.resolutions_[t]},t.prototype.getResolutions=function(){return this.resolutions_},t.prototype.getTileCoordChildTileRange=function(t,e,r){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],o=2*t[2];return(0,i.T)(n,n+1,o,o+1,e)}var a=this.getTileCoordExtent(t,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t[0]+1,e)}return null},t.prototype.getTileRangeForTileCoordAndZ=function(t,e,r){if(e>this.maxZoom||e<this.minZoom)return null;var n=t[0],o=t[1],a=t[2];if(e===n)return(0,i.T)(o,a,o,a,r);if(this.zoomFactor_){var s=Math.pow(this.zoomFactor_,e-n),u=Math.floor(o*s),h=Math.floor(a*s);if(e<n)return(0,i.T)(u,u,h,h,r);var l=Math.floor(s*(o+1))-1,c=Math.floor(s*(a+1))-1;return(0,i.T)(u,l,h,c,r)}var f=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(f,e,r)},t.prototype.getTileRangeExtent=function(t,e,r){var i=this.getOrigin(t),n=this.getResolution(t),o=(0,c.Pq)(this.getTileSize(t),this.tmpSize_),a=i[0]+e.minX*o[0]*n,u=i[0]+(e.maxX+1)*o[0]*n,h=i[1]+e.minY*o[1]*n,l=i[1]+(e.maxY+1)*o[1]*n;return(0,s.T9)(a,h,u,l,r)},t.prototype.getTileRangeForExtentAndZ=function(t,e,r){var n=f;this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n);var o=n[1],a=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),(0,i.T)(o,n[1],a,n[2],r)},t.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=(0,c.Pq)(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*r,e[1]-(t[2]+.5)*i[1]*r]},t.prototype.getTileCoordExtent=function(t,e){var r=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=(0,c.Pq)(this.getTileSize(t[0]),this.tmpSize_),o=r[0]+t[1]*n[0]*i,a=r[1]-(t[2]+1)*n[1]*i,u=o+n[0]*i,h=a+n[1]*i;return(0,s.T9)(o,a,u,h,e)},t.prototype.getTileCoordForCoordAndResolution=function(t,e,r){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,r)},t.prototype.getTileCoordForXYAndResolution_=function(t,e,r,i,n){var o=this.getZForResolution(r),s=r/this.getResolution(o),h=this.getOrigin(o),l=(0,c.Pq)(this.getTileSize(o),this.tmpSize_),f=s*(t-h[0])/r/l[0],p=s*(h[1]-e)/r/l[1];return i?(f=(0,a.mD)(f,d)-1,p=(0,a.mD)(p,d)-1):(f=(0,a.GW)(f,d),p=(0,a.GW)(p,d)),(0,u.T9)(o,f,p,n)},t.prototype.getTileCoordForXYAndZ_=function(t,e,r,i,n){var o=this.getOrigin(r),s=this.getResolution(r),h=(0,c.Pq)(this.getTileSize(r),this.tmpSize_),l=(t-o[0])/s/h[0],f=(o[1]-e)/s/h[1];return i?(l=(0,a.mD)(l,d)-1,f=(0,a.mD)(f,d)-1):(l=(0,a.GW)(l,d),f=(0,a.GW)(f,d)),(0,u.T9)(r,l,f,n)},t.prototype.getTileCoordForCoordAndZ=function(t,e,r){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,r)},t.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},t.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},t.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null},t.prototype.getZForResolution=function(t,e){var r=(0,l.h7)(this.resolutions_,t,e||0);return(0,a.uZ)(r,this.minZoom,this.maxZoom)},t.prototype.tileCoordIntersectsViewport=function(t,e){return(0,h.mV)(e,0,e.length,2,this.getTileCoordExtent(t))},t.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,r=new Array(e),i=this.minZoom;i<e;++i)r[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=r},t}();const m=p},94768:(t,e,r)=>{"use strict";r.d(e,{S:()=>n,e:()=>i});var i=42,n=256},67848:(t,e,r)=>{"use strict";r.d(e,{Gk:()=>h,Un:()=>u,uR:()=>s});var i=r(99515),n=r(33983),o=r(98634);function a(t,e){var r=/\{z\}/g,n=/\{x\}/g,o=/\{y\}/g,a=/\{-y\}/g;return function(s,u,h){return s?t.replace(r,s[0].toString()).replace(n,s[1].toString()).replace(o,s[2].toString()).replace(a,(function(){var t=s[0],r=e.getFullTileRange(t);(0,i.h)(r,55);var n=r.getHeight()-s[2]-1;return n.toString()})):void 0}}function s(t,e){for(var r=t.length,i=new Array(r),n=0;n<r;++n)i[n]=a(t[n],e);return u(i)}function u(t){return 1===t.length?t[0]:function(e,r,i){if(e){var a=(0,o.vp)(e),s=(0,n.$W)(a,t.length);return t[s](e,r,i)}}}function h(t){var e=[],r=/\{([a-z])-([a-z])\}/.exec(t);if(r){var i=r[1].charCodeAt(0),n=r[2].charCodeAt(0),o=void 0;for(o=i;o<=n;++o)e.push(t.replace(r[0],String.fromCharCode(o)));return e}if(r=/\{(\d+)-(\d+)\}/.exec(t),r){for(var a=parseInt(r[2],10),s=parseInt(r[1],10);s<=a;s++)e.push(t.replace(r[0],s.toString()));return e}return e.push(t),e}},6101:(t,e,r)=>{"use strict";r.d(e,{BB:()=>x,Iu:()=>g,Jp:()=>h,U1:()=>d,Ue:()=>s,bA:()=>p,lk:()=>c,mc:()=>u,n3:()=>m,nb:()=>T,nn:()=>f,qC:()=>_});var i,n=r(40177),o=r(99515),a=new Array(6);function s(){return[1,0,0,1,0,0]}function u(t){return l(t,1,0,0,1,0,0)}function h(t,e){var r=t[0],i=t[1],n=t[2],o=t[3],a=t[4],s=t[5],u=e[0],h=e[1],l=e[2],c=e[3],f=e[4],d=e[5];return t[0]=r*u+n*h,t[1]=i*u+o*h,t[2]=r*l+n*c,t[3]=i*l+o*c,t[4]=r*f+n*d+a,t[5]=i*f+o*d+s,t}function l(t,e,r,i,n,o,a){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=o,t[5]=a,t}function c(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function f(t,e){var r=e[0],i=e[1];return e[0]=t[0]*r+t[2]*i+t[4],e[1]=t[1]*r+t[3]*i+t[5],e}function d(t,e){var r=Math.cos(e),i=Math.sin(e);return h(t,l(a,r,i,-i,r,0,0))}function p(t,e,r){return h(t,l(a,e,0,0,r,0,0))}function m(t,e,r){return l(t,e,0,0,r,0,0)}function g(t,e,r){return h(t,l(a,1,0,0,1,e,r))}function _(t,e,r,i,n,o,a,s){var u=Math.sin(o),h=Math.cos(o);return t[0]=i*h,t[1]=n*u,t[2]=-i*u,t[3]=n*h,t[4]=a*i*h-s*i*u+e,t[5]=a*n*u+s*n*h+r,t}function T(t,e){var r=v(e);(0,o.h)(0!==r,32);var i=e[0],n=e[1],a=e[2],s=e[3],u=e[4],h=e[5];return t[0]=s/r,t[1]=-n/r,t[2]=-a/r,t[3]=i/r,t[4]=(a*h-s*u)/r,t[5]=-(i*h-n*u)/r,t}function v(t){return t[0]*t[3]-t[1]*t[2]}function x(t){var e="matrix("+t.join(", ")+")";if(n.Id)return e;var r=i||(i=document.createElement("div"));return r.style.transform=e,r.style.transform}},81428:(t,e,r)=>{"use strict";function i(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function n(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}r.d(e,{U:()=>i,u:()=>n})},41536:(t,e,r)=>{"use strict";r.d(e,{Ae:()=>c,F_:()=>s,MB:()=>u,RF:()=>d,cX:()=>a,fw:()=>m,kd:()=>h,qO:()=>o,r1:()=>f,wg:()=>l});var i=r(40177),n=r(69374),o=34962,a=34963,s=35040,u=35044,h=35048,l=5121,c=5123,f=5125,d=5126,p=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function m(t,e){for(var r=(0,n.f0)({preserveDrawingBuffer:!0,antialias:!i.ME},e),o=p.length,a=0;a<o;++a)try{var s=t.getContext(p[a],r);if(s)return s}catch(u){}return null}},22988:(t,e,r)=>{"use strict";r.d(e,{ZP:()=>u});var i=r(41536),n=r(99515),o={STATIC_DRAW:i.MB,STREAM_DRAW:i.F_,DYNAMIC_DRAW:i.kd},a=function(){function t(t,e){this.array=null,this.type=t,(0,n.h)(t===i.qO||t===i.cX,62),this.usage=void 0!==e?e:o.STATIC_DRAW}return t.prototype.ofSize=function(t){this.array=new(s(this.type))(t)},t.prototype.fromArray=function(t){var e=s(this.type);this.array=e.from?e.from(t):new e(t)},t.prototype.fromArrayBuffer=function(t){this.array=new(s(this.type))(t)},t.prototype.getType=function(){return this.type},t.prototype.getArray=function(){return this.array},t.prototype.getUsage=function(){return this.usage},t.prototype.getSize=function(){return this.array?this.array.length:0},t}();function s(t){switch(t){case i.qO:return Float32Array;case i.cX:return Uint32Array;default:return Float32Array}}const u=a},37751:(t,e,r)=>{"use strict";r.d(e,{GC:()=>g,ZC:()=>m,ZP:()=>A});const i={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};var n=r(55431),o=r(74187),a="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",s="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n",u=function(){function t(t){this.gl_=t.webGlContext;var e=this.gl_;this.scaleRatio_=t.scaleRatio||1,this.renderTargetTexture_=e.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=e.createFramebuffer();var r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,t.vertexShader||a),e.compileShader(r);var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,t.fragmentShader||s),e.compileShader(i),this.renderTargetProgram_=e.createProgram(),e.attachShader(this.renderTargetProgram_,r),e.attachShader(this.renderTargetProgram_,i),e.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=e.createBuffer();var n=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];e.bindBuffer(e.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW),this.renderTargetAttribLocation_=e.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=e.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(r){this.uniforms_.push({value:t.uniforms[r],location:e.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}return t.prototype.getGL=function(){return this.gl_},t.prototype.init=function(t){var e=this.getGL(),r=[e.drawingBufferWidth*this.scaleRatio_,e.drawingBufferHeight*this.scaleRatio_];if(e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer()),e.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var i=0,n=e.RGBA,o=0,a=e.RGBA,s=e.UNSIGNED_BYTE,u=null;e.bindTexture(e.TEXTURE_2D,this.renderTargetTexture_),e.texImage2D(e.TEXTURE_2D,i,n,r[0],r[1],o,a,s,u),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.renderTargetTexture_,0)}},t.prototype.apply=function(t,e,r,i){var n=this.getGL(),a=t.size;if(n.bindFramebuffer(n.FRAMEBUFFER,e?e.getFrameBuffer():null),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),!e){var s=(0,o.sq)(n.canvas);if(!t.renderTargets[s]){var u=n.getContextAttributes();u&&u.preserveDrawingBuffer&&(n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT)),t.renderTargets[s]=!0}}n.enable(n.BLEND),n.blendFunc(n.ONE,n.ONE_MINUS_SRC_ALPHA),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.useProgram(this.renderTargetProgram_),n.enableVertexAttribArray(this.renderTargetAttribLocation_),n.vertexAttribPointer(this.renderTargetAttribLocation_,2,n.FLOAT,!1,0,0),n.uniform2f(this.renderTargetUniformLocation_,a[0],a[1]),n.uniform1i(this.renderTargetTextureLocation_,0);var h=t.layerStatesArray[t.layerIndex].opacity;n.uniform1f(this.renderTargetOpacityLocation_,h),this.applyUniforms(t),r&&r(n,t),n.drawArrays(n.TRIANGLES,0,6),i&&i(n,t)},t.prototype.getFrameBuffer=function(){return this.frameBuffer_},t.prototype.applyUniforms=function(t){var e,r=this.getGL(),i=1;this.uniforms_.forEach((function(n){if(e="function"===typeof n.value?n.value(t):n.value,e instanceof HTMLCanvasElement||e instanceof ImageData)n.texture||(n.texture=r.createTexture()),r.activeTexture(r["TEXTURE".concat(i)]),r.bindTexture(r.TEXTURE_2D,n.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),e instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,e.width,e.height,0,r.UNSIGNED_BYTE,new Uint8Array(e.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.uniform1i(n.location,i++);else if(Array.isArray(e))switch(e.length){case 2:return void r.uniform2f(n.location,e[0],e[1]);case 3:return void r.uniform3f(n.location,e[0],e[1],e[2]);case 4:return void r.uniform4f(n.location,e[0],e[1],e[2],e[3]);default:return}else"number"===typeof e&&r.uniform1f(n.location,e)}))},t}();const h=u;var l=r(41536),c=r(69374),f=r(6101),d=r(81428),p=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),m={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"},g={UNSIGNED_BYTE:l.wg,UNSIGNED_SHORT:l.Ae,UNSIGNED_INT:l.r1,FLOAT:l.RF},_={};function T(t){return"shared/"+t}var v=0;function x(){var t="unique/"+v;return v+=1,t}function E(t){var e=_[t];if(!e){var r=document.createElement("canvas");r.style.position="absolute",r.style.left="0",e={users:0,canvas:r},_[t]=e}return e.users+=1,e.canvas}function y(t){var e=_[t];if(e&&(e.users-=1,!(e.users>0))){var r=e.canvas,i=(0,l.fw)(r),n=i.getExtension("WEBGL_lose_context");n&&n.loseContext(),delete _[t]}}var R=function(t){function e(e){var r=t.call(this)||this,n=e||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvasCacheKey_=n.canvasCacheKey?T(n.canvasCacheKey):x(),r.canvas_=E(r.canvasCacheKey_),r.gl_=(0,l.fw)(r.canvas_),r.bufferCache_={},r.extensionCache_={},r.currentProgram_=null,r.canvas_.addEventListener(i.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(i.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=(0,f.Ue)(),r.offsetScaleMatrix_=(0,f.Ue)(),r.tmpMat4_=(0,d.U)(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],n.uniforms&&r.setUniforms(n.uniforms);var o=r.getGL();return r.postProcessPasses_=n.postProcesses?n.postProcesses.map((function(t){return new h({webGlContext:o,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})})):[new h({webGlContext:o})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return p(e,t),e.prototype.setUniforms=function(t){for(var e in this.uniforms_=[],t)this.uniforms_.push({name:e,value:t[e]});this.uniformLocations_={}},e.prototype.canvasCacheKeyMatches=function(t){return this.canvasCacheKey_===T(t)},e.prototype.getExtension=function(t){if(t in this.extensionCache_)return this.extensionCache_[t];var e=this.gl_.getExtension(t);return this.extensionCache_[t]=e,e},e.prototype.bindBuffer=function(t){var e=this.getGL(),r=(0,o.sq)(t),i=this.bufferCache_[r];if(!i){var n=e.createBuffer();i={buffer:t,webGlBuffer:n},this.bufferCache_[r]=i}e.bindBuffer(t.getType(),i.webGlBuffer)},e.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var e=this.getGL(),r=(0,o.sq)(t),i=this.bufferCache_[r];i&&!e.isContextLost()&&e.deleteBuffer(i.webGlBuffer),delete this.bufferCache_[r]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(i.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(i.RESTORED,this.boundHandleWebGLContextRestored_),y(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},e.prototype.prepareDraw=function(t,e){var r=this.getGL(),i=this.getCanvas(),n=t.size,o=t.pixelRatio;i.width=n[0]*o,i.height=n[1]*o,i.style.width=n[0]+"px",i.style.height=n[1]+"px",r.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(t);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,e?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,e,r){var i=this.getGL(),n=e.getSize();i.bindFramebuffer(i.FRAMEBUFFER,e.getFramebuffer()),i.viewport(0,0,n[0],n[1]),i.bindTexture(i.TEXTURE_2D,e.getTexture()),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,r?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,e){var r=this.getGL();this.getExtension("OES_element_index_uint");var i=r.UNSIGNED_INT,n=4,o=e-t,a=t*n;r.drawElements(r.TRIANGLES,o,i,a)},e.prototype.finalizeDraw=function(t,e,r){for(var i=0,n=this.postProcessPasses_.length;i<n;i++)i===n-1?this.postProcessPasses_[i].apply(t,null,e,r):this.postProcessPasses_[i].apply(t,this.postProcessPasses_[i+1])},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var e=t.size,r=t.viewState.rotation,i=(0,f.mc)(this.offsetScaleMatrix_);(0,f.bA)(i,2/e[0],2/e[1]);var n=(0,f.mc)(this.offsetRotateMatrix_);0!==r&&(0,f.U1)(n,-r),this.setUniformMatrixValue(m.OFFSET_SCALE_MATRIX,(0,d.u)(this.tmpMat4_,i)),this.setUniformMatrixValue(m.OFFSET_ROTATION_MATRIX,(0,d.u)(this.tmpMat4_,n)),this.setUniformFloatValue(m.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(m.ZOOM,t.viewState.zoom),this.setUniformFloatValue(m.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var e,r=this.getGL(),i=0;this.uniforms_.forEach(function(n){if(e="function"===typeof n.value?n.value(t):n.value,e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData){n.texture||(n.prevValue=void 0,n.texture=r.createTexture()),r.activeTexture(r["TEXTURE".concat(i)]),r.bindTexture(r.TEXTURE_2D,n.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);var o=!(e instanceof HTMLImageElement)||e.complete;o&&n.prevValue!==e&&(n.prevValue=e,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)),r.uniform1i(this.getUniformLocation(n.name),i++)}else if(Array.isArray(e)&&6===e.length)this.setUniformMatrixValue(n.name,(0,d.u)(this.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void r.uniform2f(this.getUniformLocation(n.name),e[0],e[1]);case 3:return void r.uniform3f(this.getUniformLocation(n.name),e[0],e[1],e[2]);case 4:return void r.uniform4f(this.getUniformLocation(n.name),e[0],e[1],e[2],e[3]);default:return}else"number"===typeof e&&r.uniform1f(this.getUniformLocation(n.name),e)}.bind(this))},e.prototype.useProgram=function(t){if(t==this.currentProgram_)return!1;var e=this.getGL();return e.useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0},e.prototype.compileShader=function(t,e){var r=this.getGL(),i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),i},e.prototype.getProgram=function(t,e){var r=this.getGL(),i=this.compileShader(t,r.FRAGMENT_SHADER),n=this.compileShader(e,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,i),r.attachShader(o,n),r.linkProgram(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){var a="Fragment shader compliation failed: ".concat(r.getShaderInfoLog(i));throw new Error(a)}if(r.deleteShader(i),!r.getShaderParameter(n,r.COMPILE_STATUS)){a="Vertex shader compilation failed: ".concat(r.getShaderInfoLog(n));throw new Error(a)}if(r.deleteShader(n),!r.getProgramParameter(o,r.LINK_STATUS)){a="GL program linking failed: ".concat(r.getShaderInfoLog(n));throw new Error(a)}return o},e.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,e){var r=t.size,i=t.viewState.rotation,n=t.viewState.resolution,o=t.viewState.center;return(0,f.mc)(e),(0,f.qC)(e,0,0,2/(n*r[0]),2/(n*r[1]),-i,-o[0],-o[1]),e},e.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},e.prototype.setUniformFloatVec4=function(t,e){this.getGL().uniform4fv(this.getUniformLocation(t),e)},e.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},e.prototype.enableAttributeArray_=function(t,e,r,i,n){var o=this.getAttributeLocation(t);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,e,r,!1,i,n))},e.prototype.enableAttributes=function(t){for(var e=S(t),r=0,i=0;i<t.length;i++){var n=t[i];this.enableAttributeArray_(n.name,n.size,n.type||l.RF,e,r),r+=n.size*L(n.type)}},e.prototype.handleWebGLContextLost=function(){(0,c.ZH)(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,e,r){var i=this.getGL(),n=r||i.createTexture(),o=0,a=i.RGBA,s=0,u=i.RGBA,h=i.UNSIGNED_BYTE;return i.bindTexture(i.TEXTURE_2D,n),e?i.texImage2D(i.TEXTURE_2D,o,a,u,h,e):i.texImage2D(i.TEXTURE_2D,o,a,t[0],t[1],s,u,h,null),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n},e}(n.Z);function S(t){for(var e=0,r=0;r<t.length;r++){var i=t[r];e+=i.size*L(i.type)}return e}function L(t){switch(t){case g.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case g.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case g.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case g.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}const A=R},60931:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(65537),n=new Uint8Array(4),o=function(){function t(t,e){this.helper_=t;var r=t.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.size_=e||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return t.prototype.setSize=function(t){(0,i.fS)(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},t.prototype.getSize=function(){return this.size_},t.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},t.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,e=this.helper_.getGL();e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.readPixels(0,0,t[0],t[1],e.RGBA,e.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},t.prototype.readPixel=function(t,e){if(t<0||e<0||t>this.size_[0]||e>=this.size_[1])return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n;this.readAll();var r=Math.floor(t)+(this.size_[1]-Math.floor(e)-1)*this.size_[0];return n[0]=this.data_[4*r],n[1]=this.data_[4*r+1],n[2]=this.data_[4*r+2],n[3]=this.data_[4*r+3],n},t.prototype.getTexture=function(){return this.texture_},t.prototype.getFramebuffer=function(){return this.framebuffer_},t.prototype.updateSize_=function(){var t=this.size_,e=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer_),e.viewport(0,0,t[0],t[1]),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},t}();const a=o},21025:(t,e,r)=>{"use strict";r.d(e,{U:()=>n});var i=r(48764)["Buffer"];function n(){var t='const e="function"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1,n=arguments.length;e<n;++e){const n=arguments[e];if(null!=n)for(const e in n)n.hasOwnProperty(e)&&(t[e]=n[e])}return t},n="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";n.indexOf("firefox");-1!==n.indexOf("safari")&&-1==n.indexOf("chrom")&&(n.indexOf("version/15.4")>=0||n.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==n.indexOf("webkit")&&n.indexOf("edge"),n.indexOf("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){let e=!1;try{const n=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,n),window.removeEventListener("_",null,n)}catch(e){}}(),new Array(6);const t="GENERATE_BUFFERS",o=[],r={vertexPosition:0,indexPosition:0};function i(e,n,t,o,r){e[n+0]=t,e[n+1]=o,e[n+2]=r}function s(e,n,t,s,f,c){const l=3+f,a=e[n+0],u=e[n+1],d=o;d.length=f;for(let t=0;t<d.length;t++)d[t]=e[n+2+t];let g=c?c.vertexPosition:0,x=c?c.indexPosition:0;const h=g/l;return i(t,g,a,u,0),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,1),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,2),d.length&&t.set(d,g+3),g+=l,i(t,g,a,u,3),d.length&&t.set(d,g+3),g+=l,s[x++]=h,s[x++]=h+1,s[x++]=h+3,s[x++]=h+1,s[x++]=h+2,s[x++]=h+3,r.vertexPosition=g,r.indexPosition=x,r}const f=self;f.onmessage=n=>{const o=n.data;if(o.type===t){const n=3,t=2,r=o.customAttributesCount,i=t+r,c=new Float32Array(o.renderInstructions),l=c.length/i,a=4*l*(r+n),u=new Uint32Array(6*l),d=new Float32Array(a);let g;for(let e=0;e<c.length;e+=i)g=s(c,e,d,u,r,g);const x=e({vertexBuffer:d.buffer,indexBuffer:u.buffer,renderInstructions:c.buffer},o);f.postMessage(x,[d.buffer,u.buffer,c.buffer])}};';return new Worker("undefined"===typeof Blob?"data:application/javascript;base64,"+i.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}}}]);
//# sourceMappingURL=2121.b77d1450.js.map