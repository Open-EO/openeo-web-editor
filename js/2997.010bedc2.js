"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[2997],{613:(t,e,i)=>{i.d(e,{A:()=>s});const s={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"}},53537:(t,e,i)=>{i.d(e,{A:()=>h});var s=i(90025),n=i(34142);class o extends s.A{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+i,s.top=Math.min(t[1],e[1])+i,s.width=Math.abs(e[0]-t[0])+i,s.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]],s=i.map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new n.Ay([s])}getGeometry(){return this.geometry_}}const h=o},9960:(t,e,i)=>{i.d(e,{A:()=>o});var s=i(1685);class n extends s.Ay{constructor(t,e,i,s){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=s}}const o=n},83984:(t,e,i)=>{i.d(e,{A:()=>s});const s={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"}},32826:(t,e,i)=>{i.d(e,{A:()=>n});class s{drawCustom(t,e,i,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}const n=s},38774:(t,e,i)=>{i.d(e,{Jw:()=>L,M8:()=>S,MY:()=>x,NT:()=>f,Oq:()=>_,TA:()=>E,Tq:()=>m,ZV:()=>r,_K:()=>g,_m:()=>c,aq:()=>p,eL:()=>u,fZ:()=>C,jT:()=>A,qY:()=>a,vk:()=>d,yY:()=>y});var s=i(34120),n=i(7771),o=i(43530),h=i(68711),l=i(25176);const r="10px sans-serif",a="#000",c="round",_=[],d=0,g="round",u=10,f="#000",x="center",S="middle",m=[0,0,0,0],p=1,y=new s.A;let k,T=null;const v={},C=function(){const t=100,e="32px ",i=["monospace","serif"],s=i.length,n="wmytzilWMYTZIL@#/&?$%10";let h,r;function a(t,o,h){let l=!0;for(let a=0;a<s;++a){const s=i[a];if(r=R(t+" "+o+" "+e+s,n),h!=s){const i=R(t+" "+o+" "+e+h+","+s,n);l=l&&i!=r}}return!!l}function c(){let e=!0;const i=y.getKeys();for(let s=0,n=i.length;s<n;++s){const n=i[s];y.get(n)<t&&(a.apply(this,n.split("\n"))?((0,o.I)(v),T=null,k=void 0,y.set(n,t)):(y.set(n,y.get(n)+1,!0),e=!1))}e&&(clearInterval(h),h=void 0)}return function(e){const i=(0,l.K5)(e);if(!i)return;const s=i.families;for(let n=0,o=s.length;n<o;++n){const e=s[n],o=i.style+"\n"+i.weight+"\n"+e;void 0===y.get(o)&&(y.set(o,t,!0),a(i.style,i.weight,e)||(y.set(o,0,!0),void 0===h&&(h=setInterval(c,32))))}}}(),I=function(){let t;return function(e){let i=v[e];if(void 0==i){if(n.Wl){const t=(0,l.K5)(e),s=w(e,"Žg"),n=isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight);i=n*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);v[e]=i}return i}}();function w(t,e){return T||(T=(0,h.Y)(1,1)),t!=k&&(T.font=t,k=T.font),T.measureText(e)}function R(t,e){return w(t,e).width}function E(t,e,i){if(e in i)return i[e];const s=e.split("\n").reduce(((e,i)=>Math.max(e,R(t,i))),0);return i[e]=s,s}function A(t,e){const i=[],s=[],n=[];let o=0,h=0,l=0,r=0;for(let a=0,c=e.length;a<=c;a+=2){const _=e[a];if("\n"===_||a===c){o=Math.max(o,h),n.push(h),h=0,l+=r;continue}const d=e[a+1]||t.font,g=R(d,_);i.push(g),h+=g;const u=I(d);s.push(u),r=Math.max(r,u)}return{width:o,height:l,widths:i,heights:s,lineWidths:n}}function L(t,e,i,s,n,o,h,l,r,a,c){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.setTransform.apply(t,e),s.contextInstructions?(t.translate(r,a),t.scale(c[0],c[1]),O(s,t)):c[0]<0||c[1]<0?(t.translate(r,a),t.scale(c[0],c[1]),t.drawImage(s,n,o,h,l,0,0,h,l)):t.drawImage(s,n,o,h,l,r,a,h*c[0],l*c[1]),t.restore()}function O(t,e){const i=t.contextInstructions;for(let s=0,n=i.length;s<n;s+=2)Array.isArray(i[s+1])?e[i[s]].apply(e,i[s+1]):e[i[s]]=i[s+1]}},8130:(t,e,i)=>{i.d(e,{A:()=>d});var s=i(66429),n=i(11580),o=i(32826),h=i(77295),l=i(70915),r=i(38774),a=i(66514),c=i(56361);class _ extends o.A{constructor(t,e,i,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,n=this.coordinates;let o=n.length;for(let h=0,r=t.length;h<r;h+=e)s[0]=t[h],s[1]=t[h+1],(0,l.Ym)(i,s)&&(n[o++]=s[0],n[o++]=s[1]);return o}appendFlatLineCoordinates(t,e,i,s,o,h){const r=this.coordinates;let a=r.length;const c=this.getBufferedMaxExtent();h&&(e+=s);let _=t[e],d=t[e+1];const g=this.tmpCoordinate_;let u,f,x,S=!0;for(u=e+s;u<i;u+=s)g[0]=t[u],g[1]=t[u+1],x=(0,l.vz)(c,g),x!==f?(S&&(r[a++]=_,r[a++]=d,S=!1),r[a++]=g[0],r[a++]=g[1]):x===n.A.INTERSECTING?(r[a++]=g[0],r[a++]=g[1],S=!1):S=!0,_=g[0],d=g[1],f=x;return(o&&S||u===e+s)&&(r[a++]=_,r[a++]=d),a}drawCustomCoordinates_(t,e,i,s,n){for(let o=0,h=i.length;o<h;++o){const h=i[o],l=this.appendFlatLineCoordinates(t,e,h,s,!1,!1);n.push(l),e=h}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const o=t.getType(),h=t.getStride(),l=this.coordinates.length;let r,a,_,d,g;switch(o){case"MultiPolygon":r=t.getOrientedFlatCoordinates(),d=[];const e=t.getEndss();g=0;for(let t=0,i=e.length;t<i;++t){const i=[];g=this.drawCustomCoordinates_(r,g,e[t],h,i),d.push(i)}this.instructions.push([s.Ay.CUSTOM,l,d,t,i,c.Dz]),this.hitDetectionInstructions.push([s.Ay.CUSTOM,l,d,t,n||i,c.Dz]);break;case"Polygon":case"MultiLineString":_=[],r="Polygon"==o?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),g=this.drawCustomCoordinates_(r,0,t.getEnds(),h,_),this.instructions.push([s.Ay.CUSTOM,l,_,t,i,c.cD]),this.hitDetectionInstructions.push([s.Ay.CUSTOM,l,_,t,n||i,c.cD]);break;case"LineString":case"Circle":r=t.getFlatCoordinates(),a=this.appendFlatLineCoordinates(r,0,r.length,h,!1,!1),this.instructions.push([s.Ay.CUSTOM,l,a,t,i,c.n2]),this.hitDetectionInstructions.push([s.Ay.CUSTOM,l,a,t,n||i,c.n2]);break;case"MultiPoint":r=t.getFlatCoordinates(),a=this.appendFlatPointCoordinates(r,h),a>l&&(this.instructions.push([s.Ay.CUSTOM,l,a,t,i,c.n2]),this.hitDetectionInstructions.push([s.Ay.CUSTOM,l,a,t,n||i,c.n2]));break;case"Point":r=t.getFlatCoordinates(),this.coordinates.push(r[0],r[1]),a=this.coordinates.length,this.instructions.push([s.Ay.CUSTOM,l,a,t,i]),this.hitDetectionInstructions.push([s.Ay.CUSTOM,l,a,t,n||i]);break;default:}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[s.Ay.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[s.Ay.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,o,h=-1;for(e=0;e<i;++e)n=t[e],o=n[0],o==s.Ay.END_GEOMETRY?h=e:o==s.Ay.BEGIN_GEOMETRY&&(n[2]=e,(0,a.gI)(this.hitDetectionInstructions,h,e),h=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=(0,h.F)(e||r.qY)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=(0,h.F)(t||r.NT);const s=e.getLineCap();i.lineCap=void 0!==s?s:r._m;const n=e.getLineDash();i.lineDash=n?n.slice():r.Oq;const o=e.getLineDashOffset();i.lineDashOffset=o||r.vk;const l=e.getLineJoin();i.lineJoin=void 0!==l?l:r._K;const a=e.getWidth();i.lineWidth=void 0!==a?a:r.aq;const c=e.getMiterLimit();i.miterLimit=void 0!==c?c:r.eL,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[s.Ay.SET_FILL_STYLE,e];return"string"!==typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[s.Ay.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"===typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,s=t.lineCap,n=t.lineDash,o=t.lineDashOffset,h=t.lineJoin,l=t.lineWidth,r=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=s||n!=t.currentLineDash&&!(0,a.aI)(t.currentLineDash,n)||t.currentLineDashOffset!=o||t.currentLineJoin!=h||t.currentLineWidth!=l||t.currentMiterLimit!=r)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=s,t.currentLineDash=n,t.currentLineDashOffset=o,t.currentLineJoin=h,t.currentLineWidth=l,t.currentMiterLimit=r)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[s.Ay.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,l.o8)(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;(0,l.r)(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const d=_},70587:(t,e,i)=>{i.d(e,{A:()=>x});var s=i(8130),n=i(66429);class o extends s.A{constructor(t,e,i,s){super(t,e,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,h=this.appendFlatPointCoordinates(i,s);this.instructions.push([n.Ay.DRAW_IMAGE,o,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.Ay.DRAW_IMAGE,o,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),s=t.getStride(),o=this.coordinates.length,h=this.appendFlatPointCoordinates(i,s);this.instructions.push([n.Ay.DRAW_IMAGE,o,h,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([n.Ay.DRAW_IMAGE,o,h,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),s=t.getSize(),n=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=n[0],this.originY_=n[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const h=o;var l=i(38774);class r extends s.A{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinates_(t,e,i,s){const o=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,i,s,!1,!1),l=[n.Ay.MOVE_TO_LINE_TO,o,h];return this.instructions.push(l),this.hitDetectionInstructions.push(l),i}drawLineString(t,e){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(void 0===s||void 0===o)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([n.Ay.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,l.Oq,l.vk],n.th);const h=t.getFlatCoordinates(),r=t.getStride();this.drawFlatCoordinates_(h,0,h.length,r),this.hitDetectionInstructions.push(n.VD),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(void 0===s||void 0===o)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([n.Ay.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,l.Oq,l.vk],n.th);const h=t.getEnds(),r=t.getFlatCoordinates(),a=t.getStride();let c=0;for(let n=0,l=h.length;n<l;++n)c=this.drawFlatCoordinates_(r,c,h[n],a);this.hitDetectionInstructions.push(n.VD),this.endGeometry(e)}finish(){const t=this.state;return void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(n.VD),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(n.VD),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(n.th)}}const a=r;var c=i(83671);class _ extends s.A{constructor(t,e,i,s){super(t,e,i,s)}drawFlatCoordinatess_(t,e,i,s){const o=this.state,h=void 0!==o.fillStyle,l=void 0!==o.strokeStyle,r=i.length;this.instructions.push(n.th),this.hitDetectionInstructions.push(n.th);for(let a=0;a<r;++a){const o=i[a],h=this.coordinates.length,r=this.appendFlatLineCoordinates(t,e,o,s,!0,!l),c=[n.Ay.MOVE_TO_LINE_TO,h,r];this.instructions.push(c),this.hitDetectionInstructions.push(c),l&&(this.instructions.push(n.kx),this.hitDetectionInstructions.push(n.kx)),e=o}return h&&(this.instructions.push(n.I5),this.hitDetectionInstructions.push(n.I5)),l&&(this.instructions.push(n.VD),this.hitDetectionInstructions.push(n.VD)),e}drawCircle(t,e){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(void 0===s&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.Ay.SET_FILL_STYLE,l.qY]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.Ay.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,l.Oq,l.vk]);const h=t.getFlatCoordinates(),r=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(h,0,h.length,r,!1,!1);const c=[n.Ay.CIRCLE,a];this.instructions.push(n.th,c),this.hitDetectionInstructions.push(n.th,c),void 0!==i.fillStyle&&(this.instructions.push(n.I5),this.hitDetectionInstructions.push(n.I5)),void 0!==i.strokeStyle&&(this.instructions.push(n.VD),this.hitDetectionInstructions.push(n.VD)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(void 0===s&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.Ay.SET_FILL_STYLE,l.qY]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.Ay.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,l.Oq,l.vk]);const h=t.getEnds(),r=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(r,0,h,a),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(void 0===s&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([n.Ay.SET_FILL_STYLE,l.qY]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([n.Ay.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,l.Oq,l.vk]);const h=t.getEndss(),r=t.getOrientedFlatCoordinates(),a=t.getStride();let c=0;for(let n=0,l=h.length;n<l;++n)c=this.drawFlatCoordinatess_(r,c,h[n],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,s=e.length;i<s;++i)e[i]=(0,c.n$)(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state,e=t.fillStyle;void 0!==e&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}const d=_;var g=i(55799);const u={Circle:d,Default:s.A,Image:h,LineString:a,Polygon:d,Text:g.A};class f{constructor(t,e,i,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const s in i){const n=i[s].finish();t[e][s]=n}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let s=this.buildersByZIndex_[i];void 0===s&&(s={},this.buildersByZIndex_[i]=s);let n=s[e];if(void 0===n){const t=u[e];n=new t(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=n}return n}}const x=f},4961:(t,e,i)=>{i.d(e,{A:()=>A});var s=i(66429),n=i(55799),o=i(9703),h=i(70915),l=i(38774),r=i(27016),a=i(66514),c=i(50904),_=i(87622);const d=(0,h.S5)(),g=[],u=[],f=[],x=[];function S(t){return t[3].declutterBox}const m=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function p(t,e){return"start"===e?e=m.test(t)?"right":"left":"end"===e&&(e=m.test(t)?"left":"right"),n.E[e]}function y(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}class k{constructor(t,e,i,s){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,o.vt)(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,s){const o=t+e+i+s;if(this.labels_[o])return this.labels_[o];const h=s?this.strokeStates[s]:null,r=i?this.fillStates[i]:null,a=this.textStates[e],c=this.pixelRatio,_=[a.scale[0]*c,a.scale[1]*c],d=Array.isArray(t),g=a.justify?n.E[a.justify]:p(Array.isArray(t)?t[0]:t,a.textAlign||l.MY),u=s&&h.lineWidth?h.lineWidth:0,f=d?t:t.split("\n").reduce(y,[]),{width:x,height:S,widths:m,heights:k,lineWidths:T}=(0,l.jT)(a,f),v=x+u,C=[],I=(v+2)*_[0],w=(S+u)*_[1],R={width:I<0?Math.floor(I):Math.ceil(I),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:C};1==_[0]&&1==_[1]||C.push("scale",_),s&&(C.push("strokeStyle",h.strokeStyle),C.push("lineWidth",u),C.push("lineCap",h.lineCap),C.push("lineJoin",h.lineJoin),C.push("miterLimit",h.miterLimit),C.push("setLineDash",[h.lineDash]),C.push("lineDashOffset",h.lineDashOffset)),i&&C.push("fillStyle",r.fillStyle),C.push("textBaseline","middle"),C.push("textAlign","center");const E=.5-g;let A=g*v+E*u;const L=[],O=[];let D,M=0,b=0,F=0,P=0;for(let n=0,l=f.length;n<l;n+=2){const t=f[n];if("\n"===t){b+=M,M=0,A=g*v+E*u,++P;continue}const e=f[n+1]||a.font;e!==D&&(s&&L.push("font",e),i&&O.push("font",e),D=e),M=Math.max(M,k[F]);const o=[t,A+E*m[F]+g*(m[F]-T[P]),.5*(u+M)+b];A+=m[F],s&&L.push("strokeText",o),i&&O.push("fillText",o),++F}return Array.prototype.push.apply(C,L),Array.prototype.push.apply(C,O),this.labels_[o]=R,R}replayTextBackground_(t,e,i,s,n,o,h){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,s),t.lineTo.apply(t,n),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),h&&(this.setStrokeStyle_(t,h),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,s,n,l,r,a,c,_,S,m,p,y,k,T){r*=m[0],a*=m[1];let v=i-r,C=s-a;const I=n+c>t?t-c:n,w=l+_>e?e-_:l,R=y[3]+I*m[0]+y[1],E=y[0]+w*m[1]+y[2],A=v-y[3],L=C-y[0];let O;return(k||0!==S)&&(g[0]=A,x[0]=A,g[1]=L,u[1]=L,u[0]=A+R,f[0]=u[0],f[1]=L+E,x[1]=f[1]),0!==S?(O=(0,o.Zz)((0,o.vt)(),i,s,1,1,S,-i,-s),(0,o.Bb)(O,g),(0,o.Bb)(O,u),(0,o.Bb)(O,f),(0,o.Bb)(O,x),(0,h.N)(Math.min(g[0],u[0],f[0],x[0]),Math.min(g[1],u[1],f[1],x[1]),Math.max(g[0],u[0],f[0],x[0]),Math.max(g[1],u[1],f[1],x[1]),d)):(0,h.N)(Math.min(A,A+R),Math.min(L,L+E),Math.max(A,A+R),Math.max(L,L+E),d),p&&(v=Math.round(v),C=Math.round(C)),{drawImageX:v,drawImageY:C,drawImageW:I,drawImageH:w,originX:c,originY:_,declutterBox:{minX:d[0],minY:d[1],maxX:d[2],maxY:d[3],value:T},canvasTransform:O,scale:m}}replayImageOrLabel_(t,e,i,s,n,o,h){const r=!(!o&&!h),a=s.declutterBox,c=t.canvas,_=h?h[2]*s.scale[0]/2:0,d=a.minX-_<=c.width/e&&a.maxX+_>=0&&a.minY-_<=c.height/e&&a.maxY+_>=0;return d&&(r&&this.replayTextBackground_(t,g,u,f,x,o,h),(0,l.Jw)(t,s.canvasTransform,n,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){if(this.alignFill_){const e=(0,o.Bb)(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t["strokeStyle"]=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,s){const o=this.textStates[e],h=this.createLabel(t,e,s,i),r=this.strokeStates[i],a=this.pixelRatio,c=p(Array.isArray(t)?t[0]:t,o.textAlign||l.MY),_=n.E[o.textBaseline||l.M8],d=r&&r.lineWidth?r.lineWidth:0,g=h.width/a-2*o.scale[0],u=c*g+2*(.5-c)*d,f=_*h.height/a+2*(.5-_)*d;return{label:h,anchorX:u,anchorY:f}}execute_(t,e,i,n,d,g,u,f){let x;this.pixelCoordinates_&&(0,a.aI)(i,this.renderedTransform_)?x=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),x=(0,_.Rc)(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),(0,o.k3)(this.renderedTransform_,i));let m=0;const y=n.length;let k,T,v,C,I,w,R,E,A,L,O,D,M=0,b=0,F=0,P=null,W=null;const Y=this.coordinateCache_,G=this.viewRotation_,B=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,N={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:G},q=this.instructions!=n||this.overlaps?0:200;let V,X,H,K;while(m<y){const i=n[m],o=i[0];switch(o){case s.Ay.BEGIN_GEOMETRY:V=i[1],K=i[3],V.getGeometry()?void 0===u||(0,h.HY)(u,K.getExtent())?++m:m=i[2]+1:m=i[2];break;case s.Ay.BEGIN_PATH:b>q&&(this.fill_(t),b=0),F>q&&(t.stroke(),F=0),b||F||(t.beginPath(),C=NaN,I=NaN),++m;break;case s.Ay.CIRCLE:M=i[1];const n=x[M],o=x[M+1],a=x[M+2],_=x[M+3],y=a-n,J=_-o,Z=Math.sqrt(y*y+J*J);t.moveTo(n+Z,o),t.arc(n,o,Z,0,2*Math.PI,!0),++m;break;case s.Ay.CLOSE_PATH:t.closePath(),++m;break;case s.Ay.CUSTOM:M=i[1],k=i[2];const U=i[3],z=i[4],j=6==i.length?i[5]:void 0;N.geometry=U,N.feature=V,m in Y||(Y[m]=[]);const $=Y[m];j?j(x,M,k,2,$):($[0]=x[M],$[1]=x[M+1],$.length=2),z($,N),++m;break;case s.Ay.DRAW_IMAGE:M=i[1],k=i[2],E=i[3],T=i[4],v=i[5];let Q=i[6];const tt=i[7],et=i[8],it=i[9],st=i[10];let nt=i[11];const ot=i[12];let ht=i[13];const lt=i[14],rt=i[15];if(!E&&i.length>=20){A=i[19],L=i[20],O=i[21],D=i[22];const t=this.drawLabelWithPointPlacement_(A,L,O,D);E=t.label,i[3]=E;const e=i[23];T=(t.anchorX-e)*this.pixelRatio,i[4]=T;const s=i[24];v=(t.anchorY-s)*this.pixelRatio,i[5]=v,Q=E.height,i[6]=Q,ht=E.width,i[13]=ht}let at,ct,_t,dt;i.length>25&&(at=i[25]),i.length>17?(ct=i[16],_t=i[17],dt=i[18]):(ct=l.Tq,_t=!1,dt=!1),st&&B?nt+=G:st||B||(nt-=G);let gt=0;for(;M<k;M+=2){if(at&&at[gt++]<ht/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(E.width,E.height,x[M],x[M+1],ht,Q,T,v,et,it,nt,ot,d,ct,_t||dt,V),s=[t,e,E,i,tt,_t?P:null,dt?W:null];if(f){if("none"===lt)continue;if("obstacle"===lt){f.insert(i.declutterBox);continue}{let t,e;if(rt){const i=k-M;if(!rt[i]){rt[i]=s;continue}if(t=rt[i],delete rt[i],e=S(t),f.collides(e))continue}if(f.collides(i.declutterBox))continue;t&&(f.insert(e),this.replayImageOrLabel_.apply(this,t)),f.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,s)}++m;break;case s.Ay.DRAW_CHARS:const ut=i[1],ft=i[2],xt=i[3],St=i[4];D=i[5];const mt=i[6],pt=i[7],yt=i[8];O=i[9];const kt=i[10];A=i[11],L=i[12];const Tt=[i[13],i[13]],vt=this.textStates[L],Ct=vt.font,It=[vt.scale[0]*pt,vt.scale[1]*pt];let wt;Ct in this.widths_?wt=this.widths_[Ct]:(wt={},this.widths_[Ct]=wt);const Rt=(0,c.k)(x,ut,ft,2),Et=Math.abs(It[0])*(0,l.TA)(Ct,A,wt);if(St||Et<=Rt){const i=this.textStates[L].textAlign,s=(Rt-Et)*p(A,i),n=(0,r.w)(x,ut,ft,2,A,s,mt,Math.abs(It[0]),l.TA,Ct,wt,B?0:this.viewRotation_);t:if(n){const i=[];let s,o,h,r,a;if(O)for(s=0,o=n.length;s<o;++s){a=n[s],h=a[4],r=this.createLabel(h,L,"",O),T=a[2]+(It[0]<0?-kt:kt),v=xt*r.height+2*(.5-xt)*kt*It[1]/It[0]-yt;const o=this.calculateImageOrLabelDimensions_(r.width,r.height,a[0],a[1],r.width,r.height,T,v,0,0,a[3],Tt,!1,l.Tq,!1,V);if(f&&f.collides(o.declutterBox))break t;i.push([t,e,r,o,1,null,null])}if(D)for(s=0,o=n.length;s<o;++s){a=n[s],h=a[4],r=this.createLabel(h,L,D,""),T=a[2],v=xt*r.height-yt;const o=this.calculateImageOrLabelDimensions_(r.width,r.height,a[0],a[1],r.width,r.height,T,v,0,0,a[3],Tt,!1,l.Tq,!1,V);if(f&&f.collides(o.declutterBox))break t;i.push([t,e,r,o,1,null,null])}f&&f.load(i.map(S));for(let t=0,e=i.length;t<e;++t)this.replayImageOrLabel_.apply(this,i[t])}}++m;break;case s.Ay.END_GEOMETRY:if(void 0!==g){V=i[1];const t=g(V,K);if(t)return t}++m;break;case s.Ay.FILL:q?b++:this.fill_(t),++m;break;case s.Ay.MOVE_TO_LINE_TO:for(M=i[1],k=i[2],X=x[M],H=x[M+1],w=X+.5|0,R=H+.5|0,w===C&&R===I||(t.moveTo(X,H),C=w,I=R),M+=2;M<k;M+=2)X=x[M],H=x[M+1],w=X+.5|0,R=H+.5|0,M!=k-2&&w===C&&R===I||(t.lineTo(X,H),C=w,I=R);++m;break;case s.Ay.SET_FILL_STYLE:P=i,this.alignFill_=i[2],b&&(this.fill_(t),b=0,F&&(t.stroke(),F=0)),t.fillStyle=i[1],++m;break;case s.Ay.SET_STROKE_STYLE:W=i,F&&(t.stroke(),F=0),this.setStrokeStyle_(t,i),++m;break;case s.Ay.STROKE:q?F++:t.stroke(),++m;break;default:++m;break}}b&&this.fill_(t),F&&t.stroke()}execute(t,e,i,s,n,o){this.viewRotation_=s,this.execute_(t,e,i,this.instructions,n,void 0,void 0,o)}executeHitDetection(t,e,i,s,n){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,s,n)}}const T=k;var v=i(68711),C=i(43530);const I=["Polygon","Circle","LineString","Image","Text","Default"];class w{constructor(t,e,i,s,n,h){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=h,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,o.vt)(),this.createExecutors_(n)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const s=t[e];for(const t in s){const e=s[t];i[t]=new T(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,s=t.length;e<s;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,s,n,l){s=Math.round(s);const r=2*s+1,c=(0,o.Zz)(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-i,-t[0],-t[1]),_=!this.hitDetectionContext_;_&&(this.hitDetectionContext_=(0,v.Y)(r,r,void 0,{willReadFrequently:!0}));const d=this.hitDetectionContext_;let g;d.canvas.width!==r||d.canvas.height!==r?(d.canvas.width=r,d.canvas.height=r):_||d.clearRect(0,0,r,r),void 0!==this.renderBuffer_&&(g=(0,h.S5)(),(0,h.$C)(g,t),(0,h.r)(g,e*(this.renderBuffer_+s),g));const u=E(s);let f;function x(t,e){const i=d.getImageData(0,0,r,r).data;for(let o=0,h=u.length;o<h;o++)if(i[u[o]]>0){if(!l||"Image"!==f&&"Text"!==f||l.includes(t)){const i=(u[o]-3)/4,h=s-i%r,l=s-(i/r|0),a=n(t,e,h*h+l*l);if(a)return a}d.clearRect(0,0,r,r);break}}const S=Object.keys(this.executorsByZIndex_).map(Number);let m,p,y,k,T;for(S.sort(a.V_),m=S.length-1;m>=0;--m){const t=S[m].toString();for(y=this.executorsByZIndex_[t],p=I.length-1;p>=0;--p)if(f=I[p],k=y[f],void 0!==k&&(T=k.executeHitDetection(d,c,i,x,g),T))return T}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],s=e[1],n=e[2],o=e[3],h=[i,s,i,o,n,o,n,s];return(0,_.Rc)(h,0,8,2,t,h),h}isEmpty(){return(0,C.p)(this.executorsByZIndex_)}execute(t,e,i,s,n,o,h){const l=Object.keys(this.executorsByZIndex_).map(Number);let r,c,_,d,g,u;for(l.sort(a.V_),this.maxExtent_&&(t.save(),this.clip(t,i)),o=o||I,h&&l.reverse(),r=0,c=l.length;r<c;++r){const a=l[r].toString();for(g=this.executorsByZIndex_[a],_=0,d=o.length;_<d;++_){const l=o[_];u=g[l],void 0!==u&&u.execute(t,e,i,s,n,h)}}this.maxExtent_&&t.restore()}}const R={};function E(t){if(void 0!==R[t])return R[t];const e=2*t+1,i=t*t,s=new Array(i+1);for(let o=0;o<=t;++o)for(let n=0;n<=t;++n){const h=o*o+n*n;if(h>i)break;let l=s[h];l||(l=[],s[h]=l),l.push(4*((t+o)*e+(t+n))+3),o>0&&l.push(4*((t-o)*e+(t+n))+3),n>0&&(l.push(4*((t+o)*e+(t-n))+3),o>0&&l.push(4*((t-o)*e+(t-n))+3))}const n=[];for(let o=0,h=s.length;o<h;++o)s[o]&&n.push(...s[o]);return R[t]=n,n}const A=w},66429:(t,e,i)=>{i.d(e,{Ay:()=>r,I5:()=>n,VD:()=>o,kx:()=>l,th:()=>h});const s={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},n=[s.FILL],o=[s.STROKE],h=[s.BEGIN_PATH],l=[s.CLOSE_PATH],r=s},55799:(t,e,i)=>{i.d(e,{A:()=>g,E:()=>_});var s=i(8130),n=i(66429),o=i(77295),h=i(38774),l=i(4087),r=i(70915),a=i(68297),c=i(10126);const _={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class d extends s.A{constructor(t,e,i,s){super(t,e,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[h.qY]={fillStyle:h.qY},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(""===this.text_||!o||!i&&!s)return;const l=this.coordinates;let _=l.length;const d=t.getType();let g=null,u=t.getStride();if("line"!==o.placement||"LineString"!=d&&"MultiLineString"!=d&&"Polygon"!=d&&"MultiPolygon"!=d){let i=o.overflow?null:[];switch(d){case"Point":case"MultiPoint":g=t.getFlatCoordinates();break;case"LineString":g=t.getFlatMidpoint();break;case"Circle":g=t.getCenter();break;case"MultiLineString":g=t.getFlatMidpoints(),u=2;break;case"Polygon":g=t.getFlatInteriorPoint(),o.overflow||i.push(g[2]/this.resolution),u=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();g=[];for(let t=0,s=e.length;t<s;t+=3)o.overflow||i.push(e[t+2]/this.resolution),g.push(e[t],e[t+1]);if(0===g.length)return;u=2;break;default:}const s=this.appendFlatPointCoordinates(g,u);if(s===_)return;if(i&&(s-_)/2!==g.length/u){let t=_/2;i=i.filter(((e,i)=>{const s=l[2*(t+i)]===g[i*u]&&l[2*(t+i)+1]===g[i*u+1];return s||--t,s}))}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let r=o.padding;if(r!=h.Tq&&(o.scale[0]<0||o.scale[1]<0)){let t=o.padding[0],e=o.padding[1],i=o.padding[2],s=o.padding[3];o.scale[0]<0&&(e=-e,s=-s),o.scale[1]<0&&(t=-t,i=-i),r=[t,e,i,s]}const a=this.pixelRatio;this.instructions.push([n.Ay.DRAW_IMAGE,_,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,r==h.Tq?h.Tq:r.map((function(t){return t*a})),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const c=1/a,f=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=h.qY,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([n.Ay.DRAW_IMAGE,_,s,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[c,c],NaN,void 0,this.declutterImageWithText_,r,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?h.qY:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),o.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!(0,r.HY)(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(g=t.getFlatCoordinates(),"LineString"==d)i=[g.length];else if("MultiLineString"==d)i=t.getEnds();else if("Polygon"==d)i=t.getEnds().slice(0,1);else if("MultiPolygon"==d){const e=t.getEndss();i=[];for(let t=0,s=e.length;t<s;++t)i.push(e[t][0])}this.beginGeometry(t,e);const s=o.repeat,n=s?void 0:o.textAlign;let h=0;for(let t=0,e=i.length;t<e;++t){let e;e=s?(0,a.W)(s*this.resolution,g,h,i[t],u):[g.slice(h,i[t])];for(let s=0,r=e.length;s<r;++s){const r=e[s];let a=0,d=r.length;if(void 0==n){const t=(0,c.z)(o.maxAngle,r,0,r.length,2);a=t[0],d=t[1]}for(let t=a;t<d;t+=u)l.push(r[t],r[t+1]);const g=l.length;h=i[t],this.drawChars_(_,g),_=g}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const n=this.textKey_;n in this.textStates||(this.textStates[n]={font:e.font,textAlign:e.textAlign||h.MY,justify:e.justify,textBaseline:e.textBaseline||h.M8,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,s=this.textState_,o=this.strokeKey_,l=this.textKey_,r=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,c=_[s.textBaseline],d=this.textOffsetY_*a,g=this.text_,u=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([n.Ay.DRAW_CHARS,t,e,c,s.overflow,r,s.maxAngle,a,d,o,u*a,g,l,1]),this.hitDetectionInstructions.push([n.Ay.DRAW_CHARS,t,e,c,s.overflow,r?h.qY:r,s.maxAngle,1,d,o,u,g,l,1/a])}setTextStyle(t,e){let i,s,n;if(t){const e=t.getFill();e?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=(0,o.F)(e.getColor()||h.qY)):(s=null,this.textFillState_=s);const r=t.getStroke();if(r){n=this.textStrokeState_,n||(n={},this.textStrokeState_=n);const t=r.getLineDash(),e=r.getLineDashOffset(),i=r.getWidth(),s=r.getMiterLimit();n.lineCap=r.getLineCap()||h._m,n.lineDash=t?t.slice():h.Oq,n.lineDashOffset=void 0===e?h.vk:e,n.lineJoin=r.getLineJoin()||h._K,n.lineWidth=void 0===i?h.aq:i,n.miterLimit=void 0===s?h.eL:s,n.strokeStyle=(0,o.F)(r.getColor()||h.NT)}else n=null,this.textStrokeState_=n;i=this.textState_;const a=t.getFont()||h.ZV;(0,h.fZ)(a);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=a,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||h.M8,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||h.Tq,i.scale=void 0===c?[1,1]:c;const _=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===_?0:_,this.textOffsetY_=void 0===d?0:d,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===u?0:u,this.strokeKey_=n?("string"==typeof n.strokeStyle?n.strokeStyle:(0,l.v6)(n.strokeStyle))+n.lineCap+n.lineDashOffset+"|"+n.lineWidth+n.lineJoin+n.miterLimit+"["+n.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s?"string"==typeof s.fillStyle?s.fillStyle:"|"+(0,l.v6)(s.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}const g=d},57849:(t,e,i)=>{i.d(e,{tF:()=>x,_7:()=>S,F8:()=>m});var s=i(32826),n=i(77295),o=i(9703),h=i(38774),l=i(66514),r=i(70915),a=i(61597),c=i(87622),_=i(62096);class d extends s.A{constructor(t,e,i,s,n,h,l){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=s,this.transformRotation_=s?(0,a.Mg)(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=n,this.squaredTolerance_=h,this.userTransform_=l,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,o.vt)()}drawImages_(t,e,i,s){if(!this.image_)return;const n=(0,c.Rc)(t,e,i,s,this.transform_,this.pixelCoordinates_),h=this.context_,l=this.tmpLocalTransform_,r=h.globalAlpha;1!=this.imageOpacity_&&(h.globalAlpha=r*this.imageOpacity_);let a=this.imageRotation_;0===this.transformRotation_&&(a-=this.viewRotation_),this.imageRotateWithView_&&(a+=this.viewRotation_);for(let c=0,_=n.length;c<_;c+=2){const t=n[c]-this.imageAnchorX_,e=n[c+1]-this.imageAnchorY_;if(0!==a||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const i=t+this.imageAnchorX_,s=e+this.imageAnchorY_;(0,o.Zz)(l,i,s,1,1,a,-i,-s),h.setTransform.apply(h,l),h.translate(i,s),h.scale(this.imageScale_[0],this.imageScale_[1]),h.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),h.setTransform(1,0,0,1,0,0)}else h.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,t,e,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(h.globalAlpha=r)}drawText_(t,e,i,s){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const n=(0,c.Rc)(t,e,i,s,this.transform_,this.pixelCoordinates_),o=this.context_;let h=this.textRotation_;for(0===this.transformRotation_&&(h-=this.viewRotation_),this.textRotateWithView_&&(h+=this.viewRotation_);e<i;e+=s){const t=n[e]+this.textOffsetX_,i=n[e+1]+this.textOffsetY_;0!==h||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.translate(t-this.textOffsetX_,i-this.textOffsetY_),o.rotate(h),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&o.strokeText(this.text_,t,i),this.textFillState_&&o.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,s,n){const o=this.context_,h=(0,c.Rc)(t,e,i,s,this.transform_,this.pixelCoordinates_);o.moveTo(h[0],h[1]);let l=h.length;n&&(l-=2);for(let r=2;r<l;r+=2)o.lineTo(h[r],h[r+1]);return n&&o.closePath(),i}drawRings_(t,e,i,s){for(let n=0,o=i.length;n<o;++n)e=this.moveToLineTo_(t,e,i[n],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,r.HY)(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=(0,_.v7)(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],s=e[3]-e[1],n=Math.sqrt(i*i+s*s),o=this.context_;o.beginPath(),o.arc(e[0],e[1],n,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){const e=t.getType();switch(e){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break;default:}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,s=e.length;i<s;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,r.HY)(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if((0,r.HY)(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let s=0;const n=t.getEnds(),o=t.getStride();e.beginPath();for(let t=0,h=n.length;t<h;++t)s=this.moveToLineTo_(i,s,n[t],o,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,r.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,r.HY)(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let s=0;const n=t.getEndss(),o=t.getStride();e.beginPath();for(let t=0,h=n.length;t<h;++t){const e=n[t];s=this.drawRings_(i,s,e,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),(0,l.aI)(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,s=t.textAlign?t.textAlign:h.MY;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=s&&(i.textAlign=s,e.textAlign=s),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:(0,n.F)(e||h.qY)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),l=e.getLineJoin(),r=e.getWidth(),a=e.getMiterLimit(),c=s||h.Oq;this.strokeState_={lineCap:void 0!==i?i:h._m,lineDash:1===this.pixelRatio_?c:c.map((t=>t*this.pixelRatio_)),lineDashOffset:(o||h.vk)*this.pixelRatio_,lineJoin:void 0!==l?l:h._K,lineWidth:(void 0!==r?r:h.aq)*this.pixelRatio_,miterLimit:void 0!==a?a:h.eL,strokeStyle:(0,n.F)(t||h.NT)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),n=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*i,this.imageAnchorY_=s[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:(0,n.F)(t||h.qY)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),s=i.getLineDash(),o=i.getLineDashOffset(),l=i.getLineJoin(),r=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:h._m,lineDash:s||h.Oq,lineDashOffset:o||h.vk,lineJoin:void 0!==l?l:h._K,lineWidth:void 0!==r?r:h.aq,miterLimit:void 0!==a?a:h.eL,strokeStyle:(0,n.F)(t||h.NT)}}else this.textStrokeState_=null;const s=t.getFont(),o=t.getOffsetX(),l=t.getOffsetY(),r=t.getRotateWithView(),a=t.getRotation(),c=t.getScaleArray(),_=t.getText(),d=t.getTextAlign(),g=t.getTextBaseline();this.textState_={font:void 0!==s?s:h.ZV,textAlign:void 0!==d?d:h.MY,textBaseline:void 0!==g?g:h.M8},this.text_=void 0!==_?Array.isArray(_)?_.reduce(((t,e,i)=>t+(i%2?" ":e)),""):_:"",this.textOffsetX_=void 0!==o?this.pixelRatio_*o:0,this.textOffsetY_=void 0!==l?this.pixelRatio_*l:0,this.textRotateWithView_=void 0!==r&&r,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}else this.text_=""}}const g=d;var u=i(55394),f=i(68711);const x=.5;function S(t,e,i,s,n,o,h){const a=t[0]*x,c=t[1]*x,_=(0,f.Y)(a,c);_.imageSmoothingEnabled=!1;const d=_.canvas,S=new g(_,x,n,null,h),m=i.length,p=Math.floor(16777215/m),y={};for(let l=1;l<=m;++l){const t=i[l-1],e=t.getStyleFunction()||s;if(!e)continue;let h=e(t,o);if(!h)continue;Array.isArray(h)||(h=[h]);const a=l*p,c=a.toString(16).padStart(7,"#00000");for(let i=0,s=h.length;i<s;++i){const e=h[i],s=e.getGeometryFunction()(t);if(!s||!(0,r.HY)(n,s.getExtent()))continue;const o=e.clone(),l=o.getFill();l&&l.setColor(c);const a=o.getStroke();a&&(a.setColor(c),a.setLineDash(null)),o.setText(void 0);const _=e.getImage();if(_){const t=_.getImageSize();if(!t)continue;const e=(0,f.Y)(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=c,e.fillRect(0,0,i.width,i.height),o.setImage(new u["default"]({img:i,imgSize:t,anchor:_.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:_.getOrigin(),opacity:1,size:_.getSize(),scale:_.getScale(),rotation:_.getRotation(),rotateWithView:_.getRotateWithView()}))}const d=o.getZIndex()||0;let g=y[d];g||(g={},y[d]=g,g["Polygon"]=[],g["Circle"]=[],g["LineString"]=[],g["Point"]=[]);const x=s.getType();if("GeometryCollection"===x){const t=s.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];g[i.getType().replace("Multi","")].push(i,o)}}else g[x.replace("Multi","")].push(s,o)}}const k=Object.keys(y).map(Number).sort(l.V_);for(let l=0,r=k.length;l<r;++l){const t=y[k[l]];for(const i in t){const s=t[i];for(let t=0,i=s.length;t<i;t+=2){S.setStyle(s[t+1]);for(let i=0,n=e.length;i<n;++i)S.setTransform(e[i]),S.drawGeometry(s[t])}}}return _.getImageData(0,0,d.width,d.height)}function m(t,e,i){const s=[];if(i){const n=Math.floor(Math.round(t[0])*x),o=Math.floor(Math.round(t[1])*x),h=4*((0,a.qE)(n,0,i.width-1)+(0,a.qE)(o,0,i.height-1)*i.width),l=i.data[h],r=i.data[h+1],c=i.data[h+2],_=c+256*(r+256*l),d=Math.floor(16777215/e.length);_&&_%d===0&&s.push(e[_/d-1])}return s}}}]);
//# sourceMappingURL=2997.010bedc2.js.map