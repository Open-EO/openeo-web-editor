"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[8022],{29186:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(57581),i=r(70553),o=r(37755),a=r(4773),s=r(11481),l=r(6101),u=r(69374),h=r(28641),d=r(63432),c=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=function(e){function t(t){var r=e.call(this,t)||this;return r.image_=null,r}return c(t,e),t.prototype.getImage=function(){return this.image_?this.image_.getImage():null},t.prototype.prepareFrame=function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.viewState,s=n.resolution,l=this.getLayer().getSource(),u=e.viewHints,c=e.extent;if(void 0!==t.extent&&(c=(0,h.Ed)(c,(0,d.dY)(t.extent,n.projection))),!u[o.Z.ANIMATING]&&!u[o.Z.INTERACTING]&&!(0,h.xb)(c))if(l){var p=n.projection;if(!a.j){var f=l.getProjection();f&&(p=f)}var g=l.getImage(c,s,r,p);g&&(this.loadImage(g)?this.image_=g:g.getState()===i.Z.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_},t.prototype.getData=function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,l.nn)(t.pixelToCoordinateTransform,e.slice()),i=r.getExtent();if(i&&!(0,h.b8)(i,n))return null;var o=this.image_.getExtent(),a=this.image_.getImage(),s=(0,h.dz)(o),u=Math.floor(a.width*((n[0]-o[0])/s));if(u<0||u>=a.width)return null;var d=(0,h.Cr)(o),c=Math.floor(a.height*((o[3]-n[1])/d));return c<0||c>=a.height?null:this.getImageData(a,u,c)},t.prototype.renderFrame=function(e,t){var r=this.image_,n=r.getExtent(),i=r.getResolution(),o=r.getPixelRatio(),a=e.layerStatesArray[e.layerIndex],c=e.pixelRatio,p=e.viewState,f=p.center,g=p.resolution,v=c*i/(g*o),y=e.extent,m=p.resolution,_=p.rotation,T=Math.round((0,h.dz)(y)/m*c),x=Math.round((0,h.Cr)(y)/m*c);(0,l.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/c,1/c,_,-T/2,-x/2),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);var R=(0,l.BB)(this.pixelTransform);this.useContainer(t,R,this.getBackground(e));var C=this.context,S=C.canvas;S.width!=T||S.height!=x?(S.width=T,S.height=x):this.containerReused||C.clearRect(0,0,T,x);var E=!1,I=!0;if(a.extent){var w=(0,d.dY)(a.extent,p.projection);I=(0,h.kK)(w,e.extent),E=I&&!(0,h.r4)(w,e.extent),E&&this.clipUnrotated(C,e,w)}var b=r.getImage(),P=(0,l.qC)(this.tempTransform,T/2,x/2,v,v,0,o*(n[0]-f[0])/i,o*(f[1]-n[3])/i);this.renderedResolution=i*c/o;var A=b.width*P[0],F=b.height*P[3];if(this.getLayer().getSource().getInterpolate()||(0,u.f0)(C,s.$),this.preRender(C,e),I&&A>=.5&&F>=.5){var Z=P[4],O=P[5],D=a.opacity,L=void 0;1!==D&&(L=C.globalAlpha,C.globalAlpha=D),C.drawImage(b,0,0,+b.width,+b.height,Z,O,A,F),1!==D&&(C.globalAlpha=L)}return this.postRender(C,e),E&&C.restore(),(0,u.f0)(C,s.s),R!==S.style.transform&&(S.style.transform=R),this.container},t}(n.Z);const f=p},57581:(e,t,r)=>{r.d(t,{Z:()=>v,r:()=>c});var n=r(10115),i=r(57380),o=r(98771),a=r(6101),s=r(79706),l=r(28641),u=r(68326),h=r(65537),d=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=[],p=null;function f(){var e=document.createElement("canvas");e.width=1,e.height=1,p=e.getContext("2d")}var g=function(e){function t(t){var r=e.call(this,t)||this;return r.container=null,r.renderedResolution,r.tempTransform=(0,a.Ue)(),r.pixelTransform=(0,a.Ue)(),r.inversePixelTransform=(0,a.Ue)(),r.context=null,r.containerReused=!1,r.pixelContext_=null,r.frameState=null,r}return d(t,e),t.prototype.getImageData=function(e,t,r){var n;p||f(),p.clearRect(0,0,1,1);try{p.drawImage(e,t,r,1,1,0,0,1,1),n=p.getImageData(0,0,1,1).data}catch(i){return p=null,null}return n},t.prototype.getBackground=function(e){var t=this.getLayer(),r=t.getBackground();return"function"===typeof r&&(r=r(e.viewState.resolution)),r||void 0},t.prototype.useContainer=function(e,t,r){var n,i,o=this.getLayer().getClassName();if(e&&e.className===o&&(!r||e&&e.style.backgroundColor&&(0,h.fS)((0,s._2)(e.style.backgroundColor),(0,s._2)(r)))){var a=e.firstElementChild;a instanceof HTMLCanvasElement&&(i=a.getContext("2d"))}if(i&&i.canvas.style.transform===t?(this.container=e,this.context=i,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){n=document.createElement("div"),n.className=o;var l=n.style;l.position="absolute",l.width="100%",l.height="100%",i=(0,u.E4)();a=i.canvas;n.appendChild(a),l=a.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=n,this.context=i}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)},t.prototype.clipUnrotated=function(e,t,r){var n=(0,l.rL)(r),i=(0,l.Xv)(r),o=(0,l.w$)(r),s=(0,l.hC)(r);(0,a.nn)(t.coordinateToPixelTransform,n),(0,a.nn)(t.coordinateToPixelTransform,i),(0,a.nn)(t.coordinateToPixelTransform,o),(0,a.nn)(t.coordinateToPixelTransform,s);var u=this.inversePixelTransform;(0,a.nn)(u,n),(0,a.nn)(u,i),(0,a.nn)(u,o),(0,a.nn)(u,s),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.clip()},t.prototype.dispatchRenderEvent_=function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){var o=new i.Z(e,this.inversePixelTransform,r,t);n.dispatchEvent(o)}},t.prototype.preRender=function(e,t){this.frameState=t,this.dispatchRenderEvent_(o.Z.PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(o.Z.POSTRENDER,e,t)},t.prototype.getRenderTransform=function(e,t,r,n,i,o,s){var l=i/2,u=o/2,h=n/t,d=-h,c=-e[0]+s,p=-e[1];return(0,a.qC)(this.tempTransform,l,u,h,d,-r,c,p)},t.prototype.getDataAtPixel=function(e,t,r){var n=(0,a.nn)(this.inversePixelTransform,e.slice()),i=this.context,o=this.getLayer(),s=o.getExtent();if(s){var u=(0,a.nn)(t.pixelToCoordinateTransform,e.slice());if(!(0,l.b8)(s,u))return null}var h,d=Math.round(n[0]),c=Math.round(n[1]),p=this.pixelContext_;if(!p){var f=document.createElement("canvas");f.width=1,f.height=1,p=f.getContext("2d"),this.pixelContext_=p}p.clearRect(0,0,1,1);try{p.drawImage(i.canvas,d,c,1,1,0,0,1,1),h=p.getImageData(0,0,1,1).data}catch(g){return"SecurityError"===g.name?(this.pixelContext_=null,new Uint8Array):h}return 0===h[3]?null:h},t.prototype.disposeInternal=function(){delete this.frameState,e.prototype.disposeInternal.call(this)},t}(n.Z);const v=g},8845:(e,t,r)=>{r.d(t,{Z:()=>m});var n=r(57581),i=r(20825),o=r(96113),a=r(2519),s=r(37195),l=r(11481),u=r(6101),h=r(69374),d=r(28641),c=r(63432),p=r(74187),f=r(65537),g=r(4307),v=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=(0,d.lJ)(),r.tmpTileRange_=new a.Z(0,0,0,0),r}return v(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),n=t.getUseInterimTilesOnError();return r==s.Z.LOADED||r==s.Z.EMPTY||r==s.Z.ERROR&&!n},t.prototype.getTile=function(e,t,r,n){var i=n.pixelRatio,o=n.viewState.projection,a=this.getLayer(),l=a.getSource(),u=l.getTile(e,t,r,i,o);return u.getState()==s.Z.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):u.setState(s.Z.LOADED)),this.isDrawableTile(u)||(u=u.getInterimTile()),u},t.prototype.getData=function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,u.nn)(t.pixelToCoordinateTransform,e.slice()),a=r.getExtent();if(a&&!(0,d.b8)(a,n))return null;for(var l=t.pixelRatio,h=t.viewState.projection,c=t.viewState,p=r.getRenderSource(),f=p.getTileGridForProjection(c.projection),v=p.getTilePixelRatio(t.pixelRatio),y=f.getZForResolution(c.resolution);y>=f.getMinZoom();--y){var m=f.getTileCoordForCoordAndZ(n,y),_=p.getTile(y,m[1],m[2],l,h);if(!(_ instanceof i.Z||_ instanceof o.Z))return null;if(_.getState()===s.Z.LOADED){var T=f.getOrigin(y),x=(0,g.Pq)(f.getTileSize(y)),R=f.getResolution(y),C=Math.floor(v*((n[0]-T[0])/R-m[1]*x[0])),S=Math.floor(v*((T[1]-n[1])/R-m[2]*x[1])),E=Math.round(v*p.getGutterForProjection(c.projection));return this.getImageData(_.getImage(),C+E,S+E)}}return null},t.prototype.loadedTileCallback=function(t,r,n){return!!this.isDrawableTile(n)&&e.prototype.loadedTileCallback.call(this,t,r,n)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],n=e.viewState,i=n.projection,o=n.resolution,a=n.center,g=n.rotation,v=e.pixelRatio,y=this.getLayer(),m=y.getSource(),_=m.getRevision(),T=m.getTileGridForProjection(i),x=T.getZForResolution(o,m.zDirection),R=T.getResolution(x),C=e.extent,S=e.viewState.resolution,E=m.getTilePixelRatio(v),I=Math.round((0,d.dz)(C)/S*v),w=Math.round((0,d.Cr)(C)/S*v),b=r.extent&&(0,c.dY)(r.extent,i);b&&(C=(0,d.Ed)(C,(0,c.dY)(r.extent,i)));var P=R*I/2/E,A=R*w/2/E,F=[a[0]-P,a[1]-A,a[0]+P,a[1]+A],Z=T.getTileRangeForExtentAndZ(C,x),O={};O[x]={};var D=this.createLoadedTileFinder(m,i,O),L=this.tmpExtent,M=this.tmpTileRange_;this.newTiles_=!1;for(var G=g?(0,d.dY)(n.center,S,g,e.size):void 0,B=Z.minX;B<=Z.maxX;++B)for(var j=Z.minY;j<=Z.maxY;++j)if(!g||T.tileCoordIntersectsViewport([x,B,j],G)){var N=this.getTile(x,B,j,e);if(this.isDrawableTile(N)){var k=(0,p.sq)(this);if(N.getState()==s.Z.LOADED){O[x][N.tileCoord.toString()]=N;var z=N.inTransition(k);z&&1!==r.opacity&&(N.endTransition(k),z=!1),this.newTiles_||!z&&-1!==this.renderedTiles.indexOf(N)||(this.newTiles_=!0)}if(1===N.getAlpha(k,e.time))continue}var U=T.getTileCoordChildTileRange(N.tileCoord,M,L),q=!1;U&&(q=D(x+1,U)),q||T.forEachTileCoordParentTileRange(N.tileCoord,D,M,L)}var H=R/o*v/E;(0,u.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/v,1/v,g,-I/2,-w/2);var V=(0,u.BB)(this.pixelTransform);this.useContainer(t,V,this.getBackground(e));var X=this.context,K=X.canvas;(0,u.nb)(this.inversePixelTransform,this.pixelTransform),(0,u.qC)(this.tempTransform,I/2,w/2,H,H,0,-I/2,-w/2),K.width!=I||K.height!=w?(K.width=I,K.height=w):this.containerReused||X.clearRect(0,0,I,w),b&&this.clipUnrotated(X,e,b),m.getInterpolate()||(0,h.f0)(X,l.$),this.preRender(X,e),this.renderedTiles.length=0;var W,Y,$,J=Object.keys(O).map(Number);J.sort(f.kK),1!==r.opacity||this.containerReused&&!m.getOpaque(e.viewState.projection)?(W=[],Y=[]):J=J.reverse();for(var Q=J.length-1;Q>=0;--Q){var ee=J[Q],te=m.getTilePixelSize(ee,v,i),re=T.getResolution(ee),ne=re/R,ie=te[0]*ne*H,oe=te[1]*ne*H,ae=T.getTileCoordForCoordAndZ((0,d.rL)(F),ee),se=T.getTileCoordExtent(ae),le=(0,u.nn)(this.tempTransform,[E*(se[0]-F[0])/R,E*(F[3]-se[3])/R]),ue=E*m.getGutterForProjection(i),he=O[ee];for(var de in he){N=he[de];var ce=N.tileCoord,pe=ae[1]-ce[1],fe=Math.round(le[0]-(pe-1)*ie),ge=ae[2]-ce[2],ve=Math.round(le[1]-(ge-1)*oe),ye=(B=Math.round(le[0]-pe*ie),j=Math.round(le[1]-ge*oe),fe-B),me=ve-j,_e=x===ee,Te=(z=_e&&1!==N.getAlpha((0,p.sq)(this),e.time),!1);if(!z)if(W){$=[B,j,B+ye,j,B+ye,j+me,B,j+me];for(var xe=0,Re=W.length;xe<Re;++xe)if(x!==ee&&ee<Y[xe]){var Ce=W[xe];(0,d.kK)([B,j,B+ye,j+me],[Ce[0],Ce[3],Ce[4],Ce[7]])&&(Te||(X.save(),Te=!0),X.beginPath(),X.moveTo($[0],$[1]),X.lineTo($[2],$[3]),X.lineTo($[4],$[5]),X.lineTo($[6],$[7]),X.moveTo(Ce[6],Ce[7]),X.lineTo(Ce[4],Ce[5]),X.lineTo(Ce[2],Ce[3]),X.lineTo(Ce[0],Ce[1]),X.clip())}W.push($),Y.push(ee)}else X.clearRect(B,j,ye,me);this.drawTileImage(N,e,B,j,ye,me,ue,_e),W&&!z?(Te&&X.restore(),this.renderedTiles.unshift(N)):this.renderedTiles.push(N),this.updateUsedTiles(e.usedTiles,m,N)}}return this.renderedRevision=_,this.renderedResolution=R,this.extentChanged=!this.renderedExtent_||!(0,d.fS)(this.renderedExtent_,F),this.renderedExtent_=F,this.renderedPixelRatio=v,this.renderedProjection=i,this.manageTilePyramid(e,m,T,v,i,C,x,y.getPreload()),this.scheduleExpireCache(e,m),this.postRender(X,e),r.extent&&X.restore(),(0,h.f0)(X,l.s),V!==K.style.transform&&(K.style.transform=V),this.container},t.prototype.drawTileImage=function(e,t,r,n,i,o,a,s){var l=this.getTileImage(e);if(l){var u=(0,p.sq)(this),h=t.layerStatesArray[t.layerIndex],d=h.opacity*(s?e.getAlpha(u,t.time):1),c=d!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,r,n,i,o),c&&this.context.restore(),d!==h.opacity?t.animate=!0:s&&e.endTransition(u)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var n=(0,p.sq)(e);n in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var n=(0,p.sq)(t);n in e||(e[n]={}),e[n][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,n,i,o,a,l,u){var h=(0,p.sq)(t);h in e.wantedTiles||(e.wantedTiles[h]={});var c,f,g,v,y,m,_=e.wantedTiles[h],T=e.tileQueue,x=r.getMinZoom(),R=e.viewState.rotation,C=R?(0,d.dY)(e.viewState.center,e.viewState.resolution,R,e.size):void 0,S=0;for(m=x;m<=a;++m)for(f=r.getTileRangeForExtentAndZ(o,m,f),g=r.getResolution(m),v=f.minX;v<=f.maxX;++v)for(y=f.minY;y<=f.maxY;++y)R&&!r.tileCoordIntersectsViewport([m,v,y],C)||(a-m<=l?(++S,c=t.getTile(m,v,y,n,i),c.getState()==s.Z.IDLE&&(_[c.getKey()]=!0,T.isKeyQueued(c.getKey())||T.enqueue([c,h,r.getTileCoordCenter(c.tileCoord),g])),void 0!==u&&u(c)):t.useTile(m,v,y,i));t.updateCacheSize(S,i)},t}(n.Z);const m=y},25682:(e,t,r)=>{r.d(t,{Z:()=>m});var n=r(35570),i=r(57581),o=r(15240),a=r(37755),s=r(12382),l=r(6101),u=r(28641),h=r(68326),d=r(76234),c=r(65537),p=r(63432),f=r(74187),g=r(91900),v=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.hitDetectionImageData_=null,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=(0,u.lJ)(),r.wrappedRenderedExtent_=(0,u.lJ)(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r.declutterExecutorGroup=null,r.clipping=!0,r.compositionContext_=null,r.opacity_=1,r}return v(t,e),t.prototype.renderWorlds=function(e,t,r){var n=t.extent,i=t.viewState,o=i.center,s=i.resolution,l=i.projection,h=i.rotation,d=l.getExtent(),c=this.getLayer().getSource(),p=t.pixelRatio,f=t.viewHints,g=!(f[a.Z.ANIMATING]||f[a.Z.INTERACTING]),v=this.compositionContext_,y=Math.round(t.size[0]*p),m=Math.round(t.size[1]*p),_=c.getWrapX()&&l.canWrapX(),T=_?(0,u.dz)(d):null,x=_?Math.ceil((n[2]-d[2])/T)+1:1,R=_?Math.floor((n[0]-d[0])/T):0;do{var C=this.getRenderTransform(o,s,h,p,y,m,R*T);e.execute(v,1,C,h,g,void 0,r)}while(++R<x)},t.prototype.setupCompositionContext_=function(){if(1!==this.opacity_){var e=(0,h.E4)(this.context.canvas.width,this.context.canvas.height,i.r);this.compositionContext_=e}else this.compositionContext_=this.context},t.prototype.releaseCompositionContext_=function(){if(1!==this.opacity_){var e=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=e,(0,h.jy)(this.compositionContext_),i.r.push(this.compositionContext_.canvas),this.compositionContext_=null}},t.prototype.renderDeclutter=function(e){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree),this.releaseCompositionContext_())},t.prototype.renderFrame=function(e,t){var r=e.pixelRatio,n=e.layerStatesArray[e.layerIndex];(0,l.n3)(this.pixelTransform,1/r,1/r),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);var i=(0,l.BB)(this.pixelTransform);this.useContainer(t,i,this.getBackground(e));var o=this.context,a=o.canvas,s=this.replayGroup_,h=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!h||h.isEmpty()))return null;var d=Math.round(e.size[0]*r),c=Math.round(e.size[1]*r);a.width!=d||a.height!=c?(a.width=d,a.height=c,a.style.transform!==i&&(a.style.transform=i)):this.containerReused||o.clearRect(0,0,d,c),this.preRender(o,e);var f=e.viewState,g=f.projection;this.opacity_=n.opacity,this.setupCompositionContext_();var v=!1,y=!0;if(n.extent&&this.clipping){var m=(0,p.dY)(n.extent,g);y=(0,u.kK)(m,e.extent),v=y&&!(0,u.r4)(m,e.extent),v&&this.clipUnrotated(this.compositionContext_,e,m)}return y&&this.renderWorlds(s,e),v&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,e),this.renderedRotation_!==f.rotation&&(this.renderedRotation_=f.rotation,this.hitDetectionImageData_=null),this.container},t.prototype.getFeatures=function(e){return new Promise(function(t){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];(0,l.nn)(this.pixelTransform,r);var n=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,h=this.wrappedRenderedExtent_,d=this.getLayer(),c=[],p=r[0]*s.UN,f=r[1]*s.UN;c.push(this.getRenderTransform(n,i,o,s.UN,p,f,0).slice());var g=d.getSource(),v=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!(0,u.r4)(v,h)){var y=h[0],m=(0,u.dz)(v),_=0,T=void 0;while(y<v[0])--_,T=m*_,c.push(this.getRenderTransform(n,i,o,s.UN,p,f,T).slice()),y+=m;_=0,y=h[2];while(y>v[2])++_,T=m*_,c.push(this.getRenderTransform(n,i,o,s.UN,p,f,T).slice()),y-=m}this.hitDetectionImageData_=(0,s.TU)(r,c,this.renderedFeatures_,d.getStyleFunction(),h,i,o)}t((0,s.ix)(e,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){var o=this;if(this.replayGroup_){var a,s=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},d=function(e,t,r){var o=(0,f.sq)(e),a=h[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return h[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,u,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return h[o]=!0,n(e,u,t);i.push(h[o]={feature:e,layer:u,geometry:t,distanceSq:r,callback:n})}},c=[this.replayGroup_];return this.declutterExecutorGroup&&c.push(this.declutterExecutorGroup),c.some((function(n){return a=n.forEachFeatureAtCoordinate(e,s,l,r,d,n===o.declutterExecutorGroup&&t.declutterTree?t.declutterTree.all().map((function(e){return e.value})):null)})),a}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource();if(!r)return!1;var i=e.viewHints[a.Z.ANIMATING],s=e.viewHints[a.Z.INTERACTING],l=t.getUpdateWhileAnimating(),h=t.getUpdateWhileInteracting();if(this.ready&&!l&&i||!h&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var f=e.extent,v=e.viewState,y=v.projection,m=v.resolution,_=e.pixelRatio,T=t.getRevision(),x=t.getRenderBuffer(),R=t.getRenderOrder();void 0===R&&(R=d.eR);var C=v.center.slice(),S=(0,u.f3)(f,x*m),E=S.slice(),I=[S.slice()],w=y.getExtent();if(r.getWrapX()&&y.canWrapX()&&!(0,u.r4)(w,e.extent)){var b=(0,u.dz)(w),P=Math.max((0,u.dz)(S)/2,b);S[0]=w[0]-P,S[2]=w[2]+P,(0,g.Cf)(C,y);var A=(0,u.Cf)(I[0],y);A[0]<w[0]&&A[2]<w[2]?I.push([A[0]+b,A[1],A[2]+b,A[3]]):A[0]>w[0]&&A[2]>w[2]&&I.push([A[0]-b,A[1],A[2]-b,A[3]])}if(this.ready&&this.renderedResolution_==m&&this.renderedRevision_==T&&this.renderedRenderOrder_==R&&(0,u.r4)(this.wrappedRenderedExtent_,S))return(0,c.fS)(this.renderedExtent_,E)||(this.hitDetectionImageData_=null,this.renderedExtent_=E),this.renderedCenter_=C,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var F,Z=new n.Z((0,d.Qz)(m,_),S,m,_);this.getLayer().getDeclutter()&&(F=new n.Z((0,d.Qz)(m,_),S,m,_));var O,D=(0,p.Cs)();if(D){for(var L=0,M=I.length;L<M;++L){var G=I[L],B=(0,p.Fj)(G,y);r.loadFeatures(B,(0,p.on)(m,y),D)}O=(0,p.WO)(D,y)}else for(L=0,M=I.length;L<M;++L)r.loadFeatures(I[L],m,y);var j=(0,d.se)(m,_),N=!0,k=function(e){var r,n=e.getStyleFunction()||t.getStyleFunction();if(n&&(r=n(e,m)),r){var i=this.renderFeature(e,j,r,Z,O,F);N=N&&!i}}.bind(this),z=(0,p.Fj)(S,y),U=r.getFeaturesInExtent(z);R&&U.sort(R);for(L=0,M=U.length;L<M;++L)k(U[L]);this.renderedFeatures_=U,this.ready=N;var q=Z.finish(),H=new o.Z(S,m,_,r.getOverlaps(),q,t.getRenderBuffer());return F&&(this.declutterExecutorGroup=new o.Z(S,m,_,r.getOverlaps(),F.finish(),t.getRenderBuffer())),this.renderedResolution_=m,this.renderedRevision_=T,this.renderedRenderOrder_=R,this.renderedExtent_=E,this.wrappedRenderedExtent_=S,this.renderedCenter_=C,this.renderedProjection_=y,this.replayGroup_=H,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(e,t,r,n,i,o){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var s=0,l=r.length;s<l;++s)a=(0,d.Pn)(n,e,r[s],t,this.boundHandleStyleImageChange_,i,o)||a;else a=(0,d.Pn)(n,e,r,t,this.boundHandleStyleImageChange_,i,o);return a},t}(i.Z);const m=y},85980:(e,t,r)=>{r.d(t,{Z:()=>T});var n=r(35570),i=r(15240),o=r(8845),a=r(37195),s=r(74225),l=r(37755),u=r(12382),h=r(6101),d=r(28641),c=r(76234),p=r(74187),f=r(4307),g=r(91900),v=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},m={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]},_=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.renderedLayerRevision_,r.renderedPixelToCoordinateTransform_=null,r.renderedRotation_,r.tmpTransform_=(0,h.Ue)(),r}return v(t,e),t.prototype.prepareTile=function(e,t,r){var n,i=e.getState();return i!==a.Z.LOADED&&i!==a.Z.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e)&&(n=!0)),n},t.prototype.getTile=function(t,r,n,i){var o=i.pixelRatio,a=i.viewState,u=a.resolution,h=a.projection,d=this.getLayer(),c=d.getSource().getTile(t,r,n,o,h),p=i.viewHints,f=!(p[l.Z.ANIMATING]||p[l.Z.INTERACTING]);!f&&c.wantedResolution||(c.wantedResolution=u);var g=this.prepareTile(c,o,h);return g&&(f||Date.now()-i.time<8)&&d.getRenderMode()!==s.Z.VECTOR&&this.renderTileImage_(c,i),e.prototype.getTile.call(this,t,r,n,i)},t.prototype.isDrawableTile=function(t){var r=this.getLayer();return e.prototype.isDrawableTile.call(this,t)&&(r.getRenderMode()===s.Z.VECTOR?(0,p.sq)(r)in t.executorGroups:t.hasContext(r))},t.prototype.getTileImage=function(e){return e.getImage(this.getLayer())},t.prototype.prepareFrame=function(t){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!==r&&(this.renderedLayerRevision_=r,this.renderedTiles.length=0),e.prototype.prepareFrame.call(this,t)},t.prototype.updateExecutorGroup_=function(e,t,r){var o=this.getLayer(),l=o.getRevision(),u=o.getRenderOrder()||null,h=e.wantedResolution,f=e.getReplayState(o);if(f.dirty||f.renderedResolution!==h||f.renderedRevision!=l||f.renderedRenderOrder!=u){var g=o.getSource(),v=o.getDeclutter(),y=g.getTileGrid(),m=g.getTileGridForProjection(r),_=m.getTileCoordExtent(e.wrappedTileCoord),T=g.getSourceTiles(t,r,e),x=(0,p.sq)(o);delete e.hitDetectionImageData[x],e.executorGroups[x]=[],v&&(e.declutterExecutorGroups[x]=[]),f.dirty=!1;for(var R=function(r,l){var p=T[r];if(p.getState()!=a.Z.LOADED)return"continue";var m=p.tileCoord,R=y.getTileCoordExtent(m),S=(0,d.Ed)(_,R),E=(0,d.f3)(S,o.getRenderBuffer()*h,C.tmpExtent),I=(0,d.fS)(R,S)?null:E,w=new n.Z(0,E,h,t),b=v?new n.Z(0,S,h,t):void 0,P=(0,c.se)(h,t),A=function(e){var t,r=e.getStyleFunction()||o.getStyleFunction();if(r&&(t=r(e,h)),t){var n=this.renderFeature(e,P,t,w,b);f.dirty=f.dirty||n}},F=p.getFeatures();u&&u!==f.renderedRenderOrder&&F.sort(u);for(var Z=0,O=F.length;Z<O;++Z){var D=F[Z];I&&!(0,d.kK)(I,D.getGeometry().getExtent())||A.call(C,D)}var L=w.finish(),M=o.getRenderMode()!==s.Z.VECTOR&&v&&1===T.length?null:S,G=new i.Z(M,h,t,g.getOverlaps(),L,o.getRenderBuffer());if(e.executorGroups[x].push(G),b){var B=new i.Z(null,h,t,g.getOverlaps(),b.finish(),o.getRenderBuffer());e.declutterExecutorGroups[x].push(B)}},C=this,S=0,E=T.length;S<E;++S)R(S,E);f.renderedRevision=l,f.renderedRenderOrder=u,f.renderedResolution=h}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){var o=t.viewState.resolution,a=t.viewState.rotation;r=void 0==r?0:r;var s=this.getLayer(),l=s.getSource(),u=l.getTileGridForProjection(t.viewState.projection),h=(0,d.hI)([e]);(0,d.f3)(h,o*r,h);for(var c,f={},g=function(e,t,r){var o=e.getId();void 0===o&&(o=(0,p.sq)(e));var a=f[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return f[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,s,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return f[o]=!0,n(e,s,t);i.push(f[o]={feature:e,layer:s,geometry:t,distanceSq:r,callback:n})}},v=this.renderedTiles,y=function(n,i){var l=v[n],f=u.getTileCoordExtent(l.wrappedTileCoord);if(!(0,d.kK)(f,h))return"continue";var y=(0,p.sq)(s),m=[l.executorGroups[y]],_=l.declutterExecutorGroups[y];_&&m.push(_),m.some((function(n){for(var i=n===_?t.declutterTree.all().map((function(e){return e.value})):null,s=0,l=n.length;s<l;++s){var u=n[s];if(c=u.forEachFeatureAtCoordinate(e,o,a,r,g,i),c)return!0}}))},m=0,_=v.length;!c&&m<_;++m)y(m,_);return c},t.prototype.getFeatures=function(e){return new Promise(function(t,r){for(var n,i=this.getLayer(),o=(0,p.sq)(i),s=i.getSource(),l=this.renderedProjection,c=l.getExtent(),v=this.renderedResolution,y=s.getTileGridForProjection(l),m=(0,h.nn)(this.renderedPixelToCoordinateTransform_,e.slice()),_=y.getTileCoordForCoordAndResolution(m,v),T=0,x=this.renderedTiles.length;T<x;++T)if(_.toString()===this.renderedTiles[T].tileCoord.toString()){if(n=this.renderedTiles[T],n.getState()===a.Z.LOADED){var R=y.getTileCoordExtent(n.tileCoord);s.getWrapX()&&l.canWrapX()&&!(0,d.r4)(c,R)&&(0,g.Cf)(m,l);break}n=void 0}if(!n||n.loadingSourceTiles>0)t([]);else{var C=y.getTileCoordExtent(n.wrappedTileCoord),S=(0,d.rL)(C),E=[(m[0]-S[0])/v,(S[1]-m[1])/v],I=n.getSourceTiles().reduce((function(e,t){return e.concat(t.getFeatures())}),[]),w=n.hitDetectionImageData[o];if(!w&&!this.animatingOrInteracting_){var b=(0,f.Pq)(y.getTileSize(y.getZForResolution(v,s.zDirection))),P=this.renderedRotation_,A=[this.getRenderTransform(y.getTileCoordCenter(n.wrappedTileCoord),v,0,u.UN,b[0]*u.UN,b[1]*u.UN,0)];w=(0,u.TU)(b,A,I,i.getStyleFunction(),y.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(i).renderedResolution,P),n.hitDetectionImageData[o]=w}t((0,u.ix)(E,I,w))}}.bind(this))},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.renderDeclutter=function(e){var t=this.context,r=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();for(var n=e.viewHints,i=!(n[l.Z.ANIMATING]||n[l.Z.INTERACTING]),o=this.renderedTiles,a=0,s=o.length;a<s;++a){var u=o[a],h=u.declutterExecutorGroups[(0,p.sq)(this.getLayer())];if(h)for(var d=h.length-1;d>=0;--d)h[d].execute(this.context,1,this.getTileRenderTransform(u,e),e.viewState.rotation,i,void 0,e.declutterTree)}t.globalAlpha=r},t.prototype.getTileRenderTransform=function(e,t){var r=t.pixelRatio,n=t.viewState,i=n.center,o=n.resolution,a=n.rotation,s=t.size,l=Math.round(s[0]*r),u=Math.round(s[1]*r),d=this.getLayer().getSource(),c=d.getTileGridForProjection(t.viewState.projection),p=e.tileCoord,f=c.getTileCoordExtent(e.wrappedTileCoord),g=c.getTileCoordExtent(p,this.tmpExtent)[0]-f[0],v=(0,h.Jp)((0,h.bA)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,a,r,l,u,g));return v},t.prototype.renderFrame=function(t,r){var n=t.viewHints,i=!(n[l.Z.ANIMATING]||n[l.Z.INTERACTING]);e.prototype.renderFrame.call(this,t,r),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var o=this.getLayer(),a=o.getRenderMode(),s=this.context,u=s.globalAlpha;s.globalAlpha=o.getOpacity();for(var h=m[a],c=t.viewState,f=c.rotation,g=o.getSource(),v=g.getTileGridForProjection(c.projection),y=v.getZForResolution(c.resolution,g.zDirection),_=this.renderedTiles,T=[],x=[],R=!0,C=_.length-1;C>=0;--C){var S=_[C];R=R&&!S.getReplayState(o).dirty;var E=S.executorGroups[(0,p.sq)(o)].filter((function(e){return e.hasExecutors(h)}));if(0!==E.length){var I=this.getTileRenderTransform(S,t),w=S.tileCoord[0],b=!1,P=E[0].getClipCoords(I);if(P){for(var A=0,F=T.length;A<F;++A)if(y!==w&&w<x[A]){var Z=T[A];(0,d.kK)([P[0],P[3],P[4],P[7]],[Z[0],Z[3],Z[4],Z[7]])&&(b||(s.save(),b=!0),s.beginPath(),s.moveTo(P[0],P[1]),s.lineTo(P[2],P[3]),s.lineTo(P[4],P[5]),s.lineTo(P[6],P[7]),s.moveTo(Z[6],Z[7]),s.lineTo(Z[4],Z[5]),s.lineTo(Z[2],Z[3]),s.lineTo(Z[0],Z[1]),s.clip())}T.push(P),x.push(w)}for(var O=0,D=E.length;O<D;++O){var L=E[O];L.execute(s,1,I,f,i,h)}b&&s.restore()}}return s.globalAlpha=u,this.ready=R,this.container},t.prototype.renderFeature=function(e,t,r,n,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var a=0,s=r.length;a<s;++a)o=(0,c.Pn)(n,e,r[a],t,this.boundHandleStyleImageChange_,void 0,i)||o;else o=(0,c.Pn)(n,e,r,t,this.boundHandleStyleImageChange_,void 0,i);return o},t.prototype.tileImageNeedsRender_=function(e){var t=this.getLayer();if(t.getRenderMode()===s.Z.VECTOR)return!1;var r=e.getReplayState(t),n=t.getRevision(),i=e.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n},t.prototype.renderTileImage_=function(e,t){var r=this.getLayer(),n=e.getReplayState(r),i=r.getRevision(),o=e.executorGroups[(0,p.sq)(r)];n.renderedTileRevision=i;var a=e.wrappedTileCoord,s=a[0],l=r.getSource(),u=t.pixelRatio,d=t.viewState,c=d.projection,f=l.getTileGridForProjection(c),g=f.getResolution(e.tileCoord[0]),v=t.pixelRatio/e.wantedResolution*g,m=f.getResolution(s),_=e.getContext(r);u=Math.round(Math.max(u,v/u));var T=l.getTilePixelSize(s,u,c);_.canvas.width=T[0],_.canvas.height=T[1];var x=u/v;if(1!==x){var R=(0,h.mc)(this.tmpTransform_);(0,h.bA)(R,x,x),_.setTransform.apply(_,R)}var C=f.getTileCoordExtent(a,this.tmpExtent),S=v/m,E=(0,h.mc)(this.tmpTransform_);(0,h.bA)(E,S,-S),(0,h.Iu)(E,-C[0],-C[3]);for(var I=0,w=o.length;I<w;++I){var b=o[I];b.execute(_,x,E,0,!0,y[r.getRenderMode()])}n.renderedTileResolution=e.wantedResolution},t}(o.Z);const T=_},11481:(e,t,r)=>{r.d(t,{$:()=>n,s:()=>i});var n={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},i={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0}},76234:(e,t,r)=>{r.d(t,{Pn:()=>d,Qz:()=>u,eR:()=>s,se:()=>l});var n=r(70553),i=r(74187),o=.5,a={Point:m,LineString:g,Polygon:T,MultiPoint:_,MultiLineString:v,MultiPolygon:y,GeometryCollection:f,Circle:h};function s(e,t){return parseInt((0,i.sq)(e),10)-parseInt((0,i.sq)(t),10)}function l(e,t){var r=u(e,t);return r*r}function u(e,t){return o*e/t}function h(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();if(o||a){var s=e.getBuilder(r.getZIndex(),"Circle");s.setFillStrokeStyle(o,a),s.drawCircle(t,n)}var l=r.getText();if(l&&l.getText()){var u=(i||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(l),u.drawText(t,n)}}function d(e,t,r,i,o,a,s){var l=!1,u=r.getImage();if(u){var h=u.getImageState();h==n.Z.LOADED||h==n.Z.ERROR?u.unlistenImageChange(o):(h==n.Z.IDLE&&u.load(),u.listenImageChange(o),l=!0)}return c(e,t,r,i,a,s),l}function c(e,t,r,n,i,o){var s=r.getGeometryFunction()(t);if(s){var l=s.simplifyTransformed(n,i),u=r.getRenderer();if(u)p(e,l,r,t);else{var h=a[l.getType()];h(e,l,r,t,o)}}}function p(e,t,r,n){if("GeometryCollection"!=t.getType()){var i=e.getBuilder(r.getZIndex(),"Default");i.drawCustom(t,n,r.getRenderer(),r.getHitDetectionRenderer())}else for(var o=t.getGeometries(),a=0,s=o.length;a<s;++a)p(e,o[a],r,n)}function f(e,t,r,n,i){var o,s,l=t.getGeometriesArray();for(o=0,s=l.length;o<s;++o){var u=a[l[o].getType()];u(e,l[o],r,n,i)}}function g(e,t,r,n,i){var o=r.getStroke();if(o){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(t,n)}var s=r.getText();if(s&&s.getText()){var l=(i||e).getBuilder(r.getZIndex(),"Text");l.setTextStyle(s),l.drawText(t,n)}}function v(e,t,r,n,i){var o=r.getStroke();if(o){var a=e.getBuilder(r.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(t,n)}var s=r.getText();if(s&&s.getText()){var l=(i||e).getBuilder(r.getZIndex(),"Text");l.setTextStyle(s),l.drawText(t,n)}}function y(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();if(a||o){var s=e.getBuilder(r.getZIndex(),"Polygon");s.setFillStrokeStyle(o,a),s.drawMultiPolygon(t,n)}var l=r.getText();if(l&&l.getText()){var u=(i||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(l),u.drawText(t,n)}}function m(e,t,r,i,o){var a,s=r.getImage(),l=r.getText();if(s){if(s.getImageState()!=n.Z.LOADED)return;var u=e;if(o){var h=s.getDeclutterMode();if("none"!==h)if(u=o,"obstacle"===h){var d=e.getBuilder(r.getZIndex(),"Image");d.setImageStyle(s,a),d.drawPoint(t,i)}else l&&l.getText()&&(a={})}var c=u.getBuilder(r.getZIndex(),"Image");c.setImageStyle(s,a),c.drawPoint(t,i)}if(l&&l.getText()){var p=e;o&&(p=o);var f=p.getBuilder(r.getZIndex(),"Text");f.setTextStyle(l,a),f.drawText(t,i)}}function _(e,t,r,i,o){var a,s=r.getImage(),l=r.getText();if(s){if(s.getImageState()!=n.Z.LOADED)return;var u=e;if(o){var h=s.getDeclutterMode();if("none"!==h)if(u=o,"obstacle"===h){var d=e.getBuilder(r.getZIndex(),"Image");d.setImageStyle(s,a),d.drawMultiPoint(t,i)}else l&&l.getText()&&(a={})}var c=u.getBuilder(r.getZIndex(),"Image");c.setImageStyle(s,a),c.drawMultiPoint(t,i)}if(l&&l.getText()){var p=e;o&&(p=o);var f=p.getBuilder(r.getZIndex(),"Text");f.setTextStyle(l,a),f.drawText(t,i)}}function T(e,t,r,n,i){var o=r.getFill(),a=r.getStroke();if(o||a){var s=e.getBuilder(r.getZIndex(),"Polygon");s.setFillStrokeStyle(o,a),s.drawPolygon(t,n)}var l=r.getText();if(l&&l.getText()){var u=(i||e).getBuilder(r.getZIndex(),"Text");u.setTextStyle(l),u.drawText(t,n)}}},35455:(e,t,r)=>{r.d(t,{O$:()=>p,S$:()=>d,ZP:()=>g,il:()=>f});var n=r(71912),i=r(10115),o=r(57380),a=r(98771),s=r(37751),l=r(6101),u=r(28641),h=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d={GENERATE_BUFFERS:"GENERATE_BUFFERS"},c=function(e){function t(t,r){var i=e.call(this,t)||this,o=r||{};return i.inversePixelTransform_=(0,l.Ue)(),i.pixelContext_=null,i.postProcesses_=o.postProcesses,i.uniforms_=o.uniforms,i.helper,t.addChangeListener(n.Z.MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return h(t,e),t.prototype.dispatchPreComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(a.Z.PRECOMPOSE)){var n=new o.Z(a.Z.PRECOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.dispatchPostComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(a.Z.POSTCOMPOSE)){var n=new o.Z(a.Z.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.reset=function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},t.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},t.prototype.prepareFrame=function(e){if(this.getLayer().getRenderSource()){for(var r=!0,n=-1,i=void 0,o=0,a=e.layerStatesArray.length;o<a;o++){var l=e.layerStatesArray[o].layer,u=l.getRenderer();if(u instanceof t){var h=l.getClassName();if((r||h!==i)&&(n+=1,r=!1),i=h,u===this)break}else r=!0}var d="map/"+e.mapId+"/group/"+n;this.helper&&this.helper.canvasCacheKeyMatches(d)||(this.removeHelper(),this.helper=new s.ZP({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:d}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)},t.prototype.afterHelperCreated=function(){},t.prototype.prepareFrameInternal=function(e){return!0},t.prototype.disposeInternal=function(){this.removeHelper(),e.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){(0,l.qC)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);var i=new o.Z(e,this.inversePixelTransform_,r,t);n.dispatchEvent(i)}},t.prototype.preRender=function(e,t){this.dispatchRenderEvent_(a.Z.PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(a.Z.POSTRENDER,e,t)},t.prototype.getDataAtPixel=function(e,t,r){var n=(0,l.nn)([t.pixelRatio,0,0,t.pixelRatio,0,0],e.slice()),i=this.helper.getGL();if(!i)return null;var o=this.getLayer(),a=o.getExtent();if(a){var s=(0,l.nn)(t.pixelToCoordinateTransform,e.slice());if(!(0,u.b8)(a,s))return null}var h=i.getContextAttributes();if(!h||!h.preserveDrawingBuffer)return new Uint8Array;var d,c=Math.round(n[0]),p=Math.round(n[1]),f=this.pixelContext_;if(!f){var g=document.createElement("canvas");g.width=1,g.height=1,f=g.getContext("2d"),this.pixelContext_=f}f.clearRect(0,0,1,1);try{f.drawImage(i.canvas,c,p,1,1,0,0,1,1),d=f.getImageData(0,0,1,1).data}catch(v){return d}return 0===d[3]?null:d},t}(i.Z);function p(e,t){var r=t||[],n=256,i=n-1;return r[0]=Math.floor(e/n/n/n)/i,r[1]=Math.floor(e/n/n)%n/i,r[2]=Math.floor(e/n)%n/i,r[3]=e%n/i,r}function f(e){var t=0,r=256,n=r-1;return t+=Math.round(e[0]*r*r*r*n),t+=Math.round(e[1]*r*r*n),t+=Math.round(e[2]*r*n),t+=Math.round(e[3]*n),t}const g=c},79567:(e,t,r)=>{r.d(t,{Z:()=>_});var n=r(12582),i=r(22796),o=r(37755),a=r(22988),s=r(35455),l=r(60931),u=r(41536),h=r(37751),d=r(6101),c=r(99515),p=r(28641),f=r(21025),g=r(74187),v=r(65818),y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),m=function(e){function t(t,r){var n=this,o=r.uniforms||{},l=(0,d.Ue)();o[h.ZC.PROJECTION_MATRIX]=l,n=e.call(this,t,{uniforms:o,postProcesses:r.postProcesses})||this,n.ready=!1,n.sourceRevision_=-1,n.verticesBuffer_=new a.ZP(u.qO,u.kd),n.hitVerticesBuffer_=new a.ZP(u.qO,u.kd),n.indicesBuffer_=new a.ZP(u.cX,u.kd),n.vertexShader_=r.vertexShader,n.fragmentShader_=r.fragmentShader,n.program_,n.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),n.hitVertexShader_=r.hitVertexShader,n.hitFragmentShader_=r.hitFragmentShader,n.hitProgram_;var c=r.attributes?r.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:h.GC.FLOAT}})):[];n.attributes=[{name:"a_position",size:2,type:h.GC.FLOAT},{name:"a_index",size:1,type:h.GC.FLOAT}].concat(c),n.hitDetectionAttributes=[{name:"a_position",size:2,type:h.GC.FLOAT},{name:"a_index",size:1,type:h.GC.FLOAT},{name:"a_hitColor",size:4,type:h.GC.FLOAT},{name:"a_featureUid",size:1,type:h.GC.FLOAT}].concat(c),n.customAttributes=r.attributes?r.attributes:[],n.previousExtent_=(0,p.lJ)(),n.currentTransform_=l,n.renderTransform_=(0,d.Ue)(),n.invertRenderTransform_=(0,d.Ue)(),n.renderInstructions_=new Float32Array(0),n.hitRenderInstructions_=new Float32Array(0),n.hitRenderTarget_,n.generateBuffersRun_=0,n.worker_=(0,f.U)(),n.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===s.S$.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,(0,d.nb)(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):(this.renderInstructions_=new Float32Array(e.data.renderInstructions),t.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}.bind(n)),n.featureCache_={},n.featureCount_=0;var y=n.getLayer().getSource();return n.sourceListenKeys_=[(0,v.oL)(y,i.Z.ADDFEATURE,n.handleSourceFeatureAdded_,n),(0,v.oL)(y,i.Z.CHANGEFEATURE,n.handleSourceFeatureChanged_,n),(0,v.oL)(y,i.Z.REMOVEFEATURE,n.handleSourceFeatureDelete_,n),(0,v.oL)(y,i.Z.CLEAR,n.handleSourceFeatureClear_,n)],y.forEachFeature(function(e){this.featureCache_[(0,g.sq)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(n)),n}return y(t,e),t.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new l.Z(this.helper))},t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[(0,g.sq)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[(0,g.sq)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[(0,g.sq)(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.helper.getGL();this.preRender(t,e);var r=e.viewState.projection,n=this.getLayer(),i=n.getSource(),o=i.getWrapX()&&r.canWrapX(),a=r.getExtent(),s=e.extent,l=o?(0,p.dz)(a):null,u=o?Math.ceil((s[2]-a[2])/l)+1:1,h=o?Math.floor((s[0]-a[0])/l):0,c=h,f=this.indicesBuffer_.getSize();do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,d.Iu)(this.currentTransform_,c*l,0),(0,d.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e),this.helper.drawElements(0,f)}while(++c<u);this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var g=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e,h,u,l),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),g},t.prototype.prepareFrameInternal=function(e){var t=this.getLayer(),r=t.getSource(),i=e.viewState,a=!e.viewHints[o.Z.ANIMATING]&&!e.viewHints[o.Z.INTERACTING],s=!(0,p.fS)(this.previousExtent_,e.extent),l=this.sourceRevision_<r.getRevision();if(l&&(this.sourceRevision_=r.getRevision()),a&&(s||l)){var u=i.projection,h=i.resolution,d=t instanceof n.Z?t.getRenderBuffer():0,c=(0,p.f3)(e.extent,d*h);r.loadFeatures(c,h,u),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=(0,d.Ue)();this.helper.makeProjectionTransform(e,t);var r,n,i=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===i||(this.renderInstructions_=new Float32Array(i)),this.hitDetectionEnabled_){var o=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===o||(this.hitRenderInstructions_=new Float32Array(o))}var a,l=[],u=[],h=0,c=0;for(var p in this.featureCache_)if(r=this.featureCache_[p],n=r.geometry,n&&"Point"===n.getType()){l[0]=n.getFlatCoordinates()[0],l[1]=n.getFlatCoordinates()[1],(0,d.nn)(t,l),a=(0,s.O$)(c+6,u),this.renderInstructions_[h++]=l[0],this.renderInstructions_[h++]=l[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[c++]=l[0],this.hitRenderInstructions_[c++]=l[1],this.hitRenderInstructions_[c++]=a[0],this.hitRenderInstructions_[c++]=a[1],this.hitRenderInstructions_[c++]=a[2],this.hitRenderInstructions_[c++]=a[3],this.hitRenderInstructions_[c++]=Number(p));for(var f=void 0,g=0;g<this.customAttributes.length;g++)f=this.customAttributes[g].callback(r.feature,r.properties),this.renderInstructions_[h++]=f,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[c++]=f)}var v={type:s.S$.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(v["projectionTransform"]=t,v["generateBuffersRun"]=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(v,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var y={type:s.S$.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};y["projectionTransform"]=t,y["hitDetection"]=!0,this.worker_.postMessage(y,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){if((0,c.h)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var o=(0,d.nn)(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=(0,s.il)(l),h=this.hitRenderInstructions_[u],p=Math.floor(h).toString(),f=this.getLayer().getSource(),g=f.getFeatureByUid(p);return g?n(g,this.getLayer(),null):void 0}},t.prototype.renderHitDetection=function(e,t,r,n){if(this.hitVerticesBuffer_.getSize()){var i=t;this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(e,this.currentTransform_),(0,d.Iu)(this.currentTransform_,i*n,0),(0,d.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.applyUniforms(e);var o=this.indicesBuffer_.getSize();this.helper.drawElements(0,o)}while(++i<r)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){(0,v.bN)(e)})),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(s.ZP);const _=m}}]);
//# sourceMappingURL=8022.8a0498d3.js.map