(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fc4e4b0"],{"0606":function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var r=a("b40f"),s=a.n(r),n=a("3075");class i extends n["b"]{constructor(e){super(e,"ImageViewer","fa-image")}isBinary(){return!0}async fetchData(){let e=new Image;return e.crossOrigin="anonymous",e.src=this.getUrl(),e}}var o=i,c=a("4d00"),l=a("57f6"),h=a("e979");class u extends n["b"]{constructor(e){super(e,"DataViewer")}}var d=u;class p extends c["a"]{constructor(e){super(e,["\t"])}}var m=p;class g{constructor(){}createFilesFromSTAC(e,t=null){let a=Object.values(e.assets).map(t=>this.createFileFromAsset(t,e));return t&&a.forEach(e=>e.setContext(t)),a}createFilesFromBlob(e){if(!(e instanceof Blob))throw new Error("Given data is not a valid Blob");return this.createFilesFromSTAC({stac_version:"1.0.0",type:"Feature",geometry:null,properties:{},links:[],assets:{result:{href:URL.createObjectURL(e),type:e.type}}})}createFileFromAsset(e,t){try{if("string"===typeof e.type){let a=s.a.parse(e.type.toLowerCase());switch(a.type){case"image/png":case"image/jpg":case"image/jpeg":case"image/gif":case"image/webp":return new o(e);case"application/json":case"text/json":case"application/geo+json":return new h["a"](e);case"text/plain":return new d(e);case"text/csv":return new c["a"](e);case"text/tab-separated-values":return new m(e);case"image/tiff":return new l["a"](e,t)}}if("string"===typeof e.href){let a=e.href.split(/[#?]/)[0].split(".").pop().trim().toLowerCase();switch(a){case"png":case"jpg":case"jpeg":case"gif":case"webp":return new o(e);case"json":case"geojson":return new h["a"](e);case"txt":return new d(e);case"csv":return new c["a"](e);case"tsv":return new m(e);case"tif":case"tiff":return new l["a"](e,t)}}}catch(a){console.log(a)}return new n["c"](e)}}},3075:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i}));var r=a("025e");class s{constructor(e){Object.assign(this,e),this.context=null}setContext(e){this.context=e}getContext(){return this.context}getUrl(){return this.href}canGroup(){return!1}isBinary(){return!0}download(e=null){let t=document.createElement("a");t.style.display="none",t.href=this.getUrl(),t.setAttribute("download",e||r["a"].makeFileName("result",this.type)),"undefined"===typeof t.download&&t.setAttribute("target","_blank"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}async loadData(e){this.loaded||(this.data=await this.fetchData(e),this.loaded=!0)}getData(){if(!this.loaded)throw new Error("Data must be loaded before");return this.data}async fetchData(e){let t,a=this.getUrl();if(a.startsWith("blob:")){let e=await fetch(a);t=await e.blob()}else t=await e.download(a,!1);let r=new Promise((e,a)=>{let r=new FileReader;r.onload=t=>e(t.target.result),r.onerror=a,this.isBinary()?r.readAsBinaryString(t):r.readAsText(t)}),s=await r;return await this.parseData(s)}async parseData(e){return e}}class n extends s{constructor(e,t=null,a="fa-database",r={},s={}){super(e),this.loaded=!1,this.component=t,this.props=r,this.props.data||(this.props.data=this),this.icon=a,this.events=s}isBinary(){return!1}}class i extends s{constructor(e){super(e)}}},"4d00":function(e,t,a){"use strict";var r=a("3075");class s extends r["b"]{constructor(e,t=[",",";"]){super(e,"TableViewer","fa-table"),this.delim=t}async parseData(e){if("string"===typeof e){let t=this.parseCSV(e.trim());return t.map(e=>e.map(e=>(e=e.trim(),0===e.length?NaN:isNaN(e)?e:parseFloat(e))))}return e}parseCSV(e){for(var t=[],a=!1,r=0,s=0,n=0;n<e.length;n++){var i=e[n],o=e[n+1];t[r]=t[r]||[],t[r][s]=t[r][s]||"",'"'==i&&a&&'"'==o?(t[r][s]+=i,++n):'"'!=i?!this.delim.includes(i)||a?"\r"!=i||"\n"!=o||a?("\n"!=i||a)&&("\r"!=i||a)?t[r][s]+=i:(++r,s=0):(++r,s=0,++n):++s:a=!a}return t}}t["a"]=s},"57f6":function(e,t,a){"use strict";var r=a("3075"),s=a("025e"),n=a("601e"),i=a("2721"),o=a("aba6"),c=a("256f"),l=a("f5dd"),h=a("fced");const u="STATISTICS_MINIMUM",d="STATISTICS_MAXIMUM",p="DESCRIPTION";class m extends r["b"]{constructor(e,t){super(e,"MapViewer","fa-map",{removableLayers:!0}),this.bands=[],this.nodata=[],this.img=null,this.projection=null,this.extent=null,this.convertToRGB=!1,this.stac=t}isBinary(){return!0}canGroup(){return!0}async loadData(e){return this.loaded||(await this.parseMetadata(),this.loaded=!0),this}getData(){return this}async parseMetadata(){let e=this.stac&&(this.stac.geometry||this.stac.extent);this.projection=await n["a"].addFromStac(this.stac),Array.isArray(this["file:nodata"])&&this["file:nodata"].length>0&&(this.nodata=s["a"].parseNodata(this["file:nodata"])),Array.isArray(this["eo:bands"])&&this["eo:bands"].length>0&&this["eo:bands"].forEach((e,t)=>this.setBandInfo(t,{name:e.name})),Array.isArray(this["raster:bands"])&&this["raster:bands"].length>0&&this["raster:bands"].forEach((e,t)=>{e.name&&this.setBandInfo(t,{name:e.name}),s["a"].isObject(e.statistics)&&this.setBandInfo(t,{min:e.statistics.minimum,max:e.statistics.maximum}),0===this.nodata.length&&"undefined"!==typeof e.nodata&&this.nodata.push(s["a"].parseNodata(e.nodata))});let t,a=await Object(i["a"])(this.getUrl());this.img=await a.getImage();for(let n=0;n<this.img.getSamplesPerPixel();n++){let e={};try{let t=this.img.getArrayForSample(n);Number.isFinite(this.bands[n].min)||(e.min=this.getMinForDataType(t)),Number.isFinite(this.bands[n].max)||(e.max=this.getMaxForDataType(t))}catch(r){}let t=this.img.getGDALMetadata(n);s["a"].isObject(t)&&(u in t&&(e.min=parseFloat(t[u])),d in t&&(e.max=parseFloat(t[d])),p in t&&(e.name=t[p])),this.setBandInfo(n,e);let a=this.img.getGDALNoData();0===this.nodata.length&&null!==a&&this.nodata.push(a)}if(!this.projection&&this.img.geoKeys){let{ProjectedCSTypeGeoKey:e,GeographicTypeGeoKey:a,ProjLinearUnitsGeoKey:r,GeogAngularUnitsGeoKey:s}=this.img.geoKeys;if(e&&(t="EPSG:"+e,this.projection=await n["a"].get(t)),!this.projection&&a&&(t="EPSG:"+a,this.projection=await n["a"].get(t)),!this.projection&&t){const e=r&&Object(h["c"])(r)||s&&Object(h["c"])(s);e&&(this.projection=new l["a"]({code:t,units:e}))}}if(!e)try{let e=this.img.getBoundingBox();this.extent=Object(c["t"])(e,this.projection)}catch(r){console.warn(r)}if(this.img.fileDirectory.ColorMap){const e=Array.from(this.img.fileDirectory.ColorMap),t=e.length/3,a=e.length/3*2;this.colorMap=[];for(let r=0;r<t;r++)this.colorMap.push([Math.trunc(e[r]/65536*256),Math.trunc(e[r+t]/65536*256),Math.trunc(e[r+a]/65536*256),this.nodata.includes(r)?0:1])}switch(this.img.fileDirectory.PhotometricInterpretation){case o["j"].CMYK:case o["j"].YCbCr:case o["j"].CIELab:this.convertToRGB=!0;break;default:this.convertToRGB=!1}}setBandInfo(e,t){this.bands[e]?Object.assign(this.bands[e],t):this.bands.push(Object.assign({id:e+1},t))}getNoData(){return this.nodata}getContext(){return this.stac}getBands(){return this.bands}getProjection(){return this.projection}getExtent(){return this.extent}getColorMap(){return this.colorMap}getMinForDataType(e){return e instanceof Int8Array?-128:e instanceof Int16Array?-32768:e instanceof Int32Array?-2147483648:e instanceof Float32Array?12e-39:0}getMaxForDataType(e){return e instanceof Int8Array?127:e instanceof Uint8Array||e instanceof Uint8ClampedArray?255:e instanceof Int16Array?32767:e instanceof Uint16Array?65535:e instanceof Int32Array?2147483647:e instanceof Uint32Array?4294967295:e instanceof Float32Array?34e37:255}}t["a"]=m},"79f4":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a("a76e"),s=a("025e");class n extends r["BaseProcess"]{constructor(e,t){super(e),this.exporter=t}async execute(e){await this.exporter.generateFunction(e)}}class i extends r["ProcessGraph"]{constructor(e,t,a){super(s["a"].isObject(e)?e:{},t),this.connection=a,this.code=[],this.fnCounter=1,this.allowEmpty(),this.fillUndefinedParameters()}createProcessGraphInstance(e){let t=new i(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(t)}copyProcessGraphInstanceProperties(e){return e=super.copyProcessGraphInstanceProperties(e),e.connection=this.connection,e}createProcessInstance(e){return new n(e,this)}isKeyword(e){return this.getKeywords().includes(e.toLowerCase())}getKeywords(){return[]}comment(){}generateImports(){}generateConnection(){}generateAuthentication(){}generateBuilder(){}generateMetadata(){}generateMissingParameter(){}async generateFunction(){}generateFunctionParams(e){return e.map(e=>"undefined"!==typeof e.default?`${e.name} = ${this.e(e.default)}`:e.name)}async generateCallback(){}generateResult(){}makeNull(){return"null"}makeBoolean(e){return e?"true":"false"}makeArray(e){return`[${e.join(", ")}]`}makeObject(e){let t=s["a"].mapObject(e,(e,t)=>`${this.makeString(t)}: ${e}`);return`{${t.join(", ")}}`}makeString(e){return JSON.stringify(e)}makeNumber(e){return e}e(e){return null===e?this.makeNull():"boolean"===typeof e?this.makeBoolean(e):"number"===typeof e?this.makeNumber(e):"string"===typeof e?this.makeString(e):Array.isArray(e)?this.makeArray(e.map(e=>this.e(e))):s["a"].isObject(e)?this.makeObject(s["a"].mapObjectValues(e,e=>this.e(e))):"function"===typeof e?e():this.makeNull()}generateMetadata(){let e=!1;for(let t in this.process){if("process_graph"===t)continue;let a=this.process[t];Array.isArray(a)&&0===a.length||("string"===typeof a&&0===a.length||("boolean"!==typeof a||a)&&(e||(this.newLine(),this.comment("Set the metadata for the process"),e=!0),this.generateMetadataEntry(t,a)))}}async resolveArguments(e,t,a){let r=Array.isArray(e)?[]:{};for(let n in e){let o=e[n];if(!a||!a(n,o))if(s["a"].isObject(o)){if(o.from_node){r[n]=()=>this.var(o.from_node,this.varPrefix());continue}if(o.from_parameter){r[n]=()=>this.var(o.from_parameter);continue}if(o instanceof i){let e=await t(n);r[n]=()=>e;continue}r[n]=await this.resolveArguments(o,t,a)}else Array.isArray(o)?r[n]=await this.resolveArguments(o,t,a):r[n]=o}return r}async resolveCallback(e,t){let a;if("load_collection"===e.process_id){let r=e.getArgument("properties");a=r[t]}else a=e.getArgument(t);let r=a.getCallbackParameters();await a.execute(r);let s=this.var(`${t}${this.fnCounter++}`,"fn_"),n=await this.generateCallback(a,r,s);return n||s}async generateArguments(e,t=!1,a=null){let r=await this.resolveArguments(e.arguments,async t=>await this.resolveCallback(e,t),a);return t&&(r=this.orderArguments(e,r)),r}orderArguments(e,t){let a=e.getProcessGraph().getProcess(e);if(a&&Array.isArray(a.parameters)){let e=a.parameters.map(e=>"undefined"!==typeof t[e.name]?t[e.name]:e.optional?void 0:null),r=!1;for(let t=e.length-1;t>=0;t--)"undefined"===typeof e[t]?r?e[t]=null:e.pop():r=!0;return e}}varPrefix(){return this.getParent()?"data":"datacube"}var(e,t="var"){return e=String(e),this.isKeyword(e)?e+"_":e.match(/^[a-z_]\w*$/)?e:t+e.replace(/[^\w]+/g,"_")}getTab(){return"\t"}addCode(e,t="",a=0){if("string"!==typeof e)return;let r=this.getTab().repeat(a),s=e.trim().split(/\r\n|\r|\n/g);for(let n of s)this.code.push(`${r}${t}${n}\n`)}newLine(e=1){for(let t=0;t<e;t++)this.addCode("")}getServerUrl(){return this.connection.getUrl()}async toCode(e=!1){this.code=[],e||(this.comment("Import required packages"),this.generateImports(),this.newLine(),this.comment("Connect to the back-end"),this.generateConnection(),this.generateAuthentication(),this.newLine(),this.generateBuilder(),this.generateMetadata(),this.newLine());let t=this.getProcessParameters();if(t.length>0){this.comment("ToDo: Here you need to set values for the parameters");for(let e of t)this.generateMissingParameter(e);this.newLine()}return await this.execute(),e||(this.newLine(),this.comment("The process can be executed synchronously (see below), as batch job or as web service now")),this.generateResult(this.getResultNode(),e),this.code.join("").trim()}async execute(){return await this.validate(),this.reset(),await this.executeNodes(this.getStartNodes()),this.getResultNode()}isMath(){return"undefined"===typeof this._isMath&&(this._isMath=this.processRegistry.isMath(this)),this._isMath}}},db05:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a("025e"),s=a("79f4"),n=a("2b70");const i=["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield","builder","connection","formula","openeo","result"];class o extends s["a"]{constructor(e,t,a,r=!1){super(e,t,a),this.generateFormula=r}createProcessGraphInstance(e){let t=new o(e,this.processRegistry,this.getJsonSchemaValidator(),this.generateFormula);return this.copyProcessGraphInstanceProperties(t)}parse(){this.parsed||super.parse()}getKeywords(){return i}comment(e){this.addCode(e,"// ")}generateImports(){this.addCode("import { OpenEO, Formula } from '@openeo/js-client';")}generateConnection(){this.addCode(`let connection = await OpenEO.connect('${this.getServerUrl()}');`)}generateAuthentication(){this.comment("ToDo: Here you need to add your authentication steps")}generateBuilder(){this.addCode("let builder = await connection.buildProcess();")}generateMetadataEntry(e,t){this.addCode(`builder.${e} = ${this.e(t)};`)}async generateFunction(e){let t=e.getParent()?"this":"builder",a=this.var(e.id,this.varPrefix()),s=await this.generateArguments(e,!e.namespace);if(this.comment(e.description),r["a"].isObject(s)){let r=e.namespace?`${e.process_id}@${e.namespace}`:e.process_id;this.addCode(`let ${a} = ${t}.process("${r}", ${this.e(s)});`)}else this.addCode(`let ${a} = ${t}.${e.process_id}(${s.map(e=>this.e(e)).join(", ")});`)}generateMissingParameter(e){this.comment(e.description);let t=this.var(e.name,"param"),a="undefined"!==typeof e.default?e.default:null;this.addCode(`let ${t} = ${this.e(a)};`)}async generateCallback(e,t,a){if(this.generateFormula&&e&&e.isMath()){let t=e.toFormulaString(),a=JSON.stringify(t);return`new Formula(${a})`}{let r=this.generateFunctionParams(t);this.newLine(),this.addCode(`let ${a} = function(${r.join(", ")}) {`),this.addCode(await e.toCode(!0),"",1),this.addCode("}")}}generateResult(e,t){if(!e)return;let a=this.var(e.id,this.varPrefix());t?this.addCode(`return ${a};`):this.addCode(`let result = await connection.computeResult(${a});`)}toFormulaString(){return this.isMath()?this.nodeToFormula(this.getResultNode()):""}getArrayElementPlaceholder(e){if("array_element"===e.process_id&&"parameter"===e.getArgumentType("data")){let t=e.getRawArgument("data").from_parameter,a=this.getCallbackParameters().findIndex(e=>e.name===t);if(a>=0)return"$".repeat(a+1)+(e.getArgument("label")||e.getArgument("index"))}return null}nodeToFormula(e,t=null){if("array_element"===e.process_id){let t=this.getArrayElementPlaceholder(e);if(t)return t}let a=n["Formula"].reverseOperatorMapping[e.process_id],s=this.processRegistry.get(e.process_id),i="undefined"!==typeof n["Formula"].arrayOperatorMapping[e.process_id],o=t=>{if(r["a"].isObject(t))if(t.from_node){let r=e.getProcessGraph().getNode(t.from_node);t=r?this.nodeToFormula(r,a):"#"+t.from_node}else{if(!t.from_parameter)throw new Error("Objects not allowed");t=t.from_parameter}return t},c=[],l=Array.isArray(s.parameters)?s.parameters:[];for(let r of l){let t=o(e.getRawArgument(r.name));if(i&&Array.isArray(t)&&"data"===r.name){c=t.map(e=>o(e));break}if("undefined"!==typeof t)c.push(t);else{if("undefined"===typeof r.default)throw new Error('Argument for parameter "'+r.name+'" missing');c.push(r.default)}}if(i&&(c=c.filter(e=>null!==e)),a){let e=["/","*"],r=["-","+"],s=c.map(e=>e<0?"("+e+")":e).join(a);return!t||r.includes(t)&&r.includes(a)||"^"===a||r.includes(t)&&e.includes(a)?s:"("+s+")"}return e.process_id+"("+c.join(", ")+")"}}},e979:function(e,t,a){"use strict";a("af87");var r=a("025e"),s=a("3075");class n extends s["b"]{constructor(e,t="DataViewer"){super(e,t),this.isGeoJson=!1}async parseData(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(t){console.log(t)}return r["a"].detectGeoJson(e)?(this.isGeoJson=!0,this.component="MapViewer",this.icon="fa-map"):this.isTable(e)&&(this.component="TableViewer",this.icon="fa-table"),e}isTable(e){if(!e||"object"!==typeof e||0===r["a"].size(e))return!1;let t=Object.values(e),a=Object.keys(t[0]);return!t.some(e=>!e||"object"!==typeof e||!r["a"].equals(Object.keys(e),a))}}t["a"]=n}}]);
//# sourceMappingURL=chunk-5fc4e4b0.7453c3d3.js.map