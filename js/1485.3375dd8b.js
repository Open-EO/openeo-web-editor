(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[1485],{66684:function(e,t,i){
/*!
 * @kirtandesai/ol-geocoder - v5.0.3
 * A geocoder extension compatible with OpenLayers v7.
 * https://github.com/kirtan-desai/ol-geocoder
 * Built: Thu Nov 17 2022 14:58:35 GMT-0500 (Eastern Standard Time)
 */
!function(t,s){e.exports=s(i(10972),i(29276),i(49700),i(82986),i(54602),i(44294),i(86717),i(89718))}(0,(function(e,t,i,s,r,n,o,a){"use strict";function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=l(e),h=l(t),u=l(i),d=l(s),p=l(r),g=l(n),m=l(o),f=l(a),y="gcd-container",v="gcd-button-control",_="gcd-input-query",S="gcd-input-reset",w={namespace:"ol-geocoder",spin:"gcd-pseudo-rotate",hidden:"gcd-hidden",address:"gcd-address",country:"gcd-country",city:"gcd-city",road:"gcd-road",olControl:"ol-control",glass:{container:"gcd-gl-container",control:"gcd-gl-control",button:"gcd-gl-btn",input:"gcd-gl-input",expanded:"gcd-gl-expanded",reset:"gcd-gl-reset",result:"gcd-gl-result"},inputText:{container:"gcd-txt-container",control:"gcd-txt-control",input:"gcd-txt-input",reset:"gcd-txt-reset",icon:"gcd-txt-glass",result:"gcd-txt-result"}},T={containerId:y,buttonControlId:v,inputQueryId:_,inputResetId:S,cssClasses:w};const b=Object.freeze({__proto__:null,containerId:y,buttonControlId:v,inputQueryId:_,inputResetId:S,cssClasses:w,default:T}),x="addresschosen",D="nominatim",C="reverse",A="glass-button",E="text-input",M="osm",L="mapquest",F="photon",R="bing",P="opencage",I={provider:M,placeholder:"Search for an address",featureStyle:null,targetType:A,lang:"en-US",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,autoCompleteTimeout:200,debug:!1};function N(e,t="Assertion failed"){if(!e){if("undefined"!=typeof Error)throw new Error(t);throw t}}function $(e){const t=function(){if("performance"in window==0&&(window.performance={}),"now"in window.performance==0){let e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=()=>Date.now()-e}return window.performance.now()}().toString(36);return e?e+t:t}function j(e){return/^\d+$/u.test(e)}function k(e,t,i){if(Array.isArray(e))return void e.forEach((e=>k(e,t)));const s=Array.isArray(t)?t:t.split(/\s+/u);let r=s.length;for(;r--;)O(e,s[r])||U(e,s[r],i)}function G(e,t,i){if(Array.isArray(e))return void e.forEach((e=>G(e,t,i)));const s=Array.isArray(t)?t:t.split(/\s+/u);let r=s.length;for(;r--;)O(e,s[r])&&q(e,s[r],i)}function O(e,t){return e.classList?e.classList.contains(t):B(t).test(e.className)}function z(e,t){return e.replace(/\{\s*([\w-]+)\s*\}/gu,((e,i)=>{const s=void 0===t[i]?"":t[i];return String(s).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}))}function V(e,t){let i;if(Array.isArray(e)){if(i=document.createElement(e[0]),e[1].id&&(i.id=e[1].id),e[1].classname&&(i.className=e[1].classname),e[1].attr){const{attr:t}=e[1];if(Array.isArray(t)){let e=-1;for(;++e<t.length;)i.setAttribute(t[e].name,t[e].value)}else i.setAttribute(t.name,t.value)}}else i=document.createElement(e);i.innerHTML=t;const s=document.createDocumentFragment();for(;i.childNodes[0];)s.append(i.childNodes[0]);return i.append(s),i}function B(e){return new RegExp(`(^|\\s+) ${e} (\\s+|$)`,"u")}function U(e,t,i){e.classList?e.classList.add(t):e.className=`${e.className} ${t}`.trim(),i&&j(i)&&window.setTimeout((()=>q(e,t)),i)}function q(e,t,i){e.classList?e.classList.remove(t):e.className=e.className.replace(B(t)," ").trim(),i&&j(i)&&window.setTimeout((()=>U(e,t)),i)}const W=b.cssClasses;class X{constructor(e){this.options=e,this.els=this.createControl()}createControl(){let e,t,i;return this.options.targetType===E?(t=`${W.namespace} ${W.inputText.container}`,e=V(["div",{id:b.containerId,classname:t}],X.input),i={container:e,control:e.querySelector(`.${W.inputText.control}`),input:e.querySelector(`.${W.inputText.input}`),reset:e.querySelector(`.${W.inputText.reset}`),result:e.querySelector(`.${W.inputText.result}`)}):(t=`${W.namespace} ${W.glass.container}`,e=V(["div",{id:b.containerId,classname:t}],X.glass),i={container:e,control:e.querySelector(`.${W.glass.control}`),button:e.querySelector(`.${W.glass.button}`),input:e.querySelector(`.${W.glass.input}`),reset:e.querySelector(`.${W.glass.reset}`),result:e.querySelector(`.${W.glass.result}`)}),i.input.placeholder=this.options.placeholder,i}}X.glass=`\n  <div class="${W.glass.control} ${W.olControl}">\n    <button type="button" id="${b.buttonControlId}" class="${W.glass.button}"></button>\n    <input type="text" id="${b.inputQueryId}" class="${W.glass.input}" autocomplete="off" placeholder="Search ...">\n    <a id="${b.inputResetId}" class="${W.glass.reset} ${W.hidden}"></a>\n  </div>\n  <ul class="${W.glass.result}"></ul>\n`,X.input=`\n  <div class="${W.inputText.control}">\n    <input type="text" id="${b.inputQueryId}" class="${W.inputText.input}" autocomplete="off" placeholder="Search ...">\n    <span class="${W.inputText.icon}"></span>\n    <button type="button" id="${b.inputResetId}" class="${W.inputText.reset} ${W.hidden}"></button>\n  </div>\n  <ul class="${W.inputText.result}"></ul>\n`;class H{constructor(){this.settings={url:"https://photon.komoot.io/api/",params:{q:"",limit:10,lang:"en"},langs:["de","it","fr","en"]}}getParameters(e){return e.lang=e.lang.toLowerCase(),{url:this.settings.url,params:{q:e.query,limit:e.limit||this.settings.params.limit,lang:this.settings.langs.includes(e.lang)?e.lang:this.settings.params.lang}}}handleResponse(e){return 0===e.features.length?[]:e.features.map((e=>({lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],address:{name:e.properties.name,postcode:e.properties.postcode,city:e.properties.city,state:e.properties.state,country:e.properties.country},original:{formatted:e.properties.name,details:e.properties}})))}}class K{constructor(){this.settings={url:"https://nominatim.openstreetmap.org/search/",params:{q:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}}handleResponse(e){return 0===e.length?[]:e.map((e=>({lon:e.lon,lat:e.lat,bbox:e.boundingbox,address:{name:e.display_name,road:e.address.road||"",houseNumber:e.address.house_number||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}})))}}class Y{constructor(){this.settings={url:"https://open.mapquestapi.com/nominatim/v1/search.php",params:{q:"",key:"",format:"json",addressdetails:1,limit:10,countrycodes:"","accept-language":"en-US"}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,key:e.key,format:"json",addressdetails:1,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,"accept-language":e.lang||this.settings.params["accept-language"]}}}handleResponse(e){return 0===e.length?[]:e.map((e=>({lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||"",road:e.address.road||"",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}})))}}class Z{constructor(){this.settings={url:"https://dev.virtualearth.net/REST/v1/Locations",callbackName:"jsonp",params:{query:"",key:"",includeNeighborhood:0,maxResults:10}}}getParameters(e){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:e.query,key:e.key,includeNeighborhood:e.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:e.maxResults||this.settings.params.maxResults}}}handleResponse(e){const{resources:t}=e.resourceSets[0];return 0===t.length?[]:t.map((e=>({lon:e.point.coordinates[1],lat:e.point.coordinates[0],address:{name:e.name},original:{formatted:e.address.formattedAddress,details:e.address}})))}}class Q{constructor(){this.settings={url:"https://api.opencagedata.com/geocode/v1/json?",params:{q:"",key:"",limit:10,countrycode:"",pretty:1,no_annotations:1}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,key:e.key,limit:e.limit||this.settings.params.limit,countrycode:e.countrycodes||this.settings.params.countrycodes}}}handleResponse(e){return 0===e.results.length?[]:e.results.map((e=>({lon:e.geometry.lng,lat:e.geometry.lat,address:{name:e.components.house_number||"",road:e.components.road||"",postcode:e.components.postcode,city:e.components.city||e.components.town,state:e.components.state,country:e.components.country},original:{formatted:e.formatted,details:e.components}})))}}function J(e){return new Promise(((t,i)=>{const s=function(e,t){return t&&"object"==typeof t&&(e+=(/\?/u.test(e)?"&":"?")+ee(t)),e}(e.url,e.data),r={method:"GET",mode:"cors",credentials:"same-origin"};e.jsonp?function(e,t,i){const{head:s}=document,r=document.createElement("script"),n=`f${Math.round(Math.random()*Date.now())}`;r.setAttribute("src",`${e+(e.indexOf("?")>0?"&":"?")+t}=${n}`),window[n]=e=>{window[n]=void 0,setTimeout((()=>s.removeChild(r)),0),i(e)},s.append(r)}(s,e.callbackName,t):fetch(s,r).then((e=>e.json())).then(t).catch(i)}))}function ee(e){return Object.keys(e).reduce(((t,i)=>(t.push("object"==typeof e[i]?ee(e[i]):`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`),t)),[]).join("&")}const te=b.cssClasses;class ie{constructor(e,t){this.Base=e,this.layerName=$("geocoder-layer-"),this.layer=new d.default({name:this.layerName,source:new p.default}),this.options=e.options,this.options.provider="string"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=t,this.lastQuery="",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()}setListeners(){let e,t;const i=e=>{e.stopPropagation(),O(this.els.control,te.glass.expanded)?this.collapse():this.expand()};this.els.input.addEventListener("keypress",(e=>{const t=e.target.value.trim();(e.key?"Enter"===e.key:e.which?13===e.which:e.keyCode&&13===e.keyCode)&&(e.preventDefault(),this.query(t))}),!1),this.els.input.addEventListener("click",(e=>e.stopPropagation()),!1),this.els.input.addEventListener("input",(i=>{const s=i.target.value.trim();0!==s.length?G(this.els.reset,te.hidden):k(this.els.reset,te.hidden),this.options.autoComplete&&s!==t&&(t=s,e&&clearTimeout(e),e=setTimeout((()=>{s.length>=this.options.autoCompleteMinLength&&this.query(s)}),this.options.autoCompleteTimeout))}),!1),this.els.reset.addEventListener("click",(e=>{this.els.input.focus(),this.els.input.value="",this.lastQuery="",k(this.els.reset,te.hidden),this.clearResults()}),!1),this.options.targetType===A&&this.els.button.addEventListener("click",i,!1)}query(e){this.provider||(this.provider=this.newProvider());const t=this.provider.getParameters({query:e,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery===e&&this.els.result.firstChild)return;this.lastQuery=e,this.clearResults(),k(this.els.reset,te.spin);const i={url:t.url,data:t.params};t.callbackName&&(i.jsonp=!0,i.callbackName=t.callbackName),J(i).then((e=>{this.options.debug&&console.info(e),G(this.els.reset,te.spin);const t=this.provider.handleResponse(e);t&&(this.createList(t),this.listenMapClick())})).catch((e=>{G(this.els.reset,te.spin);const t=V("li","<h5>Error! No internet connection?</h5>");this.els.result.append(t)}))}createList(e){const t=this.els.result;e.forEach((e=>{let i;i=this.options.provider===M?`<span class="${te.road}">${e.address.name}</span>`:this.addressTemplate(e.address);const s=V("li",`<a href="#">${i}</a>`);s.addEventListener("click",(t=>{t.preventDefault(),this.chosen(e,i,e.address,e.original)}),!1),t.append(s)}))}chosen(e,t,i,s){const r=this.Base.getMap(),n=[Number.parseFloat(e.lon),Number.parseFloat(e.lat)],o=r.getView().getProjection(),a=f.default.transform(n,"EPSG:4326",o);let{bbox:l}=e;l&&(l=f.default.transformExtent([l[2],l[1],l[3],l[0]],"EPSG:4326",o));const c={formatted:t,details:i,original:s};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:x,address:c,coordinate:a,bbox:l,place:e});else{l?r.getView().fit(l,{duration:500}):function(e,t,i=500,s=2.388657133911758){e.getView().animate({duration:i,resolution:s},{duration:i,center:t})}(r,a);const t=this.createFeature(a,c);this.Base.dispatchEvent({type:x,address:c,feature:t,coordinate:a,bbox:l,place:e})}}createFeature(e){const t=new m.default(new g.default(e));return this.addLayer(),t.setStyle(this.options.featureStyle),t.setId($("geocoder-ft-")),this.getSource().addFeature(t),t}addressTemplate(e){const t=[];return e.name&&t.push(['<span class="',te.road,'">{name}</span>'].join("")),(e.road||e.building||e.house_number)&&t.push(['<span class="',te.road,'">{building} {road} {house_number}</span>'].join("")),(e.city||e.town||e.village)&&t.push(['<span class="',te.city,'">{postcode} {city} {town} {village}</span>'].join("")),(e.state||e.country)&&t.push(['<span class="',te.country,'">{state} {country}</span>'].join("")),z(t.join("<br>"),e)}newProvider(){switch(this.options.provider){case M:return new K;case L:return new Y;case F:return new H;case R:return new Z;case P:return new Q;default:return this.options.provider}}expand(){G(this.els.input,te.spin),k(this.els.control,te.glass.expanded),window.setTimeout((()=>this.els.input.focus()),100),this.listenMapClick()}collapse(){this.els.input.value="",this.els.input.blur(),k(this.els.reset,te.hidden),G(this.els.control,te.glass.expanded),this.clearResults()}listenMapClick(){if(this.registeredListeners.mapClick)return;const e=this,t=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,t.addEventListener("click",{handleEvent(i){e.clearResults(!0),t.removeEventListener(i.type,this,!1),e.registeredListeners.mapClick=!1}},!1)}clearResults(e){e&&this.options.targetType===A?this.collapse():function(e){for(;e.firstChild;)e.firstChild.remove()}(this.els.result)}getSource(){return this.layer.getSource()}addLayer(){let e=!1;const t=this.Base.getMap();t.getLayers().forEach((t=>{t===this.layer&&(e=!0)})),e||t.addLayer(this.layer)}}class se extends c.default{constructor(e=D,t={}){let i,s;N("string"==typeof e,"@param `type` should be string!"),N(e===D||e===C,`@param 'type' should be '${D}'\n      or '${C}'!`),N("object"==typeof t,"@param `options` should be object!"),I.featureStyle=[new h.default({image:new u.default({scale:.7,src:"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png"})})];const r=new X(t);if(e===D&&(i=r.els.container),super({element:i}),!(this instanceof se))return new se;this.options=function(e,t){const i={};return Object.keys(e).forEach((t=>{Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])})),Object.keys(t).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e])})),i}(I,t),this.container=i,e===D&&(s=new ie(this,r.els),this.layer=s.layer)}getLayer(){return this.layer}getSource(){return this.getLayer().getSource()}setProvider(e){this.options.provider=e}setProviderKey(e){this.options.key=e}}return se}))},31660:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});i(81454);var s=i(66684),r=i.n(s);i(98992),i(54520);class n{constructor(e,t=!1){this.url=e,this.geojson=t}getParameters(e){return{url:this.url,params:{q:e.query,format:"json",limit:10,"accept-language":"en",polygon_geojson:this.geojson?1:0,polygon_threshold:.001}}}handleResponse(e){return 0===e.length?[]:e.filter((e=>["boundary","geological","leisure","natural","place","water","waterway"].includes(e.class))).map((e=>({lon:e.lon,lat:e.lat,bbox:e.boundingbox,address:{name:e.display_name},original:{formatted:e.display_name,details:e.address,geojson:e.geojson}})))}}const o={methods:{addGeocoder(e,t=!1){if(!this.$config.geocoder)return;const i={provider:new n(this.$config.geocoder,t),placeholder:"Search for ...",keepOpen:!0,preventDefault:!0},s=new(r())("nominatim",i);s.on("addresschosen",(i=>{if(t)e(i.place?.original?.geojson,i);else if(i.place.bbox){let t=i.place.bbox.map((e=>parseFloat(e))),s={west:t[2],east:t[3],north:t[1],south:t[0]};e(s,i)}else e(null,i)})),this.map.addControl(s)}}},a=o;var l,c,h=i(81656),u=(0,h.A)(a,l,c,!1,null,null,null);const d=u.exports},55193:(e,t,i)=>{"use strict";i.d(t,{A:()=>h});var s=function(){var e=this,t=e._self._c;return e.texts.length>0?t("div",{staticClass:"ol-unselectable ol-control value",class:{pointer:e.texts.length>1},on:{click:e.toggle}},[e._v(e._s(e.current))]):e._e()},r=[],n=i(23634);const o={name:"TextControl",mixins:[n.A],data(){return{i:0}},computed:{texts(){return Array.isArray(this.text)?this.text:"string"===typeof this.text&&this.text.length>0?[this.text]:[]},current(){return 0===this.texts.length?"":this.texts[this.i%this.text.length]}},props:{text:{text:[String,Array],default:""}},methods:{toggle(){this.i++}}},a=o;var l=i(81656),c=(0,l.A)(a,s,r,!1,null,"52fec35a",null);const h=c.exports},91235:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>ji});i(81454);var s=function(){var e=this,t=e._self._c;return t("Splitpanes",{staticClass:"default-theme",attrs:{horizontal:""}},[t("Pane",{attrs:{id:"map"}},[t("div",{staticClass:"map-viewer",attrs:{id:e.id}},[t("ProgressControl",{ref:"progress",attrs:{map:e.map}}),t("UserLocationControl",{attrs:{map:e.map}}),t("AddDataControl",{attrs:{map:e.map},on:{add:e.addData}}),e.isGeoTiff?[t("TextControl",{attrs:{text:e.textControlText}}),t("div",{staticClass:"ol-unselectable ol-control geotiff-channels"},[e._l(e.geotiffs,(function(i){return[i.colorMap?e._e():t("ChannelControl",{key:i.layer.id,attrs:{bands:i.bands,defaultChannels:i.defaultChannels,title:e.geotiffs.length>1?i.layer.get("title"):""},on:{update:(t,s)=>e.updateGeoTiffStyle(i,t,s)}})]}))],2)]:e._e(),e.loading?t("div",{staticClass:"map-loading"},[t("i",{staticClass:"fas fa-spinner fa-spin"}),t("span",[e._v("Loading map...")])]):e._e()],2)]),e.chart?t("Pane",{attrs:{id:"chart",size:33}},[t("span",{staticClass:"close",on:{click:e.closeChart}},[t("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})]),t("ScatterChart",e._b({attrs:{height:220}},"ScatterChart",e.chart,!1))],1):e._e()],1)},r=[],n=(i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(98992),i(64743),i(23215),i(54520),i(2566)),o=i(76130),a=i(75024),l=i(44304),c=i(38363),h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ol-add-data ol-unselectable ol-control",staticStyle:{"pointer-events":"auto"}},[t("button",{attrs:{type:"button",title:"Add external data source"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.openModal.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-image"})])])},u=[],d=i(23634),p=i(61663);const g={name:"AddDataControl",mixins:[d.A,p.A],methods:{openModal(){let e={save:this.addLayer};this.broadcast("showModal","AddMapDataModal",{},e)},addLayer(e){this.$emit("add",e)}}},m=g;var f=i(81656),y=(0,f.A)(m,h,u,!1,null,"046026ef",null);const v=y.exports;var _=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.channels.length>0,expression:"channels.length > 0"}],staticClass:"channels"},[t("table",[t("thead",[e.title?t("tr",[t("th",{attrs:{colspan:e.cols}},[e._v(e._s(e.title))])]):e._e(),t("tr",[e.isGray?e._e():t("th",[e._v("Channel")]),e.multiBand?t("th",[e._v("Band")]):e._e(),t("th",[e._v("Min")]),t("th",[e._v("Max")])])]),t("tbody",e._l(e.channels,(function(i,s){return t("tr",{key:s},[e.isGray?e._e():t("th",[e._v(e._s(e.labels[s]))]),e.multiBand?t("td",[t("select",{directives:[{name:"model",rawName:"v-model.number",value:i.id,expression:"channel.id",modifiers:{number:!0}}],on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(t){var i="_value"in t?t._value:t.value;return e._n(i)}));e.$set(i,"id",t.target.multiple?s:s[0])}}},e._l(e.bands,(function(i){return t("option",{key:i.id,domProps:{value:i.id}},[e._v(e._s(i.name||i.id))])})),0)]):e._e(),t("td",[t("input",{directives:[{name:"model",rawName:"v-model.number",value:i.min,expression:"channel.min",modifiers:{number:!0}}],attrs:{type:"number",required:""},domProps:{value:i.min},on:{input:function(t){t.target.composing||e.$set(i,"min",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})]),t("td",[t("input",{directives:[{name:"model",rawName:"v-model.number",value:i.max,expression:"channel.max",modifiers:{number:!0}}],attrs:{type:"number",required:""},domProps:{value:i.max},on:{input:function(t){t.target.composing||e.$set(i,"max",e._n(t.target.value))},blur:function(t){return e.$forceUpdate()}}})])])})),0),e.multiBand?t("tfoot",[t("tr",[t("td",{attrs:{colspan:e.cols}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isGray,expression:"isGray"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isGray)?e._i(e.isGray,null)>-1:e.isGray},on:{change:function(t){var i=e.isGray,s=t.target,r=!!s.checked;if(Array.isArray(i)){var n=null,o=e._i(i,n);s.checked?o<0&&(e.isGray=i.concat([n])):o>-1&&(e.isGray=i.slice(0,o).concat(i.slice(o+1)))}else e.isGray=r}}}),e._v(" Grayscale ")])])]):e._e()])])},S=[];const w={name:"ChannelControl",mixins:[d.A],props:{title:{type:String,default:""},bands:{type:Array,default:()=>[]},defaultChannels:{type:Array,default:()=>[]}},computed:{multiBand(){return this.bands.length>1},cols(){return this.isGray?this.multiBand?3:2:4},labels(){return this.isGray?["Grayscale"]:["Red","Green","Blue"]}},data(){return{channels:this.defaultChannels,isGray:1===this.defaultChannels.length||1===this.bands.length}},mounted(){},watch:{bands:{immediate:!0,handler(){1===this.bands.length&&(this.isGray=!0),this.updateChannels()}},isGray(){this.updateChannels(),this.emit()},channels:{deep:!0,handler(){this.emit()}}},methods:{isValid(e){return"number"===typeof e},updateChannels(){this.defaultChannels.length>0?(this.channels=this.defaultChannels,1===this.defaultChannels.length&&(this.isGray=!0)):this.channels=this.bands.slice(0,this.isGray?1:3).map((e=>Object.assign({},e))),2===this.channels.length&&this.channels.push(Object.assign({},this.channels[1]))},emit(){this.channels.filter((e=>this.isValid(e.min)&&this.isValid(e.max))).length>0&&this.$emit("update","channels",this.channels)}}},T=w;var b=(0,f.A)(T,_,S,!1,null,"5223a7ca",null);const x=b.exports;var D=i(66451),C=i(31660),A=i(95104),E=i(55193),M=(i(72577),i(3949),i(50071)),L=i(35598),F=i(30945),R=i(10702),P=i(4087);function I(e,t){return X().createElementNS(e,t)}function N(e,t){return $(e,t,[]).join("")}function $(e,t,i){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)t?i.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(e.nodeValue);else{let s;for(s=e.firstChild;s;s=s.nextSibling)$(s,t,i)}return i}function j(e){return"documentElement"in e}function k(e){return(new DOMParser).parseFromString(e,"application/xml")}function G(e,t){return function(i,s){const r=e.call(void 0!==t?t:this,i,s);if(void 0!==r){const e=s[s.length-1];e.push(r)}}}function O(e,t,i){return function(s,r){const n=e.call(void 0!==i?i:this,s,r);if(void 0!==n){const e=r[r.length-1],i=void 0!==t?t:s.localName;let o;i in e?o=e[i]:(o=[],e[i]=o),o.push(n)}}}function z(e,t,i){return function(s,r){const n=e.call(void 0!==i?i:this,s,r);if(void 0!==n){const e=r[r.length-1],i=void 0!==t?t:s.localName;e[i]=n}}}function V(e,t){return function(i,s,r){const n=s[s.length-1],o=n.node;let a=e;void 0===a&&(a=r);const l=void 0!==t?t:o.namespaceURI;return I(l,a)}}V();function B(e,t,i){let s,r;for(i=void 0!==i?i:{},s=0,r=e.length;s<r;++s)i[e[s]]=t;return i}function U(e,t,i,s){let r;for(r=t.firstElementChild;r;r=r.nextElementSibling){const t=e[r.namespaceURI];if(void 0!==t){const e=t[r.localName];void 0!==e&&e.call(s,r,i)}}}function q(e,t,i,s,r){return s.push(e),U(t,i,s,r),s.pop()}let W;function X(){return void 0===W&&"undefined"!==typeof document&&(W=document.implementation.createDocument("","",null)),W}class H{read(e){if(!e)return null;if("string"===typeof e){const t=k(e);return this.readFromDocument(t)}return j(e)?this.readFromDocument(e):this.readFromNode(e)}readFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFromNode(t);return null}readFromNode(e){(0,P.b0)()}}const K=H,Y="http://www.w3.org/1999/xlink";function Z(e){return e.getAttributeNS(Y,"href")}function Q(e){const t=N(e,!1);return J(t)}function J(e){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);if(t)return parseFloat(t[1])}function ee(e){const t=N(e,!1);return te(t)}function te(e){const t=/^\s*(\d+)\s*$/.exec(e);if(t)return parseInt(t[1],10)}function ie(e){return N(e,!1).trim()}const se=[null,"http://www.opengis.net/ows/1.1"],re=B(se,{ServiceIdentification:z(Me),ServiceProvider:z(Fe),OperationsMetadata:z(Ae)});class ne extends K{constructor(){super()}readFromNode(e){const t=q({},re,e,[]);return t||null}}const oe=B(se,{DeliveryPoint:z(ie),City:z(ie),AdministrativeArea:z(ie),PostalCode:z(ie),Country:z(ie),ElectronicMailAddress:z(ie)}),ae=B(se,{Value:O(Re)}),le=B(se,{AllowedValues:z(Se)}),ce=B(se,{Phone:z(Ee),Address:z(_e)}),he=B(se,{HTTP:z(De)}),ue=B(se,{Get:O(xe),Post:void 0}),de=B(se,{DCP:z(be)}),pe=B(se,{Operation:Ce}),ge=B(se,{Voice:z(ie),Facsimile:z(ie)}),me=B(se,{Constraint:O(we)}),fe=B(se,{IndividualName:z(ie),PositionName:z(ie),ContactInfo:z(Te)}),ye=B(se,{Abstract:z(ie),AccessConstraints:z(ie),Fees:z(ie),Title:z(ie),ServiceTypeVersion:z(ie),ServiceType:z(ie)}),ve=B(se,{ProviderName:z(ie),ProviderSite:z(Z),ServiceContact:z(Le)});function _e(e,t){return q({},oe,e,t)}function Se(e,t){return q({},ae,e,t)}function we(e,t){const i=e.getAttribute("name");if(i)return q({name:i},le,e,t)}function Te(e,t){return q({},ce,e,t)}function be(e,t){return q({},he,e,t)}function xe(e,t){const i=Z(e);if(i)return q({href:i},me,e,t)}function De(e,t){return q({},ue,e,t)}function Ce(e,t){const i=e.getAttribute("name"),s=q({},de,e,t);if(!s)return;const r=t[t.length-1];r[i]=s}function Ae(e,t){return q({},pe,e,t)}function Ee(e,t){return q({},ge,e,t)}function Me(e,t){return q({},ye,e,t)}function Le(e,t){return q({},fe,e,t)}function Fe(e,t){return q({},ve,e,t)}function Re(e,t){return ie(e)}const Pe=ne;var Ie=i(70915);const Ne=[null,"http://www.opengis.net/wmts/1.0"],$e=[null,"http://www.opengis.net/ows/1.1"],je=B(Ne,{Contents:z(Ke)});class ke extends K{constructor(){super(),this.owsParser_=new Pe}readFromNode(e){let t=e.getAttribute("version");t&&(t=t.trim());let i=this.owsParser_.readFromNode(e);return i?(i["version"]=t,i=q(i,je,e,[]),i||null):null}}const Ge=B(Ne,{Layer:O(Ye),TileMatrixSet:O(Ze)}),Oe=B(Ne,{Style:O(Qe),Format:O(ie),TileMatrixSetLink:O(Je),Dimension:O(et),ResourceURL:O(tt)},B($e,{Title:z(ie),Abstract:z(ie),WGS84BoundingBox:z(it),BoundingBox:O(st),Identifier:z(ie)})),ze=B(Ne,{LegendURL:O(rt)},B($e,{Title:z(ie),Identifier:z(ie)})),Ve=B(Ne,{TileMatrixSet:z(ie),TileMatrixSetLimits:z(at)}),Be=B(Ne,{TileMatrixLimits:G(lt)}),Ue=B(Ne,{TileMatrix:z(ie),MinTileRow:z(ee),MaxTileRow:z(ee),MinTileCol:z(ee),MaxTileCol:z(ee)}),qe=B(Ne,{Default:z(ie),Value:O(ie)},B($e,{Identifier:z(ie)})),We=B($e,{LowerCorner:G(nt),UpperCorner:G(nt)}),Xe=B(Ne,{WellKnownScaleSet:z(ie),TileMatrix:O(ot)},B($e,{SupportedCRS:z(ie),Identifier:z(ie),BoundingBox:z(it)})),He=B(Ne,{TopLeftCorner:z(nt),ScaleDenominator:z(Q),TileWidth:z(ee),TileHeight:z(ee),MatrixWidth:z(ee),MatrixHeight:z(ee)},B($e,{Identifier:z(ie)}));function Ke(e,t){return q({},Ge,e,t)}function Ye(e,t){return q({},Oe,e,t)}function Ze(e,t){return q({},Xe,e,t)}function Qe(e,t){const i=q({},ze,e,t);if(!i)return;const s="true"===e.getAttribute("isDefault");return i["isDefault"]=s,i}function Je(e,t){return q({},Ve,e,t)}function et(e,t){return q({},qe,e,t)}function tt(e,t){const i=e.getAttribute("format"),s=e.getAttribute("template"),r=e.getAttribute("resourceType"),n={};return i&&(n["format"]=i),s&&(n["template"]=s),r&&(n["resourceType"]=r),n}function it(e,t){const i=q([],We,e,t);if(2==i.length)return(0,Ie.Tr)(i)}function st(e,t){const i=e.getAttribute("crs"),s=q([],We,e,t);if(2==s.length)return{extent:(0,Ie.Tr)(s),crs:i}}function rt(e,t){const i={};return i["format"]=e.getAttribute("format"),i["href"]=Z(e),i}function nt(e,t){const i=ie(e).split(/\s+/);if(!i||2!=i.length)return;const s=+i[0],r=+i[1];return isNaN(s)||isNaN(r)?void 0:[s,r]}function ot(e,t){return q({},He,e,t)}function at(e,t){return q([],Be,e,t)}function lt(e,t){return q({},Ue,e,t)}const ct=ke;var ht=i(21483);function ut(e,t){const i=[];Object.keys(t).forEach((function(e){null!==t[e]&&void 0!==t[e]&&i.push(e+"="+encodeURIComponent(t[e]))}));const s=i.join("&");return e=e.replace(/[?&]$/,""),e+=e.includes("?")?"&":"?",e+s}var dt=i(56758),pt=i(89718);class gt extends dt.A{constructor(e){super({extent:e.extent,origin:e.origin,origins:e.origins,resolutions:e.resolutions,tileSize:e.tileSize,tileSizes:e.tileSizes,sizes:e.sizes}),this.matrixIds_=e.matrixIds}getMatrixId(e){return this.matrixIds_[e]}getMatrixIds(){return this.matrixIds_}}function mt(e,t,i){const s=[],r=[],n=[],o=[],a=[];i=void 0!==i?i:[];const l="SupportedCRS",c="TileMatrix",h="Identifier",u="ScaleDenominator",d="TopLeftCorner",p="TileWidth",g="TileHeight",m=e[l],f=(0,pt.get)(m),y=f.getMetersPerUnit(),v="ne"==f.getAxisOrientation().substr(0,2);return e[c].sort((function(e,t){return t[u]-e[u]})),e[c].forEach((function(t){let l;if(l=!(i.length>0)||i.find((function(i){return t[h]==i[c]||!t[h].includes(":")&&e[h]+":"+t[h]===i[c]})),l){r.push(t[h]);const e=28e-5*t[u]/y,i=t[p],l=t[g];v?n.push([t[d][1],t[d][0]]):n.push(t[d]),s.push(e),o.push(i==l?i:[i,l]),a.push([t["MatrixWidth"],t["MatrixHeight"]])}})),new gt({extent:t,origins:n,resolutions:s,matrixIds:r,tileSizes:o,sizes:a})}var ft=i(42654);class yt extends ht.A{constructor(e){const t=void 0!==e.requestEncoding?e.requestEncoding:"KVP",i=e.tileGrid;let s=e.urls;void 0===s&&void 0!==e.url&&(s=(0,ft.Uu)(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:s,wrapX:void 0!==e.wrapX&&e.wrapX,transition:e.transition,zDirection:e.zDirection}),this.version_=void 0!==e.version?e.version:"1.0.0",this.format_=void 0!==e.format?e.format:"image/jpeg",this.dimensions_=void 0!==e.dimensions?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),s&&s.length>0&&(this.tileUrlFunction=(0,ft.FD)(s.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const t=e.join("\n");this.setTileUrlFunction((0,ft.FD)(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==t&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e="KVP"==t?ut(e,i):e.replace(/\{(\w+?)\}/g,(function(e,t){return t.toLowerCase()in i?i[t.toLowerCase()]:e}));const s=this.tileGrid,r=this.dimensions_;return function(i,n,o){if(!i)return;const a={TileMatrix:s.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,r);let l=e;return l="KVP"==t?ut(l,a):l.replace(/\{(\w+?)\}/g,(function(e,t){return a[t]})),l}}}const vt=yt;function _t(e,t){const i=e["Contents"]["Layer"],s=i?.find((function(e){return e["Identifier"]==t["layer"]}));if(!s)return null;const r=e["Contents"]["TileMatrixSet"];let n;n=s["TileMatrixSetLink"].length>1?"projection"in t?s["TileMatrixSetLink"].findIndex((function(e){const i=r.find((function(t){return t["Identifier"]==e["TileMatrixSet"]})),s=i["SupportedCRS"],n=(0,pt.get)(s),o=(0,pt.get)(t["projection"]);return n&&o?(0,pt.equivalent)(n,o):s==t["projection"]})):s["TileMatrixSetLink"].findIndex((function(e){return e["TileMatrixSet"]==t["matrixSet"]})):0,n<0&&(n=0);const o=s["TileMatrixSetLink"][n]["TileMatrixSet"],a=s["TileMatrixSetLink"][n]["TileMatrixSetLimits"];let l=s["Format"][0];"format"in t&&(l=t["format"]),n=s["Style"].findIndex((function(e){return"style"in t?e["Title"]==t["style"]:e["isDefault"]})),n<0&&(n=0);const c=s["Style"][n]["Identifier"],h={};"Dimension"in s&&s["Dimension"].forEach((function(e,t,i){const s=e["Identifier"];let r=e["Default"];void 0===r&&(r=e["Value"][0]),h[s]=r}));const u=e["Contents"]["TileMatrixSet"],d=u.find((function(e){return e["Identifier"]==o}));let p;const g=d["SupportedCRS"];if(g&&(p=(0,pt.get)(g)),"projection"in t){const e=(0,pt.get)(t["projection"]);e&&(p&&!(0,pt.equivalent)(e,p)||(p=e))}let m=!1;const f="ne"==p.getAxisOrientation().substr(0,2);let y=d.TileMatrix[0],v={MinTileCol:0,MinTileRow:0,MaxTileCol:y.MatrixWidth-1,MaxTileRow:y.MatrixHeight-1};if(a){v=a[a.length-1];const e=d.TileMatrix.find((e=>e.Identifier===v.TileMatrix||d.Identifier+":"+e.Identifier===v.TileMatrix));e&&(y=e)}const _=28e-5*y.ScaleDenominator/p.getMetersPerUnit(),S=f?[y.TopLeftCorner[1],y.TopLeftCorner[0]]:y.TopLeftCorner,w=y.TileWidth*_,T=y.TileHeight*_;let b=d["BoundingBox"];b&&f&&(b=[b[1],b[0],b[3],b[2]]);let x=[S[0]+w*v.MinTileCol,S[1]-T*(1+v.MaxTileRow),S[0]+w*(1+v.MaxTileCol),S[1]-T*v.MinTileRow];if(void 0!==b&&!(0,Ie.ms)(b,x)){const e=s["WGS84BoundingBox"],t=(0,pt.get)("EPSG:4326").getExtent();if(x=b,e)m=e[0]===t[0]&&e[2]===t[2];else{const e=(0,pt.transformExtent)(b,d["SupportedCRS"],"EPSG:4326");m=e[0]-1e-10<=t[0]&&e[2]+1e-10>=t[2]}}const D=mt(d,x,a),C=[];let A=t["requestEncoding"];if(A=void 0!==A?A:"","OperationsMetadata"in e&&"GetTile"in e["OperationsMetadata"]){const t=e["OperationsMetadata"]["GetTile"]["DCP"]["HTTP"]["Get"];for(let e=0,i=t.length;e<i;++e)if(t[e]["Constraint"]){const i=t[e]["Constraint"].find((function(e){return"GetEncoding"==e["name"]})),s=i["AllowedValues"]["Value"];if(""===A&&(A=s[0]),"KVP"!==A)break;s.includes("KVP")&&C.push(t[e]["href"])}else t[e]["href"]&&(A="KVP",C.push(t[e]["href"]))}return 0===C.length&&(A="REST",s["ResourceURL"].forEach((function(e){"tile"===e["resourceType"]&&(l=e["format"],C.push(e["template"]))}))),{urls:C,layer:t["layer"],matrixSet:o,format:l,projection:p,requestEncoding:A,tileGrid:D,style:c,dimensions:h,wrapX:m,crossOrigin:t["crossOrigin"]}}var St=i(54602),wt=i(10972),Tt=i(16452),bt=class extends wt["default"]{constructor(e){var t=Tt.A.create("DIV",{className:(e.className||"")+" ol-timeline"+(e.target?"":" ol-unselectable ol-control")+(e.zoomButton?" ol-hasbutton":"")});super({element:t,target:e.target}),this._scrollDiv=Tt.A.create("DIV",{className:"ol-scroll",parent:this.element}),this._buttons=Tt.A.create("DIV",{className:"ol-buttons",parent:this.element}),e.zoomButton&&(this.addButton({className:"ol-zoom-in",handleClick:function(){var e=this.get("zoom");e>=1?e++:e=Math.min(1,e+.1),e=Math.round(100*e)/100,this.refresh(e)}.bind(this)}),this.addButton({className:"ol-zoom-out",handleClick:function(){var e=this.get("zoom");e>1?e--:e-=.1,e=Math.round(100*e)/100,this.refresh(e)}.bind(this)})),this._intervalDiv=Tt.A.create("DIV",{className:"ol-center-date",parent:this.element}),this.element.addEventListener("mouseover",function(){this._select&&this._select.elt.classList.remove("ol-select")}.bind(this));var i=null;this._scrollDiv.addEventListener("scroll",function(){this._setScrollLeft(),i&&(clearTimeout(i),i=null),i=setTimeout(function(){this.dispatchEvent({type:"scroll",date:this.getDate(),dateStart:this.getDate("start"),dateEnd:this.getDate("end")})}.bind(this),e.scrollTimeout||15)}.bind(this)),Tt.A.scrollDiv(this._scrollDiv,{onmove:function(e){this._moving=e}.bind(this)}),this._tline=[],this._scrollLeft=0,this.set("maxWidth",e.maxWidth||2e3),this.set("minDate",e.minDate||1/0),this.set("maxDate",e.maxDate||-1/0),this.set("graduation",e.graduation),this.set("minZoom",e.minZoom||.2),this.set("maxZoom",e.maxZoom||4),this.setInterval(e.interval),e.getHTML&&(this._getHTML=e.getHTML),e.getFeatureDate&&(this._getFeatureDate=e.getFeatureDate),e.endFeatureDate&&(this._endFeatureDate=e.endFeatureDate),this.setFeatures(e.features||e.source,e.zoom)}setMap(e){super.setMap(e),this.refresh(this.get("zoom")||1,!0)}addButton(e){this.element.classList.add("ol-hasbutton"),Tt.A.create("BUTTON",{className:e.className||void 0,title:e.title,html:e.html,click:e.handleClick,parent:this._buttons})}setInterval(e){"string"===typeof e&&(e=/s$/.test(e)?1e3*parseFloat(e):/mn$/.test(e)?1e3*parseFloat(e)*60:/h$/.test(e)?1e3*parseFloat(e)*3600:/d$/.test(e)?1e3*parseFloat(e)*3600*24:/y$/.test(e)?1e3*parseFloat(e)*3600*24*365:0),this.set("interval",e||0),e?this.element.classList.add("ol-interval"):this.element.classList.remove("ol-interval"),this.refresh(this.get("zoom"))}_getHTML(e){return e.get("name")||""}_getFeatureDate(e){return e&&e.get?e.get("date"):null}_endFeatureDate(){}isCollapsed(){return this.element.classList.contains("ol-collapsed")}collapse(e){e?this.element.classList.add("ol-collapsed"):this.element.classList.remove("ol-collapsed"),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})}toggle(){this.element.classList.toggle("ol-collapsed"),this.dispatchEvent({type:"collapse",collapsed:this.isCollapsed()})}setFeatures(e,t){this._features=this._source=null,e instanceof St["default"]?this._source=e:this._features=e instanceof Array?e:[],this.refresh(t)}getFeatures(){return this._features||this._source.getFeatures()}refresh(e,t){if(this.getMap()){e||(e=this.get("zoom")),e=Math.min(this.get("maxZoom"),Math.max(this.get("minZoom"),e||1)),this.set("zoom",e),this._scrollDiv.innerHTML="";var i,s,r=this.getFeatures(),n=this._tline=[];r.forEach(function(e){(i=this._getFeatureDate(e))&&(i instanceof Date||(i=new Date(i)),this._endFeatureDate&&(s=this._endFeatureDate(e),s instanceof Date||(s=new Date(s))),isNaN(i)||n.push({date:i,end:isNaN(s)?null:s,feature:e}))}.bind(this)),n.sort((function(e,t){return e.date<t.date?-1:e.date===t.date?0:1}));var o=Tt.A.create("DIV",{parent:this._scrollDiv}),a=this._minDate=Math.min(this.get("minDate"),n.length?n[0].date:1/0),l=this._maxDate=Math.max(this.get("maxDate"),n.length?n[n.length-1].date:-1/0);isFinite(a)||(this._minDate=a=new Date),isFinite(l)||(this._maxDate=l=new Date);var c=l-a,h=this.get("maxWidth"),u=this._scale=(c>h?h/c:1)*e;a=this._minDate=this._minDate-10/u,c=(l-a)*u,Tt.A.setStyle(o,{width:c,maxWidth:"unset"}),this._drawTime(o,a,l,u),this.get("interval")?Tt.A.setStyle(this._intervalDiv,{width:this.get("interval")*u}):Tt.A.setStyle(this._intervalDiv,{width:""});var d=[],p=Tt.A.getStyle(this._scrollDiv,"lineHeight"),g=Tt.A.create("DIV",{className:"ol-features",parent:o});n.forEach(function(e){for(var t=e.date,i=e.elt=Tt.A.create("DIV",{className:"ol-feature",style:{left:Math.round((t-a)*u)},html:this._getHTML(e.feature),parent:g}),s=i.querySelectorAll("img"),r=0;r<s.length;r++)s[r].ondragstart=function(){return!1};e.end&&Tt.A.setStyle(i,{minWidth:(e.end-t)*u,width:(e.end-t)*u,maxWidth:"unset"});var n,o,l=Tt.A.getStyle(i,"left");for(i.addEventListener("click",function(){this._moving||this.dispatchEvent({type:"select",feature:e.feature})}.bind(this)),n=0;o=d[n];n++)if(l>o)break;d[n]=l+Tt.A.getStyle(i,"width"),Tt.A.setStyle(i,{top:n*p})}.bind(this)),this._nbline=d.length,t&&this.setDate(this._minDate,{anim:!1,position:"start"}),this.dispatchEvent({type:"scroll",date:this.getDate(),dateStart:this.getDate("start"),dateEnd:this.getDate("end")})}}_getOffsetFromDate(e){return(e-this._minDate)*this._scale}_getDateFromOffset(e){return e/this._scale+this._minDate}_setScrollLeft(e){this._scrollLeft=e,void 0!==e&&(this._scrollDiv.scrollLeft=e)}_getScrollLeft(){return void 0===this._scrollLeft?this._scrollDiv.scrollLeft:this._scrollLeft}_drawTime(e,t,i,s){var r,n,o,a,l=Tt.A.create("DIV",{className:"ol-times",parent:e}),c=Tt.A.getStyle(l,"left"),h=Tt.A.getStyle(l,"height"),u=new Date(this._minDate).getFullYear();n=(new Date(0).setFullYear(String(u))-new Date(0).setFullYear(String(u-1)))*s;var d=Math.round(2*h/n)+1;while(1){if(r=new Date(0).setFullYear(u),r>this._maxDate)break;Tt.A.create("DIV",{className:"ol-time ol-year",style:{left:this._getOffsetFromDate(r)-c},html:u,parent:l}),u+=d}if(/day|month/.test(this.get("graduation"))&&(n=(new Date(0,0,1).setFullYear(String(u))-new Date(0,0,1).setFullYear(String(u-1)))*s,a=Math.max(1,Math.round(12/Math.round(n/h/2))),a<12)){u=new Date(this._minDate).getFullYear(),o=a+1;while(1){if(r=new Date(0,0,1),r.setFullYear(u),r.setMonth(o-1),r>this._maxDate)break;Tt.A.create("DIV",{className:"ol-time ol-month",style:{left:this._getOffsetFromDate(r)-c},html:r.toLocaleDateString(void 0,{month:"short"}),parent:l}),o+=a,o>12&&(u++,o=a+1)}}if("day"===this.get("graduation")){n=(new Date(0,1,1)-new Date(0,0,1))*s;var p=Math.max(1,Math.round(31/Math.round(n/h/2)));if(p<31){u=new Date(this._minDate).getFullYear(),o=0;var g=p;while(1)if(r=new Date(0,0,1),r.setFullYear(u),r.setMonth(o),r.setDate(g),isNaN(r))o++,o>12&&(o=1,u++),g=p;else{if(r>this._maxDate)break;if(g>1){var m=this._getOffsetFromDate(r);this._getOffsetFromDate(new Date(u,o+1,1))-m>h&&Tt.A.create("DIV",{className:"ol-time ol-day",style:{left:m-c},html:g,parent:l})}u=r.getFullYear(),o=r.getMonth(),g=r.getDate()+p,g>new Date(u,o+1,0).getDate()&&(o++,g=p)}}}}setDate(e,t){var i;if(t=t||{},e instanceof Date?i=e:(this.getFeatures().indexOf(e)>=0&&(i=this._getFeatureDate(e)),!i||i instanceof Date||(i=new Date(i)),i&&!isNaN(i)||(i=new Date(String(e)))),!isNaN(i)){!1===t.anim&&this._scrollDiv.classList.add("ol-move");var s=this._getOffsetFromDate(i);if("start"===t.position?s+=Tt.A.outerWidth(this._scrollDiv)/2-Tt.A.getStyle(this._scrollDiv,"marginLeft")/2:"end"===t.position&&(s-=Tt.A.outerWidth(this._scrollDiv)/2-Tt.A.getStyle(this._scrollDiv,"marginLeft")/2),this._setScrollLeft(s),!1===t.anim&&this._scrollDiv.classList.remove("ol-move"),e)for(var r,n=0;r=this._tline[n];n++)r.feature===e?(r.elt.classList.add("ol-select"),this._select=r):r.elt.classList.remove("ol-select")}}roundDate(e,t){switch(t){case"mn":return new Date(this._roundTo(e,6e4));case"hour":return new Date(this._roundTo(e,36e5));case"day":return new Date(this._roundTo(e,864e5));case"month":return e=new Date(this._roundTo(e,864e5)),e.getDate()>15&&(e=new Date(e.setMonth(e.getMonth()+1))),e=e.setDate(1),new Date(e);default:return new Date(e)}}getDate(e,t){var i;switch(t||(t=e),e){case"start":i=this.get("interval")?-Tt.A.getStyle(this._intervalDiv,"width")/2+Tt.A.getStyle(this._scrollDiv,"marginLeft")/2:-Tt.A.outerWidth(this._scrollDiv)/2+Tt.A.getStyle(this._scrollDiv,"marginLeft")/2;break;case"end":i=this.get("interval")?Tt.A.getStyle(this._intervalDiv,"width")/2-Tt.A.getStyle(this._scrollDiv,"marginLeft")/2:Tt.A.outerWidth(this._scrollDiv)/2-Tt.A.getStyle(this._scrollDiv,"marginLeft")/2;break;default:i=0;break}var s=this._getDateFromOffset(this._getScrollLeft()+i);return s=this.roundDate(s,t),new Date(s)}_roundTo(e,t){return Math.round(e/t)*t}getStartDate(){return new Date(this.get("minDate"))}getEndDate(){return new Date(this.get("maxDate"))}};const xt=bt,Dt={mixins:[D.A],data(){return{WMTSCapabilities:{},timeline:null}},methods:{async addWebService(e){switch(e.type.toLowerCase()){case"xyz":return this.updateXYZLayer(e);case"wmts":return await this.updateWMTSLayer(e);default:return n.A.error(this,"Sorry, this web service type is not supported."),null}},getWMTSTimes(e,t){const i=e.Contents.Layer||[];let s=i.find((e=>e.Identifier==t));if(!s||!s.Dimension)return[];let r=s.Dimension.find((e=>"TIME"===e.Identifier));return r?r.Value.sort():[]},async initWMTSLayer(e){if(!this.WMTSCapabilities[e.url])try{let i=new URL(e.url);i.searchParams.set("service","wmts"),i.searchParams.set("request","GetCapabilities");let s=await axios.get(i.toString(),{responseType:"text"});var t=new ct;this.WMTSCapabilities[e.url]=t.read(s.data)}catch(error){n.A.exception(this,error,"WMTS Discovery failed")}return this.WMTSCapabilities[e.url]},async updateWMTSLayer(e,t="Service"){let i=e.attributes||{},s=await this.initWMTSLayer(e);s||n.A.exception(this,error,"WMTS Discovery failed");let r,o=null,a=null,l=null,c=null,h=n.A.getResourceTitle(e,t),u=new M.A;Array.isArray(i.layers)?r=i.layers:Array.isArray(s.Contents.Layer)&&(r=layers.map((e=>e.Identifier)));for(let g of r){if(!g)continue;let t=_t(s,{layer:g,matrixSet:"EPSG:3857"});l||(l=new Date(t.dimensions.TIME));let r=this.getWMTSTimes(s,g);if(r.length){let e=new Date(r[0]),t=new Date(r[r.length-1]);(!o||e<o)&&(o=e),(!a||t>a)&&(a=t)}n.A.isObject(i.dimensions)&&Object.assign(t.dimensions,e.attributes.dimensions),c=new vt(t);var d=new F.A({title:h,source:this.trackTileProgress(c),noSwitcherDelete:!0});u.push(d)}if(o&&a){let e;this.timeline=new xt({className:"ol-pointer",graduation:"day",minDate:o,maxDate:a}),this.timeline.on("scroll",(function(t){!t.date||t.date>a||t.date<o||(e&&window.clearTimeout(e),e=window.setTimeout((()=>{try{let e=t.date.toISOString().substr(0,10);c.updateDimensions({TIME:e});let i=document.getElementsByClassName("timeline-date-label");i[0].innerText=e,i[0].disabled=!0}catch(error){console.log(error)}e=null}),500))})),this.map.addControl(this.timeline),this.timeline.addButton({className:"timeline-date-label",title:`The date that is shown on the map for the collection '${h}'`,html:"No date"}),this.timeline.setDate(l)}let p=new L.A({id:e.id,title:h,layers:u});return p.on("change:visible",(()=>{this.timeline&&this.timeline.element&&(this.timeline.element.style.display=p.getVisible()?"block":"none")})),this.addLayerToMap(p),this.timeline&&this.map.getLayers().on("remove",(e=>{e.element===p&&(this.map.removeControl(this.timeline),this.timeline=null)})),p},updateXYZLayer(e,t="Service"){let i=n.A.replaceParam(e.url,"__editorSessionId",(new Date).getTime()).replace(/%7B/g,"{").replace(/%7D/g,"}"),s=n.A.getResourceTitle(e,t),r=new F.A({title:s,source:this.trackTileProgress(new R.A({url:i})),noSwitcherDelete:!0}),o=new L.A({id:e.id,title:s,layers:[r]});if(this.addLayerToMap(o),n.A.isObject(e.process)&&n.A.isObject(e.process.process_graph)){const t="urn:ogc:def:crs:OGC:1.3:CRS84",i="EPSG:4326";Object.values(e.process.process_graph).filter((e=>"load_collection"===e.process_id&&n.A.isObject(e.arguments)&&e.arguments.spatial_extent)).forEach((e=>{let s=e.arguments.spatial_extent,r=(s.west||s.east||s.south||s.north)&&(!s.crs||4326===s.crs||s.crs===i),o=s.type&&(!s.crs||n.A.isObject(s.crs)&&"name"===s.crs.type&&(s.crs.properties?.name===i||s.properties?.name===t));(r||o)&&this.addExtent(s,!1)}))}return o}}},Ct=Dt;var At,Et,Mt=(0,f.A)(Ct,At,Et,!1,null,null,null);const Lt=Mt.exports;class Ft{constructor(e){this.layer=null,this.colorMap=e.getColorMap(),this.noData=e.getNoData(),this.bands=e.getBands(),this.defaultChannels=this.bands.slice(0,3),this.channels=this.bands.slice(0,3),this.file=e}getBandVar(e){return["band",["var",`${e}band`]]}getFormula(e){let t=["var",`${e}min`],i=["var",`${e}max`],s=this.getBandVar(e),r=["*",["/",["-",s,t],["-",i,t]],255];return["clamp",r,0,255]}getNoDataFormula(){let e=this.getBandVar("alpha");return["case",["==",e,0],0,1]}setStyle(){if(!this.layer)return;let e={};for(let i in this.channels){let t=this.channels[i];e[`${i}band`]=t.id,e[`${i}min`]=t.min,e[`${i}max`]=t.max}e.alphaband=this.bands.length+1;let t=[];if(this.colorMap)t.push("palette"),t.push(["band",1]),t.push(this.colorMap);else{if(0===this.channels.length)return null;if(1===this.channels.length){t.push("color");let e=this.getFormula(0);t.push(e),t.push(e),t.push(e),this.noData.length>0&&t.push(this.getNoDataFormula())}else t.push("color"),t.push(this.getFormula(0)),t.push(this.getFormula(1)),t.push(this.getFormula(2)),this.noData.length>0&&t.push(this.getNoDataFormula())}this.layer.setStyle({variables:e,color:t})}}var Rt=i(88022);Rt.A.prototype.getSampleByteSize=function(e){if(this.fileDirectory.BitsPerSample&&0!==this.fileDirectory.BitsPerSample.length)return e>=this.fileDirectory.BitsPerSample.length&&(e=0),Math.ceil(this.fileDirectory.BitsPerSample[e]/8)},Rt.A.prototype.getReaderForSample=function(e){const t=this.getSampleFormat(e),i=this.getBitsPerSample(e);switch(t){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(e,t){return getFloat16(this,e,t)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64;default:break}break;default:break}throw Error("Unsupported data format/bitsPerSample")},Rt.A.prototype.getSampleFormat=function(e=0){return this.fileDirectory.SampleFormat&&0!==this.fileDirectory.SampleFormat.length?"undefined"!==typeof this.fileDirectory.SampleFormat[e]?this.fileDirectory.SampleFormat[e]:this.fileDirectory.SampleFormat[0]:1},Rt.A.prototype.getBitsPerSample=function(e=0){if(this.fileDirectory.BitsPerSample&&0!==this.fileDirectory.BitsPerSample.length)return"undefined"!==typeof this.fileDirectory.BitsPerSample[e]?this.fileDirectory.BitsPerSample[e]:this.fileDirectory.BitsPerSample[0]};var Pt=i(73902),It=i(86717),Nt=i(34142),$t=i(82986),jt=i(22808),kt=i(75332),Gt=i(566),Ot=i(49825),zt=i(15477);function Vt(e,t,i){const s=(0,Ot.SR)();return s.style=e.style,(0,zt.nR)(t,i,s,e)}function Bt(e,t){const i=`\n    attribute vec2 ${Gt.eS.TEXTURE_COORD};\n    uniform mat4 ${Gt.gF.TILE_TRANSFORM};\n    uniform float ${Gt.gF.TEXTURE_PIXEL_WIDTH};\n    uniform float ${Gt.gF.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${Gt.gF.TEXTURE_RESOLUTION};\n    uniform float ${Gt.gF.TEXTURE_ORIGIN_X};\n    uniform float ${Gt.gF.TEXTURE_ORIGIN_Y};\n    uniform float ${Gt.gF.DEPTH};\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ${Gt.eS.TEXTURE_COORD};\n      v_mapCoord = vec2(\n        ${Gt.gF.TEXTURE_ORIGIN_X} + ${Gt.gF.TEXTURE_RESOLUTION} * ${Gt.gF.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],\n        ${Gt.gF.TEXTURE_ORIGIN_Y} - ${Gt.gF.TEXTURE_RESOLUTION} * ${Gt.gF.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]\n      );\n      gl_Position = ${Gt.gF.TILE_TRANSFORM} * vec4(${Gt.eS.TEXTURE_COORD}, ${Gt.gF.DEPTH}, 1.0);\n    }\n  `,s={...(0,zt.z0)(),inFragmentShader:!0,bandCount:t,style:e},r=[];if(void 0!==e.color){const t=Vt(s,e.color,Ot.mE);r.push(`color = ${t};`)}if(void 0!==e.contrast){const t=Vt(s,e.contrast,Ot.wl);r.push(`color.rgb = clamp((${t} + 1.0) * color.rgb - (${t} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==e.exposure){const t=Vt(s,e.exposure,Ot.wl);r.push(`color.rgb = clamp((${t} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(void 0!==e.saturation){const t=Vt(s,e.saturation,Ot.wl);r.push(`\n      float saturation = ${t} + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    `)}if(void 0!==e.gamma){const t=Vt(s,e.gamma,Ot.wl);r.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${t}));`)}if(void 0!==e.brightness){const t=Vt(s,e.brightness,Ot.wl);r.push(`color.rgb = clamp(color.rgb + ${t}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const n={},o=Object.keys(s.variables).length;if(o>1&&!e.variables)throw new Error(`Missing variables in style (expected ${s.variables})`);for(let u=0;u<o;++u){const t=s.variables[Object.keys(s.variables)[u]];if(!(t.name in e.variables))throw new Error(`Missing '${t.name}' in style variables`);const i=(0,zt.Sl)(t.name);n[i]=function(){let i=e.variables[t.name];return"string"===typeof i&&(i=(0,zt.Lm)(i)),void 0!==i?i:-9999999}}const a=Object.keys(n).map((function(e){return`uniform float ${e};`})),l=Math.ceil(t/4);a.push(`uniform sampler2D ${Gt.gF.TILE_TEXTURE_ARRAY}[${l}];`),s.paletteTextures&&a.push(`uniform sampler2D ${zt.uZ}[${s.paletteTextures.length}];`);const c=Object.keys(s.functions).map((function(e){return s.functions[e]})),h=`\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ${Gt.gF.RENDER_EXTENT};\n    uniform float ${Gt.gF.TRANSITION_ALPHA};\n    uniform float ${Gt.gF.TEXTURE_PIXEL_WIDTH};\n    uniform float ${Gt.gF.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${Gt.gF.RESOLUTION};\n    uniform float ${Gt.gF.ZOOM};\n\n    ${a.join("\n")}\n\n    ${c.join("\n")}\n\n    void main() {\n      if (\n        v_mapCoord[0] < ${Gt.gF.RENDER_EXTENT}[0] ||\n        v_mapCoord[1] < ${Gt.gF.RENDER_EXTENT}[1] ||\n        v_mapCoord[0] > ${Gt.gF.RENDER_EXTENT}[2] ||\n        v_mapCoord[1] > ${Gt.gF.RENDER_EXTENT}[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(${Gt.gF.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);\n\n      ${r.join("\n")}\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ${Gt.gF.TRANSITION_ALPHA};\n    }`;return{vertexShader:i,fragmentShader:h,uniforms:n,paletteTextures:s.paletteTextures}}class Ut extends jt.A{constructor(e){e=e?Object.assign({},e):{};const t=e.style||{};delete e.style;const i=e.cacheSize;delete e.cacheSize,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=t,this.cacheSize_=i,this.styleVariables_=this.style_.variables||{},this.addChangeListener(kt.A.SOURCE,this.handleSourceUpdate_)}getSources(e,t){const i=this.getSource();return this.sources_?"function"===typeof this.sources_?this.sources_(e,t):this.sources_:i?[i]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,t=this.getSources([-e,-e,e,e],e);return t&&t.length&&"bandCount"in t[0]?t[0].bandCount:4}createRenderer(){const e=Bt(this.style_,this.getSourceBandCount_());return new Gt.Ay(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}renderSources(e,t){const i=this.getRenderer();let s;for(let r=0,n=t.length;r<n;++r)this.renderedSource_=t[r],i.prepareFrame(e)&&(s=i.renderFrame(e));return s}render(e,t){this.rendered=!0;const i=e.viewState,s=this.getSources(e.extent,i.resolution);let r=!0;for(let o=0,a=s.length;o<a;++o){const e=s[o],t=e.getState();if("loading"==t){const t=()=>{"ready"==e.getState()&&(e.removeEventListener("change",t),this.changed())};e.addEventListener("change",t)}r=r&&"ready"==t}const n=this.renderSources(e,s);if(this.getRenderer().renderComplete&&r)return this.renderedResolution_=i.resolution,n;if(this.renderedResolution_>.5*i.resolution){const t=this.getSources(e.extent,this.renderedResolution_).filter((e=>!s.includes(e)));if(t.length>0)return this.renderSources(e,t)}return n}setStyle(e){this.styleVariables_=e.variables||{},this.style_=e;const t=Bt(this.style_,this.getSourceBandCount_()),i=this.getRenderer();i.reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,paletteTextures:t.paletteTextures}),this.changed()}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}Ut.prototype.dispose;const qt=Ut;var Wt=i(27607),Xt=i(6837),Ht=i(98596),Kt=i(70061),Yt=i(18469),Zt=i(66017),Qt=i(11078),Jt=i(4863),ei=i(40186),ti=i(74238),ii=i(6782);class si extends Zt.A{constructor(e){const t=void 0===e.projection?"EPSG:3857":e.projection;let i=e.tileGrid;void 0===i&&t&&(i=(0,Jt.EN)({extent:(0,Jt.kZ)(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:i,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}),this.gutter_=void 0!==e.gutter?e.gutter:0,this.tileSize_=e.tileSize?(0,ii.xq)(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=void 0===e.bandCount?4:e.bandCount,this.tileGridForProjection_={},this.tileCacheForProjection_={}}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const t=this.getTileGrid();return t?(0,ii.xq)(t.getTileSize(e)):[256,256]}getGutterForProjection(e){const t=this.getProjection();return!t||(0,pt.equivalent)(t,e)?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,i,s,r){const n=this.getTileCacheForProjection(s),o=(0,ei.dp)(e,t,i);if(n.containsKey(o)){const e=n.get(o);if(e&&e.key==this.getKey())return e}const a=this.getTileGrid(),l=Math.max.apply(null,a.getResolutions().map(((e,t)=>{const i=(0,ii.xq)(a.getTileSize(t)),s=this.getTileSize(t);return Math.max(s[0]/i[0],s[1]/i[1])}))),c=this.getTileGridForProjection(r),h=this.getTileGridForProjection(s),u=[e,t,i],d=this.getTileCoordForTileUrlFunction(u,s),p=Object.assign({sourceProj:r,sourceTileGrid:c,targetProj:s,targetTileGrid:h,tileCoord:u,wrappedTileCoord:d,pixelRatio:l,gutter:this.getGutterForProjection(r),getTileFunction:(e,t,i,s)=>this.getTile(e,t,i,s,r)},this.tileOptions),g=new Ht.A(p);return g.key=this.getKey(),g}getTile(e,t,i,s,r){const n=this.getProjection();if(n&&r&&!(0,pt.equivalent)(n,r))return this.getReprojTile_(e,t,i,r,n);const o=this.getTileSize(e),a=(0,ei.dp)(e,t,i);if(this.tileCache.containsKey(a))return this.tileCache.get(a);const l=this.loader_;function c(){return(0,ti.hq)((function(){return l(e,t,i)}))}const h=Object.assign({tileCoord:[e,t,i],loader:c,size:o},this.tileOptions),u=new Wt.Ay(h);return u.key=this.getKey(),u.addEventListener(Xt.A.CHANGE,this.handleTileChange_),this.tileCache.set(a,u),u}handleTileChange_(e){const t=e.target,i=(0,P.v6)(t),s=t.getState();let r;s==Qt.A.LOADING?(this.tileLoadingKeys_[i]=!0,r=Yt.A.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=s==Qt.A.ERROR?Yt.A.TILELOADERROR:s==Qt.A.LOADED?Yt.A.TILELOADEND:void 0),r&&this.dispatchEvent(new Zt.c(r,t))}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||(0,pt.equivalent)(t,e)))return this.tileGrid;const i=(0,P.v6)(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=(0,Jt.pr)(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,t){const i=(0,pt.get)(e);if(i){const e=(0,P.v6)(i);e in this.tileGridForProjection_||(this.tileGridForProjection_[e]=t)}}getTileCacheForProjection(e){const t=this.getProjection();if(!t||(0,pt.equivalent)(t,e))return this.tileCache;const i=(0,P.v6)(e);return i in this.tileCacheForProjection_||(this.tileCacheForProjection_[i]=new Kt.A(.1)),this.tileCacheForProjection_[i]}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const s in this.tileCacheForProjection_){const e=this.tileCacheForProjection_[s];e.expireCache(e==i?t:{})}}clear(){super.clear();for(const e in this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}const ri=si;var ni=i(98622),oi=i(70851);const ai="undefined"!==typeof navigator&&navigator.hardwareConcurrency||2;class li{constructor(e=ai,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise((e=>{i.e(9989).then(i.bind(i,79989)).then((t=>{e(t.create)}))})),this._awaitingDecoder.then((t=>{this._awaitingDecoder=null,this.workers=[];for(let i=0;i<e;i++)this.workers.push({worker:t(),idle:!0})})))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,0===this.size?(0,oi.f)(e).then((i=>i.decode(e,t))):new Promise((i=>{const s=this.workers.find((e=>e.idle))||this.workers[Math.floor(Math.random()*this.size)];s.idle=!1;const r=this.messageId++,n=e=>{e.data.id===r&&(s.idle=!0,i(e.data.decoded),s.worker.removeEventListener("message",n))};s.worker.addEventListener("message",n),s.worker.postMessage({fileDirectory:e,buffer:t,id:r},[t])}))}destroy(){this.workers&&(this.workers.forEach((e=>{e.worker.terminate()})),this.workers=null)}}const ci=li;var hi=i(34099),ui=i(61597),di=i(54422),pi=i(8100);function gi(e){const t=e.fileDirectory,i=t.NewSubfileType||0;return 4===(4&i)}function mi(e,t){if(!e)return!1;if(!0===e)return!0;if(3!==t.getSamplesPerPixel())return!1;const i=t.fileDirectory.PhotometricInterpretation,s=ni.ub;return i===s.CMYK||i===s.YCbCr||i===s.CIELab||i===s.ICCLab}const fi="STATISTICS_MAXIMUM",yi="STATISTICS_MINIMUM",vi=256;let _i;function Si(){return _i||(_i=new ci),_i}function wi(e){try{return e.getBoundingBox()}catch(t){return[0,0,e.getWidth(),e.getHeight()]}}function Ti(e){try{return e.getOrigin().slice(0,2)}catch(t){return[0,e.getHeight()]}}function bi(e,t){try{return e.getResolution(t)}catch(i){return[t.getWidth()/e.getWidth(),t.getHeight()/e.getHeight()]}}function xi(e){const t=e.geoKeys;if(!t)return null;if(t.ProjectedCSTypeGeoKey&&32767!==t.ProjectedCSTypeGeoKey){const e="EPSG:"+t.ProjectedCSTypeGeoKey;let i=(0,pt.get)(e);if(!i){const s=(0,pi.q)(t.ProjLinearUnitsGeoKey);s&&(i=new pt.Projection({code:e,units:s}))}return i}if(t.GeographicTypeGeoKey&&32767!==t.GeographicTypeGeoKey){const e="EPSG:"+t.GeographicTypeGeoKey;let i=(0,pt.get)(e);if(!i){const s=(0,pi.q)(t.GeogAngularUnitsGeoKey);s&&(i=new pt.Projection({code:e,units:s}))}return i}return null}function Di(e){return e.getImageCount().then((function(t){const i=new Array(t);for(let s=0;s<t;++s)i[s]=e.getImage(s);return Promise.all(i)}))}function Ci(e,t){let i;return i=e.blob?(0,hi._F)(e.blob):e.overviews?(0,hi.Vj)(e.url,e.overviews,t):(0,hi.uz)(e.url,t),i.then(Di)}function Ai(e,t,i,s,r){if(Array.isArray(e)){const n=e.length;if(!Array.isArray(t)||n!=t.length){const e=new Error(s);throw r(e),e}for(let o=0;o<n;++o)Ai(e[o],t[o],i,s,r)}else if(Math.abs(e-t)>i*e)throw new Error(s)}function Ei(e){return e instanceof Int8Array?-128:e instanceof Int16Array?-32768:e instanceof Int32Array?-2147483648:e instanceof Float32Array?12e-39:0}function Mi(e){return e instanceof Int8Array?127:e instanceof Uint8Array||e instanceof Uint8ClampedArray?255:e instanceof Int16Array?32767:e instanceof Uint16Array?65535:e instanceof Int32Array?2147483647:e instanceof Uint32Array?4294967295:e instanceof Float32Array?34e37:255}class Li extends ri{constructor(e){super({state:"loading",tileGrid:null,projection:e.projection||null,opaque:e.opaque,transition:e.transition,interpolate:!1!==e.interpolate,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const t=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(t),this.sourceMasks_=new Array(t),this.resolutionFactors_=new Array(t),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=!1!==e.normalize,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map((e=>e.url)).join(","));const i=this,s=new Array(t);for(let r=0;r<t;++r)s[r]=Ci(this.sourceInfo_[r],this.sourceOptions_);Promise.all(s).then((function(e){i.configure_(e)})).catch((function(e){(0,di.z3)(e),i.error_=e,i.setState("error")}))}getError(){return this.error_}determineProjection(e){const t=e[0];for(let i=t.length-1;i>=0;--i){const e=t[i],s=xi(e);if(s){this.projection=s;break}}}configure_(e){let t,i,s,r,n;const o=new Array(e.length),a=new Array(e.length),l=new Array(e.length);let c=0;const h=e.length;for(let g=0;g<h;++g){const h=[],u=[];e[g].forEach((e=>{gi(e)?u.push(e):h.push(e)}));const d=h.length;if(u.length>0&&u.length!==d)throw new Error(`Expected one mask per image found ${u.length} masks and ${d} images`);let p,m;const f=new Array(d),y=new Array(d),v=new Array(d);a[g]=new Array(d),l[g]=new Array(d);for(let e=0;e<d;++e){const t=h[e],i=t.getGDALNoData();l[g][e]=t.getGDALMetadata(0),a[g][e]=i;const s=this.sourceInfo_[g].bands;o[g]=s?s.length:t.getSamplesPerPixel();const r=d-(e+1);p||(p=wi(t)),m||(m=Ti(t));const n=bi(t,h[0]);v[r]=n[0];const c=[t.getTileWidth(),t.getTileHeight()];c[0]!==c[1]&&c[1]<vi&&(c[0]=vi,c[1]=vi),f[r]=c;const u=n[0]/Math.abs(n[1]);y[r]=[c[0],c[1]/u]}if(t?(0,Ie._N)(t,p,t):t=p,i){const e=`Origin mismatch for source ${g}, got [${m}] but expected [${i}]`;Ai(i,m,0,e,this.viewRejector)}else i=m;if(n){n.length-c>v.length&&(c=n.length-v.length);const e=n[n.length-1]/v[v.length-1];this.resolutionFactors_[g]=e;const t=v.map((t=>t*e)),i=`Resolution mismatch for source ${g}, got [${t}] but expected [${n}]`;Ai(n.slice(c,n.length),t,.02,i,this.viewRejector)}else n=v,this.resolutionFactors_[g]=1;s?Ai(s.slice(c,s.length),y,.01,`Tile size mismatch for source ${g}`,this.viewRejector):s=y,r?Ai(r.slice(c,r.length),f,0,`Tile size mismatch for source ${g}`,this.viewRejector):r=f,this.sourceImagery_[g]=h.reverse(),this.sourceMasks_[g]=u.reverse()}for(let g=0,m=this.sourceImagery_.length;g<m;++g){const e=this.sourceImagery_[g];while(e.length<n.length)e.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=o,this.nodataValues_=a,this.metadata_=l;e:for(let g=0;g<h;++g){if(void 0!==this.sourceInfo_[g].nodata){this.addAlpha_=!0;break}if(this.sourceMasks_[g].length){this.addAlpha_=!0;break}const e=a[g],t=this.sourceInfo_[g].bands;if(t){for(let i=0;i<t.length;++i)if(null!==e[t[i]-1]){this.addAlpha_=!0;break e}}else for(let i=0;i<e.length;++i)if(null!==e[i]){this.addAlpha_=!0;break e}}let u=this.addAlpha_?1:0;for(let g=0;g<h;++g)u+=o[g];this.bandCount=u;const d=new dt.A({extent:t,minZoom:c,origin:i,resolutions:n,tileSizes:s});this.tileGrid=d,this.setTileSizes(r),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const p=1;2===n.length?n=[n[0],n[1],n[1]/2]:1===n.length&&(n=[2*n[0],n[0],n[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:n,center:(0,pt.toUserCoordinate)((0,Ie.q1)(t),this.projection),extent:(0,pt.toUserExtent)(t,this.projection),zoom:p})}loadTile_(e,t,i){const s=this.getTileSize(e),r=this.sourceImagery_.length,n=new Array(2*r),o=this.nodataValues_,a=this.sourceInfo_,l=Si();for(let c=0;c<r;++c){const h=a[c],u=this.resolutionFactors_[c],d=[Math.round(t*(s[0]*u)),Math.round(i*(s[1]*u)),Math.round((t+1)*(s[0]*u)),Math.round((i+1)*(s[1]*u))],p=this.sourceImagery_[c][e];let g,m;h.bands&&(g=h.bands.map((function(e){return e-1}))),m="nodata"in h&&null!==h.nodata?h.nodata:g?g.map((function(e){return o[c][e]})):o[c];const f={window:d,width:s[0],height:s[1],samples:g,fillValue:m,pool:l,interleave:!1};mi(this.convertToRGB_,p)?n[c]=p.readRGB(f):n[c]=p.readRasters(f);const y=r+c,v=this.sourceMasks_[c][e];v?n[y]=v.readRasters({window:d,width:s[0],height:s[1],samples:[0],pool:l,interleave:!1}):n[y]=Promise.resolve(null)}return Promise.all(n).then(this.composeTile_.bind(this,s)).catch((function(e){throw(0,di.z3)(e),e}))}composeTile_(e,t){const i=this.metadata_,s=this.sourceInfo_,r=this.sourceImagery_.length,n=this.bandCount,o=this.samplesPerPixel_,a=this.nodataValues_,l=this.normalize_,c=this.addAlpha_,h=e[0]*e[1],u=h*n;let d;d=l?new Uint8Array(u):new Float32Array(u);let p=0;for(let g=0;g<h;++g){let e=c;for(let n=0;n<r;++n){const h=s[n];let u,m,f=h.min,y=h.max;if(l){const e=i[n][0];void 0===f&&(f=e&&yi in e?parseFloat(e[yi]):Ei(t[n][0])),void 0===y&&(y=e&&fi in e?parseFloat(e[fi]):Mi(t[n][0])),u=255/(y-f),m=-f*u}for(let i=0;i<o[n];++i){const s=t[n][i][g];let r;if(r=l?(0,ui.qE)(u*s+m,0,255):s,c){let t=h.nodata;if(void 0===t){let e;e=h.bands?h.bands[i]-1:i,t=a[n][e]}const o=isNaN(t);(!o&&s!==t||o&&!isNaN(s))&&(e=!1,d[p]=r)}else d[p]=r;p++}if(!e){const i=r+n,s=t[i];s&&!s[0][g]&&(e=!0)}}c&&(e||(d[p]=255),p++)}return d}}Li.prototype.getView;const Fi=Li;var Ri=class extends wt["default"]{constructor(e){e=e||{};var t=document.createElement("div");super({element:t}),t.className=(e.className||"ol-swipe")+" ol-unselectable ol-control";var i=document.createElement("button");t.appendChild(i),t.addEventListener("mousedown",this.move.bind(this)),t.addEventListener("touchstart",this.move.bind(this)),this.precomposeRight_=this.precomposeRight.bind(this),this.precomposeLeft_=this.precomposeLeft.bind(this),this.postcompose_=this.postcompose.bind(this),this.layers=[],e.layers&&this.addLayer(e.layers,!1),e.rightLayers&&this.addLayer(e.rightLayers,!0),this.on("propertychange",function(e){if(this.getMap())try{this.getMap().renderSync()}catch(e){}"horizontal"===this.get("orientation")?(this.element.style.top=100*this.get("position")+"%",this.element.style.left=""):("vertical"!==this.get("orientation")&&this.set("orientation","vertical"),this.element.style.left=100*this.get("position")+"%",this.element.style.top=""),"orientation"===e.key&&(this.element.classList.remove("horizontal","vertical"),this.element.classList.add(this.get("orientation"))),this.isMoving||this.layers.forEach((function(e){e.layer.getImageRatio&&e.layer.changed()}))}.bind(this)),this.set("position",e.position||.5),this.set("orientation",e.orientation||"vertical")}setMap(e){var t,i;if(this.getMap()){for(t=0;t<this.layers.length;t++)i=this.layers[t],i.right?i.layer.un(["precompose","prerender"],this.precomposeRight_):i.layer.un(["precompose","prerender"],this.precomposeLeft_),i.layer.un(["postcompose","postrender"],this.postcompose_);try{this.getMap().renderSync()}catch(s){}}if(super.setMap(e),e){for(this._listener=[],t=0;t<this.layers.length;t++)i=this.layers[t],i.right?i.layer.on(["precompose","prerender"],this.precomposeRight_):i.layer.on(["precompose","prerender"],this.precomposeLeft_),i.layer.on(["postcompose","postrender"],this.postcompose_);try{e.renderSync()}catch(s){}}}isLayer_(e){for(var t=0;t<this.layers.length;t++)if(this.layers[t].layer===e)return t;return-1}addLayer(e,t){e instanceof Array||(e=[e]);for(var i=0;i<e.length;i++){var s=e[i];if(this.isLayer_(s)<0&&(this.layers.push({layer:s,right:t}),this.getMap())){t?s.on(["precompose","prerender"],this.precomposeRight_):s.on(["precompose","prerender"],this.precomposeLeft_),s.on(["postcompose","postrender"],this.postcompose_);try{this.getMap().renderSync()}catch(r){}}}}removeLayers(){var e=[];this.layers.forEach((function(t){e.push(t.layer)})),this.removeLayer(e)}removeLayer(e){e instanceof Array||(e=[e]);for(var t=0;t<e.length;t++){var i=this.isLayer_(e[t]);i>=0&&this.getMap()&&(this.layers[i].right?e[t].un(["precompose","prerender"],this.precomposeRight_):e[t].un(["precompose","prerender"],this.precomposeLeft_),e[t].un(["postcompose","postrender"],this.postcompose_),this.layers.splice(i,1))}if(this.getMap())try{this.getMap().renderSync()}catch(s){}}getRectangle(){var e;return"vertical"===this.get("orientation")?(e=this.getMap().getSize(),[0,0,e[0]*this.get("position"),e[1]]):(e=this.getMap().getSize(),[0,0,e[0],e[1]*this.get("position")])}move(e){var t,i=this;switch(this._movefn||(this._movefn=this.move.bind(this)),e.type){case"touchcancel":case"touchend":case"mouseup":i.isMoving=!1,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach((function(e){document.removeEventListener(e,i._movefn)})),this.layers.forEach((function(e){e.layer.getImageRatio&&e.layer.changed()}));break;case"mousedown":case"touchstart":i.isMoving=!0,["mouseup","mousemove","touchend","touchcancel","touchmove"].forEach((function(e){document.addEventListener(e,i._movefn)}));case"mousemove":case"touchmove":if(i.isMoving)if("vertical"===i.get("orientation")){var s=e.pageX||e.touches&&e.touches.length&&e.touches[0].pageX||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageX;if(!s)break;s-=i.getMap().getTargetElement().getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft,t=i.getMap().getSize()[0];var r=t-Math.min(Math.max(0,t-s),t);t=r/t,i.set("position",t),i.dispatchEvent({type:"moving",size:[r,i.getMap().getSize()[1]],position:[t,0]})}else{var n=e.pageY||e.touches&&e.touches.length&&e.touches[0].pageY||e.changedTouches&&e.changedTouches.length&&e.changedTouches[0].pageY;if(!n)break;n-=i.getMap().getTargetElement().getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop,t=i.getMap().getSize()[1];var o=t-Math.min(Math.max(0,t-n),t);t=o/t,i.set("position",t),i.dispatchEvent({type:"moving",size:[i.getMap().getSize()[0],o],position:[0,t]})}break;default:break}}_transformPt(e,t){var i=e.inversePixelTransform,s=t[0],r=t[1];return t[0]=i[0]*s+i[2]*r+i[4],t[1]=i[1]*s+i[3]*r+i[5],t}_drawRect(e,t){var i=e.inversePixelTransform;if(i){var s=[[t[0][0],t[0][1]],[t[0][0],t[1][1]],[t[1][0],t[1][1]],[t[1][0],t[0][1]],[t[0][0],t[0][1]]];if(e.context.save(),e.target.getImageRatio){var r=-Math.atan2(e.frameState.pixelToCoordinateTransform[1],e.frameState.pixelToCoordinateTransform[0]);e.context.translate(e.frameState.size[0]/2,e.frameState.size[1]/2),e.context.rotate(r),e.context.translate(-e.frameState.size[0]/2,-e.frameState.size[1]/2)}s.forEach((function(t,s){t=[t[0]*i[0]-t[1]*i[1]+i[4],-t[0]*i[2]+t[1]*i[3]+i[5]],s?e.context.lineTo(t[0],t[1]):e.context.moveTo(t[0],t[1])})),e.context.restore()}else{var n=e.frameState.pixelRatio;e.context.rect(t[0][0]*n,t[0][1]*n,t[1][0]*n,t[1][1]*n)}}precomposeLeft(e){var t=e.context;if(t instanceof WebGLRenderingContext){if("prerender"===e.type){this._lefttime!=e.frameState.time&&(t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),this._lefttime=e.frameState.time),t.enable(t.SCISSOR_TEST);var i,s,r=this.getMap().getSize(),n=this._transformPt(e,[0,r[1]]),o=this._transformPt(e,[r[0],0]),a=o[0]-n[0],l=o[1]-n[1];"vertical"===this.get("orientation")?(i=Math.round(a*this.get("position")),s=l):(i=a,s=Math.round(l*this.get("position")),n[1]+=l-s),t.scissor(n[0],n[1],i,s),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}}else{var c=e.frameState.size;t.save(),t.beginPath();var h=[[0,0],[c[0],c[1]]];"vertical"===this.get("orientation")?h[1]=[.5*c[0]+this.getMap().getSize()[0]*(this.get("position")-.5),c[1]]:h[1]=[c[0],.5*c[1]+this.getMap().getSize()[1]*(this.get("position")-.5)],this._drawRect(e,h),t.clip()}}precomposeRight(e){var t=e.context;if(t instanceof WebGLRenderingContext){if("prerender"===e.type){this._righttime!=e.frameState.time&&(t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),this._righttime=e.frameState.time),t.enable(t.SCISSOR_TEST);var i,s,r=this.getMap().getSize(),n=this._transformPt(e,[0,r[1]]),o=this._transformPt(e,[r[0],0]),a=o[0]-n[0],l=o[1]-n[1];"vertical"===this.get("orientation")?(s=l,i=Math.round(a*(1-this.get("position"))),n[0]+=a-i):(i=a,s=Math.round(l*(1-this.get("position")))),t.scissor(n[0],n[1],i,s),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)}}else{var c=e.frameState.size;t.save(),t.beginPath();var h=[[0,0],[c[0],c[1]]];"vertical"===this.get("orientation")?h[0]=[.5*c[0]+this.getMap().getSize()[0]*(this.get("position")-.5),0]:h[0]=[0,.5*c[1]+this.getMap().getSize()[1]*(this.get("position")-.5)],this._drawRect(e,h),t.clip()}}postcompose(e){if(e.context instanceof WebGLRenderingContext){if("postrender"===e.type){var t=e.context;t.disable(t.SCISSOR_TEST)}}else e.target.getClassName&&"ol-layer"!==e.target.getClassName()&&e.target.get("declutter")?setTimeout((function(){e.context.restore()}),0):e.context.restore()}};const Pi=Ri,Ii={name:"MapViewer",mixins:[D.A,C.A,A.A,Lt],components:{AddDataControl:v,ChannelControl:x,Pane:l.Z,ScatterChart:c.A,Splitpanes:l.S,TextControl:E.A},props:{data:{}},data(){return{textControlText:"Value: -",loading:!0,chart:null,geotiffs:[],swipe:null,layerId:0}},computed:{...n.A.mapState(["connection"]),...n.A.mapState("editor",["appMode"]),isWebService(){return this.data instanceof Pt.Service&&"string"===typeof this.data.type},isGeoTiff(){return this.data instanceof o.A},isGeoJson(){return this.data instanceof a.A&&this.data.isGeoJson}},mounted(){this.$emit("mounted",this)},methods:{async renderMap(){try{let e,t;if(this.isGeoJson)t=await this.data.loadData(this.connection);else if(this.isGeoTiff){t=await this.data.loadData(this.connection);let i=t.getProjection();i&&(e=i)}else{if(!this.isWebService||!n.A.isMapServiceSupported(this.data.type))throw new Error("Sorry, the given data can't be shown on a web map.");if("wmts"===this.data.type.toLowerCase()){await this.initWMTSLayer(this.data)}}await this.createMap(e);const i=this.map.getLayers();if(i.on("add",(e=>{const t=e.element.get("geotiff");t&&(this.geotiffs.push(t),this.updateSwiper())})),i.on("remove",(e=>{const t=e.element.get("geotiff"),i=this.geotiffs.indexOf(t);i>-1&&(this.geotiffs.splice(i,1),this.updateSwiper())})),this.addLayerSwitcher(),this.addGeocoder((e=>{if(!e)return;let t=this.toExtent(e);t=(0,pt.transformExtent)(t,"EPSG:4326",this.map.getView().getProjection()),this.map.getView().fit(t,this.getFitOptions())})),this.isGeoJson)this.addBasemaps(),this.addGeoJson(t,!0);else if(this.isGeoTiff){let e=this.map.getView().getProjection();(e.basemap||["EPSG:3857","EPSG:4326"].includes(e.getCode()))&&this.addBasemaps(),this.addGeoTiff(t,t.title);let i=this.data.getContext();i&&this.addExtent(i,!1)}else this.isWebService&&n.A.isMapServiceSupported(this.data.type)&&(this.addBasemaps(),this.addWebService(this.data));this.$listeners&&this.$listeners.drop&&(this.map.getViewport().addEventListener("dragover",(e=>e.preventDefault())),this.map.getViewport().addEventListener("drop",this.$listeners.drop)),this.map.on("pointermove",this.onPointerMove),this.map.on("click",this.onClick)}catch(error){n.A.exception(this,error)}this.loading=!1},async addCollection(){let e=this.showWebService(this.data);try{let t=service.attributes.bbox,i=[...this.fromLonLat([t.west,t.south]),...this.fromLonLat([t.east,t.north])],s=new $t["default"]({title:"Extent",noSwitcherDelete:!0,source:new St["default"]({features:[new It["default"]((0,Nt.VY)(i))],projection:"EPSG:4326",wrapX:!1})});this.removeLayerFill(s),e.getLayers().push(s),this.map.getView().fit(i,this.getFitOptions(10))}catch(error){console.log(error)}},getPixelValues(e){return this.geotiffs.map((t=>{const i=t.layer;let s=i.getData(e);s=s?Array.from(s):[];const r=t.noData,n=r.length>0?s.pop():void 0;s=s.map((e=>0===n||r.includes(e)?NaN:e));const o=s.map(((e,i)=>{const s=t.bands[i];if(s){const e=String(s.name||s.id);if(e.length>0)return e}return String(i)}));return{title:i.get("title"),data:s,labels:o}}))},formatCoords(e){return e.map((e=>String(parseFloat(e.toFixed(6))))).join(", ")},formatValue({data:e}){return Array.isArray(e)&&0!==e.length?e.map((e=>(e=parseFloat(e.toFixed(6)),isNaN(e)?"no data":e))).join(" / "):"-"},onPointerMove(e){const t=this.getPixelValues(e.pixel);let i="-";1===t.length?i=this.formatValue(t[0]):t.length>1&&(i=t.map((e=>`\r\n- ${e.title}: ${this.formatValue(e)}`)).join(""));const s=t.length>1?"s":"",r=this.formatCoords(e.coordinate);this.textControlText=[`Value${s}: ${i}`,`Pixel Value${s}: ${i}\r\nCoordinate: ${r}`]},onClick(e){const t=this.getPixelValues(e.pixel),i=t.map((e=>e.data)).flat().filter((e=>isFinite(e)));if(i.length<2)return void(this.chart=null);let s=t.map((e=>e.labels)).flat();s=Array.from(new Set(s));const r=t.map((e=>{const t={};for(let i in e.data)t[e.labels[i]]=e.data[i];return{label:e.title,data:t}})),n=this.formatCoords(e.coordinate);this.chart={title:`Coordinate: ${n}`,labels:s,datasets:r}},closeChart(){this.chart=null},async addGeoTiff(e,t="GeoTiff"){const i=new Ft(e),s={nodata:i.noData[0]};e.getBlob()?s.blob=e.getBlob():s.url=e.getUrl();const r=new Fi({interpolate:!1,normalize:!1,convertToRGB:e.convertToRGB,sources:[s]}),n=new qt({id:e.getUrl(),title:t,source:r,className:"geotiff"+this.layerId++,cacheSize:2048});i.layer=n,n.set("geotiff",i),n.once("prerender",(()=>i.setStyle())),n.on("change:visible",(()=>this.updateSwiper())),this.addLayerToMap(n);let o=e.getExtent();return o&&this.map.getView().fit(o,this.getFitOptions(10)),n},async addData(e){if(e.length>5&&!n.A.confirmOpenAll(e))return;const t=e.map((async e=>(await e.loadData(this.connection),e instanceof o.A?await this.addGeoTiff(e,e.title):e instanceof a.A&&e.isGeoJson?await this.addGeoJson(e,!1,e.title):void n.A.error(this,new Error(`Sorry, the given data at ${e.href} is not supported.`)))));await Promise.all(t)},updateSwiper(){const e=this.map.getLayers().getArray().filter((e=>e.get("geotiff")&&e.getVisible()));if(2===e.length){if(this.swipe&&e.every(((e,t)=>e===this.swipe.layers[t])))return;const t={layers:e[0],rightLayers:e[1]},i=new Pi(t);this.swipe={control:i,layers:e},this.map.addControl(i)}else 2!==e.length&&this.swipe&&(this.map.removeControl(this.swipe.control),this.swipe=null)},updateGeoTiffStyle(e,t,i){switch(t){case"channels":e.channels=i,this.setOptions("channels",i);break}e.setStyle()}}},Ni=Ii;var $i=(0,f.A)(Ni,s,r,!1,null,null,null);const ji=$i.exports},24149:e=>{"use strict";var t=RangeError;e.exports=function(e){if(e===e)return e;throw new t("NaN is not allowed")}},99590:(e,t,i)=>{"use strict";var s=i(91291),r=RangeError;e.exports=function(e){var t=s(e);if(t<0)throw new r("The argument can't be less than 0");return t}},29314:(e,t,i)=>{"use strict";var s=i(46518),r=i(69565),n=i(28551),o=i(1767),a=i(24149),l=i(99590),c=i(19462),h=i(96395),u=c((function(){var e,t,i=this.iterator,s=this.next;while(this.remaining)if(this.remaining--,e=n(r(s,i)),t=this.done=!!e.done,t)return;if(e=n(r(s,i)),t=this.done=!!e.done,!t)return e.value}));s({target:"Iterator",proto:!0,real:!0,forced:h},{drop:function(e){n(this);var t=l(a(+e));return new u(o(this),{remaining:t})}})},64743:(e,t,i)=>{"use strict";i(29314)}}]);
//# sourceMappingURL=1485.3375dd8b.js.map