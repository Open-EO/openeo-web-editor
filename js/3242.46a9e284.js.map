{"version":3,"file":"js/3242.46a9e284.js","mappings":"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","sources":["webpack://@openeo/web-editor/./src/components/modals/ExpressionModal.vue","webpack://@openeo/web-editor/src/components/modals/ExpressionModal.vue","webpack://@openeo/web-editor/./src/components/modals/ExpressionModal.vue?83c3","webpack://@openeo/web-editor/./src/components/modals/ExpressionModal.vue?b6ae","webpack://@openeo/web-editor/./src/components/modals/Modal.vue","webpack://@openeo/web-editor/src/components/modals/Modal.vue","webpack://@openeo/web-editor/./src/components/modals/Modal.vue?7020","webpack://@openeo/web-editor/./src/components/modals/Modal.vue?5039"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('Modal',{attrs:{\"show\":_vm.show,\"width\":\"80%\",\"title\":\"Formula Editor\"},on:{\"closed\":function($event){return _vm.$emit('closed')}},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('div',{staticClass:\"content\"},[_c('TextEditor',{ref:\"editor\",staticClass:\"editor\",attrs:{\"id\":\"input\",\"language\":\"math\",\"placeholder\":\"e.g. x * 2.5 / (x - y)\"},on:{\"drop\":_vm.onDrop,\"dragover\":_vm.allowDrop},model:{value:(_vm.input),callback:function ($$v) {_vm.input=$$v},expression:\"input\"}}),_c('div',{staticClass:\"description\"},[_c('p',[_c('i',{staticClass:\"fas fa-info-circle\"}),_vm._v(\" Above you can insert a mathematical formula and it will be converted to openEO code for you.\")]),_c('p',[_c('strong',[_vm._v(\"Operators\")]),_vm._v(\":\"),_c('br'),_vm._l((_vm.operators),function(op){return _c('kbd',{key:op.op,staticClass:\"click\",attrs:{\"title\":op.title,\"draggable\":\"true\"},on:{\"click\":function($event){return _vm.emit('showProcess', {id: op.processId})},\"dragstart\":function($event){return _vm.onDrag($event, 'operators', op.op)}}},[_vm._v(_vm._s(op.op))])})],2),_c('p',[_vm._v(\"Supported \"),_c('strong',[_vm._v(\"mathematical functions\")]),_vm._v(\": \"),(_vm.mathProcesses.length)?[_c('br'),_vm._l((_vm.mathProcesses),function(func){return _c('kbd',{key:func.id,staticClass:\"click\",attrs:{\"title\":func.summary,\"draggable\":\"true\"},on:{\"click\":function($event){return _vm.emit('showProcess', func)},\"dragstart\":function($event){return _vm.onDrag($event, 'functions', func)}}},[_vm._v(_vm._s(func.id))])})]:[_vm._v(\"None\")]],2),_c('p',[_vm._v(\"Available \"),_c('strong',[_vm._v(\"output from processes\")]),_vm._v(\": \"),(_vm.results.length)?[_c('br'),_vm._l((_vm.results),function(id){return _c('kbd',{key:id,attrs:{\"draggable\":\"true\"},on:{\"dragstart\":function($event){return _vm.onDrag($event, 'results', id)}}},[_vm._v(\"#\"+_vm._s(id))])})]:[_vm._v(\"None\")]],2),_c('p',[_c('strong',[_vm._v(\"Parameters\")]),_vm._v(\": If a variable is found in the formula which can't be resolved to a pre-defined parameter, a new parameter will be created for it. Available pre-defined parameters: \"),(_vm.pgParameters.length)?[_c('br'),_vm._l((_vm.pgParameters),function(param){return _c('kbd',{key:param.id,staticClass:\"click\",attrs:{\"draggable\":\"true\"},on:{\"click\":function($event){return _vm.emit('showProcessParameter', param)},\"dragstart\":function($event){return _vm.onDrag($event, 'pgParameters', param.name)}}},[_vm._v(_vm._s(param.name))])})]:[_vm._v(\"None\")]],2),(_vm.supportsArrayElement)?_c('p',[_vm._v(\"If the first pre-defined parameter is a (labeled) \"),_c('strong',[_vm._v(\"array\")]),_vm._v(\", the value for a specific index or label can be accessed by typing the numeric index or textual label with a \"),_c('kbd',[_vm._v(\"$\")]),_vm._v(\" in front, for example \"),_c('kbd',[_vm._v(\"$B1\")]),_vm._v(\" for the label B1 or \"),_c('kbd',[_vm._v(\"$0\")]),_vm._v(\" for the first element in the array. You can access subsequent parameters by adding additional $ characters at the beginning, e.g. \"),_c('kbd',[_vm._v(\"$$0\")]),_vm._v(\" for the first element of an array in the second parameter, \"),_c('kbd',[_vm._v(\"$$$0\")]),_vm._v(\" for the same behavior in the third parameter etc. Numeric labels are not supported.\")]):_vm._e()])],1)]},proxy:true},{key:\"footer\",fn:function(){return [_c('div',{staticClass:\"footer\"},[_c('button',{attrs:{\"type\":\"button\"},on:{\"click\":_vm.createResult}},[_vm._v(\"Insert\")])])]},proxy:true}])})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<Modal :show=\"show\" width=\"80%\" title=\"Formula Editor\" @closed=\"$emit('closed')\">\n\t\t<template #default>\n\t\t\t<div class=\"content\">\n\t\t\t\t<TextEditor ref=\"editor\" id=\"input\" class=\"editor\" v-model=\"input\" language=\"math\" placeholder=\"e.g. x * 2.5 / (x - y)\" @drop=\"onDrop\" @dragover=\"allowDrop\" />\n\t\t\t\t<div class=\"description\">\n\t\t\t\t\t<p><i  class=\"fas fa-info-circle\"></i> Above you can insert a mathematical formula and it will be converted to openEO code for you.</p>\n\t\t\t\t\t<p><strong>Operators</strong>:<br />\n\t\t\t\t\t\t<kbd v-for=\"op in operators\" :key=\"op.op\" :title=\"op.title\" @click=\"emit('showProcess', {id: op.processId})\" class=\"click\" draggable=\"true\" @dragstart=\"onDrag($event, 'operators', op.op)\">{{ op.op }}</kbd>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>Supported <strong>mathematical functions</strong>:\n\t\t\t\t\t\t<template v-if=\"mathProcesses.length\">\n\t\t\t\t\t\t\t<br /><kbd v-for=\"func in mathProcesses\" :key=\"func.id\" :title=\"func.summary\" @click=\"emit('showProcess', func)\" class=\"click\" draggable=\"true\" @dragstart=\"onDrag($event, 'functions', func)\">{{ func.id }}</kbd>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>None</template>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>Available <strong>output from processes</strong>:\n\t\t\t\t\t\t<template v-if=\"results.length\">\n\t\t\t\t\t\t\t<br /><kbd v-for=\"id in results\" :key=\"id\" draggable=\"true\" @dragstart=\"onDrag($event, 'results', id)\">#{{ id }}</kbd> <!-- ToDo: Open non-editable parameter editor or process schema -->\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>None</template>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p><strong>Parameters</strong>: If a variable is found in the formula which can't be resolved to a pre-defined parameter, a new parameter will be created for it. Available pre-defined parameters:\n\t\t\t\t\t\t<template v-if=\"pgParameters.length\">\n\t\t\t\t\t\t\t<br /><kbd v-for=\"param in pgParameters\" :key=\"param.id\" @click=\"emit('showProcessParameter', param)\" class=\"click\" draggable=\"true\" @dragstart=\"onDrag($event, 'pgParameters', param.name)\">{{ param.name }}</kbd>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template v-else>None</template>\n\t\t\t\t\t</p>\n\t\t\t\t\t<p v-if=\"supportsArrayElement\">If the first pre-defined parameter is a (labeled) <strong>array</strong>, the value for a specific index or label can be accessed by typing the numeric index or textual label with a <kbd>$</kbd> in front, for example <kbd>$B1</kbd> for the label B1 or <kbd>$0</kbd> for the first element in the array. You can access subsequent parameters by adding additional $ characters at the beginning, e.g. <kbd>$$0</kbd> for the first element of an array in the second parameter, <kbd>$$$0</kbd> for the same behavior in the third parameter etc. Numeric labels are not supported.</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t\t<template #footer>\n\t\t\t<div class=\"footer\">\n\t\t\t\t<button type=\"button\" @click=\"createResult\">Insert</button>\n\t\t\t</div>\n\t\t</template>\n\t</Modal>\n</template>\n\n<script>\nimport Modal from './Modal.vue';\nimport Utils from '../../utils.js';\nimport TextEditor from '../TextEditor.vue';\nimport EventBusMixin from '../EventBusMixin.vue';\nimport Process from '../../process';\nimport { Formula } from '@openeo/js-client';\n\nexport default {\n\tname: 'ExpressionModal',\n\tmixins: [EventBusMixin],\n\tcomponents: {\n\t\tModal,\n\t\tTextEditor\n\t},\n\tprops: {\n\t\tprocess: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({})\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow: true,\n\t\t\tinput: '',\n\t\t\tarrayElements: {},\n\t\t\tresult: {},\n\t\t\treplace: false\n\t\t};\n\t},\n\tcreated() {\n\t\ttry {\n\t\t\tthis.importFormula();\n\t\t} catch (error) {\n\t\t\tconsole.info(error);\n\t\t}\n\n\t\tthis.arrayElements = {};\n\t\tif(!this.replace) {\n\t\t\t// If not replacing: Add all array_element calls for labels to the list so that we don't get duplicate array_element calls\n\t\t\tfor(let id in this.process.getNodes()) {\n\t\t\t\tlet node = this.process.getNode(id);\n\t\t\t\tif (node.process_id === 'array_element') {\n\t\t\t\t\tlet placeholder = this.process.getArrayElementPlaceholder(node);\n\t\t\t\t\tthis.arrayElements[placeholder] = {from_node: node.id};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\t...Utils.mapGetters(['processes']),\n\t\tmathProcesses() {\n\t\t\treturn this.processes.getMathProcesses();\n\t\t},\n\t\tpgParameters() {\n\t\t\treturn this.process.getCallbackParameters();\n\t\t},\n\t\toperators() {\n\t\t\tvar ops = [];\n\t\t\tfor(var op in Formula.operatorMapping) {\n\t\t\t\tlet processId = Formula.operatorMapping[op];\n\t\t\t\tlet title = this.processes.get(processId).summary;\n\t\t\t\tops.push({op, processId, title});\n\t\t\t}\n\t\t\treturn ops;\n\t\t},\n\t\tresults() {\n\t\t\tlet resultNodes = [];\n\t\t\tfor(var id in this.process.getNodes()) {\n\t\t\t\tvar node = this.process.getNode(id);\n\t\t\t\tvar p = this.processes.get(node.process_id);\n\t\t\t\tif (Process.isMathProcess(p)) {\n\t\t\t\t\tresultNodes.push(id);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn resultNodes;\n\t\t},\n\t\tsupportsArrayElement() {\n\t\t\t// A pg parameter needs to be available\n\t\t\tif (this.pgParameters.length === 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// array_element must be supported\n\t\t\treturn this.processes.has('array_element');\n\t\t}\n\t},\n\tmethods: {\n\t\tonDrag(event, type, data) {\n\t\t\tswitch(type) {\n\t\t\t\tcase 'functions':\n\t\t\t\t\tlet params = (data.parameters || []).map(p => p.name);\n\t\t\t\t\tdata = data.id + '(' + params.join(', ') + ')';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'results':\n\t\t\t\t\tdata = '#' + data;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tevent.dataTransfer.setData(\"text/plain\", data);\n\t\t},\n\t\tallowDrop(event) {\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tonDrop(event) {\n\t\t\tvar text = event.dataTransfer.getData(\"text/plain\");\n\t\t\tif (text) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.$refs.editor.insert(text, false);\n\t\t\t}\n\t\t},\n\t\timportFormula() {\n\t\t\tlet formula = this.process.toFormulaString();\n\t\t\tif (formula) {\n\t\t\t\tthis.input = formula;\n\t\t\t\tthis.replace = true;\n\t\t\t}\n\t\t},\n\t\tcreateResult() {\n\t\t\tif (this.input.length === 0) {\n\t\t\t\tthis.show = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tthis.result = {};\n\t\t\t\tlet formula = new Formula(this.input);\n\t\t\t\tlet res = this.parseTree(formula.tree);\n\t\t\t\tif (!Utils.isObject(res) || !res.from_node) {\n\t\t\t\t\tthrow new Error('Invalid formula specified.');\n\t\t\t\t}\n\t\t\t\t// Set result node\n\t\t\t\tthis.result[res.from_node].result = true;\n\t\t\t\t// Send result\n\t\t\t\tthis.$emit('save', this.result, this.replace);\n\t\t\t\tthis.show = false;\n\t\t\t} catch(e) {\n\t\t\t\tUtils.exception(this, e);\n\t\t\t}\n\t\t},\n\t\tparseTree(tree) {\n\t\t\tlet key = Object.keys(tree)[0]; // There's never more than one property so no loop required\n\t\t\tswitch(key) {\n\t\t\t\tcase 'Number':\n\t\t\t\t\treturn Number.parseFloat(tree.Number);\n\t\t\t\tcase 'Identifier':\n\t\t\t\t\treturn this.getRef(tree.Identifier);\n\t\t\t\tcase 'Expression':\n\t\t\t\t\treturn this.parseTree(tree.Expression);\n\t\t\t\tcase 'FunctionCall':\n\t\t\t\t\tlet args = [];\n\t\t\t\t\tfor(let i in tree.FunctionCall.args) {\n\t\t\t\t\t\targs.push(this.parseTree(tree.FunctionCall.args[i]));\n\t\t\t\t\t}\n\t\t\t\t\treturn this.addProcess(tree.FunctionCall.name, args);\n\t\t\t\tcase 'Binary':\n\t\t\t\t\treturn this.addOperatorProcess(\n\t\t\t\t\t\ttree.Binary.operator,\n\t\t\t\t\t\tthis.parseTree(tree.Binary.left),\n\t\t\t\t\t\tthis.parseTree(tree.Binary.right)\n\t\t\t\t\t);\n\t\t\t\tcase 'Unary':\n\t\t\t\t\tlet val = this.parseTree(tree.Unary.expression);\n\t\t\t\t\tif (tree.Unary.operator === '-') {\n\t\t\t\t\t\tif (typeof val === 'number') {\n\t\t\t\t\t\t\treturn -val;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn this.addOperatorProcess('*', -1, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn val;\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error('Operation ' + key + ' not supported.');\n\t\t\t}\n\t\t},\n\t\tgetRef(value) {\n\t\t\t// Convert native data types\n\t\t\tif (value === 'true') {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (value === 'false') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse if (value === 'null') {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Output of a process\n\t\t\tif (typeof value === 'string' && value.startsWith('#')) {\n\t\t\t\tlet nodeId = value.substring(1);\n\t\t\t\tif (this.results.includes(nodeId)) {\n\t\t\t\t\treturn { from_node: nodeId };\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Array labels / indices\n\t\t\tif (this.supportsArrayElement && typeof value === 'string') {\n\t\t\t\tlet prefix = value.match(/^\\$+/);\n\t\t\t\tlet count = prefix ? prefix[0].length : 0;\n\t\t\t\tif (count > 0) {\n\t\t\t\t\tlet ref = value.substring(count);\n\t\t\t\t\tif (!(value in this.arrayElements)) {\n\t\t\t\t\t\t// ToDo: Check whether label is really supported - see implementation for supportsArrayElement()\n\t\t\t\t\t\tlet args = {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tfrom_parameter: this.pgParameters[count-1].name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (ref.match(/^\\d+$/)) {\n\t\t\t\t\t\t\targs.index = Number.parseInt(ref, 10);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\targs.label = ref;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.arrayElements[value] = this.addProcess(\"array_element\", args);\n\t\t\t\t\t}\n\t\t\t\t\treturn this.arrayElements[value];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Everything else is a parameter\n\t\t\tif (this.pgParameters.filter(p => p.name === value).length === 0) {\n\t\t\t\t// ToDo: Add new parameter to process\n\t\t\t}\n\t\t\treturn { from_parameter: value };\n\t\t},\n\t\taddOperatorProcess(operator, left, right) {\n\t\t\tif (typeof Formula.operatorMapping[operator] !== 'undefined') {\n\t\t\t\tlet process = this.processes.get(Formula.operatorMapping[operator]);\n\t\t\t\tlet args = {};\n\t\t\t\tif (!process || !Array.isArray(process.parameters) || process.parameters.length < 2) {\n\t\t\t\t\tthrow new Error(\"Process for operator \" + operator + \" must have at least two parameters\");\n\t\t\t\t}\n\t\t\t\targs[process.parameters[0].name || 'x'] = left;\n\t\t\t\targs[process.parameters[1].name || 'y'] = right;\n\t\t\t\treturn this.addProcess(process, args);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error('Operator ' + operator + ' not supported.');\n\t\t\t}\n\t\t},\n\t\taddProcess(process, args) {\n\t\t\tif (typeof process === 'string') {\n\t\t\t\tprocess = this.processes.get(process);\n\t\t\t}\n\n\t\t\tif (!process) {\n\t\t\t\tthrow new Error(\"Process not available: \" + name);\n\t\t\t}\n\t\t\telse if (args.length > Utils.size(process.parameters)) {\n\t\t\t\tthrow new Error(\"Number of given arguments exceeds number of process parameters for process '\" + name + \"'.\");\n\t\t\t}\n\n\t\t\t// Convert arguments array to object\n\t\t\tif (Array.isArray(args)) {\n\t\t\t\tlet namedArgs = {};\n\t\t\t\tfor (let i in args) {\n\t\t\t\t\tlet parameter = process.parameters[i];\n\t\t\t\t\tnamedArgs[parameter.name] = args[i];\n\t\t\t\t}\n\t\t\t\targs = namedArgs;\n\t\t\t}\n\t\t\t// ToDo: Check all arguments against their schemas / check all required fields are given\n\n\t\t\t// Add node to result with unique id\n\t\t\tlet nodeId = Utils.getUniqueId();\n\t\t\tlet node = {\n\t\t\t\tprocess_id: process.id,\n\t\t\t\targuments: args\n\t\t\t};\n\t\t\tthis.result[nodeId] = node;\n\t\t\treturn { from_node: nodeId };\n\t\t}\n\t}\n}\n</script>\n\n<style scoped>\n.footer {\n\ttext-align: right;\n}\n.content {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n.content .textEditor {\n\tflex-grow: 1;\n}\n.description {\n\tmargin-top: 1rem;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: flex-start;\n}\n.description p {\n\tmargin: 0.5em 0;\n}\n.editor {\n\twidth: 100%;\n\tmin-height: 4em;\n\theight: 10em;\n}\nkbd {\n\tfont-family: Consolas, \"Lucida Console\", monospace;\n\tdisplay: inline-block;\n\tborder-radius: 3px;\n\tpadding: 1px 5px;\n\tbox-shadow: 1px 1px 1px #777;\n\tmargin: 2px;\n\tfont-size: small;\n\tvertical-align: text-bottom;\n\tbackground: #eee;\n\tfont-weight: 600;\n\tcolor: #555;\n\tletter-spacing: 0.25px;\n}\nkbd.click {\n\tcursor: pointer;\n}\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ExpressionModal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ExpressionModal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ExpressionModal.vue?vue&type=template&id=2b7202fc&scoped=true&\"\nimport script from \"./ExpressionModal.vue?vue&type=script&lang=js&\"\nexport * from \"./ExpressionModal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ExpressionModal.vue?vue&type=style&index=0&id=2b7202fc&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2b7202fc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"modal\",style:({'z-index': _vm.zIndex}),on:{\"mousedown\":_vm.backgroundClose}},[_c('div',{ref:\"container\",staticClass:\"modal-container\",style:(_vm.style)},[_c('header',{staticClass:\"modal-header\",on:{\"mousedown\":_vm.startMove}},[_vm._t(\"header\",function(){return [_c('h2',[_vm._v(_vm._s(_vm.title))]),_c('span',{staticClass:\"close\",on:{\"click\":_vm.close}},[_c('i',{staticClass:\"fa fa-times\",attrs:{\"aria-hidden\":\"true\"}})])]})],2),_c('main',{staticClass:\"modal-content\"},[_vm._t(\"default\")],2),_c('footer',{staticClass:\"modal-footer\"},[_vm._t(\"footer\")],2)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\t<div class=\"modal\" @mousedown=\"backgroundClose\" :style=\"{'z-index': zIndex}\">\n\t\t<div ref=\"container\" class=\"modal-container\" :style=\"style\">\n\t\t\t<header class=\"modal-header\" @mousedown=\"startMove\">\n\t\t\t\t<slot name=\"header\">\n\t\t\t\t\t<h2>{{ title }}</h2>\n\t\t\t\t\t<span class=\"close\" @click=\"close\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></span>\n\t\t\t\t</slot>\n\t\t\t</header>\n\t\t\t<main class=\"modal-content\">\n\t\t\t\t<slot></slot>\n\t\t\t</main>\n\t\t\t<footer class=\"modal-footer\">\n\t\t\t\t<slot name=\"footer\"></slot>\n\t\t\t</footer>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport EventBusMixin from '../EventBusMixin.vue';\nimport Utils from '../../utils.js';\n\nexport default {\n\tname: 'Modal',\n\tmixins: [EventBusMixin],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\tminWidth: {\n\t\t\ttype: String,\n\t\t\tdefault: null\n\t\t},\n\t\twidth: {\n\t\t\ttype: String,\n\t\t\tdefault: \"auto\"\n\t\t},\n\t\tshow: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tzIndex: 1000,\n\t\t\tposition: null,\n\t\t\tdragPosition: null\n\t\t};\n\t},\n    computed: {\n\t\t...Utils.mapState('editor', ['hightestModalZIndex']),\n\t\tstyle() {\n\t\t\tlet style = {\n\t\t\t\t'width': this.width\n\t\t\t};\n\t\t\tif (this.minWidth) {\n\t\t\t\tstyle['min-width'] = this.minWidth;\n\t\t\t}\n\t\t\tif (Array.isArray(this.position)) {\n\t\t\t\tstyle.position = 'absolute';\n\t\t\t\tstyle.left = this.position[0] + 'px';\n\t\t\t\tstyle.top = this.position[1] + 'px';\n\t\t\t}\n\t\t\treturn style;\n\t\t}\n    },\n\twatch: {\n\t\tshow: {\n\t\t\timmediate: true,\n\t\t\thandler(show) {\n\t\t\t\tif (!show) {\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.open();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\t...Utils.mapMutations('editor', ['openModal', 'closeModal']),\n\t\topen() {\n\t\t\tthis.openModal();\n\t\t\tthis.zIndex = this.hightestModalZIndex;\n\t\t\twindow.addEventListener('keydown', this.escCloseListener);\n\t\t\tthis.$emit('shown');\n\t\t},\n\t\tclose() {\n\t\t\twindow.removeEventListener('keydown', this.escCloseListener);\n\t\t\tthis.closeModal();\n\t\t\tthis.$emit('closed');\n\t\t},\n\t\tstartMove(event) {\n\t\t\tif (event.target.tagName !== 'H2') {\n\t\t\t\tthis.dragPosition = [\n\t\t\t\t\tevent.clientX,\n\t\t\t\t\tevent.clientY\n\t\t\t\t];\n\n\t\t\t\tdocument.addEventListener('mousemove', this.move);\n\t\t\t\tdocument.addEventListener('mouseup', this.stopMove);\n\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tstopMove() {\n\t\t\tdocument.removeEventListener('mousemove', this.move);\n\t\t\tdocument.removeEventListener('mouseup', this.stopMove);\n\t\t},\n\t\tmove(event) {\n      \t\tevent.preventDefault();\n\t\t\t// set the element's new position\n\t\t\tthis.position = [\n\t\t\t\tthis.$refs.container.offsetLeft - (this.dragPosition[0] - event.clientX),\n\t\t\t\tthis.$refs.container.offsetTop - (this.dragPosition[1] - event.clientY)\n\t\t\t];\n\t\t\t// Store for later\n\t\t\tthis.dragPosition = [\n\t\t\t\tevent.clientX,\n\t\t\t\tevent.clientY\n\t\t\t];\n\t\t},\n\t\tescCloseListener(event) {\n\t\t\tif (event.key == \"Escape\") { \n\t\t\t\tthis.close();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tbackgroundClose(event) {\n\t\t\tif (event.target === this.$el) {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n\n<style lang=\"scss\">\n@import '../../../theme.scss';\n\n.modal {\n    position: fixed;\n    z-index: 1000; /* Snotify has 9999 and is intentionally above the modals */\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0,0,0,0.4);\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.modal .modal-container {\n    background-color: #fff;\n    border: 1px solid #fff;\n\tmin-height: 50vh;\n\tmin-width: 300px;\n\twidth: 70%;\n\tmax-height: 96%;\n\tmax-width: 96%;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbox-shadow: 8px 8px 8px 0px rgba(0,0,0,0.3);\n\tresize: both;\n\toverflow: hidden;\n}\n\n.modal .modal-header {\n\tbackground-color: $mainColor;\n\tcolor: white;\n\tmargin: 0;\n\theight: 1.5rem;\n\tpadding: 1rem;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n    cursor: move;\n}\n\n.modal .modal-header h2 {\n\tdisplay: inline-block;\n\tmargin: 0;\n\tmargin-left: -0.5rem;\n\tpadding: 0.5rem;\n\tfont-size: 1.5rem;\n\tborder: 0;\n\tcursor: text;\n\ttext-overflow: ellipsis;\n    overflow: hidden;\n}\n\n.modal .modal-content {\n    padding: 1rem;\n\toverflow: auto;\n\tflex-grow: 1;\n}\n\n.modal .inline .modal-content {\n\tpadding: 0;\n}\n\n.modal .modal-footer:empty {\n\tdisplay: none;\n}\n\n.modal .modal-footer {\n\tbackground-color: #eee;\n\tmargin: 0;\n\tpadding: 1rem;\n}\n\n.modal .close {\n\tfont-size: 1.5rem;\n\theight: 2rem;\n\twidth: 2rem;\n    color: white;\n    cursor: pointer;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n\n.modal .close:hover, .modal .close:focus {\n    color: red;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Modal.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Modal.vue?vue&type=template&id=4920e25e&\"\nimport script from \"./Modal.vue?vue&type=script&lang=js&\"\nexport * from \"./Modal.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Modal.vue?vue&type=style&index=0&id=4920e25e&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","attrs","show","on","$event","$emit","scopedSlots","_u","key","fn","staticClass","ref","onDrop","allowDrop","model","value","input","callback","$$v","expression","_v","_l","operators","op","title","emit","id","processId","onDrag","_s","mathProcesses","length","func","summary","results","pgParameters","param","name","supportsArrayElement","_e","proxy","createResult","staticRenderFns","mixins","components","Modal","TextEditor","props","process","type","default","data","arrayElements","result","replace","created","console","from_node","computed","ops","resultNodes","methods","event","importFormula","Utils","parseTree","args","tree","getRef","from_parameter","addOperatorProcess","addProcess","namedArgs","process_id","arguments","component","style","zIndex","backgroundClose","startMove","_t","close","minWidth","width","position","dragPosition","watch","immediate","handler","open","window","document","stopMove","move","escCloseListener"],"sourceRoot":""}