{"version":3,"file":"js/8221.fdfae280.js","mappings":"yKAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,QAAQ,CAACE,MAAM,CAAC,MAAQ,MAAM,MAAQ,yBAAyBC,GAAG,CAAC,OAAS,SAASC,GAAQ,OAAON,EAAIO,MAAM,SAAS,IAAI,CAACL,EAAG,UAAU,CAACM,YAAY,cAAc,CAACN,EAAG,KAAK,CAACF,EAAIS,GAAG,iCAAiCP,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOb,EAAIc,SAAUC,WAAW,aAAaX,MAAM,CAAC,KAAO,QAAQ,GAAK,KAAK,MAAQ,cAAcY,SAAS,CAAC,QAAUhB,EAAIiB,GAAGjB,EAAIc,SAAS,eAAeT,GAAG,CAAC,OAAS,SAASC,GAAQN,EAAIc,SAAS,YAAY,KAAKZ,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,OAAO,CAACJ,EAAIS,GAAG,gBAAgBP,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOb,EAAIc,SAAUC,WAAW,aAAaX,MAAM,CAAC,KAAO,QAAQ,GAAK,KAAK,MAAQ,UAAUY,SAAS,CAAC,QAAUhB,EAAIiB,GAAGjB,EAAIc,SAAS,WAAWT,GAAG,CAAC,OAAS,SAASC,GAAQN,EAAIc,SAAS,QAAQ,KAAKZ,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,OAAO,CAACJ,EAAIS,GAAG,YAAYP,EAAG,QAAQ,CAACQ,WAAW,CAAC,CAACC,KAAK,QAAQC,QAAQ,UAAUC,MAAOb,EAAIc,SAAUC,WAAW,aAAaX,MAAM,CAAC,KAAO,QAAQ,GAAK,IAAI,MAAQ,KAAKY,SAAS,CAAC,QAAUhB,EAAIiB,GAAGjB,EAAIc,SAAS,MAAMT,GAAG,CAAC,OAAS,SAASC,GAAQN,EAAIc,SAAS,GAAG,KAAKZ,EAAG,QAAQ,CAACE,MAAM,CAAC,IAAM,MAAM,CAACJ,EAAIS,GAAG,OAAOP,EAAG,KAAK,CAACF,EAAIS,GAAG,oBAAqBT,EAAIkB,MAAOhB,EAAG,MAAM,CAACM,YAAY,iBAAiB,CAACN,EAAG,IAAI,CAACM,YAAY,8BAA8BN,EAAG,OAAO,CAACF,EAAIS,GAAG,mEAAmEP,EAAG,MAAMA,EAAG,KAAK,CAACF,EAAIS,GAAGT,EAAImB,GAAGnB,EAAIkB,cAAc,CAAChB,EAAG,MAAM,CAACM,YAAY,mBAAmB,CAACN,EAAG,IAAI,CAACM,YAAY,oBAAoBN,EAAG,OAAO,CAACF,EAAIS,GAAG,qCAAqCP,EAAG,SAAS,CAACF,EAAIS,GAAG,kBAAkBT,EAAIS,GAAG,sQAAsQP,EAAG,aAAa,CAACkB,IAAI,SAAShB,MAAM,CAAC,GAAKJ,EAAIc,SAAS,MAAQd,EAAIc,SAAS,MAAQd,EAAIqB,KAAK,SAAWrB,EAAIc,SAAS,UAAW,GAAOQ,YAAYtB,EAAIuB,GAAG,CAAC,CAACC,IAAI,eAAeC,GAAG,WAAW,MAAO,CAACvB,EAAG,SAAS,CAACE,MAAM,CAAC,KAAO,SAAS,MAAQ,iBAAiBC,GAAG,CAAC,MAAQL,EAAI0B,WAAW,CAACxB,EAAG,IAAI,CAACM,YAAY,sBAAsB,EAAEmB,OAAM,SAAY,IACluE,EACIC,EAAkB,G,iECEtB,MAAMC,EAAW,CAChB,MAAO,KAAM,SAAU,QAAS,QAAS,WAAY,MAAO,MAAO,OACnE,OAAQ,SAAU,OAAQ,UAAW,MAAO,OAAQ,SAAU,KAAM,SACpE,KAAM,KAAM,SAAU,MAAO,KAAM,OAAQ,QAAS,QAAS,SAAU,MACvE,QAAS,OAAQ,QAEjB,SAAU,aAAc,UAAW,WAGrB,MAAMC,UAAeC,EAAAA,EAEnCC,0BAAAA,CAA2BC,GAC1B,IAAIC,EAAK,IAAIJ,EAAOG,EAAShC,KAAKkC,gBAAiBlC,KAAKmC,0BACxD,OAAOnC,KAAKoC,mCAAmCH,EAChD,CAEAI,WAAAA,GACC,OAAOT,CACR,CAEAU,OAAAA,CAAQA,GACPtC,KAAKuC,QAAQD,EAAS,KACvB,CAEAE,eAAAA,GACCxC,KAAKuC,QAAQ,iBACbvC,KAAKuC,QAAQ,uCACd,CAEAE,kBAAAA,GACCzC,KAAKuC,QAAQ,gCAAgCvC,KAAK0C,mBACnD,CAEAC,sBAAAA,GACC3C,KAAKsC,QAAQ,uFACd,CAEAM,eAAAA,GAAmB,CAEnBC,qBAAAA,CAAsBtB,EAAKX,GAC1BZ,KAAKsC,QAAQ,GAAGf,MAAQvB,KAAK8C,EAAElC,KAChC,CAEAmC,QAAAA,GACC,MAAO,MACR,CACAC,WAAAA,CAAYC,GACX,OAAOA,EAAM,OAAS,OACvB,CAEAC,MAAAA,GACC,MAAO,MACR,CAEAC,oBAAAA,CAAqBC,GACpB,OAAOC,QAAQC,OAAOC,OAAOH,EAAKI,WAAWC,MAAKC,GAAOA,aAAe7B,IACzE,CAEA,sBAAM8B,CAAiBP,GACtB,IACIQ,EADAC,EAAW7D,KAAK8D,IAAIV,EAAKW,GAAI/D,KAAKgE,aAElCC,GAAwB,EACxBC,EAAe,KACnB,GAAId,EAAKe,YACRP,EAAc,cAEV,CACJ,IAAIQ,EAAahB,EAAKiB,kBAAkBC,kBACxC,GAAIF,EAAWG,SAASnB,EAAKW,IACJ,oBAApBX,EAAKoB,YACRZ,EAAc,6BAEdR,EAAKI,UAAYF,OAAOmB,OAAO,CAACC,cAAetB,EAAKI,UAAUO,IAAKY,EAAAA,EAAMC,eAAexB,EAAKI,UAAW,CAAC,QACzGS,GAAwB,GAGxBL,EAAc,uCAGX,CACJ,IAAIiB,EAAYzB,EAAK0B,mBACjBC,EAAS/E,KAAK8D,IAAIe,EAAU,GAAGd,GAAI/D,KAAKgE,aAGxChE,KAAKmD,qBAAqBC,IAA6B,gBAApBA,EAAKoB,YAC3CZ,EAAc,GAAGmB,KAAU3B,EAAKoB,aAChCP,GAAwB,EAGxBC,EAAeA,CAAC3C,EAAKX,IAAU+D,EAAAA,EAAMK,SAASpE,IAAUA,EAAMqE,WAAajF,KAAK8D,IAAIlD,EAAMqE,UAAWjF,KAAKgE,eAAiBe,GAG3HnB,EAAc,GAAGmB,WAEnB,CACD,CACA,IAAIG,QAAalF,KAAKmF,kBAAkB/B,GAAM,EAAOc,GACjDd,EAAKgC,YACRF,EAAKE,UAAYpF,KAAKqF,WAAWjC,EAAKgC,YAEvCF,EAAOP,EAAAA,EAAMW,UAAUJ,GAAM,CAACtE,EAAOF,IAAS,GAAGA,OAAUV,KAAK8C,EAAElC,OAC9DqD,GACHiB,EAAKK,QAAQvF,KAAKqF,WAAWjC,EAAKoB,aAGnCxE,KAAKsC,QAAQc,EAAKoC,aAClBxF,KAAKuC,QAAQ,GAAGsB,OAAcD,KAAesB,EAAKO,KAAK,SACxD,CAEAC,wBAAAA,CAAyBC,GACxB3F,KAAKsC,QAAQqD,EAAUH,aACvB,IAAII,EAAY5F,KAAK8D,IAAI6B,EAAUjF,KAAM,SACrCE,EAAqC,qBAAtB+E,EAAUE,QAA0BF,EAAUE,QAAU,KAC3E7F,KAAKuC,QAAQ,GAAGqD,OAAe5F,KAAK8C,EAAElC,KACvC,CAEA,sBAAMkF,CAAiBC,EAAUC,EAAYnC,GAC5C,IAAIoC,EAASjG,KAAKkG,uBAAuBF,GACnB,IAAlBC,EAAOE,QACVF,EAAOG,KAAK,WAEbpG,KAAKqG,UACLrG,KAAKuC,QAAQ,OAAOsB,KAAYoC,EAAOR,KAAK,WAC5CzF,KAAKuC,cAAcwD,EAASO,QAAO,GAAO,GAAI,GAC9CtG,KAAKqG,SACN,CAEAE,cAAAA,CAAeC,EAAYT,GAC1B,IAAKS,EACJ,OAED,IAAI3C,EAAW7D,KAAK8D,IAAI0C,EAAWzC,GAAI/D,KAAKgE,aACxC+B,EACH/F,KAAKuC,QAAQ,UAAUsB,KAGvB7D,KAAKuC,QAAQ,+BAA+BsB,KAE9C,EC3ID,MAAMjC,EAAW,CAChB,KAAM,OAAQ,SAAU,QAAS,WAAY,MAAO,KAAM,OAAQ,QAClE,OAAQ,QAAS,OAAQ,MAAO,MAAO,KAAM,cAAe,WAAY,cAAe,gBAEvF,SAAU,UAAW,aAAc,WAAY,IAAK,kBAGtC,MAAM6E,UAAU3E,EAAAA,EAE9BC,0BAAAA,CAA2BC,GAC1B,IAAIC,EAAK,IAAIwE,EAAEzE,EAAShC,KAAKkC,gBAAiBlC,KAAKmC,0BACnD,OAAOnC,KAAKoC,mCAAmCH,EAChD,CAEAI,WAAAA,GACC,OAAOT,CACR,CAEAmB,QAAAA,GACC,MAAO,MACR,CACAC,WAAAA,CAAYC,GACX,OAAOA,EAAM,OAAS,OACvB,CACAyD,SAAAA,CAAUC,GACT,MAAO,QAAQA,EAAIlB,KAAK,QACzB,CACAmB,UAAAA,CAAWC,GACV,IAAIF,EAAMhC,EAAAA,EAAMW,UAAUuB,GAAK,CAAC5D,EAAK1B,IAAQ,GAAGvB,KAAKqF,WAAW9D,QAAU0B,MAC1E,MAAO,QAAQ0D,EAAIlB,KAAK,QACzB,CAEAnD,OAAAA,CAAQA,GACPtC,KAAKuC,QAAQD,EAAS,KACvB,CAEAE,eAAAA,GACCxC,KAAKuC,QAAQ,kBACd,CAEAE,kBAAAA,GACCzC,KAAKuC,QAAQ,gCAAgCvC,KAAK0C,mBACnD,CAEAC,sBAAAA,GACC3C,KAAKsC,QAAQ,oCACd,CAEAM,eAAAA,GACC5C,KAAKuC,QAAQ,kBACd,CAEAM,qBAAAA,CAAsBtB,EAAKX,GAC1BZ,KAAKsC,QAAQ,GAAGf,MAAQvB,KAAK8C,EAAElC,KAChC,CAEA,sBAAM+C,CAAiBP,GACtB,IAAIS,EAAW7D,KAAK8D,IAAIV,EAAKW,GAAI/D,KAAKgE,aAClCkB,QAAalF,KAAKmF,kBAAkB/B,GACxC,GAAIA,EAAKgC,UACR,MAAM,IAAI0B,MAAM,yDAIjB5B,EAAOP,EAAAA,EAAMW,UAAUJ,GAAM,CAACtE,EAAOF,IAAS,GAAGA,OAAUV,KAAK8C,EAAElC,OAElEZ,KAAKsC,QAAQc,EAAKoC,aAClBxF,KAAKuC,QAAQ,GAAGsB,SAAgBT,EAAKoB,cAAcU,EAAKO,KAAK,SAC9D,CAEAC,wBAAAA,CAAyBC,GACxB3F,KAAKsC,QAAQqD,EAAUH,aACvB,IAAII,EAAY5F,KAAK8D,IAAI6B,EAAUjF,KAAM,SACrCE,EAAqC,qBAAtB+E,EAAUE,QAA0BF,EAAUE,QAAU,KAC3E7F,KAAKuC,QAAQ,GAAGqD,OAAe5F,KAAK8C,EAAElC,KACvC,CAEA,sBAAMkF,CAAiBC,EAAUC,EAAYnC,GAC5C,IAAIkD,GAAgB,EACpB,GAAIA,OAGC,CACJ,IAAId,EAASjG,KAAKkG,uBAAuBF,GACzChG,KAAKqG,UACLrG,KAAKuC,QAAQ,GAAGsB,gBAAuBoC,EAAOR,KAAK,YACnDzF,KAAKuC,cAAcwD,EAASO,QAAO,GAAO,GAAI,GAC9CtG,KAAKuC,QAAQ,IACd,CACD,CAEAgE,cAAAA,CAAeC,EAAYT,GAC1B,IAAKS,EACJ,OAED,IAAI3C,EAAW7D,KAAK8D,IAAI0C,EAAWzC,GAAI/D,KAAKgE,aACxC+B,EACH/F,KAAKuC,QAAQ,UAAUsB,MAGvB7D,KAAKuC,QAAQ,mCAAmCsB,KAElD,EClED,SACAnD,KAAA,kBACAsG,WAAA,CACAC,MAAA,IACAC,WAAAA,EAAAA,GAEAC,IAAAA,GACA,OACAtG,SAAA,aACAO,KAAA,GACAH,MAAA,KAEA,EACAmG,SAAA,IACAzC,EAAAA,EAAA0C,SAAA,mBACA1C,EAAAA,EAAA0C,SAAA,yBACA1C,EAAAA,EAAA2C,WAAA,+BAEAC,MAAA,CACA1G,SAAA,CACA2G,WAAA,EACA,aAAAC,GACA,IACA,IAAAC,EACA,uBAAA7G,SACA6G,EAAA,IAAAC,EAAAA,EAAA,KAAA3F,QAAA,KAAA4F,UAAA,KAAAC,WAAA,KAAAC,mBAEA,mBAAAjH,SACA6G,EAAA,IAAA7F,EAAA,KAAAG,QAAA,KAAA4F,UAAA,KAAAC,gBAEA,eAAAhH,SAIA,UAAAiG,MAAA,6CAHAY,EAAA,IAAAjB,EAAA,KAAAzE,QAAA,KAAA4F,UAAA,KAAAC,WAIA,CACA,KAAAzG,KAAAsG,QAAAA,EAAApB,SAAA,GACA,KAAArF,MAAA,IACA,OAAAA,GACA,KAAAG,KAAA,GACA,KAAAH,MAAAA,aAAA6F,MAAA7F,EAAA8G,QAAA9G,CACA,CACA,IAGA+G,QAAA,CACAvG,QAAAA,GACA,IAAAwG,EACA,oBAAApH,SACAoH,EAAA,UAEA,gBAAApH,SACAoH,EAAA,UAEA,WAAApH,WACAoH,EAAA,UAEAC,EAAAA,OAAAC,YAAAC,WAAA,KAAAhH,KAAA6G,EACA,ICjGuQ,I,eCQnQI,GAAY,OACd,EACAvI,EACA6B,GACA,EACA,KACA,KACA,MAIF,QAAe0G,EAAiB,O,4DChBhC,MAAMC,UAAoBC,EAAAA,YACzBC,WAAAA,CAAYxG,EAAS0F,GACpBe,MAAMzG,GACNhC,KAAK0H,SAAWA,CACjB,CACA,aAAMgB,CAAQtF,SACPpD,KAAK0H,SAAS/D,iBAAiBP,EACtC,EAGc,MAAMtB,UAAiB6G,EAAAA,aAErCH,WAAAA,CAAYxG,EAAS4G,EAAUf,GAC9BY,MAAM9D,EAAAA,EAAMK,SAAShD,GAAWA,EAAU,CAAC,EAAG4G,GAC9C5I,KAAK6H,WAAaA,EAClB7H,KAAKoB,KAAO,GACZpB,KAAK6I,UAAY,EACjB7I,KAAK8I,aACL9I,KAAK+I,yBACN,CAIAhH,0BAAAA,CAA2BC,GAC1B,IAAIC,EAAK,IAAIH,EAASE,EAAShC,KAAKkC,gBAAiBlC,KAAKmC,0BAC1D,OAAOnC,KAAKoC,mCAAmCH,EAChD,CAEAG,kCAAAA,CAAmCH,GAGlC,OAFAA,EAAKwG,MAAMrG,mCAAmCH,GAC9CA,EAAG4F,WAAa7H,KAAK6H,WACd5F,CACR,CAEA+G,qBAAAA,CAAsBhH,GACrB,OAAO,IAAIsG,EAAYtG,EAAShC,KACjC,CAEAiJ,SAAAA,CAAUC,GACT,OAAOlJ,KAAKqC,cAAckC,SAAS2E,EAAQC,cAC5C,CAIA9G,WAAAA,GACC,MAAO,EACR,CAEAC,OAAAA,GAAsB,CAEtBE,eAAAA,GAAmB,CAEnBC,kBAAAA,GAAsB,CAEtBE,sBAAAA,GAA0B,CAE1BC,eAAAA,GAAmB,CAEnBwG,gBAAAA,GAAkC,CAElC1D,wBAAAA,GAA4B,CAE5B,sBAAM/B,GAA4B,CAElCuC,sBAAAA,CAAuBF,GACtB,OAAOA,EAAWqD,KAAIC,GACI,qBAAdA,EAAEzD,QACL,GAAGyD,EAAE5I,UAAUV,KAAK8C,EAAEwG,EAAEzD,WAGxByD,EAAE5I,MAGZ,CAEA,sBAAMoF,GAAsD,CAE5DS,cAAAA,GAA0C,CAE1CxD,QAAAA,GACC,MAAO,MACR,CACAC,WAAAA,CAAYC,GACX,OAAOA,EAAM,OAAS,OACvB,CACAyD,SAAAA,CAAUC,GACT,MAAO,IAAIA,EAAIlB,KAAK,QACrB,CACAmB,UAAAA,CAAWC,GACV,IAAIF,EAAMhC,EAAAA,EAAMW,UAAUuB,GAAK,CAAC5D,EAAK1B,IAAQ,GAAGvB,KAAKqF,WAAW9D,OAAS0B,MACzE,MAAO,IAAI0D,EAAIlB,KAAK,QACrB,CACAJ,UAAAA,CAAWkE,GACV,OAAOC,KAAKC,UAAUF,EACvB,CACAG,UAAAA,CAAWC,GACV,OAAOA,CACR,CAIA7G,CAAAA,CAAElC,GACD,OAAc,OAAVA,EACIZ,KAAK+C,WAEa,mBAAVnC,EACRZ,KAAKgD,YAAYpC,GAEC,kBAAVA,EACRZ,KAAK0J,WAAW9I,GAEE,kBAAVA,EACRZ,KAAKqF,WAAWzE,GAEfgJ,MAAMC,QAAQjJ,GACfZ,KAAK0G,UAAU9F,EAAMyI,KAAIpG,GAAOjD,KAAK8C,EAAEG,MAEtC0B,EAAAA,EAAMK,SAASpE,GAChBZ,KAAK4G,WAAWjC,EAAAA,EAAMmF,gBAAgBlJ,GAAOqC,GAAOjD,KAAK8C,EAAEG,MAEzC,oBAAVrC,EACRA,IAGAZ,KAAK+C,UAEd,CAEAqG,gBAAAA,GACC,IAAIW,GAAa,EACjB,IAAI,IAAIxI,KAAOvB,KAAKgC,QAAS,CAC5B,GAAY,kBAART,EACH,SAED,IAAI0B,EAAMjD,KAAKgC,QAAQT,GACnBqI,MAAMC,QAAQ5G,IAAuB,IAAfA,EAAIkD,SAGN,kBAARlD,GAAmC,IAAfA,EAAIkD,SAGhB,mBAARlD,GAAsBA,KAGjC8G,IACJ/J,KAAKqG,UACLrG,KAAKsC,QAAQ,oCACbyH,GAAa,GAEd/J,KAAK6C,sBAAsBtB,EAAK0B,IACjC,CACD,CAEA,sBAAM+G,CAAiB9E,EAAM+E,EAAYC,GACxC,IAAIC,EAAUP,MAAMC,QAAQ3E,GAAQ,GAAK,CAAC,EAC1C,IAAI,IAAI3D,KAAO2D,EAAM,CACpB,IAAItE,EAAQsE,EAAK3D,GACjB,IAAI2I,IAAUA,EAAO3I,EAAKX,GAG1B,GAAI+D,EAAAA,EAAMK,SAASpE,GAAQ,CAC1B,GAAIA,EAAMqE,UAAW,CACpBkF,EAAQ5I,GAAO,IAAMvB,KAAK8D,IAAIlD,EAAMqE,UAAWjF,KAAKgE,aACpD,QACD,CACK,GAAIpD,EAAMwJ,eAAgB,CAC9BD,EAAQ5I,GAAO,IAAMvB,KAAK8D,IAAIlD,EAAMwJ,gBACpC,QACD,CACK,GAAIxJ,aAAiBkB,EAAU,CACnC,IAAIuI,QAAeJ,EAAW1I,GAC9B4I,EAAQ5I,GAAO,IAAM8I,EACrB,QACD,CAECF,EAAQ5I,SAAavB,KAAKgK,iBAAiBpJ,EAAOqJ,EAAYC,EAEhE,MACSN,MAAMC,QAAQjJ,GACtBuJ,EAAQ5I,SAAavB,KAAKgK,iBAAiBpJ,EAAOqJ,EAAYC,GAG9DC,EAAQ5I,GAAOX,CAEjB,CACA,OAAOuJ,CACR,CAEA,qBAAMG,CAAgBlH,EAAM7B,GAC3B,IAAIwE,EACJ,GAAwB,oBAApB3C,EAAKoB,WAAkC,CAC1C,IAAI+F,EAAanH,EAAKoH,YAAY,cAClCzE,EAAWwE,EAAWhJ,EACvB,MAECwE,EAAW3C,EAAKoH,YAAYjJ,GAE7B,IAAIyE,EAAaD,EAAS0E,8BACpB1E,EAAS2C,QAAQ1C,GACvB,IAAIqE,EAASrK,KAAK8D,IAAI,GAAGvC,IAAMvB,KAAK6I,cAAe,OAC/C6B,QAAoB1K,KAAK8F,iBAAiBC,EAAUC,EAAYqE,GACpE,OAAOK,GAA4BL,CACpC,CAEA,uBAAMlF,CAAkB/B,EAAMuH,GAAU,EAAOT,EAAS,MACvD,IAAIhF,QAAalF,KAAKgK,iBAAiB5G,EAAKI,WAAWoH,eAAmB5K,KAAKsK,gBAAgBlH,EAAM7B,IAAM2I,GAI3G,OAHIS,IACHzF,EAAOlF,KAAK6K,eAAezH,EAAM8B,IAE3BA,CACR,CAEA2F,cAAAA,CAAezH,EAAM8B,GACpB,IAAIlD,EAAUoB,EAAKiB,kBAAkByG,WAAW1H,GAChD,GAAIpB,GAAW4H,MAAMC,QAAQ7H,EAAQgE,YAAa,CACjD,IAAI+E,EAAc/I,EAAQgE,WAAWqD,KAAI2B,GACR,qBAArB9F,EAAK8F,EAAMtK,MACdwE,EAAK8F,EAAMtK,MAETsK,EAAMC,cAIf,EAHO,OAMLC,GAAoB,EACxB,IAAI,IAAIC,EAAIJ,EAAY5E,OAAO,EAAGgF,GAAK,EAAGA,IACX,qBAAnBJ,EAAYI,GAClBD,EACHH,EAAYI,GAAK,KAGjBJ,EAAYK,MAIbF,GAAoB,EAGtB,OAAOH,CACR,CACD,CAEA/G,SAAAA,GACC,OAAKhE,KAAKmE,YAIF,OAHA,UAKT,CAEAL,IAAIC,EAAIsH,EAAS,OAEhB,OADAtH,EAAKuH,OAAOvH,GACR/D,KAAKiJ,UAAUlF,GACX,GAAGA,KAENA,EAAGwH,MAAM,eAINxH,EAHAsH,EAAStH,EAAGyH,QAAQ,UAAW,IAKxC,CAEAtI,MAAAA,GACC,MAAO,IACR,CAEAX,OAAAA,CAAQnB,EAAMiK,EAAS,GAAII,EAAQ,GAClC,GAAoB,kBAATrK,EACV,OAED,IAAIsK,EAAO1L,KAAKkD,SAASyI,OAAOF,GAC5BG,EAAQxK,EAAKyK,OAAOC,MAAM,eAC9B,IAAI,IAAIC,KAAQH,EACf5L,KAAKoB,KAAKgF,KAAK,GAAGsF,IAAOL,IAASU,MAEpC,CAEA1F,OAAAA,CAAQ2F,EAAQ,GACf,IAAI,IAAIb,EAAI,EAAGA,EAAIa,EAAOb,IACzBnL,KAAKuC,QAAQ,GAEf,CAEAG,YAAAA,GACC,OAAO1C,KAAK6H,WAAWoE,QACxB,CAEA,YAAM3F,CAAOP,GAAW,GACvB/F,KAAKoB,KAAO,GACP2E,IACJ/F,KAAKsC,QAAQ,4BACbtC,KAAKwC,kBACLxC,KAAKqG,UACLrG,KAAKsC,QAAQ,2BACbtC,KAAKyC,qBACLzC,KAAK2C,yBACL3C,KAAKqG,UACLrG,KAAK4C,kBACL5C,KAAKoJ,mBACLpJ,KAAKqG,WAEN,IAAIJ,EAASjG,KAAKkM,uBAClB,GAAIjG,EAAOE,OAAS,EAAG,CACtBnG,KAAKsC,QAAQ,wDACb,IAAI,IAAI0I,KAAS/E,EAChBjG,KAAK0F,yBAAyBsF,GAE/BhL,KAAKqG,SACN,CAOA,aANMrG,KAAK0I,UACN3C,IACJ/F,KAAKqG,UACLrG,KAAKsC,QAAQ,8FAEdtC,KAAKuG,eAAevG,KAAKmM,gBAAiBpG,GACnC/F,KAAKoB,KAAKqE,KAAK,IAAIoG,MAC3B,CAEA,aAAMnD,GAIL,aAHM1I,KAAKoM,WACXpM,KAAKqM,cACCrM,KAAKsM,aAAatM,KAAKuM,iBACtBvM,KAAKmM,eACb,CAEAK,MAAAA,GAKC,MAJ4B,qBAAjBxM,KAAKyM,UAEfzM,KAAKyM,QAAUzM,KAAKkC,gBAAgBsK,OAAOxM,OAErCA,KAAKyM,OACb,E,uEC9UD,MAAM7K,EAAW,CAChB,WACA,YACA,QACA,UACA,QACA,OACA,OACA,QACA,OACA,QACA,QACA,WACA,WACA,UACA,SACA,KACA,SACA,OACA,OACA,OACA,SACA,UACA,QACA,QACA,UACA,QACA,MACA,WACA,OACA,KACA,aACA,SACA,KACA,aACA,MACA,YACA,MACA,OACA,SACA,MACA,OACA,UACA,UACA,YACA,SACA,SACA,QACA,SACA,QACA,SACA,eACA,OACA,QACA,SACA,YACA,OACA,MACA,SACA,MACA,OACA,WACA,QACA,OACA,QAEA,UACA,aACA,UACA,SACA,UAGc,MAAM+F,UAAmB7F,EAAAA,EAEvC0G,WAAAA,CAAYxG,EAAS4G,EAAUf,EAAY6E,GAAkB,GAC5DjE,MAAMzG,EAAS4G,EAAUf,GACzB7H,KAAK0M,gBAAkBA,CACxB,CAEA3K,0BAAAA,CAA2BC,GAC1B,IAAIC,EAAK,IAAI0F,EAAW3F,EAAShC,KAAKkC,gBAAiBlC,KAAKmC,yBAA0BnC,KAAK0M,iBAC3F,OAAO1M,KAAKoC,mCAAmCH,EAChD,CAEA0K,KAAAA,GACK3M,KAAK4M,QAGTnE,MAAMkE,OACP,CAEAtK,WAAAA,GACC,OAAOT,CACR,CAEAU,OAAAA,CAAQA,GACPtC,KAAKuC,QAAQD,EAAS,MACvB,CAEAE,eAAAA,GACCxC,KAAKuC,QAAQ,uDACd,CAEAE,kBAAAA,GACCzC,KAAKuC,QAAQ,0CAA0CvC,KAAK0C,oBAC7D,CAEAC,sBAAAA,GACC3C,KAAKsC,QAAQ,uDACd,CAEAM,eAAAA,GACC5C,KAAKuC,QAAQ,iDACd,CAEAM,qBAAAA,CAAsBtB,EAAKX,GAC1BZ,KAAKuC,QAAQ,WAAWhB,OAASvB,KAAK8C,EAAElC,MACzC,CAEA,sBAAM+C,CAAiBP,GACtB,IAAIQ,EAAcR,EAAKe,YAAc,OAAS,UAC1CN,EAAW7D,KAAK8D,IAAIV,EAAKW,GAAI/D,KAAKgE,aAClCkB,QAAalF,KAAKmF,kBAAkB/B,GAAOA,EAAKgC,WAGpD,GADApF,KAAKsC,QAAQc,EAAKoC,aACdb,EAAAA,EAAMK,SAASE,GAAO,CACzB,IAAI2H,EAAYzJ,EAAKgC,UAAY,GAAGhC,EAAKoB,cAAcpB,EAAKgC,YAAchC,EAAKoB,WAC/ExE,KAAKuC,QAAQ,OAAOsB,OAAcD,cAAwBiJ,OAAe7M,KAAK8C,EAAEoC,OACjF,MAEClF,KAAKuC,QAAQ,OAAOsB,OAAcD,KAAeR,EAAKoB,cAAcU,EAAKmE,KAAI3F,GAAO1D,KAAK8C,EAAEY,KAAM+B,KAAK,UAExG,CAEAC,wBAAAA,CAAyBC,GACxB3F,KAAKsC,QAAQqD,EAAUH,aACvB,IAAII,EAAY5F,KAAK8D,IAAI6B,EAAUjF,KAAM,SACrCE,EAAqC,qBAAtB+E,EAAUE,QAA0BF,EAAUE,QAAU,KAC3E7F,KAAKuC,QAAQ,OAAOqD,OAAe5F,KAAK8C,EAAElC,MAC3C,CAEA,sBAAMkF,CAAiBC,EAAUC,EAAYnC,GAC5C,GAAI7D,KAAK0M,iBAAmB3G,GAAYA,EAASyG,SAAU,CAC1D,IAAIM,EAAU/G,EAASgH,kBACnBC,EAAUxD,KAAKC,UAAUqD,GAC7B,MAAO,eAAeE,IACvB,CACK,CACJ,IAAI/G,EAASjG,KAAKkG,uBAAuBF,GACzChG,KAAKqG,UACLrG,KAAKuC,QAAQ,OAAOsB,gBAAuBoC,EAAOR,KAAK,YACvDzF,KAAKuC,cAAcwD,EAASO,QAAO,GAAO,GAAI,GAC9CtG,KAAKuC,QAAQ,IACd,CACD,CAEAgE,cAAAA,CAAeC,EAAYT,GAC1B,IAAKS,EACJ,OAED,IAAI3C,EAAW7D,KAAK8D,IAAI0C,EAAWzC,GAAI/D,KAAKgE,aACxC+B,EACH/F,KAAKuC,QAAQ,UAAUsB,MAGvB7D,KAAKuC,QAAQ,+CAA+CsB,MAE9D,CAEAkJ,eAAAA,GACC,OAAI/M,KAAKwM,SACDxM,KAAKiN,cAAcjN,KAAKmM,iBAGxB,EAET,CAEAe,0BAAAA,CAA2B9J,GAC1B,GAAwB,kBAApBA,EAAKoB,YAC6B,cAAjCpB,EAAK+J,gBAAgB,QAAyB,CACjD,IAAIxH,EAAYvC,EAAKgK,eAAe,QAAQhD,eACxCiD,EAAQrN,KAAKyK,wBAAwB6C,WAAUtC,GAASA,EAAMtK,OAASiF,IAC3E,GAAI0H,GAAS,EACZ,MAAO,IAAI1B,OAAO0B,EAAM,IAAMjK,EAAKoH,YAAY,UAAYpH,EAAKoH,YAAY,SAE9E,CAED,OAAO,IACR,CAEAyC,aAAAA,CAAc7J,EAAMmK,EAAiB,MACpC,GAAwB,kBAApBnK,EAAKoB,WAAgC,CACxC,IAAIgJ,EAAexN,KAAKkN,2BAA2B9J,GACnD,GAAIoK,EACH,OAAOA,CAET,CAEA,IAAIC,EAAWC,EAAAA,QAAQC,uBAAuBvK,EAAKoB,YAC/CxC,EAAUhC,KAAKkC,gBAAgB0L,IAAIxK,EAAKoB,YACxCqJ,EAAwE,qBAAlDH,EAAAA,QAAQI,qBAAqB1K,EAAKoB,YAExDuJ,EAAenN,IAClB,GAAI+D,EAAAA,EAAMK,SAASpE,GAClB,GAAIA,EAAMqE,UAAW,CACpB,IAAI+I,EAAU5K,EAAKiB,kBAAkB4J,QAAQrN,EAAMqE,WAElDrE,EADGoN,EACKhO,KAAKiN,cAAce,EAASP,GAG5B,IAAM7M,EAAMqE,SAEtB,KACK,KAAIrE,EAAMwJ,eAId,MAAM,IAAItD,MAAM,uBAHhBlG,EAAQA,EAAMwJ,cAIf,CAED,OAAOxJ,CAAK,EAITsN,EAAU,GACVjI,EAAS2D,MAAMC,QAAQ7H,EAAQgE,YAAchE,EAAQgE,WAAa,GACtE,IAAI,IAAIL,KAAaM,EAAQ,CAC5B,IAAIrF,EAAQmN,EAAa3K,EAAKgK,eAAezH,EAAUjF,OAEvD,GAAImN,GAAejE,MAAMC,QAAQjJ,IAA6B,SAAnB+E,EAAUjF,KAAiB,CACrEwN,EAAUtN,EAAMyI,KAAI8E,GAAKJ,EAAaI,KACtC,KACD,CACK,GAAoB,qBAAVvN,EACdsN,EAAQ9H,KAAKxF,OAET,IAAgC,qBAAtB+E,EAAUE,QAIxB,MAAM,IAAIiB,MAAM,2BAA6BnB,EAAUjF,KAAO,aAH9DwN,EAAQ9H,KAAKT,EAAUE,QAIxB,CACD,CAOA,GAJIgI,IACHK,EAAUA,EAAQhE,QAAOiE,GAAW,OAANA,KAG3BV,EAAU,CACb,IAAIW,EAAY,CAAC,IAAK,KAClBC,EAAU,CAAC,IAAK,KAChBvB,EAAUoB,EACZ7E,KAAI8E,GAAKA,EAAI,EAAI,IAAMA,EAAI,IAAMA,IACjC1I,KAAKgI,GAGP,OAEEF,GAEGc,EAAQ9J,SAASgJ,IAAmBc,EAAQ9J,SAASkJ,IAIzC,MAAbA,GAECY,EAAQ9J,SAASgJ,IAAmBa,EAAU7J,SAASkJ,GAEpDX,EAGA,IAAMA,EAAU,GAEzB,CAEC,OAAO1J,EAAKoB,WAAa,IAAM0J,EAAQzI,KAAK,MAAQ,GAEtD,E","sources":["webpack://@openeo/web-editor/./src/components/modals/ExportCodeModal.vue","webpack://@openeo/web-editor/./src/export/python.js","webpack://@openeo/web-editor/./src/export/r.js","webpack://@openeo/web-editor/src/components/modals/ExportCodeModal.vue","webpack://@openeo/web-editor/./src/components/modals/ExportCodeModal.vue?dfd4","webpack://@openeo/web-editor/./src/components/modals/ExportCodeModal.vue?69ec","webpack://@openeo/web-editor/./src/export/exporter.js","webpack://@openeo/web-editor/./src/export/javascript.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('Modal',{attrs:{\"width\":\"80%\",\"title\":\"Export as Source Code\"},on:{\"closed\":function($event){return _vm.$emit('closed')}}},[_c('section',{staticClass:\"exportCode\"},[_c('h3',[_vm._v(\"Choose Programming Language\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.language),expression:\"language\"}],attrs:{\"type\":\"radio\",\"id\":\"js\",\"value\":\"JavaScript\"},domProps:{\"checked\":_vm._q(_vm.language,\"JavaScript\")},on:{\"change\":function($event){_vm.language=\"JavaScript\"}}}),_c('label',{attrs:{\"for\":\"js\"}},[_vm._v(\"JavaScript\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.language),expression:\"language\"}],attrs:{\"type\":\"radio\",\"id\":\"py\",\"value\":\"Python\"},domProps:{\"checked\":_vm._q(_vm.language,\"Python\")},on:{\"change\":function($event){_vm.language=\"Python\"}}}),_c('label',{attrs:{\"for\":\"py\"}},[_vm._v(\"Python\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.language),expression:\"language\"}],attrs:{\"type\":\"radio\",\"id\":\"r\",\"value\":\"R\"},domProps:{\"checked\":_vm._q(_vm.language,\"R\")},on:{\"change\":function($event){_vm.language=\"R\"}}}),_c('label',{attrs:{\"for\":\"r\"}},[_vm._v(\"R\")]),_c('h3',[_vm._v(\"Generated Code\")]),(_vm.error)?_c('div',{staticClass:\"message error\"},[_c('i',{staticClass:\"fas fa-exclamation-circle\"}),_c('span',[_vm._v(\" Sorry, the code generation failed due to the following reason:\"),_c('br'),_c('em',[_vm._v(_vm._s(_vm.error))])])]):[_c('div',{staticClass:\"message warning\"},[_c('i',{staticClass:\"fas fa-bullhorn\"}),_c('span',[_vm._v(\"Please note that this feature is \"),_c('strong',[_vm._v(\"experimental\")]),_vm._v(\" and there are chances that the generated code won't work. Also, the code generated is not always following best practices nor will the implementation use the most efficient way of implementing processes, which is the nature of automatic code generation.\")])]),_c('TextEditor',{ref:\"editor\",attrs:{\"id\":_vm.language,\"title\":_vm.language,\"value\":_vm.code,\"language\":_vm.language,\"editable\":false},scopedSlots:_vm._u([{key:\"file-toolbar\",fn:function(){return [_c('button',{attrs:{\"type\":\"button\",\"title\":\"Download code\"},on:{\"click\":_vm.download}},[_c('i',{staticClass:\"fas fa-download\"})])]},proxy:true}])})]],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { createOrUpdateFromFlatCoordinates } from \"ol/extent\";\nimport Utils from \"../utils\";\nimport Exporter from \"./exporter\";\n\nconst KEYWORDS = [\n\t'and', 'as', 'assert', 'break', 'class', 'continue', 'def', 'del', 'elif',\n\t'else', 'except', 'exec', 'finally', 'for', 'from', 'global', 'if', 'import',\n\t'in', 'is', 'lambda', 'not', 'or', 'pass', 'print', 'raise', 'return', 'try',\n\t'while', 'with', 'yield',\n\t// specific to this generator\n\t\"openeo\", \"connection\", \"process\", \"builder\"\n];\n\nexport default class Python extends Exporter {\n\n\tcreateProcessGraphInstance(process) {\n\t\tlet pg = new Python(process, this.processRegistry, this.getJsonSchemaValidator());\n\t\treturn this.copyProcessGraphInstanceProperties(pg);\n\t}\n\n\tgetKeywords() {\n\t\treturn KEYWORDS;\n\t}\n\n\tcomment(comment) {\n\t\tthis.addCode(comment, '# ');\n\t}\n\n\tgenerateImports() {\n\t\tthis.addCode(`import openeo`);\n\t\tthis.addCode(`from openeo.processes import process`);\n\t}\n\n\tgenerateConnection() {\n\t\tthis.addCode(`connection = openeo.connect(\"${this.getServerUrl()}\")`);\n\t}\n\n\tgenerateAuthentication() {\n\t\tthis.comment(`ToDo: Here you need to authenticate with authenticate_basic() or authenticate_oidc()`);\n\t}\n\n\tgenerateBuilder() {}\n\n\tgenerateMetadataEntry(key, value) {\n\t\tthis.comment(`${key}: ${this.e(value)}`);\n\t}\n\n\tmakeNull() {\n\t\treturn \"None\";\n\t}\n\tmakeBoolean(val) {\n\t\treturn val ? \"True\" : \"False\";\n\t}\n\n\tgetTab() {\n\t\treturn '    ';\n\t}\n\n\thasCallbackParameter(node) {\n\t\treturn Boolean(Object.values(node.arguments).find(arg => arg instanceof Python));\n\t}\n\n\tasync generateFunction(node) {\n\t\tlet variable = this.var(node.id, this.varPrefix());\n\t\tlet builderName;\n\t\tlet addProcessToArguments = true;\n\t\tlet filterDcName = null;\n\t\tif (node.getParent()) {\n\t\t\tbuilderName = 'process';\n\t\t}\n\t\telse {\n\t\t\tlet startNodes = node.getProcessGraph().getStartNodeIds();\n\t\t\tif (startNodes.includes(node.id)) {\n\t\t\t\tif (node.process_id === 'load_collection') {\n\t\t\t\t\tbuilderName = 'connection.load_collection';\n\t\t\t\t\t// Rename id to collection_id until solved: https://github.com/Open-EO/openeo-python-client/issues/223\n\t\t\t\t\tnode.arguments = Object.assign({collection_id: node.arguments.id}, Utils.omitFromObject(node.arguments, ['id']));\n\t\t\t\t\taddProcessToArguments = false;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbuilderName = 'connection.datacube_from_process';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet prevNodes = node.getPreviousNodes();\n\t\t\t\tlet dcName = this.var(prevNodes[0].id, this.varPrefix());\n\t\t\t\t// If the process has a callback parameter, we need to call the \"native\" process\n\t\t\t\t// until https://github.com/Open-EO/openeo-python-client/issues/223 is solved\n\t\t\t\tif (this.hasCallbackParameter(node) || node.process_id === 'save_result') {\n\t\t\t\t\tbuilderName = `${dcName}.${node.process_id}`;\n\t\t\t\t\taddProcessToArguments = false;\n\t\t\t\t\t// If we call the process directly on a new data cube with dcName\n\t\t\t\t\t// we need to remove the argument that is passing this data\n\t\t\t\t\tfilterDcName = (key, value) => Utils.isObject(value) && value.from_node && this.var(value.from_node, this.varPrefix()) === dcName;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbuilderName = `${dcName}.process`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlet args = await this.generateArguments(node, false, filterDcName);\n\t\tif (node.namespace) {\n\t\t\targs.namespace = this.makeString(node.namespace);\n\t\t}\n\t\targs = Utils.mapObject(args, (value, name) => `${name} = ${this.e(value)}`);\n\t\tif (addProcessToArguments) {\n\t\t\targs.unshift(this.makeString(node.process_id));\n\t\t}\n\t\t\n\t\tthis.comment(node.description);\n\t\tthis.addCode(`${variable} = ${builderName}(${args.join(', ')})`);\n\t}\n\n\tgenerateMissingParameter(parameter) {\n\t\tthis.comment(parameter.description);\n\t\tlet paramName = this.var(parameter.name, 'param');\n\t\tlet value = typeof parameter.default !== 'undefined' ? parameter.default : null;\n\t\tthis.addCode(`${paramName} = ${this.e(value)}`);\n\t}\n\n\tasync generateCallback(callback, parameters, variable) {\n\t\tlet params = this.generateFunctionParams(parameters);\n\t\tif (params.length === 0) {\n\t\t\tparams.push('builder');\n\t\t}\n\t\tthis.newLine();\n\t\tthis.addCode(`def ${variable}(${params.join(', ')}):`);\n\t\tthis.addCode(await callback.toCode(true), '', 1);\n\t\tthis.newLine();\n\t}\n\n\tgenerateResult(resultNode, callback) {\n\t\tif (!resultNode) {\n\t\t\treturn;\n\t\t}\n\t\tlet variable = this.var(resultNode.id, this.varPrefix());\n\t\tif (callback) {\n\t\t\tthis.addCode(`return ${variable}`);\n\t\t}\n\t\telse {\n\t\t\tthis.addCode(`result = connection.execute(${variable})`);\n\t\t}\n\t}\n\n}","import Utils from \"../utils\";\nimport Exporter from \"./exporter\";\n\nconst KEYWORDS = [\n\t\"if\", \"else\", \"repeat\", \"while\", \"function\", \"for\", \"in\", \"next\", \"break\",\n\t\"true\", \"false\", \"null\", \"inf\", \"nan\", \"na\", \"na_integer_\", \"na_real_\", \"na_complex_\", \"na_character_\",\n\t// specific to this generator\n\t\"openeo\", \"connect\", \"connection\", \"datacube\", \"p\", \"compute_result\"\n];\n\nexport default class R extends Exporter {\n\n\tcreateProcessGraphInstance(process) {\n\t\tlet pg = new R(process, this.processRegistry, this.getJsonSchemaValidator());\n\t\treturn this.copyProcessGraphInstanceProperties(pg);\n\t}\n\n\tgetKeywords() {\n\t\treturn KEYWORDS;\n\t}\n\n\tmakeNull() {\n\t\treturn \"NULL\";\n\t}\n\tmakeBoolean(val) {\n\t\treturn val ? \"TRUE\" : \"FALSE\";\n\t}\n\tmakeArray(arr) {\n\t\treturn `list(${arr.join(', ')})`;\n\t}\n\tmakeObject(obj) {\n\t\tlet arr = Utils.mapObject(obj, (val, key) => `${this.makeString(key)} = ${val}`);\n\t\treturn `list(${arr.join(', ')})`;\n\t}\n\n\tcomment(comment) {\n\t\tthis.addCode(comment, '# ');\n\t}\n\n\tgenerateImports() {\n\t\tthis.addCode(`library(openeo)`);\n\t}\n\n\tgenerateConnection() {\n\t\tthis.addCode(`connection = connect(host = \"${this.getServerUrl()}\")`);\n\t}\n\n\tgenerateAuthentication() {\n\t\tthis.comment(`ToDo: Authentication with login()`);\n\t}\n\n\tgenerateBuilder() {\n\t\tthis.addCode(`p = processes()`);\n\t}\n\n\tgenerateMetadataEntry(key, value) {\n\t\tthis.comment(`${key}: ${this.e(value)}`);\n\t}\n\n\tasync generateFunction(node) {\n\t\tlet variable = this.var(node.id, this.varPrefix());\n\t\tlet args = await this.generateArguments(node);\n\t\tif (node.namespace) {\n\t\t\tthrow new Error(\"The R client doesn't support namespaced processes yet\");\n\t\t\t// ToDo: This doesn't seem to be supported in R yet\n\t\t\t// args.namespace = this.e(node.namespace);\n\t\t}\n\t\targs = Utils.mapObject(args, (value, name) => `${name} = ${this.e(value)}`);\n\n\t\tthis.comment(node.description);\n\t\tthis.addCode(`${variable} = p$${node.process_id}(${args.join(', ')})`);\n\t}\n\n\tgenerateMissingParameter(parameter) {\n\t\tthis.comment(parameter.description);\n\t\tlet paramName = this.var(parameter.name, 'param');\n\t\tlet value = typeof parameter.default !== 'undefined' ? parameter.default : null;\n\t\tthis.addCode(`${paramName} = ${this.e(value)}`);\n\t}\n\n\tasync generateCallback(callback, parameters, variable) {\n\t\tlet isMathFormula = false;\n\t\tif (isMathFormula) {\n\t\t\t// ToDo: Use Formula class, use ExpressionModal code\n\t\t}\n\t\telse {\n\t\t\tlet params = this.generateFunctionParams(parameters);\n\t\t\tthis.newLine();\n\t\t\tthis.addCode(`${variable} = function(${params.join(', ')}) {`);\n\t\t\tthis.addCode(await callback.toCode(true), '', 1);\n\t\t\tthis.addCode(`}`);\n\t\t}\n\t}\n\n\tgenerateResult(resultNode, callback) {\n\t\tif (!resultNode) {\n\t\t\treturn;\n\t\t}\n\t\tlet variable = this.var(resultNode.id, this.varPrefix());\n\t\tif (callback) {\n\t\t\tthis.addCode(`return(${variable})`);\n\t\t}\n\t\telse {\n\t\t\tthis.addCode(`result = compute_result(graph = ${variable})`);\n\t\t}\n\t}\n\n}","<template>\n\t<Modal width=\"80%\" title=\"Export as Source Code\" @closed=\"$emit('closed')\">\n\t\t<section class=\"exportCode\">\n\t\t\t<h3>Choose Programming Language</h3>\n\t\t\t<input type=\"radio\" v-model=\"language\" id=\"js\" value=\"JavaScript\" /><label for=\"js\">JavaScript</label>\n\t\t\t<input type=\"radio\" v-model=\"language\" id=\"py\" value=\"Python\" /><label for=\"py\">Python</label>\n\t\t\t<input type=\"radio\" v-model=\"language\" id=\"r\" value=\"R\" /><label for=\"r\">R</label>\n\t\t\t<h3>Generated Code</h3>\n\t\t\t<div v-if=\"error\" class=\"message error\">\n\t\t\t\t<i class=\"fas fa-exclamation-circle\"></i>\n\t\t\t\t<span>\n\t\t\t\t\tSorry, the code generation failed due to the following reason:<br />\n\t\t\t\t\t<em>{{ error }}</em>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"message warning\">\n\t\t\t\t\t<i class=\"fas fa-bullhorn\"></i>\n\t\t\t\t\t<span>Please note that this feature is <strong>experimental</strong> and there are chances that the generated code won't work. Also, the code generated is not always following best practices nor will the implementation use the most efficient way of implementing processes, which is the nature of automatic code generation.</span>\n\t\t\t\t</div>\n\t\t\t\t<TextEditor :id=\"language\" :title=\"language\" :value=\"code\" :language=\"language\" :editable=\"false\" ref=\"editor\">\n\t\t\t\t\t<template #file-toolbar>\n\t\t\t\t\t\t<button type=\"button\" @click=\"download\" title=\"Download code\"><i class=\"fas fa-download\"></i></button>\n\t\t\t\t\t</template>\n\t\t\t\t</TextEditor>\n\t\t\t</template>\n\t\t</section>\n\t</Modal>\n</template>\n\n<script>\nimport { OpenEO } from '@openeo/js-client';\nimport TextEditor from '../TextEditor.vue';\nimport Modal from './Modal.vue';\nimport Utils from '../../utils';\nimport JavaScript from '../../export/javascript';\nimport Python from '../../export/python';\nimport R from '../../export/r';\n\nexport default {\n\tname: 'ExportCodeModal',\n\tcomponents: {\n\t\tModal,\n\t\tTextEditor\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tlanguage: 'JavaScript',\n\t\t\tcode: '',\n\t\t\terror: null\n\t\t};\n\t},\n\tcomputed: {\n\t\t...Utils.mapState(['connection']),\n\t\t...Utils.mapState('editor', ['process']),\n\t\t...Utils.mapGetters(['processes', 'supportsMath']),\n\t},\n\twatch: {\n\t\tlanguage: {\n\t\t\timmediate: true,\n\t\t\tasync handler() {\n\t\t\t\ttry {\n\t\t\t\t\tlet exporter;\n\t\t\t\t\tif (this.language === 'JavaScript') {\n\t\t\t\t\t\texporter = new JavaScript(this.process, this.processes, this.connection, this.supportsMath);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.language === 'Python') {\n\t\t\t\t\t\texporter = new Python(this.process, this.processes, this.connection);\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.language === 'R') {\n\t\t\t\t\t\texporter = new R(this.process, this.processes, this.connection);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthrow new Error('Unsupported programming language selected');\n\t\t\t\t\t}\n\t\t\t\t\tthis.code = exporter ? await exporter.toCode() : '';\n\t\t\t\t\tthis.error = null;\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthis.code = '';\n\t\t\t\t\tthis.error = error instanceof Error ? error.message : error;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\tdownload() {\n\t\t\tlet filename;\n\t\t\tif (this.language === 'JavaScript') {\n\t\t\t\tfilename = 'code.js';\n\t\t\t}\n\t\t\telse if (this.language === 'Python') {\n\t\t\t\tfilename = 'code.py';\n\t\t\t}\n\t\t\telse if (this.language === 'R') {\n\t\t\t\tfilename = 'code.r';\n\t\t\t}\n\t\t\tOpenEO.Environment.saveToFile(this.code, filename);\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\">\n.exportCode {\n\tlabel {\n\t\tmargin-right: 1em;\n\t}\n\th3:first-of-type {\n\t\tmargin-top: 0;\n\t}\n\th3:last-of-type {\n\t\tmargin-top: 2em;\n\t}\n\t.textEditor {\n\t\theight: 50vh;\n\t}\n}\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ExportCodeModal.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ExportCodeModal.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ExportCodeModal.vue?vue&type=template&id=10d6dfdf\"\nimport script from \"./ExportCodeModal.vue?vue&type=script&lang=js\"\nexport * from \"./ExportCodeModal.vue?vue&type=script&lang=js\"\nimport style0 from \"./ExportCodeModal.vue?vue&type=style&index=0&id=10d6dfdf&prod&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { BaseProcess, ProcessGraph } from '@openeo/js-processgraphs';\nimport Utils from \"../utils\";\n\nclass ProcessImpl extends BaseProcess {\n\tconstructor(process, exporter) {\n\t\tsuper(process);\n\t\tthis.exporter = exporter;\n\t}\n\tasync execute(node) {\n\t\tawait this.exporter.generateFunction(node);\n\t}\n}\n\nexport default class Exporter extends ProcessGraph {\n\n\tconstructor(process, registry, connection) {\n\t\tsuper(Utils.isObject(process) ? process : {}, registry);\n\t\tthis.connection = connection;\n\t\tthis.code = [];\n\t\tthis.fnCounter = 1;\n\t\tthis.allowEmpty();\n\t\tthis.fillUndefinedParameters();\n\t}\n\n\t// inherited from ProcessGraph\n\n\tcreateProcessGraphInstance(process) {\n\t\tlet pg = new Exporter(process, this.processRegistry, this.getJsonSchemaValidator());\n\t\treturn this.copyProcessGraphInstanceProperties(pg);\n\t}\n\n\tcopyProcessGraphInstanceProperties(pg) {\n\t\tpg = super.copyProcessGraphInstanceProperties(pg);\n\t\tpg.connection = this.connection;\n\t\treturn pg;\n\t}\n\n\tcreateProcessInstance(process) {\n\t\treturn new ProcessImpl(process, this);\n\t}\n\n\tisKeyword(keyword) {\n\t\treturn this.getKeywords().includes(keyword.toLowerCase());\n\t}\n\n\t// Methods to be implemented by sub-class\n\n\tgetKeywords() {\n\t\treturn [];\n\t}\n\n\tcomment(/*comment*/) {}\n\n\tgenerateImports() {}\n\n\tgenerateConnection() {}\n\n\tgenerateAuthentication() {}\n\n\tgenerateBuilder() {}\n\n\tgenerateMetadata(/*key, value*/) {}\n\n\tgenerateMissingParameter() {}\n\n\tasync generateFunction(/*node*/) {}\n\n\tgenerateFunctionParams(parameters) {\n\t\treturn parameters.map(p => {\n\t\t\tif (typeof p.default !== 'undefined') {\n\t\t\t\treturn `${p.name} = ${this.e(p.default)}`;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn p.name;\n\t\t\t}\n\t\t});\n\t}\n\n\tasync generateCallback(/*callback, parameters, variable*/) {}\n\n\tgenerateResult(/*resultNode, callback*/) {}\n\n\tmakeNull() {\n\t\treturn \"null\";\n\t}\n\tmakeBoolean(val) {\n\t\treturn val ? \"true\" : \"false\";\n\t}\n\tmakeArray(arr) {\n\t\treturn `[${arr.join(', ')}]`;\n\t}\n\tmakeObject(obj) {\n\t\tlet arr = Utils.mapObject(obj, (val, key) => `${this.makeString(key)}: ${val}`);\n\t\treturn `{${arr.join(', ')}}`;\n\t}\n\tmakeString(str) {\n\t\treturn JSON.stringify(str);\n\t}\n\tmakeNumber(num) {\n\t\treturn num;\n\t}\n\n\t// Helpers\n\n\te(value) {\n\t\tif (value === null) {\n\t\t\treturn this.makeNull();\n\t\t}\n\t\telse if (typeof value === 'boolean') {\n\t\t\treturn this.makeBoolean(value);\n\t\t}\n\t\telse if (typeof value === 'number') {\n\t\t\treturn this.makeNumber(value);\n\t\t}\n\t\telse if (typeof value === 'string') {\n\t\t\treturn this.makeString(value);\n\t\t}\n\t\telse if (Array.isArray(value)) {\n\t\t\treturn this.makeArray(value.map(val => this.e(val)));\n\t\t}\n\t\telse if (Utils.isObject(value)) {\n\t\t\treturn this.makeObject(Utils.mapObjectValues(value, val => this.e(val)));\n\t\t}\n\t\telse if (typeof value === 'function') {\n\t\t\treturn value();\n\t\t}\n\t\telse {\n\t\t\treturn this.makeNull();\n\t\t}\n\t}\n\n\tgenerateMetadata() {\n\t\tlet hasComment = false;\n\t\tfor(let key in this.process) {\n\t\t\tif (key === 'process_graph') {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet val = this.process[key];\n\t\t\tif (Array.isArray(val) && val.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (typeof val === 'string' && val.length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (typeof val === 'boolean' && !val) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!hasComment) {\n\t\t\t\tthis.newLine();\n\t\t\t\tthis.comment(`Set the metadata for the process`);\n\t\t\t\thasComment = true;\n\t\t\t}\n\t\t\tthis.generateMetadataEntry(key, val);\n\t\t}\n\t}\n\n\tasync resolveArguments(args, onExporter, filter) {\n\t\tlet newArgs = Array.isArray(args) ? [] : {};\n\t\tfor(let key in args) {\n\t\t\tlet value = args[key];\n\t\t\tif (filter && filter(key, value)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (Utils.isObject(value)) {\n\t\t\t\tif (value.from_node) {\n\t\t\t\t\tnewArgs[key] = () => this.var(value.from_node, this.varPrefix());\n\t\t\t\t\tcontinue; \n\t\t\t\t}\n\t\t\t\telse if (value.from_parameter) {\n\t\t\t\t\tnewArgs[key] = () => this.var(value.from_parameter);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\telse if (value instanceof Exporter) {\n\t\t\t\t\tlet fnName = await onExporter(key);\n\t\t\t\t\tnewArgs[key] = () => fnName;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewArgs[key] = await this.resolveArguments(value, onExporter, filter);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (Array.isArray(value)) {\n\t\t\t\tnewArgs[key] = await this.resolveArguments(value, onExporter, filter);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnewArgs[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn newArgs;\n\t}\n\n\tasync resolveCallback(node, key) {\n\t\tlet callback;\n\t\tif (node.process_id === 'load_collection') {\n\t\t\tlet properties = node.getArgument('properties');\n\t\t\tcallback = properties[key];\n\t\t}\n\t\telse {\n\t\t\tcallback = node.getArgument(key);\n\t\t}\n\t\tlet parameters = callback.getCallbackParameters();\n\t\tawait callback.execute(parameters);\n\t\tlet fnName = this.var(`${key}${this.fnCounter++}`, 'fn_');\n\t\tlet replacement = await this.generateCallback(callback, parameters, fnName);\n\t\treturn replacement ? replacement : fnName;\n\t}\n\n\tasync generateArguments(node, ordered = false, filter = null) {\n\t\tlet args = await this.resolveArguments(node.arguments, async key => await this.resolveCallback(node, key), filter);\n\t\tif (ordered) {\n\t\t\targs = this.orderArguments(node, args);\n\t\t}\n\t\treturn args;\n\t}\n\n\torderArguments(node, args) {\n\t\tlet process = node.getProcessGraph().getProcess(node);\n\t\tif (process && Array.isArray(process.parameters)) {\n\t\t\tlet orderedArgs = process.parameters.map(param => {\n\t\t\t\tif (typeof args[param.name] !== 'undefined') {\n\t\t\t\t\treturn args[param.name];\n\t\t\t\t}\n\t\t\t\telse if (!param.optional) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t\tlet definedValueFound = false;\n\t\t\tfor(let i = orderedArgs.length-1; i >= 0; i--) {\n\t\t\t\tif (typeof orderedArgs[i] === 'undefined') {\n\t\t\t\t\tif (definedValueFound) {\n\t\t\t\t\t\torderedArgs[i] = null;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\torderedArgs.pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdefinedValueFound = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn orderedArgs;\n\t\t}\n\t}\n\n\tvarPrefix() {\n\t\tif (!this.getParent()) {\n\t\t\treturn 'datacube';\n\t\t}\n\t\telse {\n\t\t\treturn 'data';\n\t\t}\n\t}\n\n\tvar(id, prefix = \"var\") {\n\t\tid = String(id);\n\t\tif (this.isKeyword(id)) {\n\t\t\treturn `${id}_`;\n\t\t}\n\t\tif (!id.match(/^[a-z_]\\w*$/)) {\n\t\t\treturn prefix + id.replace(/[^\\w]+/g, '_');\n\t\t}\n\t\telse {\n\t\t\treturn id;\n\t\t}\n\t}\n\n\tgetTab() {\n\t\treturn `\\t`;\n\t}\n\n\taddCode(code, prefix = '', level = 0) {\n\t\tif (typeof code !== 'string') {\n\t\t\treturn;\n\t\t}\n\t\tlet tabs = this.getTab().repeat(level);\n\t\tlet lines = code.trim().split(/\\r\\n|\\r|\\n/g);\n\t\tfor(let line of lines) {\n\t\t\tthis.code.push(`${tabs}${prefix}${line}\\n`);\n\t\t}\n\t}\n\n\tnewLine(count = 1) {\n\t\tfor(let i = 0; i < count; i++) {\n\t\t\tthis.addCode('');\n\t\t}\n\t}\n\n\tgetServerUrl() {\n\t\treturn this.connection.getUrl();\n\t}\n\n\tasync toCode(callback = false) {\n\t\tthis.code = [];\n\t\tif (!callback) {\n\t\t\tthis.comment(`Import required packages`);\n\t\t\tthis.generateImports();\n\t\t\tthis.newLine();\n\t\t\tthis.comment(`Connect to the back-end`);\n\t\t\tthis.generateConnection();\n\t\t\tthis.generateAuthentication();\n\t\t\tthis.newLine();\n\t\t\tthis.generateBuilder();\n\t\t\tthis.generateMetadata();\n\t\t\tthis.newLine();\n\t\t}\n\t\tlet params = this.getProcessParameters();\n\t\tif (params.length > 0) {\n\t\t\tthis.comment('ToDo: Here you need to set values for the parameters');\n\t\t\tfor(let param of params) {\n\t\t\t\tthis.generateMissingParameter(param);\n\t\t\t}\n\t\t\tthis.newLine();\n\t\t}\n\t\tawait this.execute();\n\t\tif (!callback) {\n\t\t\tthis.newLine();\n\t\t\tthis.comment(`The process can be executed synchronously (see below), as batch job or as web service now`);\n\t\t}\n\t\tthis.generateResult(this.getResultNode(), callback);\n\t\treturn this.code.join('').trim();\n\t}\n\n\tasync execute() {\n\t\tawait this.validate();\n\t\tthis.reset();\n\t\tawait this.executeNodes(this.getStartNodes());\n\t\treturn this.getResultNode();\n\t}\n\n\tisMath() {\n\t\tif (typeof this._isMath === 'undefined') {\n\t\t\t// Determine whether the process is just math\n\t\t\tthis._isMath = this.processRegistry.isMath(this);\n\t\t}\n\t\treturn this._isMath;\n\t}\n\n}","import Utils from \"../utils\";\nimport Exporter from \"./exporter\";\nimport { Formula } from '@openeo/js-client';\n\nconst KEYWORDS = [\n\t\"abstract\",\n\t\"arguments\",\n\t\"await\",\n\t\"boolean\",\n\t\"break\",\n\t\"byte\",\n\t\"case\",\n\t\"catch\",\n\t\"char\",\n\t\"class\",\n\t\"const\",\n\t\"continue\",\n\t\"debugger\",\n\t\"default\",\n\t\"delete\",\n\t\"do\",\n\t\"double\",\n\t\"else\",\n\t\"enum\",\n\t\"eval\",\n\t\"export\",\n\t\"extends\",\n\t\"false\",\n\t\"final\",\n\t\"finally\",\n\t\"float\",\n\t\"for\",\n\t\"function\",\n\t\"goto\",\n\t\"if\",\n\t\"implements\",\n\t\"import\",\n\t\"in\",\n\t\"instanceof\",\n\t\"int\",\n\t\"interface\",\n\t\"let\",\n\t\"long\",\n\t\"native\",\n\t\"new\",\n\t\"null\",\n\t\"package\",\n\t\"private\",\n\t\"protected\",\n\t\"public\",\n\t\"return\",\n\t\"short\",\n\t\"static\",\n\t\"super\",\n\t\"switch\",\n\t\"synchronized\",\n\t\"this\",\n\t\"throw\",\n\t\"throws\",\n\t\"transient\",\n\t\"true\",\n\t\"try\",\n\t\"typeof\",\n\t\"var\",\n\t\"void\",\n\t\"volatile\",\n\t\"while\",\n\t\"with\",\n\t\"yield\",\n\t// specific to this generator\n\t\"builder\",\n\t\"connection\",\n\t\"formula\",\n\t\"openeo\",\n\t\"result\"\n];\n\nexport default class JavaScript extends Exporter {\n\n\tconstructor(process, registry, connection, generateFormula = false) {\n\t\tsuper(process, registry, connection);\n\t\tthis.generateFormula = generateFormula;\n\t}\n\n\tcreateProcessGraphInstance(process) {\n\t\tlet pg = new JavaScript(process, this.processRegistry, this.getJsonSchemaValidator(), this.generateFormula);\n\t\treturn this.copyProcessGraphInstanceProperties(pg);\n\t}\n\n\tparse() {\n\t\tif (this.parsed) {\n\t\t\treturn;\n\t\t}\n\t\tsuper.parse();\n\t}\n\n\tgetKeywords() {\n\t\treturn KEYWORDS;\n\t}\n\n\tcomment(comment) {\n\t\tthis.addCode(comment, '// ');\n\t}\n\n\tgenerateImports() {\n\t\tthis.addCode(`import { OpenEO, Formula } from '@openeo/js-client';`);\n\t}\n\n\tgenerateConnection() {\n\t\tthis.addCode(`let connection = await OpenEO.connect('${this.getServerUrl()}');`);\n\t}\n\n\tgenerateAuthentication() {\n\t\tthis.comment(`ToDo: Here you need to add your authentication steps`);\n\t}\n\n\tgenerateBuilder() {\n\t\tthis.addCode(`let builder = await connection.buildProcess();`);\n\t}\n\n\tgenerateMetadataEntry(key, value) {\n\t\tthis.addCode(`builder.${key} = ${this.e(value)};`);\n\t}\n\n\tasync generateFunction(node) {\n\t\tlet builderName = node.getParent() ? 'this' : 'builder';\n\t\tlet variable = this.var(node.id, this.varPrefix());\n\t\tlet args = await this.generateArguments(node, !node.namespace);\n\n\t\tthis.comment(node.description);\n\t\tif (Utils.isObject(args)) {\n\t\t\tlet processId = node.namespace ? `${node.process_id}@${node.namespace}` : node.process_id;\n\t\t\tthis.addCode(`let ${variable} = ${builderName}.process(\"${processId}\", ${this.e(args)});`);\n\t\t}\n\t\telse {\n\t\t\tthis.addCode(`let ${variable} = ${builderName}.${node.process_id}(${args.map(arg => this.e(arg)).join(', ')});`);\n\t\t}\n\t}\n\n\tgenerateMissingParameter(parameter) {\n\t\tthis.comment(parameter.description);\n\t\tlet paramName = this.var(parameter.name, 'param');\n\t\tlet value = typeof parameter.default !== 'undefined' ? parameter.default : null;\n\t\tthis.addCode(`let ${paramName} = ${this.e(value)};`);\n\t}\n\n\tasync generateCallback(callback, parameters, variable) {\n\t\tif (this.generateFormula && callback && callback.isMath()) {\n\t\t\tlet formula = callback.toFormulaString();\n\t\t\tlet escaped = JSON.stringify(formula);\n\t\t\treturn `new Formula(${escaped})`;\n\t\t}\n\t\telse {\n\t\t\tlet params = this.generateFunctionParams(parameters);\n\t\t\tthis.newLine();\n\t\t\tthis.addCode(`let ${variable} = function(${params.join(', ')}) {`);\n\t\t\tthis.addCode(await callback.toCode(true), '', 1);\n\t\t\tthis.addCode(`}`);\n\t\t}\n\t}\n\n\tgenerateResult(resultNode, callback) {\n\t\tif (!resultNode) {\n\t\t\treturn;\n\t\t}\n\t\tlet variable = this.var(resultNode.id, this.varPrefix());\n\t\tif (callback) {\n\t\t\tthis.addCode(`return ${variable};`);\n\t\t}\n\t\telse {\n\t\t\tthis.addCode(`let result = await connection.computeResult(${variable});`);\n\t\t}\n\t}\n\n\ttoFormulaString() {\n\t\tif (this.isMath()) {\n\t\t\treturn this.nodeToFormula(this.getResultNode());\n\t\t}\n\t\telse {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tgetArrayElementPlaceholder(node) {\n\t\tif (node.process_id === 'array_element') {\n\t\t\tif (node.getArgumentType('data') === 'parameter') {\n\t\t\t\tlet parameter = node.getRawArgument('data').from_parameter;\n\t\t\t\tlet index = this.getCallbackParameters().findIndex(param => param.name === parameter);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\treturn '$'.repeat(index+1) + (node.getArgument('label') || node.getArgument('index'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tnodeToFormula(node, parentOperator = null) {\n\t\tif (node.process_id === 'array_element') {\n\t\t\tlet arrayElement = this.getArrayElementPlaceholder(node);\n\t\t\tif (arrayElement) {\n\t\t\t\treturn arrayElement;\n\t\t\t}\n\t\t}\n\n\t\tlet operator = Formula.reverseOperatorMapping[node.process_id];\n\t\tlet process = this.processRegistry.get(node.process_id);\n\t\tlet isArrayData = (typeof Formula.arrayOperatorMapping[node.process_id] !== 'undefined');\n\n\t\tlet convertValue = value => {\n\t\t\tif (Utils.isObject(value)) {\n\t\t\t\tif (value.from_node) {\n\t\t\t\t\tlet refNode = node.getProcessGraph().getNode(value.from_node);\n\t\t\t\t\tif (refNode) {\n\t\t\t\t\t\tvalue = this.nodeToFormula(refNode, operator);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = '#' + value.from_node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (value.from_parameter) {\n\t\t\t\t\tvalue = value.from_parameter;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthrow new Error('Objects not allowed');\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\n\t\t// Create the list of arguments\n\t\tlet argList = [];\n\t\tlet params = Array.isArray(process.parameters) ? process.parameters : [];\n\t\tfor(let parameter of params) {\n\t\t\tlet value = convertValue(node.getRawArgument(parameter.name));\n\n\t\t\tif (isArrayData && Array.isArray(value) && parameter.name === 'data') {\n\t\t\t\targList = value.map(v => convertValue(v));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if(typeof value !== 'undefined') {\n\t\t\t\targList.push(value);\n\t\t\t}\n\t\t\telse if(typeof parameter.default !== 'undefined') {\n\t\t\t\targList.push(parameter.default);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error('Argument for parameter \"' + parameter.name + '\" missing');\n\t\t\t}\n\t\t}\n\t\t \n\t\t // Filter null values for array data to handle ignore_nodata\n\t\tif (isArrayData) {\n\t\t\targList = argList.filter(v => v !== null);\n\t\t}\n\n\t\tif (operator) {\n\t\t\tlet strongOps = ['/', '*']; // \"Punktrechnung\" vor\n\t\t\tlet weakOps = ['-', '+']; // \"Strichrechung\"\n\t\t\tlet formula = argList\n\t\t\t\t.map(v => v < 0 ? '(' + v + ')' : v) // Put negative values in brackets\n\t\t\t\t.join(operator); // Merge everything together\n\t\t\t\n\t\t\t// Check whether brackets are required\n\t\t\tif (\n\t\t\t\t// No brackets on top-level\n\t\t\t\t!parentOperator\n\t\t\t\t// If operators are both weak, no brackets required\n\t\t\t\t|| (weakOps.includes(parentOperator) && weakOps.includes(operator))\n\t\t\t\t// If operators are both strong, no brackets required -> not correct, x/(a*b) needs it, see https://github.com/Open-EO/openeo-web-editor/issues/235\n//\t\t\t\t|| (strongOps.includes(parentOperator) && strongOps.includes(operator))\n\t\t\t\t// No brackets required for power, it's the strongest operation\n\t\t\t\t|| operator === '^'\n\t\t\t\t// If the parent operation is a weak operation (+/-) and this is a strong operation, no brackets required\n\t\t\t\t|| (weakOps.includes(parentOperator) && strongOps.includes(operator))\n\t\t\t) {\n\t\t\t\treturn formula;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn '(' + formula + ')';\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\treturn node.process_id + '(' + argList.join(', ') + ')';\n\t\t}\n\t}\n\n}"],"names":["render","_vm","this","_c","_self","attrs","on","$event","$emit","staticClass","_v","directives","name","rawName","value","language","expression","domProps","_q","error","_s","ref","code","scopedSlots","_u","key","fn","download","proxy","staticRenderFns","KEYWORDS","Python","Exporter","createProcessGraphInstance","process","pg","processRegistry","getJsonSchemaValidator","copyProcessGraphInstanceProperties","getKeywords","comment","addCode","generateImports","generateConnection","getServerUrl","generateAuthentication","generateBuilder","generateMetadataEntry","e","makeNull","makeBoolean","val","getTab","hasCallbackParameter","node","Boolean","Object","values","arguments","find","arg","generateFunction","builderName","variable","var","id","varPrefix","addProcessToArguments","filterDcName","getParent","startNodes","getProcessGraph","getStartNodeIds","includes","process_id","assign","collection_id","Utils","omitFromObject","prevNodes","getPreviousNodes","dcName","isObject","from_node","args","generateArguments","namespace","makeString","mapObject","unshift","description","join","generateMissingParameter","parameter","paramName","default","generateCallback","callback","parameters","params","generateFunctionParams","length","push","newLine","toCode","generateResult","resultNode","R","makeArray","arr","makeObject","obj","Error","isMathFormula","components","Modal","TextEditor","data","computed","mapState","mapGetters","watch","immediate","handler","exporter","JavaScript","processes","connection","supportsMath","message","methods","filename","OpenEO","Environment","saveToFile","component","ProcessImpl","BaseProcess","constructor","super","execute","ProcessGraph","registry","fnCounter","allowEmpty","fillUndefinedParameters","createProcessInstance","isKeyword","keyword","toLowerCase","generateMetadata","map","p","str","JSON","stringify","makeNumber","num","Array","isArray","mapObjectValues","hasComment","resolveArguments","onExporter","filter","newArgs","from_parameter","fnName","resolveCallback","properties","getArgument","getCallbackParameters","replacement","ordered","async","orderArguments","getProcess","orderedArgs","param","optional","definedValueFound","i","pop","prefix","String","match","replace","level","tabs","repeat","lines","trim","split","line","count","getUrl","getProcessParameters","getResultNode","validate","reset","executeNodes","getStartNodes","isMath","_isMath","generateFormula","parse","parsed","processId","formula","toFormulaString","escaped","nodeToFormula","getArrayElementPlaceholder","getArgumentType","getRawArgument","index","findIndex","parentOperator","arrayElement","operator","Formula","reverseOperatorMapping","get","isArrayData","arrayOperatorMapping","convertValue","refNode","getNode","argList","v","strongOps","weakOps"],"sourceRoot":""}