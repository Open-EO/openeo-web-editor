{"version":3,"file":"js/2279.6fe1eb6f.js","mappings":"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","sources":["webpack://@openeo/web-editor/./node_modules/earcut/src/earcut.js","webpack://@openeo/web-editor/./node_modules/ol-ext/control/LayerSwitcher.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Base.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Checkbox.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Switch.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Radio.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/element.js","webpack://@openeo/web-editor/./node_modules/ol/Collection.js","webpack://@openeo/web-editor/./node_modules/ol/CollectionEventType.js","webpack://@openeo/web-editor/./node_modules/ol/Disposable.js","webpack://@openeo/web-editor/./node_modules/ol/Feature.js","webpack://@openeo/web-editor/./node_modules/ol/ImageBase.js","webpack://@openeo/web-editor/./node_modules/ol/Image.js","webpack://@openeo/web-editor/./node_modules/ol/ImageState.js","webpack://@openeo/web-editor/./node_modules/ol/ImageTile.js","webpack://@openeo/web-editor/./node_modules/ol/Kinetic.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEventHandler.js","webpack://@openeo/web-editor/./node_modules/ol/TileQueue.js","webpack://@openeo/web-editor/./node_modules/ol/Map.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEvent.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEventType.js","webpack://@openeo/web-editor/./node_modules/ol/MapEvent.js","webpack://@openeo/web-editor/./node_modules/ol/MapEventType.js","webpack://@openeo/web-editor/./node_modules/ol/MapProperty.js","webpack://@openeo/web-editor/./node_modules/ol/Object.js","webpack://@openeo/web-editor/./node_modules/ol/ObjectEventType.js","webpack://@openeo/web-editor/./node_modules/ol/Observable.js","webpack://@openeo/web-editor/./node_modules/ol/Tile.js","webpack://@openeo/web-editor/./node_modules/ol/TileCache.js","webpack://@openeo/web-editor/./node_modules/ol/TileRange.js","webpack://@openeo/web-editor/./node_modules/ol/TileState.js","webpack://@openeo/web-editor/./node_modules/ol/ViewProperty.js","webpack://@openeo/web-editor/./node_modules/ol/View.js","webpack://@openeo/web-editor/./node_modules/ol/ViewHint.js"],"sourcesContent":["'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 32767 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize, 0);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim | 0);\n            triangles.push(ear.i / dim | 0);\n            triangles.push(next.i / dim | 0);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    var p = c.next;\n    while (p !== a) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(x0, y0, minX, minY, invSize),\n        maxZ = zOrder(x1, y1, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim | 0);\n            triangles.push(p.i / dim | 0);\n            triangles.push(b.i / dim | 0);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize, 0);\n                earcutLinked(c, triangles, dim, minX, minY, invSize, 0);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    var bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    var bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    filterPoints(bridgeReverse, bridgeReverse.next);\n    return filterPoints(bridge, bridge.next);\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                m = p.x < p.next.x ? p : p.next;\n                if (x === hx) return m; // hole touches outer segment; pick leftmost endpoint\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === 0) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = (x - minX) * invSize | 0;\n    y = (y - minY) * invSize | 0;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) >= (ax - px) * (cy - py) &&\n           (ax - px) * (by - py) >= (bx - px) * (ay - py) &&\n           (bx - px) * (cy - py) >= (cx - px) * (by - py);\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = 0;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable.js'\r\nimport ol_control_Control from 'ol/control/Control.js'\r\nimport ol_layer_Tile from 'ol/layer/Tile.js'\r\nimport ol_layer_Vector from 'ol/layer/Vector.js'\r\nimport ol_layer_VectorTile from 'ol/layer/VectorTile.js'\r\n// ol < 6 compatibility VectorImage is not defined\r\n// import ol_layer_VectorImage from 'ol/layer/VectorImage'\r\nimport ol_layer_Image from 'ol/layer/Image.js'\r\nimport ol_layer_Heatmap from 'ol/layer/Heatmap.js'\r\nimport {intersects as ol_extent_intersects} from 'ol/extent.js'\r\n\r\nimport ol_ext_element from '../util/element.js'\r\n\r\n/** Layer Switcher Control.\r\n * @fires select\r\n * @fires drawlist\r\n * @fires toggle\r\n * @fires reorder-start\r\n * @fires reorder-end\r\n * @fires layer:visible\r\n * @fires layer:opacity\r\n * \r\n * @constructor\r\n * @extends {ol_control_Control}\r\n * @param {Object=} options\r\n *  @param {boolean} options.selection enable layer selection when click on the title\r\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\r\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\r\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\r\n *  @param {boolean} options.reordering allow layer reordering, default true\r\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\r\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\r\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\r\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\r\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\r\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\r\n *  @param {ol.layer.Group} options.layerGroup a layer group to display in the switcher, default display all layers of the map\r\n *  @param {boolean} options.noScroll prevent handle scrolling, default false\r\n *  @param {function} options.onchangeCheck optional callback on click on checkbox, you can call this method for doing operations after check/uncheck a layer\r\n *\r\n * Layers attributes that control the switcher\r\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\r\n *\t- displayInLayerSwitcher {boolean} display the layer in switcher, default true\r\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\r\n */\r\nvar ol_control_LayerSwitcher = class olcontrolLayerSwitcher extends ol_control_Control {\r\n  constructor(options) {\r\n    options = options || {}\r\n    var element = ol_ext_element.create('DIV', {\r\n      className: options.switcherClass || 'ol-layerswitcher'\r\n    })\r\n    super({\r\n      element: element,\r\n      target: options.target\r\n    })\r\n    \r\n    var self = this\r\n    this.dcount = 0\r\n    this.show_progress = options.show_progress\r\n    this.oninfo = (typeof (options.oninfo) == 'function' ? options.oninfo : null)\r\n    this.onextent = (typeof (options.onextent) == 'function' ? options.onextent : null)\r\n    this.hasextent = options.extent || options.onextent\r\n    this.hastrash = options.trash\r\n    this.reordering = (options.reordering !== false)\r\n    this._layers = []\r\n    this._layerGroup = (options.layerGroup && options.layerGroup.getLayers) ? options.layerGroup : null\r\n    this.onchangeCheck = (typeof (options.onchangeCheck) == \"function\" ? options.onchangeCheck : null)\r\n\r\n    // displayInLayerSwitcher\r\n    if (typeof (options.displayInLayerSwitcher) === 'function') {\r\n      this.displayInLayerSwitcher = options.displayInLayerSwitcher\r\n    }\r\n\r\n    // Insert in the map\r\n    if (!options.target) {\r\n      element.classList.add('ol-unselectable')\r\n      element.classList.add('ol-control')\r\n      element.classList.add(options.collapsed !== false ? 'ol-collapsed' : 'ol-forceopen')\r\n\r\n      this.button = ol_ext_element.create('BUTTON', {\r\n        type: 'button',\r\n        parent: element\r\n      })\r\n      this.button.addEventListener('touchstart', function (e) {\r\n        element.classList.toggle('ol-forceopen')\r\n        element.classList.add('ol-collapsed')\r\n        self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') })\r\n        e.preventDefault()\r\n        self.overflow()\r\n      })\r\n      this.button.addEventListener('click', function () {\r\n        element.classList.toggle('ol-forceopen')\r\n        element.classList.add('ol-collapsed')\r\n        self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') })\r\n        self.overflow()\r\n      })\r\n\r\n      if (options.mouseover) {\r\n        element.addEventListener('mouseleave', function () {\r\n          element.classList.add(\"ol-collapsed\")\r\n          self.dispatchEvent({ type: 'toggle', collapsed: true })\r\n        })\r\n        element.addEventListener('mouseover', function () {\r\n          element.classList.remove(\"ol-collapsed\")\r\n          self.dispatchEvent({ type: 'toggle', collapsed: false })\r\n        })\r\n      }\r\n\r\n      if (options.minibar)\r\n        options.noScroll = true\r\n      if (!options.noScroll) {\r\n        this.topv = ol_ext_element.create('DIV', {\r\n          className: 'ol-switchertopdiv',\r\n          parent: element,\r\n          click: function () {\r\n            self.overflow(\"+50%\")\r\n          }\r\n        })\r\n\r\n        this.botv = ol_ext_element.create('DIV', {\r\n          className: 'ol-switcherbottomdiv',\r\n          parent: element,\r\n          click: function () {\r\n            self.overflow(\"-50%\")\r\n          }\r\n        })\r\n      }\r\n      this._noScroll = options.noScroll\r\n    }\r\n\r\n    this.panel_ = ol_ext_element.create('UL', {\r\n      className: 'panel',\r\n    })\r\n    this.panelContainer_ = ol_ext_element.create('DIV', {\r\n      className: 'panel-container',\r\n      html: this.panel_,\r\n      parent: element\r\n    })\r\n    // Handle mousewheel\r\n    if (!options.target && !options.noScroll) {\r\n      ol_ext_element.addListener(this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function (e) {\r\n        if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\r\n          e.stopPropagation()\r\n          e.preventDefault()\r\n        }\r\n      })\r\n    }\r\n\r\n    this.header_ = ol_ext_element.create('LI', {\r\n      className: 'ol-header',\r\n      parent: this.panel_\r\n    })\r\n\r\n    this.set('drawDelay', options.drawDelay || 0)\r\n    this.set('selection', options.selection)\r\n\r\n    if (options.minibar) {\r\n      // Wait init complete (for child classes)\r\n      setTimeout(function () {\r\n        var mbar = ol_ext_element.scrollDiv(this.panelContainer_, {\r\n          mousewheel: true,\r\n          vertical: true,\r\n          minibar: true\r\n        })\r\n        this.on(['drawlist', 'toggle'], function () {\r\n          mbar.refresh()\r\n        })\r\n      }.bind(this))\r\n    }\r\n  }\r\n  /** Test if a layer should be displayed in the switcher\r\n   * @param {ol.layer} layer\r\n   * @return {boolean} true if the layer is displayed\r\n   */\r\n  displayInLayerSwitcher(layer) {\r\n    return (layer.get('displayInLayerSwitcher') !== false)\r\n  }\r\n  /**\r\n   * Set the map instance the control is associated with.\r\n   * @param {_ol_Map_} map The map instance.\r\n   */\r\n  setMap(map) {\r\n    super.setMap(map)\r\n    this.drawPanel()\r\n\r\n    if (this._listener) {\r\n      for (var i in this._listener){\r\n        ol_Observable_unByKey(this._listener[i])\r\n      }\r\n    }\r\n    this._listener = null\r\n\r\n    // Get change (new layer added or removed)\r\n    if (map) {\r\n      this._listener = {\r\n        moveend: map.on('moveend', this.viewChange.bind(this)),\r\n        size: map.on('change:size', this.overflow.bind(this))\r\n      }\r\n      // Listen to a layer group\r\n      if (this._layerGroup) {\r\n        this._listener.change = this._layerGroup.getLayers().on('change:length', this.drawPanel.bind(this))\r\n      } else {\r\n        //Listen to all layers\r\n        this._listener.change = map.getLayerGroup().getLayers().on('change:length', this.drawPanel.bind(this))\r\n      }\r\n    }\r\n  }\r\n  /** Show control\r\n   */\r\n  show() {\r\n    this.element.classList.add('ol-forceopen')\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: false })\r\n  }\r\n  /** Hide control\r\n   */\r\n  hide() {\r\n    this.element.classList.remove('ol-forceopen')\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: true })\r\n  }\r\n  /** Toggle control\r\n   */\r\n  toggle() {\r\n    this.element.classList.toggle(\"ol-forceopen\")\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: !this.isOpen() })\r\n  }\r\n  /** Is control open\r\n   * @return {boolean}\r\n   */\r\n  isOpen() {\r\n    return this.element.classList.contains(\"ol-forceopen\")\r\n  }\r\n  /** Add a custom header\r\n   * @param {Element|string} html content html\r\n   */\r\n  setHeader(html) {\r\n    ol_ext_element.setHTML(this.header_, html)\r\n  }\r\n  /** Calculate overflow and add scrolls\r\n   * @param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\r\n   * @private\r\n   */\r\n  overflow(dir) {\r\n    if (this.button && !this._noScroll) {\r\n      // Nothing to show\r\n      if (ol_ext_element.hidden(this.panel_)) {\r\n        ol_ext_element.setStyle(this.element, { height: 'auto' })\r\n        return\r\n      }\r\n      // Calculate offset\r\n      var h = ol_ext_element.outerHeight(this.element)\r\n      var hp = ol_ext_element.outerHeight(this.panel_)\r\n      var dh = this.button.offsetTop + ol_ext_element.outerHeight(this.button)\r\n      //var dh = this.button.position().top + this.button.outerHeight(true);\r\n      var top = this.panel_.offsetTop - dh\r\n      if (hp > h - dh) {\r\n        // Bug IE: need to have an height defined\r\n        ol_ext_element.setStyle(this.element, { height: '100%' })\r\n        var li = this.panel_.querySelectorAll('li.ol-visible .li-content')[0]\r\n        var lh = li ? 2 * ol_ext_element.getStyle(li, 'height') : 0\r\n        switch (dir) {\r\n          case 1: top += lh; break\r\n          case -1: top -= lh; break\r\n          case \"+50%\": top += Math.round(h / 2); break\r\n          case \"-50%\": top -= Math.round(h / 2); break\r\n          default: break\r\n        }\r\n        // Scroll div\r\n        if (top + hp <= h - 3 * dh / 2) {\r\n          top = h - 3 * dh / 2 - hp\r\n          ol_ext_element.hide(this.botv)\r\n        } else {\r\n          ol_ext_element.show(this.botv)\r\n        }\r\n        if (top >= 0) {\r\n          top = 0\r\n          ol_ext_element.hide(this.topv)\r\n        } else {\r\n          ol_ext_element.show(this.topv)\r\n        }\r\n        // Scroll ?\r\n        ol_ext_element.setStyle(this.panel_, { top: top + \"px\" })\r\n        return true\r\n      } else {\r\n        ol_ext_element.setStyle(this.element, { height: \"auto\" })\r\n        ol_ext_element.setStyle(this.panel_, { top: 0 })\r\n        ol_ext_element.hide(this.botv)\r\n        ol_ext_element.hide(this.topv)\r\n        return false\r\n      }\r\n    }\r\n    else\r\n      return false\r\n  }\r\n  /** Set the layer associated with a li\r\n   * @param {Element} li\r\n   * @param {ol.layer} layer\r\n   * @private\r\n   */\r\n  _setLayerForLI(li, layer) {\r\n    var listeners = []\r\n    if (layer.getLayers) {\r\n      listeners.push(layer.getLayers().on('change:length', this.drawPanel.bind(this)))\r\n    }\r\n    if (li) {\r\n      // Handle opacity change\r\n      listeners.push(layer.on('change:opacity', (function () {\r\n        this.setLayerOpacity(layer, li)\r\n      }).bind(this)))\r\n      // Handle visibility chage\r\n      listeners.push(layer.on('change:visible', (function () {\r\n        this.setLayerVisibility(layer, li)\r\n      }).bind(this)))\r\n    }\r\n    // Other properties\r\n    listeners.push(layer.on('propertychange', (function (e) {\r\n      if (e.key === 'displayInLayerSwitcher'\r\n        || e.key === 'openInLayerSwitcher'\r\n        || e.key === 'title'\r\n        || e.key === 'name') {\r\n        this.drawPanel(e)\r\n      }\r\n    }).bind(this)))\r\n    this._layers.push({ li: li, layer: layer, listeners: listeners })\r\n  }\r\n  /** Set opacity for a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @param {Element} li the list element\r\n   * @private\r\n   */\r\n  setLayerOpacity(layer, li) {\r\n    var i = li.querySelector('.layerswitcher-opacity-cursor')\r\n    if (i){\r\n      i.style.left = (layer.getOpacity() * 100) + \"%\"\r\n    }\r\n    this.dispatchEvent({ type: 'layer:opacity', layer: layer })\r\n  }\r\n  /** Set visibility for a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @param {Element} li the list element\r\n   * @api\r\n   */\r\n  setLayerVisibility(layer, li) {\r\n    var i = li.querySelector('.ol-visibility')\r\n    if (i) {\r\n      i.checked = layer.getVisible()\r\n    }\r\n    if (layer.getVisible()){\r\n      li.classList.add('ol-visible')\r\n    } else{\r\n      li.classList.remove('ol-visible')\r\n    }\r\n    this.dispatchEvent({ type: 'layer:visible', layer: layer })\r\n  }\r\n  /** Clear layers associated with li\r\n   * @private\r\n   */\r\n  _clearLayerForLI() {\r\n    this._layers.forEach(function (li) {\r\n      li.listeners.forEach(function (l) {\r\n        ol_Observable_unByKey(l)\r\n      })\r\n    })\r\n    this._layers = []\r\n  }\r\n  /** Get the layer associated with a li\r\n   * @param {Element} li\r\n   * @return {ol.layer}\r\n   * @private\r\n   */\r\n  _getLayerForLI(li) {\r\n    for (var i = 0, l; l = this._layers[i]; i++) {\r\n      if (l.li === li) {\r\n        return l.layer\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  /**\r\n   * On view change hide layer depending on resolution / extent\r\n   * @private\r\n   */\r\n  viewChange() {\r\n    this.panel_.querySelectorAll('li').forEach(function (li) {\r\n      var l = this._getLayerForLI(li)\r\n      if (l) {\r\n        if (this.testLayerVisibility(l)) {\r\n          li.classList.remove('ol-layer-hidden')\r\n        } else {\r\n          li.classList.add('ol-layer-hidden')\r\n        }\r\n      }\r\n    }.bind(this))\r\n  }\r\n  /** Get control panel\r\n   * @api\r\n   */\r\n  getPanel() {\r\n    return this.panelContainer_\r\n  }\r\n  /** Draw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\r\n   * @api\r\n   */\r\n  drawPanel() {\r\n    if (!this.getMap())\r\n      return\r\n    var self = this\r\n    // Multiple event simultaneously / draw once => put drawing in the event queue\r\n    this.dcount++\r\n    setTimeout(function () { self.drawPanel_() }, this.get('drawDelay') || 0)\r\n  }\r\n  /** Delayed draw panel control\r\n   * @private\r\n   */\r\n  drawPanel_() {\r\n    if (--this.dcount || this.dragging_) {\r\n      return\r\n    }\r\n    var scrollTop = this.panelContainer_.scrollTop\r\n\r\n    // Remove existing layers\r\n    this._clearLayerForLI()\r\n    this.panel_.querySelectorAll('li').forEach(function (li) {\r\n      if (!li.classList.contains('ol-header'))\r\n        li.remove()\r\n    }.bind(this))\r\n    // Draw list\r\n    if (this._layerGroup) {\r\n      this.drawList(this.panel_, this._layerGroup.getLayers())\r\n    } else if (this.getMap()) {\r\n      this.drawList(this.panel_, this.getMap().getLayers())\r\n    }\r\n    // Reset scrolltop\r\n    this.panelContainer_.scrollTop = scrollTop\r\n  }\r\n  /** Change layer visibility according to the baselayer option\r\n   * @param {ol.layer}\r\n   * @param {Array<ol.layer>} related layers\r\n   * @private\r\n   */\r\n  switchLayerVisibility(l, layers) {\r\n    if (!l.get('baseLayer')) {\r\n      l.setVisible(!l.getVisible())\r\n    } else {\r\n      if (!l.getVisible()) {\r\n        l.setVisible(true)\r\n      }\r\n      layers.forEach(function (li) {\r\n        if (l !== li && li.get('baseLayer') && li.getVisible()) {\r\n          li.setVisible(false)\r\n        }\r\n      })\r\n    }\r\n  }\r\n  /** Check if layer is on the map (depending on resolution / zoom and extent)\r\n   * @param {ol.layer}\r\n   * @return {boolean}\r\n   * @private\r\n   */\r\n  testLayerVisibility(layer) {\r\n    if (!this.getMap())\r\n      return true\r\n    var res = this.getMap().getView().getResolution()\r\n    var zoom = this.getMap().getView().getZoom()\r\n    // Calculate visibility on resolution or zoom\r\n    if (layer.getMaxResolution() <= res || layer.getMinResolution() >= res) {\r\n      return false\r\n    } else if (layer.getMinZoom && (layer.getMinZoom() >= zoom || layer.getMaxZoom() < zoom)) {\r\n      return false\r\n    } else {\r\n      // Check extent\r\n      var ex0 = layer.getExtent()\r\n      if (ex0) {\r\n        var ex = this.getMap().getView().calculateExtent(this.getMap().getSize())\r\n        return ol_extent_intersects(ex, ex0)\r\n      }\r\n      return true\r\n    }\r\n  }\r\n  /** Start ordering the list\r\n  *\t@param {event} e drag event\r\n  *\t@private\r\n  */\r\n  dragOrdering_(e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    // Get params\r\n    var self = this\r\n    var elt = e.currentTarget.parentNode.parentNode\r\n    var start = true\r\n    var panel = this.panel_\r\n    var pageY\r\n    var pageY0 = e.pageY\r\n      || (e.touches && e.touches.length && e.touches[0].pageY)\r\n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY)\r\n    var target, dragElt\r\n    var layer, group\r\n    elt.parentNode.classList.add('drag')\r\n\r\n    // Stop ordering\r\n    function stop() {\r\n      if (target) {\r\n        // Get drag on parent\r\n        var drop = layer\r\n        var isSelected = self.getSelection() === drop\r\n        if (drop && target) {\r\n          var collection\r\n          if (group)\r\n            collection = group.getLayers()\r\n          else\r\n            collection = self._layerGroup ? self._layerGroup.getLayers() : self.getMap().getLayers()\r\n          var layers = collection.getArray()\r\n          // Switch layers\r\n          for (var i = 0; i < layers.length; i++) {\r\n            if (layers[i] == drop) {\r\n              collection.removeAt(i)\r\n              break\r\n            }\r\n          }\r\n          for (var j = 0; j < layers.length; j++) {\r\n            if (layers[j] === target) {\r\n              if (i > j)\r\n                collection.insertAt(j, drop)\r\n              else\r\n                collection.insertAt(j + 1, drop)\r\n              break\r\n            }\r\n          }\r\n        }\r\n        if (isSelected)\r\n          self.selectLayer(drop)\r\n\r\n        self.dispatchEvent({ type: \"reorder-end\", layer: drop, group: group })\r\n      }\r\n\r\n      elt.parentNode.querySelectorAll('li').forEach(function (li) {\r\n        li.classList.remove('dropover')\r\n        li.classList.remove('dropover-after')\r\n        li.classList.remove('dropover-before')\r\n      })\r\n      elt.classList.remove(\"drag\")\r\n      elt.parentNode.classList.remove(\"drag\")\r\n      self.element.classList.remove('drag')\r\n      if (dragElt)\r\n        dragElt.remove()\r\n\r\n      ol_ext_element.removeListener(document, 'mousemove touchmove', move)\r\n      ol_ext_element.removeListener(document, 'mouseup touchend touchcancel', stop)\r\n    }\r\n\r\n    // Ordering\r\n    function move(e) {\r\n      // First drag (more than 2 px) => show drag element (ghost)\r\n      pageY = e.pageY\r\n        || (e.touches && e.touches.length && e.touches[0].pageY)\r\n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY)\r\n      if (start && Math.abs(pageY0 - pageY) > 2) {\r\n        start = false\r\n        elt.classList.add(\"drag\")\r\n        layer = self._getLayerForLI(elt)\r\n        target = false\r\n        group = self._getLayerForLI(elt.parentNode.parentNode)\r\n        // Ghost div\r\n        dragElt = ol_ext_element.create('LI', {\r\n          className: 'ol-dragover',\r\n          html: elt.innerHTML,\r\n          style: {\r\n            position: \"absolute\",\r\n            \"z-index\": 10000,\r\n            left: elt.offsetLeft,\r\n            opacity: 0.5,\r\n            width: ol_ext_element.outerWidth(elt),\r\n            height: ol_ext_element.getStyle(elt, 'height'),\r\n          },\r\n          parent: panel\r\n        })\r\n        self.element.classList.add('drag')\r\n        self.dispatchEvent({ type: \"reorder-start\", layer: layer, group: group })\r\n      }\r\n      // Start a new drag sequence\r\n      if (!start) {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n\r\n        // Ghost div\r\n        ol_ext_element.setStyle(dragElt, { top: pageY - ol_ext_element.offsetRect(panel).top + panel.scrollTop + 5 })\r\n\r\n        var li\r\n        if (!e.touches) {\r\n          li = e.target\r\n          \r\n          // Get the HTML node within web component on click drag\r\n          if(e.target.shadowRoot){\r\n            li = e.composedPath()[0]\r\n          }\r\n        } else {\r\n          li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\r\n          \r\n          //Get actual HTML node within web component on touch drag\r\n          while(li.shadowRoot){\r\n            li = li.shadowRoot.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY)\r\n          }\r\n        }\r\n        if (li.classList.contains(\"ol-switcherbottomdiv\")) {\r\n          self.overflow(-1)\r\n        } else if (li.classList.contains(\"ol-switchertopdiv\")) {\r\n          self.overflow(1)\r\n        }\r\n        // Get associated li\r\n        while (li && li.tagName !== 'LI') {\r\n          li = li.parentNode\r\n        }\r\n        if (!li || !li.classList.contains('dropover')) {\r\n          elt.parentNode.querySelectorAll('li').forEach(function (li) {\r\n            li.classList.remove('dropover')\r\n            li.classList.remove('dropover-after')\r\n            li.classList.remove('dropover-before')\r\n          })\r\n        }\r\n        if (li && li.parentNode.classList.contains('drag') && li !== elt) {\r\n          target = self._getLayerForLI(li)\r\n          // Don't mix layer level\r\n          if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\r\n            li.classList.add(\"dropover\")\r\n            li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before')\r\n          } else {\r\n            target = false\r\n          }\r\n          ol_ext_element.show(dragElt)\r\n        } else {\r\n          target = false\r\n          if (li === elt)\r\n            ol_ext_element.hide(dragElt)\r\n          else\r\n            ol_ext_element.show(dragElt)\r\n        }\r\n\r\n        if (!target)\r\n          dragElt.classList.add(\"forbidden\")\r\n        else\r\n          dragElt.classList.remove(\"forbidden\")\r\n      }\r\n    }\r\n\r\n    // Start ordering\r\n    ol_ext_element.addListener(document, 'mousemove touchmove', move)\r\n    ol_ext_element.addListener(document, 'mouseup touchend touchcancel', stop)\r\n  }\r\n  /** Change opacity on drag\r\n  *\t@param {event} e drag event\r\n  *\t@private\r\n  */\r\n  dragOpacity_(e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    var self = this\r\n    // Register start params\r\n    var elt = e.target\r\n    var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode)\r\n    if (!layer)\r\n      return\r\n    var x = e.pageX\r\n      || (e.touches && e.touches.length && e.touches[0].pageX)\r\n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX)\r\n    var start = ol_ext_element.getStyle(elt, 'left') - x\r\n    self.dragging_ = true\r\n\r\n    // stop dragging\r\n    function stop() {\r\n      ol_ext_element.removeListener(document, \"mouseup touchend touchcancel\", stop)\r\n      ol_ext_element.removeListener(document, \"mousemove touchmove\", move)\r\n      self.dragging_ = false\r\n    }\r\n    // On draggin\r\n    function move(e) {\r\n      var x = e.pageX\r\n        || (e.touches && e.touches.length && e.touches[0].pageX)\r\n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX)\r\n      var delta = (start + x) / ol_ext_element.getStyle(elt.parentNode, 'width')\r\n      var opacity = Math.max(0, Math.min(1, delta))\r\n      ol_ext_element.setStyle(elt, { left: (opacity * 100) + \"%\" })\r\n      elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity * 100)\r\n      layer.setOpacity(opacity)\r\n    }\r\n    // Register move\r\n    ol_ext_element.addListener(document, \"mouseup touchend touchcancel\", stop)\r\n    ol_ext_element.addListener(document, \"mousemove touchmove\", move)\r\n  }\r\n  /** Render a list of layer\r\n   * @param {Elemen} element to render\r\n   * @layers {Array{ol.layer}} list of layer to show\r\n   * @api stable\r\n   * @private\r\n   */\r\n  drawList(ul, collection) {\r\n    var self = this\r\n    var layers = collection.getArray()\r\n\r\n    // Change layer visibility\r\n    var setVisibility = function (e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      self.switchLayerVisibility(l, collection)\r\n      if (self.get('selection') && l.getVisible()) {\r\n        self.selectLayer(l)\r\n      }\r\n      if (self.onchangeCheck) {\r\n        self.onchangeCheck(l)\r\n      }\r\n    }\r\n    // Info button click\r\n    function onInfo(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      self.oninfo(l)\r\n      self.dispatchEvent({ type: \"info\", layer: l })\r\n    }\r\n    // Zoom to extent button\r\n    function zoomExtent(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      if (self.onextent) {\r\n        self.onextent(l)\r\n      } else {\r\n        self.getMap().getView().fit(l.getExtent(), self.getMap().getSize())\r\n      }\r\n      self.dispatchEvent({ type: \"extent\", layer: l })\r\n    }\r\n    // Remove a layer on trash click\r\n    function removeLayer(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var li = this.parentNode.parentNode.parentNode.parentNode\r\n      var layer, group = self._getLayerForLI(li)\r\n      // Remove the layer from a group or from a map\r\n      if (group) {\r\n        layer = self._getLayerForLI(this.parentNode.parentNode)\r\n        group.getLayers().remove(layer)\r\n        if (group.getLayers().getLength() == 0 && !group.get('noSwitcherDelete')) {\r\n          removeLayer.call(li.querySelectorAll('.layerTrash')[0], e)\r\n        }\r\n      } else {\r\n        li = this.parentNode.parentNode\r\n        self.getMap().removeLayer(self._getLayerForLI(li))\r\n      }\r\n    }\r\n\r\n    // Create a list for a layer\r\n    function createLi(layer) {\r\n      if (!this.displayInLayerSwitcher(layer)) {\r\n        this._setLayerForLI(null, layer)\r\n        return\r\n      }\r\n\r\n      var li = ol_ext_element.create('LI', {\r\n        className: (layer.getVisible() ? \"ol-visible \" : \" \") + (layer.get('baseLayer') ? \"baselayer\" : \"\"),\r\n        parent: ul\r\n      })\r\n      this._setLayerForLI(li, layer)\r\n      if (this._selectedLayer === layer) {\r\n        li.classList.add('ol-layer-select')\r\n      }\r\n\r\n      var layer_buttons = ol_ext_element.create('DIV', {\r\n        className: 'ol-layerswitcher-buttons',\r\n        parent: li\r\n      })\r\n\r\n      // Content div\r\n      var d = ol_ext_element.create('DIV', {\r\n        className: 'li-content',\r\n        parent: li\r\n      })\r\n\r\n      // Visibility\r\n      ol_ext_element.create('INPUT', {\r\n        type: layer.get('baseLayer') ? 'radio' : 'checkbox',\r\n        className: 'ol-visibility',\r\n        checked: layer.getVisible(),\r\n        click: setVisibility,\r\n        parent: d\r\n      })\r\n      // Label\r\n      var label = ol_ext_element.create('LABEL', {\r\n        title: layer.get('title') || layer.get('name'),\r\n        click: setVisibility,\r\n        style: {\r\n          userSelect: 'none'\r\n        },\r\n        parent: d\r\n      })\r\n      label.addEventListener('selectstart', function () { return false })\r\n      ol_ext_element.create('SPAN', {\r\n        html: layer.get('title') || layer.get('name'),\r\n        click: function (e) {\r\n          if (this.get('selection')) {\r\n            e.stopPropagation()\r\n            this.selectLayer(layer)\r\n          }\r\n        }.bind(this),\r\n        parent: label\r\n      })\r\n\r\n      //  up/down\r\n      if (this.reordering) {\r\n        if ((i < layers.length - 1 && (layer.get(\"allwaysOnTop\") || !layers[i + 1].get(\"allwaysOnTop\")))\r\n          || (i > 0 && (!layer.get(\"allwaysOnTop\") || layers[i - 1].get(\"allwaysOnTop\")))) {\r\n          ol_ext_element.create('DIV', {\r\n            className: 'layerup ol-noscroll',\r\n            title: this.tip.up,\r\n            on: { 'mousedown touchstart': function (e) { self.dragOrdering_(e) } },\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Show/hide sub layers\r\n      if (layer.getLayers) {\r\n        var nb = 0\r\n        layer.getLayers().forEach(function (l) {\r\n          if (self.displayInLayerSwitcher(l))\r\n            nb++\r\n        })\r\n        if (nb) {\r\n          ol_ext_element.create('DIV', {\r\n            className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\r\n            title: this.tip.plus,\r\n            click: function () {\r\n              var l = self._getLayerForLI(this.parentNode.parentNode)\r\n              l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\"))\r\n            },\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Info button\r\n      if (this.oninfo) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerInfo',\r\n          title: this.tip.info,\r\n          click: onInfo,\r\n          parent: layer_buttons\r\n        })\r\n      }\r\n      // Layer remove\r\n      if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerTrash',\r\n          title: this.tip.trash,\r\n          click: removeLayer,\r\n          parent: layer_buttons\r\n        })\r\n      }\r\n      // Layer extent\r\n      if (this.hasextent && layers[i].getExtent()) {\r\n        var ex = layers[i].getExtent()\r\n        if (ex.length == 4 && ex[0] < ex[2] && ex[1] < ex[3]) {\r\n          ol_ext_element.create('DIV', {\r\n            className: 'layerExtent',\r\n            title: this.tip.extent,\r\n            click: zoomExtent,\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Progress\r\n      if (this.show_progress && layer instanceof ol_layer_Tile) {\r\n        var p = ol_ext_element.create('DIV', {\r\n          className: 'layerswitcher-progress',\r\n          parent: d\r\n        })\r\n        this.setprogress_(layer)\r\n        layer.layerswitcher_progress = ol_ext_element.create('DIV', { parent: p })\r\n      }\r\n\r\n      // Opacity\r\n      var opacity = ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity',\r\n        // Click on the opacity line\r\n        click: function (e) {\r\n          if (e.target !== this)\r\n            return\r\n          e.stopPropagation()\r\n          e.preventDefault()\r\n          var op = Math.max(0, Math.min(1, e.offsetX / ol_ext_element.getStyle(this, 'width')))\r\n          self._getLayerForLI(this.parentNode.parentNode).setOpacity(op)\r\n          this.parentNode.querySelectorAll('.layerswitcher-opacity-label')[0].innerHTML = Math.round(op * 100)\r\n        },\r\n        parent: d\r\n      })\r\n      // Start dragging\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity-cursor ol-noscroll',\r\n        style: { left: (layer.getOpacity() * 100) + \"%\" },\r\n        on: {\r\n          'mousedown touchstart': function (e) { self.dragOpacity_(e) }\r\n        },\r\n        parent: opacity\r\n      })\r\n      // Percent\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity-label',\r\n        html: Math.round(layer.getOpacity() * 100),\r\n        parent: d\r\n      })\r\n\r\n      // Layer group\r\n      if (layer.getLayers) {\r\n        li.classList.add('ol-layer-group')\r\n        if (layer.get(\"openInLayerSwitcher\") === true) {\r\n          var ul2 = ol_ext_element.create('UL', {\r\n            parent: li\r\n          })\r\n          this.drawList(ul2, layer.getLayers())\r\n        }\r\n      }\r\n      li.classList.add(this.getLayerClass(layer))\r\n\r\n      // Dispatch a dralist event to allow customisation\r\n      this.dispatchEvent({ type: 'drawlist', layer: layer, li: li })\r\n    }\r\n\r\n    // Add the layer list\r\n    for (var i = layers.length - 1; i >= 0; i--) {\r\n      createLi.call(this, layers[i])\r\n    }\r\n\r\n    this.viewChange()\r\n\r\n    if (ul === this.panel_)\r\n      this.overflow()\r\n  }\r\n  /** Select a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @returns {string} the layer classname\r\n   * @api\r\n   */\r\n  getLayerClass(layer) {\r\n    if (!layer)\r\n      return 'none'\r\n    if (layer.getLayers)\r\n      return 'ol-layer-group'\r\n    if (layer instanceof ol_layer_Vector)\r\n      return 'ol-layer-vector'\r\n    if (layer instanceof ol_layer_VectorTile)\r\n      return 'ol-layer-vectortile'\r\n    if (layer instanceof ol_layer_Tile)\r\n      return 'ol-layer-tile'\r\n    if (layer instanceof ol_layer_Image)\r\n      return 'ol-layer-image'\r\n    if (layer instanceof ol_layer_Heatmap)\r\n      return 'ol-layer-heatmap'\r\n    /* ol < 6 compatibility VectorImage is not defined */\r\n    // if (layer instanceof ol_layer_VectorImage) return 'ol-layer-vectorimage';\r\n    if (layer.getFeatures)\r\n      return 'ol-layer-vectorimage'\r\n    /* */\r\n    return 'unknown'\r\n  }\r\n  /** Select a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @api\r\n   */\r\n  selectLayer(layer, silent) {\r\n    if (!layer) {\r\n      if (!this.getMap())\r\n        return\r\n      layer = this.getMap().getLayers().item(this.getMap().getLayers().getLength() - 1)\r\n    }\r\n    this._selectedLayer = layer\r\n    this.drawPanel()\r\n    if (!silent)\r\n      this.dispatchEvent({ type: 'select', layer: layer })\r\n  }\r\n  /** Get selected layer\r\n   * @returns {ol.layer.Layer}\r\n   */\r\n  getSelection() {\r\n    return this._selectedLayer\r\n  }\r\n  /** Handle progress bar for a layer\r\n  *\t@private\r\n  */\r\n  setprogress_(layer) {\r\n    if (!layer.layerswitcher_progress) {\r\n      var loaded = 0\r\n      var loading = 0\r\n      var draw = function () {\r\n        if (loading === loaded) {\r\n          loading = loaded = 0\r\n          ol_ext_element.setStyle(layer.layerswitcher_progress, { width: 0 }) // layer.layerswitcher_progress.width(0);\r\n        } else {\r\n          ol_ext_element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' }) // layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\r\n        }\r\n      }\r\n      layer.getSource().on('tileloadstart', function () {\r\n        loading++\r\n        draw()\r\n      })\r\n      layer.getSource().on('tileloadend', function () {\r\n        loaded++\r\n        draw()\r\n      })\r\n      layer.getSource().on('tileloaderror', function () {\r\n        loaded++\r\n        draw()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n/** List of tips for internationalization purposes\r\n*/\r\nol_control_LayerSwitcher.prototype.tip = {\r\n  up: \"up/down\",\r\n  down: \"down\",\r\n  info: \"informations...\",\r\n  extent: \"zoom to extent\",\r\n  trash: \"remove layer\",\r\n  plus: \"expand/shrink\"\r\n};\r\n\r\nexport default ol_control_LayerSwitcher\r\n","/** Vanilla JS geographic inputs\r\n * color, size, width, font, symboles, dash, arrow, pattern\r\n */\r\nimport ol_Object from 'ol/Object.js'\r\n\r\n/** Abstract base class; normally only used for creating subclasses and not instantiated in apps.    \r\n * @constructor\r\n * @extends {ol_Object}\r\n * @param {*} options\r\n *  @param {Element} [options.input] input element, if none create one\r\n *  @param {string} [options.type] input type, if no input\r\n *  @param {number} [options.min] input min, if no input\r\n *  @param {number} [options.max] input max, if no input\r\n *  @param {number} [options.step] input step, if no input\r\n *  @param {string|number} [options.val] input value\r\n *  @param {boolean} [options.checked] check input\r\n *  @param {boolean} [options.hidden] the input is display:none\r\n *  @param {boolean} [options.disabled] disable input\r\n *  @param {Element} [options.parent] parent element, if no input\r\n */\r\nvar ol_ext_input_Base = class olextinputBase extends ol_Object {\r\n  constructor(options) {\r\n    options = options || {};\r\n    super();\r\n\r\n    var input = this.input = options.input;\r\n    if (!input) {\r\n      input = this.input = document.createElement('INPUT');\r\n      if (options.type)\r\n        input.setAttribute('type', options.type);\r\n      if (options.min !== undefined)\r\n        input.setAttribute('min', options.min);\r\n      if (options.max !== undefined)\r\n        input.setAttribute('max', options.max);\r\n      if (options.step !== undefined)\r\n        input.setAttribute('step', options.step);\r\n      if (options.parent)\r\n        options.parent.appendChild(input);\r\n    }\r\n    if (options.disabled)\r\n      input.disabled = true;\r\n    if (options.checked !== undefined)\r\n      input.checked = !!options.checked;\r\n    if (options.val !== undefined)\r\n      input.value = options.val;\r\n    if (options.hidden)\r\n      input.style.display = 'none';\r\n    input.addEventListener('focus', function () {\r\n      if (this.element)\r\n        this.element.classList.add('ol-focus');\r\n    }.bind(this));\r\n    var tout;\r\n    input.addEventListener('focusout', function () {\r\n      if (this.element) {\r\n        if (tout)\r\n          clearTimeout(tout);\r\n        tout = setTimeout(function () {\r\n          this.element.classList.remove('ol-focus');\r\n        }.bind(this), 0);\r\n      }\r\n    }.bind(this));\r\n  }\r\n  /** Listen to drag event\r\n   * @param {Element} elt\r\n   * @param {function} cback when draggin on the element\r\n   * @private\r\n   */\r\n  _listenDrag(elt, cback) {\r\n    var handle = function (e) {\r\n      this.moving = true;\r\n      this.element.classList.add('ol-moving');\r\n      var listen = function (e) {\r\n        if (e.type === 'pointerup') {\r\n          document.removeEventListener('pointermove', listen);\r\n          document.removeEventListener('pointerup', listen);\r\n          document.removeEventListener('pointercancel', listen);\r\n          setTimeout(function () {\r\n            this.moving = false;\r\n            this.element.classList.remove('ol-moving');\r\n          }.bind(this));\r\n        }\r\n        if (e.target === elt)\r\n          cback(e);\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n      }.bind(this);\r\n      document.addEventListener('pointermove', listen, false);\r\n      document.addEventListener('pointerup', listen, false);\r\n      document.addEventListener('pointercancel', listen, false);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }.bind(this);\r\n    elt.addEventListener('mousedown', handle, false);\r\n    elt.addEventListener('touchstart', handle, false);\r\n  }\r\n  /** Set the current value\r\n   */\r\n  setValue(v) {\r\n    if (v !== undefined)\r\n      this.input.value = v;\r\n    this.input.dispatchEvent(new Event('change'));\r\n  }\r\n  /** Get the current getValue\r\n   * @returns {string}\r\n   */\r\n  getValue() {\r\n    return this.input.value;\r\n  }\r\n  /** Get the input element\r\n   * @returns {Element}\r\n   */\r\n  getInputElement() {\r\n    return this.input;\r\n  }\r\n}\r\n\r\nexport default ol_ext_input_Base\r\n","import ol_ext_input_Base from './Base.js'\r\n\r\n/** Checkbox input\r\n * @constructor\r\n * @extends {ol_ext_input_Base}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element|string} [options.html] label content\r\n *  @param {string} [options.after] label garnish (placed after)\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n *  @param {boolean} [options.autoClose=true]\r\n *  @param {boolean} [options.visible=false] display the input\r\n */\r\nvar ol_ext_input_Checkbox = class olextinputCheckbox extends ol_ext_input_Base {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    var label = this.element = document.createElement('LABEL');\r\n    if (options.html instanceof Element)\r\n      label.appendChild(options.html);\r\n    else if (options.html !== undefined)\r\n      label.innerHTML = options.html;\r\n    label.className = ('ol-ext-check ol-ext-checkbox ' + (options.className || '')).trim();\r\n\r\n    if (this.input.parentNode)\r\n      this.input.parentNode.insertBefore(label, this.input);\r\n    label.appendChild(this.input);\r\n    label.appendChild(document.createElement('SPAN'));\r\n    if (options.after) {\r\n      label.appendChild(document.createTextNode(options.after));\r\n    }\r\n\r\n    // Handle change\r\n    this.input.addEventListener('change', function () {\r\n      this.dispatchEvent({ type: 'check', checked: this.input.checked, value: this.input.value });\r\n    }.bind(this));\r\n\r\n  }\r\n  isChecked() {\r\n    return this.input.checked;\r\n  }\r\n}\r\n\r\nexport default ol_ext_input_Checkbox\r\n","import ol_ext_input_Checkbox from './Checkbox.js'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Switch = class olextinputSwitch extends ol_ext_input_Checkbox {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    this.element.className = ('ol-ext-toggle-switch ' + (options.className || '')).trim();\r\n  }\r\n};\r\n  \r\nexport default ol_ext_input_Switch\r\n","import ol_ext_input_Checkbox from './Checkbox.js'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Radio = class olextinputRadio extends ol_ext_input_Checkbox {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    this.element.className = ('ol-ext-check ol-ext-radio ' + (options.className || '')).trim();\r\n  }\r\n}\r\n  \r\nexport default ol_ext_input_Radio\r\n","/** Vanilla JS helper to manipulate DOM without jQuery\r\n * @see https://github.com/nefe/You-Dont-Need-jQuery\r\n * @see https://plainjs.com/javascript/\r\n * @see http://youmightnotneedjquery.com/\r\n */\r\nimport ol_ext_input_Checkbox from './input/Checkbox.js'\r\nimport ol_ext_input_Switch from './input/Switch.js'\r\nimport ol_ext_input_Radio from './input/Radio.js'\r\n\r\n/** @namespace ol.ext.element */\r\nvar ol_ext_element = {};\r\n\r\n/**\r\n * Create an element\r\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\r\n * @param {*} options\r\n *  @param {string} options.className className The element class name \r\n *  @param {Element} options.parent Parent to append the element as child\r\n *  @param {Element|string} [options.html] Content of the element (if text is not set)\r\n *  @param {string} [options.text] Text content (if html is not set)\r\n *  @param {Element|string} [options.options] when tagName = SELECT a list of options as key:value to add to the select\r\n *  @param {string} options.* Any other attribut to add to the element\r\n */\r\nol_ext_element.create = function (tagName, options) {\r\n  options = options || {};\r\n  var elt;\r\n  // Create text node\r\n  if (tagName === 'TEXT') {\r\n    elt = document.createTextNode(options.html||'');\r\n    if (options.parent) options.parent.appendChild(elt);\r\n  } else {\r\n    // Other element\r\n    elt = document.createElement(tagName);\r\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\r\n    for (var attr in options) {\r\n      switch (attr) {\r\n        case 'className': {\r\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\r\n          break;\r\n        }\r\n        case 'text': {\r\n          elt.innerText = options.text;\r\n          break;\r\n        }\r\n        case 'html': {\r\n          if (options.html instanceof Element) elt.appendChild(options.html)\r\n          else if (options.html!==undefined) elt.innerHTML = options.html;\r\n          break;\r\n        }\r\n        case 'parent': {\r\n          if (options.parent) options.parent.appendChild(elt);\r\n          break;\r\n        }\r\n        case 'options': {\r\n          if (/select/i.test(tagName)) {\r\n            for (var i in options.options) {\r\n              ol_ext_element.create('OPTION', {\r\n                html: i,\r\n                value: options.options[i],\r\n                parent: elt          \r\n              })\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'style': {\r\n          ol_ext_element.setStyle(elt, options.style);\r\n          break;\r\n        }\r\n        case 'change':\r\n        case 'click': {\r\n          ol_ext_element.addListener(elt, attr, options[attr]);\r\n          break;\r\n        }\r\n        case 'on': {\r\n          for (var e in options.on) {\r\n            ol_ext_element.addListener(elt, e, options.on[e]);\r\n          }\r\n          break;\r\n        }\r\n        case 'checked': {\r\n          elt.checked = !!options.checked;\r\n          break;\r\n        }\r\n        default: {\r\n          elt.setAttribute(attr, options[attr]);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return elt;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {boolean} options.checked\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createSwitch = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    type: 'checkbox',\r\n    on: options.on,\r\n    click: options.click,\r\n    change: options.change,\r\n    parent: options.parent\r\n  });\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  new ol_ext_input_Switch(opt);\r\n  return input;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {string} [options.name] input name\r\n *  @param {string} [options.type=checkbox] input type: radio or checkbox\r\n *  @param {string} options.value input value\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createCheck = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    name: options.name,\r\n    type: (options.type==='radio' ? 'radio' : 'checkbox'),\r\n    on: options.on,\r\n    parent: options.parent\r\n  });\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  if (options.type === 'radio') {\r\n    new ol_ext_input_Radio(opt);\r\n  } else {\r\n    new ol_ext_input_Checkbox(opt);\r\n  }\r\n  return input;\r\n};\r\n\r\n/** Set inner html or append a child element to an element\r\n * @param {Element} element\r\n * @param {Element|string} html Content of the element\r\n */\r\nol_ext_element.setHTML = function(element, html) {\r\n  if (html instanceof Element) element.appendChild(html)\r\n  else if (html!==undefined) element.innerHTML = html;\r\n};\r\n\r\n/** Append text into an elemnt\r\n * @param {Element} element\r\n * @param {string} text text content\r\n */\r\nol_ext_element.appendText = function(element, text) {\r\n  element.appendChild(document.createTextNode(text||''));\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.addListener = function (element, eventType, fn, useCapture ) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.addEventListener(e, fn, useCapture);\r\n  });\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.removeListener = function (element, eventType, fn) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.removeEventListener(e, fn);\r\n  });\r\n};\r\n\r\n/**\r\n * Show an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.show = function (element) {\r\n  element.style.display = '';\r\n};\r\n\r\n/**\r\n * Hide an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.hide = function (element) {\r\n  element.style.display = 'none';\r\n};\r\n\r\n/**\r\n * Test if an element is hihdden\r\n * @param {Element} element\r\n * @return {boolean}\r\n */\r\nol_ext_element.hidden = function (element) {\r\n  return ol_ext_element.getStyle(element, 'display') === 'none';\r\n};\r\n\r\n/**\r\n * Toggle an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.toggle = function (element) {\r\n  element.style.display = (element.style.display==='none' ? '' : 'none');\r\n};\r\n\r\n/** Set style of an element\r\n * @param {DOMElement} el the element\r\n * @param {*} st list of style\r\n */\r\nol_ext_element.setStyle = function(el, st) {\r\n  for (var s in st) {\r\n    switch (s) {\r\n      case 'top':\r\n      case 'left':\r\n      case 'bottom':\r\n      case 'right':\r\n      case 'minWidth':\r\n      case 'maxWidth':\r\n      case 'width':\r\n      case 'height': {\r\n        if (typeof(st[s]) === 'number') {\r\n          el.style[s] = st[s]+'px';\r\n        } else {\r\n          el.style[s] = st[s];\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        el.style[s] = st[s];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get style propertie of an element\r\n * @param {DOMElement} el the element\r\n * @param {string} styleProp Propertie name\r\n * @return {*} style value\r\n */\r\nol_ext_element.getStyle = function(el, styleProp) {\r\n  var value, defaultView = (el.ownerDocument || document).defaultView;\r\n  // W3C standard way:\r\n  if (defaultView && defaultView.getComputedStyle) {\r\n    // sanitize property name to css notation\r\n    // (hypen separated words eg. font-Size)\r\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\r\n  } else if (el.currentStyle) { // IE\r\n    // sanitize property name to camelCase\r\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\r\n      return letter.toUpperCase();\r\n    });\r\n    value = el.currentStyle[styleProp];\r\n    // convert other units to pixels on IE\r\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \r\n      return (function(value) {\r\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\r\n        el.runtimeStyle.left = el.currentStyle.left;\r\n        el.style.left = value || 0;\r\n        value = el.style.pixelLeft + \"px\";\r\n        el.style.left = oldLeft;\r\n        el.runtimeStyle.left = oldRsLeft;\r\n        return value;\r\n      })(value);\r\n    }\r\n  }\r\n  if (/px$/.test(value)) return parseInt(value);\r\n  return value;\r\n};\r\n\r\n/** Get outerHeight of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerHeight = function(elt) {\r\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\r\n};\r\n\r\n/** Get outerWidth of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerWidth = function(elt) {\r\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @return {*} \r\n */\r\nol_ext_element.offsetRect = function(elt) {\r\n  var rect = elt.getBoundingClientRect();\r\n  return {\r\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\r\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\r\n    height: rect.height || (rect.bottom - rect.top),\r\n    width: rect.width || (rect.right - rect.left)\r\n  }\r\n};\r\n\r\n/** Get element offset \r\n * @param {ELement} elt\r\n * @returns {Object} top/left offset\r\n */\r\nol_ext_element.getFixedOffset = function(elt) {\r\n  var offset = {\r\n    left:0,\r\n    top:0\r\n  };\r\n  var getOffset = function(parent) {\r\n    if (!parent) return offset;\r\n    // Check position when transform\r\n    if (ol_ext_element.getStyle(parent, 'position') === 'absolute'\r\n      && ol_ext_element.getStyle(parent, 'transform') !== \"none\") {\r\n      var r = parent.getBoundingClientRect();\r\n      offset.left += r.left; \r\n      offset.top += r.top; \r\n      return offset;\r\n    }\r\n    return getOffset(parent.offsetParent)\r\n  }\r\n  return getOffset(elt.offsetParent)\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @param {boolean} fixed get fixed position\r\n * @return {Object} \r\n */\r\nol_ext_element.positionRect = function(elt, fixed) {\r\n  var gleft = 0;\r\n  var gtop = 0;\r\n\r\n  var getRect = function( parent ) {\r\n    if (parent) {\r\n      gleft += parent.offsetLeft;\r\n      gtop += parent.offsetTop;\r\n      return getRect(parent.offsetParent);\r\n    } else {\r\n      var r = {\r\n        top: elt.offsetTop + gtop,\r\n        left: elt.offsetLeft + gleft\r\n      };\r\n      if (fixed) {\r\n        r.top -= (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0);\r\n        r.left -= (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0);\r\n      }\r\n      r.bottom = r.top + elt.offsetHeight;\r\n      r.right = r.top + elt.offsetWidth;\r\n      return r;\r\n    }\r\n  }; \r\n  return getRect(elt.offsetParent);\r\n}\r\n\r\n/** Make a div scrollable without scrollbar.\r\n * On touch devices the default behavior is preserved\r\n * @param {DOMElement} elt\r\n * @param {*} options\r\n *  @param {function} [options.onmove] a function that takes a boolean indicating that the div is scrolling\r\n *  @param {boolean} [options.vertical=false] \r\n *  @param {boolean} [options.animate=true] add kinetic to scroll\r\n *  @param {boolean} [options.mousewheel=false] enable mousewheel to scroll\r\n *  @param {boolean} [options.minibar=false] add a mini scrollbar to the parent element (only vertical scrolling)\r\n * @returns {Object} an object with a refresh function\r\n */\r\nol_ext_element.scrollDiv = function(elt, options) {\r\n  options = options || {};\r\n  var pos = false;\r\n  var speed = 0;\r\n  var d, dt = 0;\r\n\r\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\r\n  //var page = options.vertical ? 'pageY' : 'pageX';\r\n  var page = options.vertical ? 'screenY' : 'screenX';\r\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\r\n  var moving = false;\r\n  // Factor scale content / container\r\n  var scale, isbar;\r\n\r\n  // Update the minibar\r\n  var updateCounter = 0;\r\n  var updateMinibar = function() {\r\n    if (scrollbar) {\r\n      updateCounter++;\r\n      setTimeout(updateMinibarDelay);\r\n    }\r\n  }\r\n  var updateMinibarDelay = function() {\r\n    if (scrollbar) {\r\n      updateCounter--;\r\n      // Prevent multi call\r\n      if (updateCounter) return;\r\n      // Container height\r\n      var pheight = elt.clientHeight;\r\n      // Content height\r\n      var height = elt.scrollHeight;\r\n      // Set scrollbar value\r\n      scale = pheight / height;\r\n      scrollbar.style.height = scale * 100 + '%';\r\n      scrollbar.style.top = (elt.scrollTop / height * 100) + '%';\r\n      scrollContainer.style.height = pheight + 'px';\r\n      // No scroll\r\n      if (pheight > height - .5) scrollContainer.classList.add('ol-100pc');\r\n      else scrollContainer.classList.remove('ol-100pc');\r\n    }\r\n  }\r\n  \r\n  // Handle pointer down\r\n  var onPointerDown = function(e) {\r\n    // Prevent scroll\r\n    if (e.target.classList.contains('ol-noscroll')) return;\r\n    // Start scrolling\r\n    moving = false;\r\n    pos = e[page];\r\n    dt = new Date();\r\n    elt.classList.add('ol-move');\r\n    // Prevent elt dragging\r\n    e.preventDefault();\r\n    // Listen scroll\r\n    window.addEventListener('pointermove', onPointerMove);\r\n    ol_ext_element.addListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  }\r\n\r\n  // Register scroll\r\n  var onPointerMove = function(e) {\r\n    if (pos !== false) {\r\n      var delta = (isbar ? -1/scale : 1) * (pos - e[page]);\r\n      moving = moving || Math.round(delta)\r\n      elt[scroll] += delta;\r\n      d = new Date();\r\n      if (d-dt) {\r\n        speed = (speed + delta / (d - dt))/2;\r\n      }\r\n      pos = e[page];\r\n      dt = d;\r\n      // Tell we are moving\r\n      if (delta) onmove(true);\r\n    } else {\r\n      moving = true;\r\n    }\r\n  };\r\n  \r\n  // Animate scroll\r\n  var animate = function(to) {\r\n    var step = (to>0) ? Math.min(100, to/2) : Math.max(-100, to/2);\r\n    to -= step;\r\n    elt[scroll] += step;\r\n    if (-1 < to && to < 1) {\r\n      if (moving) setTimeout(function() { elt.classList.remove('ol-move'); });\r\n      else elt.classList.remove('ol-move');\r\n      moving = false;\r\n      onmove(false);\r\n    } else {\r\n      setTimeout(function() {\r\n        animate(to);\r\n      }, 40);\r\n    }\r\n  }\r\n  \r\n  // Initialize scroll container for minibar\r\n  var scrollContainer, scrollbar;\r\n  if (options.vertical && options.minibar) {\r\n    var init = function(b) {\r\n      // only once\r\n      elt.removeEventListener('pointermove', init);\r\n      elt.parentNode.classList.add('ol-miniscroll');\r\n      scrollbar = ol_ext_element.create('DIV');\r\n      scrollContainer = ol_ext_element.create('DIV', {\r\n        className: 'ol-scroll',\r\n        html: scrollbar\r\n      });\r\n      elt.parentNode.insertBefore(scrollContainer, elt);\r\n      // Move scrollbar\r\n      scrollbar.addEventListener('pointerdown', function(e) {\r\n        isbar = true;\r\n        onPointerDown(e)\r\n      });\r\n      // Handle mousewheel\r\n      if (options.mousewheel) {\r\n        ol_ext_element.addListener(scrollContainer, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n        ol_ext_element.addListener(scrollbar, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n      }\r\n      // Update on enter\r\n      elt.parentNode.addEventListener('pointerenter', updateMinibar);\r\n      // Update on resize\r\n      window.addEventListener('resize', updateMinibar);\r\n      // Update\r\n      if (b!==false) updateMinibar();\r\n    };\r\n    // Allready inserted in the DOM\r\n    if (elt.parentNode) init(false);\r\n    // or wait when ready\r\n    else elt.addEventListener('pointermove', init);\r\n    // Update on scroll\r\n    elt.addEventListener('scroll', function() {\r\n      updateMinibar();\r\n    });\r\n  }\r\n\r\n  // Enable scroll\r\n  elt.style['touch-action'] = 'none';\r\n  elt.style['overflow'] = 'hidden';\r\n  elt.classList.add('ol-scrolldiv');\r\n  \r\n  // Start scrolling\r\n  ol_ext_element.addListener(elt, ['pointerdown'], function(e) {\r\n    isbar = false;\r\n    onPointerDown(e)\r\n  });\r\n\r\n  // Prevet click when moving...\r\n  elt.addEventListener('click', function(e) {\r\n    if (elt.classList.contains('ol-move')) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }, true);\r\n\r\n  // Stop scrolling\r\n  var onPointerUp = function(e) {\r\n    dt = new Date() - dt;\r\n    if (dt>100 || isbar) {\r\n      // User stop: no speed\r\n      speed = 0;\r\n    } else if (dt>0) {\r\n      // Calculate new speed\r\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\r\n    }\r\n    animate(options.animate===false ? 0 : speed*200);\r\n    pos = false;\r\n    speed = 0;\r\n    dt = 0;\r\n    // Add class to handle click (on iframe / double-click)\r\n    if (!elt.classList.contains('ol-move')) {\r\n      elt.classList.add('ol-hasClick')\r\n      setTimeout(function() { elt.classList.remove('ol-hasClick'); }, 500);\r\n    } else {\r\n      elt.classList.remove('ol-hasClick');\r\n    }\r\n    isbar = false;\r\n    window.removeEventListener('pointermove', onPointerMove)\r\n    ol_ext_element.removeListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  };\r\n\r\n  // Handle mousewheel\r\n  var onMouseWheel = function(e) {\r\n    var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\r\n    elt.classList.add('ol-move');\r\n    elt[scroll] -= delta*30;\r\n    elt.classList.remove('ol-move');\r\n    return false;\r\n  }\r\n  if (options.mousewheel) { // && !elt.classList.contains('ol-touch')) {\r\n    ol_ext_element.addListener(elt, \r\n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n      onMouseWheel\r\n    );\r\n  }\r\n\r\n  return { \r\n    refresh: updateMinibar\r\n  }\r\n};\r\n\r\n/** Dispatch an event to an Element \r\n * @param {string} eventName\r\n * @param {Element} element\r\n */\r\nol_ext_element.dispatchEvent = function (eventName, element) {\r\n  var event;\r\n  try {\r\n    event = new CustomEvent(eventName);\r\n  } catch(e) {\r\n    // Try customevent on IE\r\n    event = document.createEvent(\"CustomEvent\");\r\n    event.initCustomEvent(eventName, true, true, {});\r\n  }\r\n  element.dispatchEvent(event);\r\n};\r\n\r\nexport default ol_ext_element\r\n","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport BaseObject from './Object.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport Event from './events/Event.js';\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length',\n};\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n * @template T\n */\nexport class CollectionEvent extends Event {\n  /**\n   * @param {import(\"./CollectionEventType.js\").default} type Type.\n   * @param {T} element Element.\n   * @param {number} index The index of the added or removed element.\n   */\n  constructor(type, element, index) {\n    super(type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {T}\n     * @api\n     */\n    this.element = element;\n\n    /**\n     * The index of the added or removed element.\n     * @type {number}\n     * @api\n     */\n    this.index = index;\n  }\n}\n\n/***\n * @template T\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types|'change:length', import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").OnSignature<'add'|'remove', CollectionEvent<T>, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types|\n *     'change:length'|'add'|'remove',Return>} CollectionOnSignature\n */\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nclass Collection extends BaseObject {\n  /**\n   * @param {Array<T>} [array] Array.\n   * @param {Options} [options] Collection options.\n   */\n  constructor(array, options) {\n    super();\n\n    /***\n     * @type {CollectionOnSignature<T, import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {CollectionOnSignature<T, import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {CollectionOnSignature<T, void>}\n     */\n    this.un;\n\n    options = options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = array ? array : [];\n\n    if (this.unique_) {\n      for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n  }\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  clear() {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  }\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  extend(arr) {\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  }\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  forEach(f) {\n    const array = this.array_;\n    for (let i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  }\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  getArray() {\n    return this.array_;\n  }\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  item(index) {\n    return this.array_[index];\n  }\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  getLength() {\n    return this.get(Property.LENGTH);\n  }\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  insertAt(index, elem) {\n    if (index < 0 || index > this.getLength()) {\n      throw new Error('Index out of bounds: ' + index);\n    }\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem, index)\n    );\n  }\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  pop() {\n    return this.removeAt(this.getLength() - 1);\n  }\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  push(elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    const n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  }\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  remove(elem) {\n    const arr = this.array_;\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  removeAt(index) {\n    if (index < 0 || index >= this.getLength()) {\n      return undefined;\n    }\n    const prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.REMOVE, prev, index)\n      )\n    );\n    return prev;\n  }\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  setAt(index, elem) {\n    const n = this.getLength();\n    if (index >= n) {\n      this.insertAt(index, elem);\n      return;\n    }\n    if (index < 0) {\n      throw new Error('Index out of bounds: ' + index);\n    }\n    if (this.unique_) {\n      this.assertUnique_(elem, index);\n    }\n    const prev = this.array_[index];\n    this.array_[index] = elem;\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.REMOVE, prev, index)\n      )\n    );\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.ADD, elem, index)\n      )\n    );\n  }\n\n  /**\n   * @private\n   */\n  updateLength_() {\n    this.set(Property.LENGTH, this.array_.length);\n  }\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number} [except] Optional index to ignore.\n   */\n  assertUnique_(elem, except) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== except) {\n        throw new AssertionError(58);\n      }\n    }\n  }\n}\n\nexport default Collection;\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove',\n};\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nclass Disposable {\n  constructor() {\n    /**\n     * The object has already been disposed.\n     * @type {boolean}\n     * @protected\n     */\n    this.disposed = false;\n  }\n\n  /**\n   * Clean up.\n   */\n  dispose() {\n    if (!this.disposed) {\n      this.disposed = true;\n      this.disposeInternal();\n    }\n  }\n\n  /**\n   * Extension point for disposable objects.\n   * @protected\n   */\n  disposeInternal() {}\n}\n\nexport default Disposable;\n","/**\n * @module ol/Feature\n */\nimport BaseObject from './Object.js';\nimport EventType from './events/EventType.js';\nimport {assert} from './asserts.js';\nimport {listen, unlistenByKey} from './events.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types|'change:geometry', import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types\n *     |'change:geometry', Return>} FeatureOnSignature\n */\n\n/***\n * @template Geometry\n * @typedef {Object<string, *> & { geometry?: Geometry }} ObjectWithGeometry\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object~BaseObject} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature.js';\n * import Polygon from 'ol/geom/Polygon.js';\n * import Point from 'ol/geom/Point.js';\n *\n * const feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon',\n * });\n *\n * // get the polygon geometry\n * const poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * const point = feature.getGeometry();\n * ```\n *\n * @api\n * @template {import(\"./geom/Geometry.js\").default} [Geometry=import(\"./geom/Geometry.js\").default]\n */\nclass Feature extends BaseObject {\n  /**\n   * @param {Geometry|ObjectWithGeometry<Geometry>} [geometryOrProperties]\n   *     You may pass a Geometry object directly, or an object literal containing\n   *     properties. If you pass an object literal, you may include a Geometry\n   *     associated with a `geometry` key.\n   */\n  constructor(geometryOrProperties) {\n    super();\n\n    /***\n     * @type {FeatureOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {FeatureOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {FeatureOnSignature<void>}\n     */\n    this.un;\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    this.addChangeListener(this.geometryName_, this.handleGeometryChanged_);\n\n    if (geometryOrProperties) {\n      if (\n        typeof (\n          /** @type {?} */ (geometryOrProperties).getSimplifiedGeometry\n        ) === 'function'\n      ) {\n        const geometry = /** @type {Geometry} */ (geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        const properties = geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature<Geometry>} The clone.\n   * @api\n   */\n  clone() {\n    const clone = /** @type {Feature<Geometry>} */ (\n      new Feature(this.hasProperties() ? this.getProperties() : null)\n    );\n    clone.setGeometryName(this.getGeometryName());\n    const geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(/** @type {Geometry} */ (geometry.clone()));\n    }\n    const style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  }\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {Geometry|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  getGeometry() {\n    return /** @type {Geometry|undefined} */ (this.get(this.geometryName_));\n  }\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id_;\n  }\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  getGeometryName() {\n    return this.geometryName_;\n  }\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike|undefined} The feature style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  getStyleFunction() {\n    return this.styleFunction_;\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChange_() {\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChanged_() {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    const geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(\n        geometry,\n        EventType.CHANGE,\n        this.handleGeometryChange_,\n        this\n      );\n    }\n    this.changed();\n  }\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {Geometry|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  setGeometry(geometry) {\n    this.set(this.geometryName_, geometry);\n  }\n\n  /**\n   * Set the style for the feature to override the layer style.  This can be a\n   * single style object, an array of styles, or a function that takes a\n   * resolution and returns an array of styles. To unset the feature style, call\n   * `setStyle()` without arguments or a falsey value.\n   * @param {import(\"./style/Style.js\").StyleLike} [style] Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setStyle(style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  }\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setId(id) {\n    this.id_ = id;\n    this.changed();\n  }\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  setGeometryName(name) {\n    this.removeChangeListener(this.geometryName_, this.handleGeometryChanged_);\n    this.geometryName_ = name;\n    this.addChangeListener(this.geometryName_, this.handleGeometryChanged_);\n    this.handleGeometryChanged_();\n  }\n}\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  }\n  /**\n   * @type {Array<import(\"./style/Style.js\").default>}\n   */\n  let styles;\n  if (Array.isArray(obj)) {\n    styles = obj;\n  } else {\n    assert(typeof (/** @type {?} */ (obj).getZIndex) === 'function', 41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n    const style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n    styles = [style];\n  }\n  return function () {\n    return styles;\n  };\n}\nexport default Feature;\n","/**\n * @module ol/ImageBase\n */\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport {abstract} from './util.js';\n\n/**\n * @abstract\n */\nclass ImageBase extends EventTarget {\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"./ImageState.js\").default} state State.\n   */\n  constructor(extent, resolution, pixelRatio, state) {\n    super();\n\n    /**\n     * @protected\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = extent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number|undefined}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = state;\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  getExtent() {\n    return this.extent;\n  }\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   */\n  getImage() {\n    return abstract();\n  }\n\n  /**\n   * @return {number} PixelRatio.\n   */\n  getPixelRatio() {\n    return this.pixelRatio_;\n  }\n\n  /**\n   * @return {number} Resolution.\n   */\n  getResolution() {\n    return /** @type {number} */ (this.resolution);\n  }\n\n  /**\n   * @return {import(\"./ImageState.js\").default} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  load() {\n    abstract();\n  }\n}\n\nexport default ImageBase;\n","/**\n * @module ol/Image\n */\nimport EventType from './events/EventType.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\nimport {IMAGE_DECODE} from './has.js';\nimport {getHeight} from './extent.js';\nimport {listenOnce, unlistenByKey} from './events.js';\n\n/**\n * A function that takes an {@link module:ol/Image~ImageWrapper} for the image and a\n * `{string}` for the src as arguments. It is supposed to make it so the\n * underlying image {@link module:ol/Image~ImageWrapper#getImage} is assigned the\n * content specified by the src. If not specified, the default is\n *\n *     function(image, src) {\n *       image.getImage().src = src;\n *     }\n *\n * Providing a custom `imageLoadFunction` can be useful to load images with\n * post requests or - in general - through XHR requests, where the src of the\n * image element would be set to a data URI when the content is loaded.\n *\n * @typedef {function(ImageWrapper, string): void} LoadFunction\n * @api\n */\n\nclass ImageWrapper extends ImageBase {\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {LoadFunction} imageLoadFunction Image load function.\n   * @param {CanvasRenderingContext2D} [context] Canvas context. When provided, the image will be\n   *    drawn into the context's canvas, and `getImage()` will return the canvas once the image\n   *    has finished loading.\n   */\n  constructor(\n    extent,\n    resolution,\n    pixelRatio,\n    src,\n    crossOrigin,\n    imageLoadFunction,\n    context\n  ) {\n    super(extent, resolution, pixelRatio, ImageState.IDLE);\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = ImageState.IDLE;\n\n    /**\n     * @private\n     * @type {LoadFunction}\n     */\n    this.imageLoadFunction_ = imageLoadFunction;\n  }\n\n  /**\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  getImage() {\n    if (\n      this.state == ImageState.LOADED &&\n      this.context_ &&\n      !(this.image_ instanceof HTMLCanvasElement)\n    ) {\n      const canvas = this.context_.canvas;\n      canvas.width = this.image_.width;\n      canvas.height = this.image_.height;\n      this.context_.drawImage(this.image_, 0, 0);\n      this.image_ = this.context_.canvas;\n    }\n    return this.image_;\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = ImageState.ERROR;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    if (this.resolution === undefined) {\n      this.resolution = getHeight(this.extent) / this.image_.height;\n    }\n    this.state = ImageState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @api\n   */\n  load() {\n    if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.imageLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n   */\n  setImage(image) {\n    this.image_ = image;\n    this.resolution = getHeight(this.extent) / this.image_.height;\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n/**\n * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image element.\n * @param {function():any} loadHandler Load callback function.\n * @param {function():any} errorHandler Error callback function.\n * @return {function():void} Callback to stop listening.\n */\nexport function listenImage(image, loadHandler, errorHandler) {\n  const img = /** @type {HTMLImageElement} */ (image);\n  let listening = true;\n  let decoding = false;\n  let loaded = false;\n\n  const listenerKeys = [\n    listenOnce(img, EventType.LOAD, function () {\n      loaded = true;\n      if (!decoding) {\n        loadHandler();\n      }\n    }),\n  ];\n\n  if (img.src && IMAGE_DECODE) {\n    decoding = true;\n    img\n      .decode()\n      .then(function () {\n        if (listening) {\n          loadHandler();\n        }\n      })\n      .catch(function (error) {\n        if (listening) {\n          if (loaded) {\n            loadHandler();\n          } else {\n            errorHandler();\n          }\n        }\n      });\n  } else {\n    listenerKeys.push(listenOnce(img, EventType.ERROR, errorHandler));\n  }\n\n  return function unlisten() {\n    listening = false;\n    listenerKeys.forEach(unlistenByKey);\n  };\n}\n\nexport default ImageWrapper;\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4,\n};\n","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenImage} from './Image.js';\n\nclass ImageTile extends Tile {\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"./Tile.js\").Options} [options] Tile options.\n   */\n  constructor(tileCoord, state, src, crossOrigin, tileLoadFunction, options) {\n    super(tileCoord, state, options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    this.key = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n  }\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  getImage() {\n    return this.image_;\n  }\n\n  /**\n   * Sets an HTML image element for this tile (may be a Canvas or preloaded Image).\n   * @param {HTMLCanvasElement|HTMLImageElement} element Element.\n   */\n  setImage(element) {\n    this.image_ = element;\n    this.state = TileState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    const image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   *\n   * To retry loading tiles on failed requests, use a custom `tileLoadFunction`\n   * that checks for error status codes and reloads only when the status code is\n   * 408, 429, 500, 502, 503 and 504, and only when not too many retries have been\n   * made already:\n   *\n   * ```js\n   * const retryCodes = [408, 429, 500, 502, 503, 504];\n   * const retries = {};\n   * source.setTileLoadFunction((tile, src) => {\n   *   const image = tile.getImage();\n   *   fetch(src)\n   *     .then((response) => {\n   *       if (retryCodes.includes(response.status)) {\n   *         retries[src] = (retries[src] || 0) + 1;\n   *         if (retries[src] <= 3) {\n   *           setTimeout(() => tile.load(), retries[src] * 1000);\n   *         }\n   *         return Promise.reject();\n   *       }\n   *       return response.blob();\n   *     })\n   *     .then((blob) => {\n   *       const imageUrl = URL.createObjectURL(blob);\n   *       image.src = imageUrl;\n   *       setTimeout(() => URL.revokeObjectURL(imageUrl), 5000);\n   *     })\n   *     .catch(() => tile.setState(3)); // error\n   * });\n   * ```\n   *\n   * @api\n   */\n  load() {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.tileLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  const ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nclass Kinetic {\n  /**\n   * @param {number} decay Rate of decay (must be negative).\n   * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n   * @param {number} delay Delay to consider to calculate the kinetic\n   *     initial values (milliseconds).\n   */\n  constructor(decay, minVelocity, delay) {\n    /**\n     * @private\n     * @type {number}\n     */\n    this.decay_ = decay;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minVelocity_ = minVelocity;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.delay_ = delay;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.points_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.angle_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  begin() {\n    this.points_.length = 0;\n    this.angle_ = 0;\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   */\n  update(x, y) {\n    this.points_.push(x, y, Date.now());\n  }\n\n  /**\n   * @return {boolean} Whether we should do kinetic animation.\n   */\n  end() {\n    if (this.points_.length < 6) {\n      // at least 2 points are required (i.e. there must be at least 6 elements\n      // in the array)\n      return false;\n    }\n    const delay = Date.now() - this.delay_;\n    const lastIndex = this.points_.length - 3;\n    if (this.points_[lastIndex + 2] < delay) {\n      // the last tracked point is too old, which means that the user stopped\n      // panning before releasing the map\n      return false;\n    }\n\n    // get the first point which still falls into the delay time\n    let firstIndex = lastIndex - 3;\n    while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n      firstIndex -= 3;\n    }\n\n    const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n    // we don't want a duration of 0 (divide by zero)\n    // we also make sure the user panned for a duration of at least one frame\n    // (1/60s) to compute sane displacement values\n    if (duration < 1000 / 60) {\n      return false;\n    }\n\n    const dx = this.points_[lastIndex] - this.points_[firstIndex];\n    const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n    this.angle_ = Math.atan2(dy, dx);\n    this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n    return this.initialVelocity_ > this.minVelocity_;\n  }\n\n  /**\n   * @return {number} Total distance travelled (pixels).\n   */\n  getDistance() {\n    return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n  }\n\n  /**\n   * @return {number} Angle of the kinetic panning animation (radians).\n   */\n  getAngle() {\n    return this.angle_;\n  }\n}\n\nexport default Kinetic;\n","/**\n * @module ol/MapBrowserEventHandler\n */\n\nimport EventType from './events/EventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport PointerEventType from './pointer/EventType.js';\nimport Target from './events/Target.js';\nimport {PASSIVE_EVENT_LISTENERS} from './has.js';\nimport {listen, unlistenByKey} from './events.js';\n\nclass MapBrowserEventHandler extends Target {\n  /**\n   * @param {import(\"./Map.js\").default} map The map with the viewport to listen to events on.\n   * @param {number} [moveTolerance] The minimal distance the pointer must travel to trigger a move.\n   */\n  constructor(map, moveTolerance) {\n    super(map);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./Map.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {ReturnType<typeof setTimeout>}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * Emulate dblclick and singleclick. Will be true when only one pointer is active.\n     * @type {boolean}\n     */\n    this.emulateClicks_ = false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance === undefined ? 1 : moveTolerance;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {PointerEvent|null}\n     * @private\n     */\n    this.down_ = null;\n\n    const element = this.map_.getViewport();\n\n    /**\n     * @type {Array<PointerEvent>}\n     * @private\n     */\n    this.activePointers_ = [];\n\n    /**\n     * @type {!Object<number, Event>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    this.element_ = element;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(\n      element,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_,\n      this\n    );\n\n    /**\n     * @type {PointerEvent}\n     * @private\n     */\n    this.originalPointerMoveEvent_;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(\n      element,\n      PointerEventType.POINTERMOVE,\n      this.relayMoveEvent_,\n      this\n    );\n\n    /**\n     * @private\n     */\n    this.boundHandleTouchMove_ = this.handleTouchMove_.bind(this);\n\n    this.element_.addEventListener(\n      EventType.TOUCHMOVE,\n      this.boundHandleTouchMove_,\n      PASSIVE_EVENT_LISTENERS ? {passive: false} : false\n    );\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  emulateClick_(pointerEvent) {\n    let newEvent = new MapBrowserEvent(\n      MapBrowserEventType.CLICK,\n      this.map_,\n      pointerEvent\n    );\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserEvent(\n        MapBrowserEventType.DBLCLICK,\n        this.map_,\n        pointerEvent\n      );\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(() => {\n        this.clickTimeoutId_ = undefined;\n        const newEvent = new MapBrowserEvent(\n          MapBrowserEventType.SINGLECLICK,\n          this.map_,\n          pointerEvent\n        );\n        this.dispatchEvent(newEvent);\n      }, 250);\n    }\n  }\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  updateActivePointers_(pointerEvent) {\n    const event = pointerEvent;\n    const id = event.pointerId;\n\n    if (\n      event.type == MapBrowserEventType.POINTERUP ||\n      event.type == MapBrowserEventType.POINTERCANCEL\n    ) {\n      delete this.trackedTouches_[id];\n      for (const pointerId in this.trackedTouches_) {\n        if (this.trackedTouches_[pointerId].target !== event.target) {\n          // Some platforms assign a new pointerId when the target changes.\n          // If this happens, delete one tracked pointer. If there is more\n          // than one tracked pointer for the old target, it will be cleared\n          // by subsequent POINTERUP events from other pointers.\n          delete this.trackedTouches_[pointerId];\n          break;\n        }\n      }\n    } else if (\n      event.type == MapBrowserEventType.POINTERDOWN ||\n      event.type == MapBrowserEventType.POINTERMOVE\n    ) {\n      this.trackedTouches_[id] = event;\n    }\n    this.activePointers_ = Object.values(this.trackedTouches_);\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerUp_(pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserEvent(\n      MapBrowserEventType.POINTERUP,\n      this.map_,\n      pointerEvent,\n      undefined,\n      undefined,\n      this.activePointers_\n    );\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.preventDefault().\n    if (\n      this.emulateClicks_ &&\n      !newEvent.defaultPrevented &&\n      !this.dragging_ &&\n      this.isMouseActionButton_(pointerEvent)\n    ) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_.length === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  isMouseActionButton_(pointerEvent) {\n    return pointerEvent.button === 0;\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerDown_(pointerEvent) {\n    this.emulateClicks_ = this.activePointers_.length === 0;\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserEvent(\n      MapBrowserEventType.POINTERDOWN,\n      this.map_,\n      pointerEvent,\n      undefined,\n      undefined,\n      this.activePointers_\n    );\n    this.dispatchEvent(newEvent);\n\n    this.down_ = new PointerEvent(pointerEvent.type, pointerEvent);\n    Object.defineProperty(this.down_, 'target', {\n      writable: false,\n      value: pointerEvent.target,\n    });\n\n    if (this.dragListenerKeys_.length === 0) {\n      const doc = this.map_.getOwnerDocument();\n      this.dragListenerKeys_.push(\n        listen(\n          doc,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_,\n          this\n        ),\n        listen(doc, MapBrowserEventType.POINTERUP, this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(\n          this.element_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_,\n          this\n        )\n      );\n      if (this.element_.getRootNode && this.element_.getRootNode() !== doc) {\n        this.dragListenerKeys_.push(\n          listen(\n            this.element_.getRootNode(),\n            MapBrowserEventType.POINTERUP,\n            this.handlePointerUp_,\n            this\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerMove_(pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.updateActivePointers_(pointerEvent);\n      this.dragging_ = true;\n      const newEvent = new MapBrowserEvent(\n        MapBrowserEventType.POINTERDRAG,\n        this.map_,\n        pointerEvent,\n        this.dragging_,\n        undefined,\n        this.activePointers_\n      );\n      this.dispatchEvent(newEvent);\n    }\n  }\n\n  /**\n   * Wrap and relay a pointermove event.\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  relayMoveEvent_(pointerEvent) {\n    this.originalPointerMoveEvent_ = pointerEvent;\n    const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(\n      new MapBrowserEvent(\n        MapBrowserEventType.POINTERMOVE,\n        this.map_,\n        pointerEvent,\n        dragging\n      )\n    );\n  }\n\n  /**\n   * Flexible handling of a `touch-action: none` css equivalent: because calling\n   * `preventDefault()` on a `pointermove` event does not stop native page scrolling\n   * and zooming, we also listen for `touchmove` and call `preventDefault()` on it\n   * when an interaction (currently `DragPan` handles the event.\n   * @param {TouchEvent} event Event.\n   * @private\n   */\n  handleTouchMove_(event) {\n    // Due to https://github.com/mpizenberg/elm-pep/issues/2, `this.originalPointerMoveEvent_`\n    // may not be initialized yet when we get here on a platform without native pointer events,\n    // when elm-pep is used as pointer events polyfill.\n    const originalEvent = this.originalPointerMoveEvent_;\n    if (\n      (!originalEvent || originalEvent.defaultPrevented) &&\n      (typeof event.cancelable !== 'boolean' || event.cancelable === true)\n    ) {\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  isMoving_(pointerEvent) {\n    return (\n      this.dragging_ ||\n      Math.abs(pointerEvent.clientX - this.down_.clientX) >\n        this.moveTolerance_ ||\n      Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_\n    );\n  }\n\n  /**\n   * Clean up.\n   */\n  disposeInternal() {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    this.element_.removeEventListener(\n      EventType.TOUCHMOVE,\n      this.boundHandleTouchMove_\n    );\n\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    this.element_ = null;\n    super.disposeInternal();\n  }\n}\n\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/TileQueue\n */\nimport EventType from './events/EventType.js';\nimport PriorityQueue, {DROP} from './structs/PriorityQueue.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\nclass TileQueue extends PriorityQueue {\n  /**\n   * @param {PriorityFunction} tilePriorityFunction Tile priority function.\n   * @param {function(): ?} tileChangeCallback Function called on each tile change event.\n   */\n  constructor(tilePriorityFunction, tileChangeCallback) {\n    super(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      function (element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function (element) {\n        return /** @type {import(\"./Tile.js\").default} */ (element[0]).getKey();\n      }\n    );\n\n    /** @private */\n    this.boundHandleTileChange_ = this.handleTileChange.bind(this);\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n  }\n\n  /**\n   * @param {Array} element Element.\n   * @return {boolean} The element was added to the queue.\n   */\n  enqueue(element) {\n    const added = super.enqueue(element);\n    if (added) {\n      const tile = element[0];\n      tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n    }\n    return added;\n  }\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  getTilesLoading() {\n    return this.tilesLoading_;\n  }\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleTileChange(event) {\n    const tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    const state = tile.getState();\n    if (\n      state === TileState.LOADED ||\n      state === TileState.ERROR ||\n      state === TileState.EMPTY\n    ) {\n      if (state !== TileState.ERROR) {\n        tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n      }\n      const tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  }\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  loadMoreTiles(maxTotalLoading, maxNewLoads) {\n    let newLoads = 0;\n    let state, tile, tileKey;\n    while (\n      this.tilesLoading_ < maxTotalLoading &&\n      newLoads < maxNewLoads &&\n      this.getCount() > 0\n    ) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n  }\n}\n\nexport default TileQueue;\n\n/**\n * @param {import('./Map.js').FrameState} frameState Frame state.\n * @param {import(\"./Tile.js\").default} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nexport function getTilePriority(\n  frameState,\n  tile,\n  tileSourceKey,\n  tileCenter,\n  tileResolution\n) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels between\n  // the center of the tile and the center of the viewport.  The factor of 65536\n  // means that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const center = frameState.viewState.center;\n  const deltaX = tileCenter[0] - center[0];\n  const deltaY = tileCenter[1] - center[1];\n  return (\n    65536 * Math.log(tileResolution) +\n    Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution\n  );\n}\n","/**\n * @module ol/Map\n */\nimport BaseObject from './Object.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport CompositeMapRenderer from './renderer/Composite.js';\nimport EventType from './events/EventType.js';\nimport Layer from './layer/Layer.js';\nimport LayerGroup, {GroupEvent} from './layer/Group.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport PointerEventType from './pointer/EventType.js';\nimport RenderEventType from './render/EventType.js';\nimport TileQueue, {getTilePriority} from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {DEVICE_PIXEL_RATIO, PASSIVE_EVENT_LISTENERS} from './has.js';\nimport {TRUE} from './functions.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n} from './transform.js';\nimport {assert} from './asserts.js';\nimport {\n  clone,\n  createOrUpdateEmpty,\n  equals as equalsExtent,\n  getForViewAndSize,\n  isEmpty,\n} from './extent.js';\nimport {defaults as defaultControls} from './control/defaults.js';\nimport {defaults as defaultInteractions} from './interaction/defaults.js';\nimport {equals} from './array.js';\nimport {fromUserCoordinate, toUserCoordinate} from './proj.js';\nimport {getUid} from './util.js';\nimport {hasArea} from './size.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {removeNode} from './dom.js';\nimport {warn} from './console.js';\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate Animate.\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform CoordinateToPixelTransform.\n * @property {import(\"rbush\").default} declutterTree DeclutterTree.\n * @property {null|import(\"./extent.js\").Extent} extent Extent (in view projection coordinates).\n * @property {import(\"./extent.js\").Extent} [nextExtent] Next extent during an animation series.\n * @property {number} index Index.\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray LayerStatesArray.\n * @property {number} layerIndex LayerIndex.\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform PixelToCoordinateTransform.\n * @property {Array<PostRenderFunction>} postRenderFunctions PostRenderFunctions.\n * @property {import(\"./size.js\").Size} size Size.\n * @property {TileQueue} tileQueue TileQueue.\n * @property {!Object<string, Object<string, boolean>>} usedTiles UsedTiles.\n * @property {Array<number>} viewHints ViewHints.\n * @property {!Object<string, Object<string, boolean>>} wantedTiles WantedTiles.\n * @property {string} mapId The id of the map.\n * @property {Object<string, boolean>} renderTargets Identifiers of previously rendered elements.\n */\n\n/**\n * @typedef {function(Map, ?FrameState): any} PostRenderFunction\n */\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default<import(\"./source/Source\").default>): boolean} [layerFilter] Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer~Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in css pixels. Pixels\n * inside the radius around the given position will be checked for features.\n * @property {boolean} [checkWrapped=true] Check-Wrapped Will check for wrapped geometries inside the range of\n *   +/- 1 world width. Works only if a projection is used that can be wrapped.\n */\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls] Controls.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions] Interactions.\n * @property {HTMLElement|Document} keyboardEventTarget KeyboardEventTarget.\n * @property {Collection<import(\"./Overlay.js\").default>} overlays Overlays.\n * @property {Object<string, *>} values Values.\n */\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:layergroup'|'change:size'|'change:target'|'change:view'} MapObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *    import(\"./Observable\").OnSignature<MapObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./MapBrowserEventType\").Types, import(\"./MapBrowserEvent\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./MapEventType\").Types, import(\"./MapEvent\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./render/EventType\").MapRenderEventTypes, import(\"./render/Event\").default, Return> &\n *    import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|MapObjectEventTypes|\n *      import(\"./MapBrowserEventType\").Types|import(\"./MapEventType\").Types|\n *      import(\"./render/EventType\").MapRenderEventTypes, Return>} MapEventHandler\n */\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control/defaults.defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction/defaults.defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered. If passed by element, the container can be in a secondary document.\n * **Note:** CSS `transform` support for the target element is limited to `scale`.\n * @property {View|Promise<import(\"./View.js\").ViewOptions>} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n/**\n * @param {import(\"./layer/Base.js\").default} layer Layer.\n */\nfunction removeLayerMapProperty(layer) {\n  if (layer instanceof Layer) {\n    layer.setMapInternal(null);\n    return;\n  }\n  if (layer instanceof LayerGroup) {\n    layer.getLayers().forEach(removeLayerMapProperty);\n  }\n}\n\n/**\n * @param {import(\"./layer/Base.js\").default} layer Layer.\n * @param {Map} map Map.\n */\nfunction setLayerMapProperty(layer, map) {\n  if (layer instanceof Layer) {\n    layer.setMapInternal(map);\n    return;\n  }\n  if (layer instanceof LayerGroup) {\n    const layers = layer.getLayers().getArray();\n    for (let i = 0, ii = layers.length; i < ii; ++i) {\n      setLayerMapProperty(layers[i], map);\n    }\n  }\n}\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map.js';\n *     import View from 'ol/View.js';\n *     import TileLayer from 'ol/layer/Tile.js';\n *     import OSM from 'ol/source/OSM.js';\n *\n *     const map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1,\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM(),\n *         }),\n *       ],\n *       target: 'map',\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile~TileLayer} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~LayerGroup}\n * is a subclass of {@link module:ol/layer/Base~BaseLayer}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires import(\"./render/Event.js\").default#precompose\n * @fires import(\"./render/Event.js\").default#postcompose\n * @fires import(\"./render/Event.js\").default#rendercomplete\n * @api\n */\nclass Map extends BaseObject {\n  /**\n   * @param {MapOptions} [options] Map options.\n   */\n  constructor(options) {\n    super();\n\n    options = options || {};\n\n    /***\n     * @type {MapEventHandler<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {MapEventHandler<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {MapEventHandler<void>}\n     */\n    this.un;\n\n    const optionsInternal = createOptionsInternal(options);\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.renderComplete_;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.loaded_ = true;\n\n    /** @private */\n    this.boundHandleBrowserEvent_ = this.handleBrowserEvent.bind(this);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ =\n      options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ =\n      options.pixelRatio !== undefined\n        ? options.pixelRatio\n        : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {ReturnType<typeof setTimeout>}\n     */\n    this.postRenderTimeoutHandle_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = this.animationDelay_.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className =\n      'ol-viewport' + ('ontouchstart' in window ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.style.position = 'absolute';\n    this.overlayContainer_.style.zIndex = '0';\n    this.overlayContainer_.style.width = '100%';\n    this.overlayContainer_.style.height = '100%';\n    this.overlayContainer_.style.pointerEvents = 'none';\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.style.position = 'absolute';\n    this.overlayContainerStopEvent_.style.zIndex = '0';\n    this.overlayContainerStopEvent_.style.width = '100%';\n    this.overlayContainerStopEvent_.style.height = '100%';\n    this.overlayContainerStopEvent_.style.pointerEvents = 'none';\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.moveTolerance_ = options.moveTolerance;\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.targetChangeHandlerKeys_ = null;\n\n    /**\n     * @private\n     * @type {HTMLElement|null}\n     */\n    this.targetElement_ = null;\n\n    /**\n     * @type {ResizeObserver}\n     */\n    this.resizeObserver_ = new ResizeObserver(() => this.updateSize());\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || defaultControls();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions =\n      optionsInternal.interactions ||\n      defaultInteractions({\n        onFocusOnly: true,\n      });\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default|null}\n     * @private\n     */\n    this.renderer_ = null;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this)\n    );\n\n    this.addChangeListener(\n      MapProperty.LAYERGROUP,\n      this.handleLayerGroupChanged_\n    );\n    this.addChangeListener(MapProperty.VIEW, this.handleViewChanged_);\n    this.addChangeListener(MapProperty.SIZE, this.handleSizeChanged_);\n    this.addChangeListener(MapProperty.TARGET, this.handleTargetChanged_);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    const map = this;\n    if (options.view && !(options.view instanceof View)) {\n      options.view.then(function (viewOptions) {\n        map.setView(new View(viewOptions));\n      });\n    }\n\n    this.controls.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./control/Control.js\").default>} event CollectionEvent\n       */\n      (event) => {\n        event.element.setMap(this);\n      }\n    );\n\n    this.controls.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./control/Control.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(null);\n      }\n    );\n\n    this.interactions.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./interaction/Interaction.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(this);\n      }\n    );\n\n    this.interactions.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./interaction/Interaction.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(null);\n      }\n    );\n\n    this.overlays_.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./Overlay.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        this.addOverlayInternal_(event.element);\n      }\n    );\n\n    this.overlays_.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./Overlay.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        const id = event.element.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }\n    );\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       */\n      (control) => {\n        control.setMap(this);\n      }\n    );\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       */\n      (interaction) => {\n        interaction.setMap(this);\n      }\n    );\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n  }\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  addControl(control) {\n    this.getControls().push(control);\n  }\n\n  /**\n   * Add the given interaction to the map. If you want to add an interaction\n   * at another point of the collection use `getInteractions()` and the methods\n   * available on {@link module:ol/Collection~Collection}. This can be used to\n   * stop the event propagation from the handleEvent function. The interactions\n   * get to handle the events in the reverse order of this collection.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  addInteraction(interaction) {\n    this.getInteractions().push(interaction);\n  }\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  addLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  }\n\n  /**\n   * @param {import(\"./layer/Group.js\").GroupEvent} event The layer add event.\n   * @private\n   */\n  handleLayerAdd_(event) {\n    setLayerMapProperty(event.layer, this);\n  }\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  addOverlay(overlay) {\n    this.getOverlays().push(overlay);\n  }\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  addOverlayInternal_(overlay) {\n    const id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  }\n\n  /**\n   *\n   * Clean up.\n   */\n  disposeInternal() {\n    this.controls.clear();\n    this.interactions.clear();\n    this.overlays_.clear();\n    this.resizeObserver_.disconnect();\n    this.setTarget(null);\n    super.disposeInternal();\n  }\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(import(\"./Feature.js\").FeatureLike, import(\"./layer/Layer.js\").default<import(\"./source/Source\").default>, import(\"./geom/SimpleGeometry.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature~Feature feature} or\n   *     {@link module:ol/render/Feature~RenderFeature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer~Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template T\n   * @api\n   */\n  forEachFeatureAtPixel(pixel, callback, options) {\n    if (!this.frameState_ || !this.renderer_) {\n      return;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    options = options !== undefined ? options : {};\n    const hitTolerance =\n      options.hitTolerance !== undefined ? options.hitTolerance : 0;\n    const layerFilter =\n      options.layerFilter !== undefined ? options.layerFilter : TRUE;\n    const checkWrapped = options.checkWrapped !== false;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate,\n      this.frameState_,\n      hitTolerance,\n      checkWrapped,\n      callback,\n      null,\n      layerFilter,\n      null\n    );\n  }\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * an empty array if none were found.\n   * @api\n   */\n  getFeaturesAtPixel(pixel, options) {\n    const features = [];\n    this.forEachFeatureAtPixel(\n      pixel,\n      function (feature) {\n        features.push(feature);\n      },\n      options\n    );\n    return features;\n  }\n\n  /**\n   * Get all layers from all layer groups.\n   * @return {Array<import(\"./layer/Layer.js\").default>} Layers.\n   * @api\n   */\n  getAllLayers() {\n    const layers = [];\n    function addLayersFrom(layerGroup) {\n      layerGroup.forEach(function (layer) {\n        if (layer instanceof LayerGroup) {\n          addLayersFrom(layer.getLayers());\n        } else {\n          layers.push(layer);\n        }\n      });\n    }\n    addLayersFrom(this.getLayers());\n    return layers;\n  }\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through the `layerFilter` option.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @api\n   */\n  hasFeatureAtPixel(pixel, options) {\n    if (!this.frameState_ || !this.renderer_) {\n      return false;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    options = options !== undefined ? options : {};\n    const layerFilter =\n      options.layerFilter !== undefined ? options.layerFilter : TRUE;\n    const hitTolerance =\n      options.hitTolerance !== undefined ? options.hitTolerance : 0;\n    const checkWrapped = options.checkWrapped !== false;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate,\n      this.frameState_,\n      hitTolerance,\n      checkWrapped,\n      layerFilter,\n      null\n    );\n  }\n\n  /**\n   * Returns the coordinate in user projection for a browser event.\n   * @param {MouseEvent} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  getEventCoordinate(event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {MouseEvent} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   */\n  getEventCoordinateInternal(event) {\n    return this.getCoordinateFromPixelInternal(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {UIEvent|{clientX: number, clientY: number}} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  getEventPixel(event) {\n    const viewport = this.viewport_;\n    const viewportPosition = viewport.getBoundingClientRect();\n    const viewportSize = this.getSize();\n    const scaleX = viewportPosition.width / viewportSize[0];\n    const scaleY = viewportPosition.height / viewportSize[1];\n    const eventPosition =\n      //FIXME Are we really calling this with a TouchEvent anywhere?\n      'changedTouches' in event\n        ? /** @type {TouchEvent} */ (event).changedTouches[0]\n        : /** @type {MouseEvent} */ (event);\n\n    return [\n      (eventPosition.clientX - viewportPosition.left) / scaleX,\n      (eventPosition.clientY - viewportPosition.top) / scaleY,\n    ];\n  }\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  getTarget() {\n    return /** @type {HTMLElement|string|undefined} */ (\n      this.get(MapProperty.TARGET)\n    );\n  }\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  getTargetElement() {\n    return this.targetElement_;\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * user projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  getCoordinateFromPixel(pixel) {\n    return toUserCoordinate(\n      this.getCoordinateFromPixelInternal(pixel),\n      this.getView().getProjection()\n    );\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   */\n  getCoordinateFromPixelInternal(pixel) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    }\n    return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n  }\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  getControls() {\n    return this.controls;\n  }\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  getOverlays() {\n    return this.overlays_;\n  }\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  getOverlayById(id) {\n    const overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  }\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  getInteractions() {\n    return this.interactions;\n  }\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  getLayerGroup() {\n    return /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP));\n  }\n\n  /**\n   * Clear any existing layers and add layers to the map.\n   * @param {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>} layers The layers to be added to the map.\n   * @api\n   */\n  setLayers(layers) {\n    const group = this.getLayerGroup();\n    if (layers instanceof Collection) {\n      group.setLayers(layers);\n      return;\n    }\n\n    const collection = group.getLayers();\n    collection.clear();\n    collection.extend(layers);\n  }\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  getLayers() {\n    const layers = this.getLayerGroup().getLayers();\n    return layers;\n  }\n\n  /**\n   * @return {boolean} Layers have sources that are still loading.\n   */\n  getLoadingOrNotReady() {\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const state = layerStatesArray[i];\n      if (!state.visible) {\n        continue;\n      }\n      const renderer = state.layer.getRenderer();\n      if (renderer && !renderer.ready) {\n        return true;\n      }\n      const source = state.layer.getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the user\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  getPixelFromCoordinate(coordinate) {\n    const viewCoordinate = fromUserCoordinate(\n      coordinate,\n      this.getView().getProjection()\n    );\n    return this.getPixelFromCoordinateInternal(viewCoordinate);\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   */\n  getPixelFromCoordinateInternal(coordinate) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    }\n    return applyTransform(\n      frameState.coordinateToPixelTransform,\n      coordinate.slice(0, 2)\n    );\n  }\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default|null} Renderer\n   */\n  getRenderer() {\n    return this.renderer_;\n  }\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  getSize() {\n    return /** @type {import(\"./size.js\").Size|undefined} */ (\n      this.get(MapProperty.SIZE)\n    );\n  }\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  getView() {\n    return /** @type {View} */ (this.get(MapProperty.VIEW));\n  }\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  getViewport() {\n    return this.viewport_;\n  }\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  getOverlayContainer() {\n    return this.overlayContainer_;\n  }\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  getOverlayContainerStopEvent() {\n    return this.overlayContainerStopEvent_;\n  }\n\n  /**\n   * @return {!Document} The document where the map is displayed.\n   */\n  getOwnerDocument() {\n    const targetElement = this.getTargetElement();\n    return targetElement ? targetElement.ownerDocument : document;\n  }\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  getTilePriority(tile, tileSourceKey, tileCenter, tileResolution) {\n    return getTilePriority(\n      this.frameState_,\n      tile,\n      tileSourceKey,\n      tileCenter,\n      tileResolution\n    );\n  }\n\n  /**\n   * @param {UIEvent} browserEvent Browser event.\n   * @param {string} [type] Type.\n   */\n  handleBrowserEvent(browserEvent, type) {\n    type = type || browserEvent.type;\n    const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  }\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  handleMapBrowserEvent(mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    const originalEvent = /** @type {PointerEvent} */ (\n      mapBrowserEvent.originalEvent\n    );\n    const eventType = originalEvent.type;\n    if (\n      eventType === PointerEventType.POINTERDOWN ||\n      eventType === EventType.WHEEL ||\n      eventType === EventType.KEYDOWN\n    ) {\n      const doc = this.getOwnerDocument();\n      const rootNode = this.viewport_.getRootNode\n        ? this.viewport_.getRootNode()\n        : doc;\n      const target = /** @type {Node} */ (originalEvent.target);\n      if (\n        // Abort if the target is a child of the container for elements whose events are not meant\n        // to be handled by map interactions.\n        this.overlayContainerStopEvent_.contains(target) ||\n        // Abort if the event target is a child of the container that is no longer in the page.\n        // It's possible for the target to no longer be in the page if it has been removed in an\n        // event listener, this might happen in a Control that recreates it's content based on\n        // user interaction either manually or via a render in something like https://reactjs.org/\n        !(rootNode === doc ? doc.documentElement : rootNode).contains(target)\n      ) {\n        return;\n      }\n    }\n    mapBrowserEvent.frameState = this.frameState_;\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      const interactionsArray = this.getInteractions().getArray().slice();\n      for (let i = interactionsArray.length - 1; i >= 0; i--) {\n        const interaction = interactionsArray[i];\n        if (\n          interaction.getMap() !== this ||\n          !interaction.getActive() ||\n          !this.getTargetElement()\n        ) {\n          continue;\n        }\n        const cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont || mapBrowserEvent.propagationStopped) {\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handlePostRender() {\n    const frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    const tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      let maxTotalLoading = this.maxTilesLoading_;\n      let maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        const hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING]) {\n          const lowOnFrameBudget = Date.now() - frameState.time > 8;\n          maxTotalLoading = lowOnFrameBudget ? 0 : 8;\n          maxNewLoads = lowOnFrameBudget ? 0 : 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n\n    if (frameState && this.renderer_ && !frameState.animate) {\n      if (this.renderComplete_ === true) {\n        if (this.hasListener(RenderEventType.RENDERCOMPLETE)) {\n          this.renderer_.dispatchRenderEvent(\n            RenderEventType.RENDERCOMPLETE,\n            frameState\n          );\n        }\n        if (this.loaded_ === false) {\n          this.loaded_ = true;\n          this.dispatchEvent(\n            new MapEvent(MapEventType.LOADEND, this, frameState)\n          );\n        }\n      } else if (this.loaded_ === true) {\n        this.loaded_ = false;\n        this.dispatchEvent(\n          new MapEvent(MapEventType.LOADSTART, this, frameState)\n        );\n      }\n    }\n\n    const postRenderFunctions = this.postRenderFunctions_;\n    for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  }\n\n  /**\n   * @private\n   */\n  handleSizeChanged_() {\n    if (this.getView() && !this.getView().getAnimating()) {\n      this.getView().resolveConstraints(0);\n    }\n\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleTargetChanged_() {\n    if (this.mapBrowserEventHandler_) {\n      for (let i = 0, ii = this.targetChangeHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.targetChangeHandlerKeys_[i]);\n      }\n      this.targetChangeHandlerKeys_ = null;\n      this.viewport_.removeEventListener(\n        EventType.CONTEXTMENU,\n        this.boundHandleBrowserEvent_\n      );\n      this.viewport_.removeEventListener(\n        EventType.WHEEL,\n        this.boundHandleBrowserEvent_\n      );\n      this.mapBrowserEventHandler_.dispose();\n      this.mapBrowserEventHandler_ = null;\n      removeNode(this.viewport_);\n    }\n\n    if (this.targetElement_) {\n      this.resizeObserver_.unobserve(this.targetElement_);\n      const rootNode = this.targetElement_.getRootNode();\n      if (rootNode instanceof ShadowRoot) {\n        this.resizeObserver_.unobserve(rootNode.host);\n      }\n      this.setSize(undefined);\n    }\n\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    const target = this.getTarget();\n    const targetElement =\n      typeof target === 'string' ? document.getElementById(target) : target;\n    this.targetElement_ = targetElement;\n    if (!targetElement) {\n      if (this.renderer_) {\n        clearTimeout(this.postRenderTimeoutHandle_);\n        this.postRenderTimeoutHandle_ = undefined;\n        this.postRenderFunctions_.length = 0;\n        this.renderer_.dispose();\n        this.renderer_ = null;\n      }\n      if (this.animationDelayKey_) {\n        cancelAnimationFrame(this.animationDelayKey_);\n        this.animationDelayKey_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n      if (!this.renderer_) {\n        this.renderer_ = new CompositeMapRenderer(this);\n      }\n\n      this.mapBrowserEventHandler_ = new MapBrowserEventHandler(\n        this,\n        this.moveTolerance_\n      );\n      for (const key in MapBrowserEventType) {\n        this.mapBrowserEventHandler_.addEventListener(\n          MapBrowserEventType[key],\n          this.handleMapBrowserEvent.bind(this)\n        );\n      }\n      this.viewport_.addEventListener(\n        EventType.CONTEXTMENU,\n        this.boundHandleBrowserEvent_,\n        false\n      );\n      this.viewport_.addEventListener(\n        EventType.WHEEL,\n        this.boundHandleBrowserEvent_,\n        PASSIVE_EVENT_LISTENERS ? {passive: false} : false\n      );\n\n      const keyboardEventTarget = !this.keyboardEventTarget_\n        ? targetElement\n        : this.keyboardEventTarget_;\n      this.targetChangeHandlerKeys_ = [\n        listen(\n          keyboardEventTarget,\n          EventType.KEYDOWN,\n          this.handleBrowserEvent,\n          this\n        ),\n        listen(\n          keyboardEventTarget,\n          EventType.KEYPRESS,\n          this.handleBrowserEvent,\n          this\n        ),\n      ];\n      const rootNode = targetElement.getRootNode();\n      if (rootNode instanceof ShadowRoot) {\n        this.resizeObserver_.observe(rootNode.host);\n      }\n      this.resizeObserver_.observe(targetElement);\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  }\n\n  /**\n   * @private\n   */\n  handleTileChange_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewPropertyChanged_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewChanged_() {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    const view = this.getView();\n    if (view) {\n      this.updateViewportSize_();\n\n      this.viewPropertyListenerKey_ = listen(\n        view,\n        ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_,\n        this\n      );\n      this.viewChangeListenerKey_ = listen(\n        view,\n        EventType.CHANGE,\n        this.handleViewPropertyChanged_,\n        this\n      );\n\n      view.resolveConstraints(0);\n    }\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleLayerGroupChanged_() {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    const layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.handleLayerAdd_(new GroupEvent('addlayer', layerGroup));\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(layerGroup, ObjectEventType.PROPERTYCHANGE, this.render, this),\n        listen(layerGroup, EventType.CHANGE, this.render, this),\n        listen(layerGroup, 'addlayer', this.handleLayerAdd_, this),\n        listen(layerGroup, 'removelayer', this.handleLayerRemove_, this),\n      ];\n    }\n    this.render();\n  }\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  isRendered() {\n    return !!this.frameState_;\n  }\n\n  /**\n   * @private\n   */\n  animationDelay_() {\n    this.animationDelayKey_ = undefined;\n    this.renderFrame_(Date.now());\n  }\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  renderSync() {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  }\n\n  /**\n   * Redraws all text after new fonts have loaded\n   */\n  redrawText() {\n    const layerStates = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStates.length; i < ii; ++i) {\n      const layer = layerStates[i].layer;\n      if (layer.hasRenderer()) {\n        layer.getRenderer().handleFontsChanged();\n      }\n    }\n  }\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  render() {\n    if (this.renderer_ && this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  }\n\n  /**\n   * This method is meant to be called in a layer's `prerender` listener. It causes all collected\n   * declutter items to be decluttered and rendered on the map immediately. This is useful for\n   * layers that need to appear entirely above the decluttered items of layers lower in the layer\n   * stack.\n   * @api\n   */\n  flushDeclutterItems() {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return;\n    }\n    this.renderer_.flushDeclutterItems(frameState);\n  }\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  removeControl(control) {\n    return this.getControls().remove(control);\n  }\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  removeInteraction(interaction) {\n    return this.getInteractions().remove(interaction);\n  }\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  removeLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  }\n\n  /**\n   * @param {import(\"./layer/Group.js\").GroupEvent} event The layer remove event.\n   * @private\n   */\n  handleLayerRemove_(event) {\n    removeLayerMapProperty(event.layer);\n  }\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  removeOverlay(overlay) {\n    return this.getOverlays().remove(overlay);\n  }\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  renderFrame_(time) {\n    const size = this.getSize();\n    const view = this.getView();\n    const previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    let frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      const viewHints = view.getHints(\n        this.frameState_ ? this.frameState_.viewHints : undefined\n      );\n      const viewState = view.getState();\n      frameState = {\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        declutterTree: null,\n        extent: getForViewAndSize(\n          viewState.center,\n          viewState.resolution,\n          viewState.rotation,\n          size\n        ),\n        index: this.frameIndex_++,\n        layerIndex: 0,\n        layerStatesArray: this.getLayerGroup().getLayerStatesArray(),\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {},\n        mapId: getUid(this),\n        renderTargets: {},\n      };\n      if (viewState.nextCenter && viewState.nextResolution) {\n        const rotation = isNaN(viewState.nextRotation)\n          ? viewState.rotation\n          : viewState.nextRotation;\n\n        frameState.nextExtent = getForViewAndSize(\n          viewState.nextCenter,\n          viewState.nextResolution,\n          rotation,\n          size\n        );\n      }\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(\n        this.postRenderFunctions_,\n        frameState.postRenderFunctions\n      );\n\n      if (previousFrameState) {\n        const moveStart =\n          !this.previousExtent_ ||\n          (!isEmpty(this.previousExtent_) &&\n            !equalsExtent(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState)\n          );\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      const idle =\n        this.previousExtent_ &&\n        !frameState.viewHints[ViewHint.ANIMATING] &&\n        !frameState.viewHints[ViewHint.INTERACTING] &&\n        !equalsExtent(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(\n          new MapEvent(MapEventType.MOVEEND, this, frameState)\n        );\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    this.renderComplete_ =\n      this.hasListener(MapEventType.LOADSTART) ||\n      this.hasListener(MapEventType.LOADEND) ||\n      this.hasListener(RenderEventType.RENDERCOMPLETE)\n        ? !this.tileQueue_.getTilesLoading() &&\n          !this.tileQueue_.getCount() &&\n          !this.getLoadingOrNotReady()\n        : undefined;\n\n    if (!this.postRenderTimeoutHandle_) {\n      this.postRenderTimeoutHandle_ = setTimeout(() => {\n        this.postRenderTimeoutHandle_ = undefined;\n        this.handlePostRender();\n      }, 0);\n    }\n  }\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  setLayerGroup(layerGroup) {\n    const oldLayerGroup = this.getLayerGroup();\n    if (oldLayerGroup) {\n      this.handleLayerRemove_(new GroupEvent('removelayer', oldLayerGroup));\n    }\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  }\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  setSize(size) {\n    this.set(MapProperty.SIZE, size);\n  }\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string} [target] The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  setTarget(target) {\n    this.set(MapProperty.TARGET, target);\n  }\n\n  /**\n   * Set the view for this map.\n   * @param {View|Promise<import(\"./View.js\").ViewOptions>} view The view that controls this map.\n   * It is also possible to pass a promise that resolves to options for constructing a view.  This\n   * alternative allows view properties to be resolved by sources or other components that load\n   * view-related metadata.\n   * @observable\n   * @api\n   */\n  setView(view) {\n    if (!view || view instanceof View) {\n      this.set(MapProperty.VIEW, view);\n      return;\n    }\n    this.set(MapProperty.VIEW, new View());\n\n    const map = this;\n    view.then(function (viewOptions) {\n      map.setView(new View(viewOptions));\n    });\n  }\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  updateSize() {\n    const targetElement = this.getTargetElement();\n\n    let size = undefined;\n    if (targetElement) {\n      const computedStyle = getComputedStyle(targetElement);\n      const width =\n        targetElement.offsetWidth -\n        parseFloat(computedStyle['borderLeftWidth']) -\n        parseFloat(computedStyle['paddingLeft']) -\n        parseFloat(computedStyle['paddingRight']) -\n        parseFloat(computedStyle['borderRightWidth']);\n      const height =\n        targetElement.offsetHeight -\n        parseFloat(computedStyle['borderTopWidth']) -\n        parseFloat(computedStyle['paddingTop']) -\n        parseFloat(computedStyle['paddingBottom']) -\n        parseFloat(computedStyle['borderBottomWidth']);\n      if (!isNaN(width) && !isNaN(height)) {\n        size = [width, height];\n        if (\n          !hasArea(size) &&\n          !!(\n            targetElement.offsetWidth ||\n            targetElement.offsetHeight ||\n            targetElement.getClientRects().length\n          )\n        ) {\n          warn(\n            \"No map visible because the map container's width or height are 0.\"\n          );\n        }\n      }\n    }\n\n    const oldSize = this.getSize();\n    if (size && (!oldSize || !equals(size, oldSize))) {\n      this.setSize(size);\n      this.updateViewportSize_();\n    }\n  }\n\n  /**\n   * Recomputes the viewport size and save it on the view object (if any)\n   * @private\n   */\n  updateViewportSize_() {\n    const view = this.getView();\n    if (view) {\n      let size = undefined;\n      const computedStyle = getComputedStyle(this.viewport_);\n      if (computedStyle.width && computedStyle.height) {\n        size = [\n          parseInt(computedStyle.width, 10),\n          parseInt(computedStyle.height, 10),\n        ];\n      }\n      view.setViewportSize(size);\n    }\n  }\n}\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n  /**\n   * @type {HTMLElement|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget =\n      typeof options.keyboardEventTarget === 'string'\n        ? document.getElementById(options.keyboardEventTarget)\n        : options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  const values = {};\n\n  const layerGroup =\n    options.layers &&\n    typeof (/** @type {?} */ (options.layers).getLayers) === 'function'\n      ? /** @type {LayerGroup} */ (options.layers)\n      : new LayerGroup({\n          layers:\n            /** @type {Collection<import(\"./layer/Base.js\").default>|Array<import(\"./layer/Base.js\").default>} */ (\n              options.layers\n            ),\n        });\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] =\n    options.view instanceof View ? options.view : new View();\n\n  /** @type {Collection<import(\"./control/Control.js\").default>} */\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.controls).getArray) === 'function',\n        47\n      ); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = options.controls;\n    }\n  }\n\n  /** @type {Collection<import(\"./interaction/Interaction\").default>} */\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.interactions).getArray) ===\n          'function',\n        48\n      ); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = options.interactions;\n    }\n  }\n\n  /** @type {Collection<import(\"./Overlay.js\").default>} */\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.overlays).getArray) === 'function',\n        49\n      ); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values,\n  };\n}\nexport default Map;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map browser event.\n * @template {UIEvent} EVENT\n */\nclass MapBrowserEvent extends MapEvent {\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./Map.js\").default} map Map.\n   * @param {EVENT} originalEvent Original event.\n   * @param {boolean} [dragging] Is the map currently being dragged?\n   * @param {import(\"./Map.js\").FrameState} [frameState] Frame state.\n   * @param {Array<PointerEvent>} [activePointers] Active pointers.\n   */\n  constructor(type, map, originalEvent, dragging, frameState, activePointers) {\n    super(type, map, frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {EVENT}\n     * @api\n     */\n    this.originalEvent = originalEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {?import(\"./pixel.js\").Pixel}\n     */\n    this.pixel_ = null;\n\n    /**\n     * The coordinate in the user projection corresponding to the original browser event.\n     * @type {?import(\"./coordinate.js\").Coordinate}\n     */\n    this.coordinate_ = null;\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = dragging !== undefined ? dragging : false;\n\n    /**\n     * @type {Array<PointerEvent>|undefined}\n     */\n    this.activePointers = activePointers;\n  }\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original event.\n   * @type {import(\"./pixel.js\").Pixel}\n   * @api\n   */\n  get pixel() {\n    if (!this.pixel_) {\n      this.pixel_ = this.map.getEventPixel(this.originalEvent);\n    }\n    return this.pixel_;\n  }\n  set pixel(pixel) {\n    this.pixel_ = pixel;\n  }\n\n  /**\n   * The coordinate corresponding to the original browser event.  This will be in the user\n   * projection if one is set.  Otherwise it will be in the view projection.\n   * @type {import(\"./coordinate.js\").Coordinate}\n   * @api\n   */\n  get coordinate() {\n    if (!this.coordinate_) {\n      this.coordinate_ = this.map.getCoordinateFromPixel(this.pixel);\n    }\n    return this.coordinate_;\n  }\n  set coordinate(coordinate) {\n    this.coordinate_ = coordinate;\n  }\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @api\n   */\n  preventDefault() {\n    super.preventDefault();\n    if ('preventDefault' in this.originalEvent) {\n      /** @type {UIEvent} */ (this.originalEvent).preventDefault();\n    }\n  }\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @api\n   */\n  stopPropagation() {\n    super.stopPropagation();\n    if ('stopPropagation' in this.originalEvent) {\n      /** @type {UIEvent} */ (this.originalEvent).stopPropagation();\n    }\n  }\n}\n\nexport default MapBrowserEvent;\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel',\n};\n\n/***\n * @typedef {'singleclick'|'click'|'dblclick'|'pointerdrag'|'pointermove'} Types\n */\n","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map event.\n */\nclass MapEvent extends Event {\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./Map.js\").default} map Map.\n   * @param {?import(\"./Map.js\").FrameState} [frameState] Frame state.\n   */\n  constructor(type, map, frameState) {\n    super(type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./Map.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./Map.js\").FrameState}\n     * @api\n     */\n    this.frameState = frameState !== undefined ? frameState : null;\n  }\n}\n\nexport default MapEvent;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend',\n\n  /**\n   * Triggered when loading of additional map data (tiles, images, features) starts.\n   * @event module:ol/MapEvent~MapEvent#loadstart\n   * @api\n   */\n  LOADSTART: 'loadstart',\n\n  /**\n   * Triggered when loading of additional map data has completed.\n   * @event module:ol/MapEvent~MapEvent#loadend\n   * @api\n   */\n  LOADEND: 'loadend',\n};\n\n/***\n * @typedef {'postrender'|'movestart'|'moveend'|'loadstart'|'loadend'} Types\n */\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view',\n};\n","/**\n * @module ol/Object\n */\nimport Event from './events/Event.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport {getUid} from './util.js';\nimport {isEmpty} from './obj.js';\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport class ObjectEvent extends Event {\n  /**\n   * @param {string} type The event type.\n   * @param {string} key The property name.\n   * @param {*} oldValue The old value for `key`.\n   */\n  constructor(type, key, oldValue) {\n    super(type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n  }\n}\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types, ObjectEvent, Return> &\n *    import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types, Return>} ObjectOnSignature\n */\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable~Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nclass BaseObject extends Observable {\n  /**\n   * @param {Object<string, *>} [values] An object with key-value pairs.\n   */\n  constructor(values) {\n    super();\n\n    /***\n     * @type {ObjectOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ObjectOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ObjectOnSignature<void>}\n     */\n    this.un;\n\n    // Call {@link module:ol/util.getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {Object<string, *>}\n     */\n    this.values_ = null;\n\n    if (values !== undefined) {\n      this.setProperties(values);\n    }\n  }\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  get(key) {\n    let value;\n    if (this.values_ && this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  }\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  getKeys() {\n    return (this.values_ && Object.keys(this.values_)) || [];\n  }\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  getProperties() {\n    return (this.values_ && Object.assign({}, this.values_)) || {};\n  }\n\n  /**\n   * @return {boolean} The object has properties.\n   */\n  hasProperties() {\n    return !!this.values_;\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  notify(key, oldValue) {\n    let eventType;\n    eventType = `change:${key}`;\n    if (this.hasListener(eventType)) {\n      this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    }\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    if (this.hasListener(eventType)) {\n      this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    }\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {import(\"./events.js\").Listener} listener Listener.\n   */\n  addChangeListener(key, listener) {\n    this.addEventListener(`change:${key}`, listener);\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {import(\"./events.js\").Listener} listener Listener.\n   */\n  removeChangeListener(key, listener) {\n    this.removeEventListener(`change:${key}`, listener);\n  }\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean} [silent] Update without triggering an event.\n   * @api\n   */\n  set(key, value, silent) {\n    const values = this.values_ || (this.values_ = {});\n    if (silent) {\n      values[key] = value;\n    } else {\n      const oldValue = values[key];\n      values[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean} [silent] Update without triggering an event.\n   * @api\n   */\n  setProperties(values, silent) {\n    for (const key in values) {\n      this.set(key, values[key], silent);\n    }\n  }\n\n  /**\n   * Apply any properties from another object without triggering events.\n   * @param {BaseObject} source The source object.\n   * @protected\n   */\n  applyProperties(source) {\n    if (!source.values_) {\n      return;\n    }\n    Object.assign(this.values_ || (this.values_ = {}), source.values_);\n  }\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean} [silent] Unset without triggering an event.\n   * @api\n   */\n  unset(key, silent) {\n    if (this.values_ && key in this.values_) {\n      const oldValue = this.values_[key];\n      delete this.values_[key];\n      if (isEmpty(this.values_)) {\n        this.values_ = null;\n      }\n      if (!silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n}\n\nexport default BaseObject;\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange',\n};\n\n/**\n * @typedef {'propertychange'} Types\n */\n","/**\n * @module ol/Observable\n */\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport {listen, listenOnce, unlistenByKey} from './events.js';\n\n/***\n * @template {string} Type\n * @template {Event|import(\"./events/Event.js\").default} EventClass\n * @template Return\n * @typedef {(type: Type, listener: (event: EventClass) => ?) => Return} OnSignature\n */\n\n/***\n * @template {string} Type\n * @template Return\n * @typedef {(type: Type[], listener: (event: Event|import(\"./events/Event\").default) => ?) => Return extends void ? void : Return[]} CombinedOnSignature\n */\n\n/**\n * @typedef {'change'|'error'} EventTypes\n */\n\n/***\n * @template Return\n * @typedef {OnSignature<EventTypes, import(\"./events/Event.js\").default, Return> & CombinedOnSignature<EventTypes, Return>} ObservableOnSignature\n */\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").default\n * @api\n */\nclass Observable extends EventTarget {\n  constructor() {\n    super();\n\n    this.on =\n      /** @type {ObservableOnSignature<import(\"./events\").EventsKey>} */ (\n        this.onInternal\n      );\n\n    this.once =\n      /** @type {ObservableOnSignature<import(\"./events\").EventsKey>} */ (\n        this.onceInternal\n      );\n\n    this.un = /** @type {ObservableOnSignature<void>} */ (this.unInternal);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n  }\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  changed() {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  getRevision() {\n    return this.revision_;\n  }\n\n  /**\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Event key.\n   * @protected\n   */\n  onInternal(type, listener) {\n    if (Array.isArray(type)) {\n      const len = type.length;\n      const keys = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    }\n    return listen(this, /** @type {string} */ (type), listener);\n  }\n\n  /**\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Event key.\n   * @protected\n   */\n  onceInternal(type, listener) {\n    let key;\n    if (Array.isArray(type)) {\n      const len = type.length;\n      key = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        key[i] = listenOnce(this, type[i], listener);\n      }\n    } else {\n      key = listenOnce(this, /** @type {string} */ (type), listener);\n    }\n    /** @type {Object} */ (listener).ol_key = key;\n    return key;\n  }\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @protected\n   */\n  unInternal(type, listener) {\n    const key = /** @type {Object} */ (listener).ol_key;\n    if (key) {\n      unByKey(key);\n    } else if (Array.isArray(type)) {\n      for (let i = 0, ii = type.length; i < ii; ++i) {\n        this.removeEventListener(type[i], listener);\n      }\n    } else {\n      this.removeEventListener(type, listener);\n    }\n  }\n}\n\n/**\n * Listen for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.on;\n\n/**\n * Listen once for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.once;\n\n/**\n * Unlisten for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @api\n */\nObservable.prototype.un;\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\nexport default Observable;\n","/**\n * @module ol/Tile\n */\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport TileState from './TileState.js';\nimport {abstract} from './util.js';\nimport {easeIn} from './easing.js';\n\n/**\n * A function that takes an {@link module:ol/Tile~Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState.js';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   const xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     const data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string): void} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~TileSource} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection~Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @api\n */\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nclass Tile extends EventTarget {\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {Options} [options] Tile options.\n   */\n  constructor(tileCoord, state, options) {\n    super();\n\n    options = options ? options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {import(\"./TileState.js\").default}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ =\n      options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n    /**\n     * @type {boolean}\n     */\n    this.interpolate = !!options.interpolate;\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Called by the tile cache when the tile is removed from the cache due to expiry\n   */\n  release() {\n    if (this.state === TileState.ERROR) {\n      // to remove the `change` listener on this tile in `ol/TileQueue#handleTileChange`\n      this.setState(TileState.EMPTY);\n    }\n  }\n\n  /**\n   * @return {string} Key.\n   */\n  getKey() {\n    return this.key + '/' + this.tileCoord;\n  }\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  getInterimTile() {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    let tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        // Show tile immediately instead of fading it in after loading, because\n        // the interim tile is in place already\n        this.transition_ = 0;\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  }\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  refreshInterimChain() {\n    if (!this.interimTile) {\n      return;\n    }\n\n    let tile = this.interimTile;\n\n    /**\n     * @type {Tile}\n     */\n    let prev = this;\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  }\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  getTileCoord() {\n    return this.tileCoord;\n  }\n\n  /**\n   * @return {import(\"./TileState.js\").default} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @api\n   */\n  setState(state) {\n    if (this.state !== TileState.ERROR && this.state > state) {\n      throw new Error('Tile load sequence violation');\n    }\n    this.state = state;\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  load() {\n    abstract();\n  }\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  getAlpha(id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    let start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    const delta = time - start + 1000 / 60; // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  }\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  inTransition(id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  }\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  endTransition(id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  }\n}\n\nexport default Tile;\n","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nclass TileCache extends LRUCache {\n  clear() {\n    while (this.getCount() > 0) {\n      this.pop().release();\n    }\n    super.clear();\n  }\n\n  /**\n   * @param {!Object<string, boolean>} usedTiles Used tiles.\n   */\n  expireCache(usedTiles) {\n    while (this.canExpireCache()) {\n      const tile = this.peekLast();\n      if (tile.getKey() in usedTiles) {\n        break;\n      } else {\n        this.pop().release();\n      }\n    }\n  }\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  pruneExceptNewestZ() {\n    if (this.getCount() === 0) {\n      return;\n    }\n    const key = this.peekFirstKey();\n    const tileCoord = fromKey(key);\n    const z = tileCoord[0];\n    this.forEach((tile) => {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.release();\n      }\n    });\n  }\n}\n\nexport default TileCache;\n","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nclass TileRange {\n  /**\n   * @param {number} minX Minimum X.\n   * @param {number} maxX Maximum X.\n   * @param {number} minY Minimum Y.\n   * @param {number} maxY Maximum Y.\n   */\n  constructor(minX, maxX, minY, maxY) {\n    /**\n     * @type {number}\n     */\n    this.minX = minX;\n\n    /**\n     * @type {number}\n     */\n    this.maxX = maxX;\n\n    /**\n     * @type {number}\n     */\n    this.minY = minY;\n\n    /**\n     * @type {number}\n     */\n    this.maxY = maxY;\n  }\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @return {boolean} Contains tile coordinate.\n   */\n  contains(tileCoord) {\n    return this.containsXY(tileCoord[1], tileCoord[2]);\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Contains.\n   */\n  containsTileRange(tileRange) {\n    return (\n      this.minX <= tileRange.minX &&\n      tileRange.maxX <= this.maxX &&\n      this.minY <= tileRange.minY &&\n      tileRange.maxY <= this.maxY\n    );\n  }\n\n  /**\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @return {boolean} Contains coordinate.\n   */\n  containsXY(x, y) {\n    return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Equals.\n   */\n  equals(tileRange) {\n    return (\n      this.minX == tileRange.minX &&\n      this.minY == tileRange.minY &&\n      this.maxX == tileRange.maxX &&\n      this.maxY == tileRange.maxY\n    );\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   */\n  extend(tileRange) {\n    if (tileRange.minX < this.minX) {\n      this.minX = tileRange.minX;\n    }\n    if (tileRange.maxX > this.maxX) {\n      this.maxX = tileRange.maxX;\n    }\n    if (tileRange.minY < this.minY) {\n      this.minY = tileRange.minY;\n    }\n    if (tileRange.maxY > this.maxY) {\n      this.maxY = tileRange.maxY;\n    }\n  }\n\n  /**\n   * @return {number} Height.\n   */\n  getHeight() {\n    return this.maxY - this.minY + 1;\n  }\n\n  /**\n   * @return {import(\"./size.js\").Size} Size.\n   */\n  getSize() {\n    return [this.getWidth(), this.getHeight()];\n  }\n\n  /**\n   * @return {number} Width.\n   */\n  getWidth() {\n    return this.maxX - this.minX + 1;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Intersects.\n   */\n  intersects(tileRange) {\n    return (\n      this.minX <= tileRange.maxX &&\n      this.maxX >= tileRange.minX &&\n      this.minY <= tileRange.maxY &&\n      this.maxY >= tileRange.minY\n    );\n  }\n}\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange} [tileRange] TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  }\n  return new TileRange(minX, maxX, minY, maxY);\n}\n\nexport default TileRange;\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation',\n};\n","/**\n * @module ol/View\n */\nimport BaseObject from './Object.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {\n  METERS_PER_UNIT,\n  createProjection,\n  disableCoordinateWarning,\n  fromUserCoordinate,\n  fromUserExtent,\n  getUserProjection,\n  toUserCoordinate,\n  toUserExtent,\n} from './proj.js';\nimport {VOID} from './functions.js';\nimport {\n  add as addCoordinate,\n  equals as coordinatesEqual,\n  equals,\n  rotate as rotateCoordinate,\n} from './coordinate.js';\nimport {assert} from './asserts.js';\nimport {none as centerNone, createExtent} from './centerconstraint.js';\nimport {clamp, modulo} from './math.js';\nimport {\n  createMinMaxResolution,\n  createSnapToPower,\n  createSnapToResolutions,\n} from './resolutionconstraint.js';\nimport {\n  createSnapToN,\n  createSnapToZero,\n  disable,\n  none as rotationNone,\n} from './rotationconstraint.js';\nimport {easeOut, inAndOut} from './easing.js';\nimport {\n  getCenter,\n  getForViewAndSize,\n  getHeight,\n  getWidth,\n  isEmpty,\n} from './extent.js';\nimport {linearFindNearest} from './array.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter] Source center.\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter] Target center.\n * @property {number} [sourceResolution] Source resolution.\n * @property {number} [targetResolution] Target resolution.\n * @property {number} [sourceRotation] Source rotation.\n * @property {number} [targetRotation] Target rotation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Anchor.\n * @property {number} start Start.\n * @property {number} duration Duration.\n * @property {boolean} complete Complete.\n * @property {function(number):number} easing Easing.\n * @property {function(boolean):void} callback Callback.\n */\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center Center.\n * @property {import(\"./resolutionconstraint.js\").Type} resolution Resolution.\n * @property {import(\"./rotationconstraint.js\").Type} rotation Rotation.\n */\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [nearest=false] If the view `constrainResolution` option is `true`,\n * get the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing.inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean):void} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. If a user projection is not set, the coordinate system for the center is\n * specified with the `projection` option. Layer sources will not be fetched if this\n * is not set, but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * view, in other words, nothing outside of this extent can be visible on the map.\n * @property {boolean} [constrainOnlyCenter=false] If true, the extent\n * constraint will only apply to the view center and not the whole extent.\n * @property {boolean} [smoothExtentConstraint=true] If true, the extent\n * constraint will be applied smoothly, i.e. allow the view to go slightly outside\n * of the given `extent`.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {boolean} [multiWorld=false] If `false` the view is constrained so\n * only one world is visible, and you cannot pan off the edge.  If `true` the map\n * may show multiple worlds at low zoom levels.  Only used if the `projection` is\n * global.  Note that if `extent` is also provided it is given precedence.\n * @property {boolean} [constrainResolution=false] If true, the view will always\n * animate to the closest zoom level after an interaction; false means\n * intermediary zoom levels are allowed.\n * @property {boolean} [smoothResolutionConstraint=true] If true, the resolution\n * min/max values will be applied smoothly, i. e. allow the view to exceed slightly\n * the given resolution or zoom bounds.\n * @property {boolean} [showFullExtent=false] Allow the view to be zoomed out to\n * show the full configured extent. By default, when a view is configured with an\n * extent, users will not be able to zoom out so the viewport exceeds the extent in\n * either dimension. This means the full extent may not be visible if the viewport\n * is taller or wider than the aspect ratio of the configured extent. If\n * showFullExtent is true, the user will be able to zoom out so that the viewport\n * exceeds the height or width of the configured extent, but not both, allowing the\n * full extent to be shown.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions that determine the\n * zoom levels if specified. The index in the array corresponds to the zoom level,\n * therefore the resolution values have to be in descending order. It also constrains\n * the resolution by the minimum and maximum value. If set the `maxResolution`,\n * `minResolution`, `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view.\n * @property {number} [zoomFactor=2] The zoom factor used to compute the\n * corresponding resolution.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in css pixels).\n * If the map viewport is partially covered with other content (overlays) along\n * its edges, this setting allows to shift the center of the viewport away from\n * that content. The order of the values is top, right, bottom, left.\n */\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remain fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing.inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center Center (in view projection coordinates).\n * @property {import(\"./proj/Projection.js\").default} projection Projection.\n * @property {number} resolution Resolution.\n * @property {import(\"./coordinate.js\").Coordinate} [nextCenter] The next center during an animation series.\n * @property {number} [nextResolution] The next resolution during an animation series.\n * @property {number} [nextRotation] The next rotation during an animation series.\n * @property {number} rotation Rotation.\n * @property {number} zoom Zoom.\n */\n\n/**\n * Like {@link import(\"./Map.js\").FrameState}, but just `viewState` and `extent`.\n * @typedef {Object} ViewStateLayerStateExtent\n * @property {State} viewState View state.\n * @property {import(\"./extent.js\").Extent} extent Extent (in user projection coordinates).\n * @property {Array<import(\"./layer/Layer.js\").State>} [layerStatesArray] Layer states.\n */\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:center'|'change:resolution'|'change:rotation'} ViewObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<ViewObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|ViewObjectEventTypes, Return>} ViewOnSignature\n */\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * A View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Web Mercator (EPSG:3857).\n *\n * ### The view states\n *\n * A View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * The `zoom` state is actually not saved on the view: all computations\n * internally use the `resolution` state. Still, the `setZoom` and `getZoom`\n * methods are available, as well as `getResolutionForZoom` and\n * `getZoomForResolution` to switch from one system to the other.\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view, but any constraint defined in the constructor will\n * be applied along the way.\n *\n * A View object can have a *resolution constraint*, a *rotation constraint*\n * and a *center constraint*.\n *\n * The *resolution constraint* typically restricts min/max values and\n * snaps to specific resolutions. It is determined by the following\n * options: `resolutions`, `maxResolution`, `maxZoom` and `zoomFactor`.\n * If `resolutions` is set, the other three options are ignored. See\n * documentation for each option for more information. By default, the view\n * only has a min/max restriction and allow intermediary zoom levels when\n * pinch-zooming for example.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default rotation is allowed and its value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the view center is not constrained at all.\n *\n * ### Changing the view state\n *\n * It is important to note that `setZoom`, `setResolution`, `setCenter` and\n * `setRotation` are subject to the above mentioned constraints. As such, it\n * may sometimes not be possible to know in advance the resulting state of the\n * View. For example, calling `setResolution(10)` does not guarantee that\n * `getResolution()` will return `10`.\n *\n * A consequence of this is that, when applying a delta on the view state, one\n * should use `adjustCenter`, `adjustRotation`, `adjustZoom` and `adjustResolution`\n * rather than the corresponding setters. This will let view do its internal\n * computations. Besides, the `adjust*` methods also take an `anchor`\n * argument which allows specifying an origin for the transformation.\n *\n * ### Interacting with the view\n *\n * View constraints are usually only applied when the view is *at rest*, meaning that\n * no interaction or animation is ongoing. As such, if the user puts the view in a\n * state that is not equivalent to a constrained one (e.g. rotating the view when\n * the snap angle is 0), an animation will be triggered at the interaction end to\n * put back the view to a stable state;\n *\n * @api\n */\nclass View extends BaseObject {\n  /**\n   * @param {ViewOptions} [options] View options.\n   */\n  constructor(options) {\n    super();\n\n    /***\n     * @type {ViewOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ViewOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ViewOnSignature<void>}\n     */\n    this.un;\n\n    options = Object.assign({}, options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    /**\n     * @private\n     * @type {import(\"./size.js\").Size}\n     */\n    this.viewportSize_ = [100, 100];\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate|undefined}\n     */\n    this.targetCenter_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetResolution_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetRotation_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate}\n     */\n    this.nextCenter_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.nextResolution_;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.nextRotation_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate|undefined}\n     */\n    this.cancelAnchor_ = undefined;\n\n    if (options.projection) {\n      disableCoordinateWarning();\n    }\n    if (options.center) {\n      options.center = fromUserCoordinate(options.center, this.projection_);\n    }\n    if (options.extent) {\n      options.extent = fromUserExtent(options.extent, this.projection_);\n    }\n\n    this.applyOptions_(options);\n  }\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  applyOptions_(options) {\n    const properties = Object.assign({}, options);\n    for (const key in ViewProperty) {\n      delete properties[key];\n    }\n    this.setProperties(properties, true);\n\n    const resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @type {Array<number>|undefined}\n     * @private\n     */\n    this.padding_ = options.padding;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    const centerConstraint = createCenterConstraint(options);\n    const resolutionConstraint = resolutionConstraintInfo.constraint;\n    const rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint,\n    };\n\n    this.setRotation(options.rotation !== undefined ? options.rotation : 0);\n    this.setCenterInternal(\n      options.center !== undefined ? options.center : null\n    );\n    if (options.resolution !== undefined) {\n      this.setResolution(options.resolution);\n    } else if (options.zoom !== undefined) {\n      this.setZoom(options.zoom);\n    }\n  }\n\n  /**\n   * Padding (in css pixels).\n   * If the map viewport is partially covered with other content (overlays) along\n   * its edges, this setting allows to shift the center of the viewport away from that\n   * content. The order of the values in the array is top, right, bottom, left.\n   * The default is no padding, which is equivalent to `[0, 0, 0, 0]`.\n   * @type {Array<number>|undefined}\n   * @api\n   */\n  get padding() {\n    return this.padding_;\n  }\n  set padding(padding) {\n    let oldPadding = this.padding_;\n    this.padding_ = padding;\n    const center = this.getCenterInternal();\n    if (center) {\n      const newPadding = padding || [0, 0, 0, 0];\n      oldPadding = oldPadding || [0, 0, 0, 0];\n      const resolution = this.getResolution();\n      const offsetX =\n        (resolution / 2) *\n        (newPadding[3] - oldPadding[3] + oldPadding[1] - newPadding[1]);\n      const offsetY =\n        (resolution / 2) *\n        (newPadding[0] - oldPadding[0] + oldPadding[2] - newPadding[2]);\n      this.setCenterInternal([center[0] + offsetX, center[1] - offsetY]);\n    }\n  }\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  getUpdatedOptions_(newOptions) {\n    const options = this.getProperties();\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenterInternal();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return Object.assign({}, options, newOptions);\n  }\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  animate(var_args) {\n    if (this.isDef() && !this.getAnimating()) {\n      this.resolveConstraints(0);\n    }\n    const args = new Array(arguments.length);\n    for (let i = 0; i < args.length; ++i) {\n      let options = arguments[i];\n      if (options.center) {\n        options = Object.assign({}, options);\n        options.center = fromUserCoordinate(\n          options.center,\n          this.getProjection()\n        );\n      }\n      if (options.anchor) {\n        options = Object.assign({}, options);\n        options.anchor = fromUserCoordinate(\n          options.anchor,\n          this.getProjection()\n        );\n      }\n      args[i] = options;\n    }\n    this.animateInternal.apply(this, args);\n  }\n\n  /**\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation options.\n   */\n  animateInternal(var_args) {\n    let animationCount = arguments.length;\n    let callback;\n    if (\n      animationCount > 1 &&\n      typeof arguments[animationCount - 1] === 'function'\n    ) {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n\n    let i = 0;\n    for (; i < animationCount && !this.isDef(); ++i) {\n      // if view properties are not yet set, shortcut to the final state\n      const state = arguments[i];\n      if (state.center) {\n        this.setCenterInternal(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      } else if (state.resolution) {\n        this.setResolution(state.resolution);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n    }\n    if (i === animationCount) {\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n\n    let start = Date.now();\n    let center = this.targetCenter_.slice();\n    let resolution = this.targetResolution_;\n    let rotation = this.targetRotation_;\n    const series = [];\n    for (; i < animationCount; ++i) {\n      const options = /** @type {AnimationOptions} */ (arguments[i]);\n\n      const animation = {\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut,\n        callback: callback,\n      };\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center.slice();\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.getResolutionForZoom(options.zoom);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        const delta =\n          modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  }\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  getAnimating() {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  }\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  getInteracting() {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  }\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  cancelAnimations() {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    let anchor;\n    for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n      const series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n      if (!anchor) {\n        for (let j = 0, jj = series.length; j < jj; ++j) {\n          const animation = series[j];\n          if (!animation.complete) {\n            anchor = animation.anchor;\n            break;\n          }\n        }\n      }\n    }\n    this.animations_.length = 0;\n    this.cancelAnchor_ = anchor;\n    this.nextCenter_ = null;\n    this.nextResolution_ = NaN;\n    this.nextRotation_ = NaN;\n  }\n\n  /**\n   * Update all animations.\n   */\n  updateAnimations_() {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    const now = Date.now();\n    let more = false;\n    for (let i = this.animations_.length - 1; i >= 0; --i) {\n      const series = this.animations_[i];\n      let seriesComplete = true;\n      for (let j = 0, jj = series.length; j < jj; ++j) {\n        const animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        const elapsed = now - animation.start;\n        let fraction =\n          animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        const progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          const x0 = animation.sourceCenter[0];\n          const y0 = animation.sourceCenter[1];\n          const x1 = animation.targetCenter[0];\n          const y1 = animation.targetCenter[1];\n          this.nextCenter_ = animation.targetCenter;\n          const x = x0 + progress * (x1 - x0);\n          const y = y0 + progress * (y1 - y0);\n          this.targetCenter_ = [x, y];\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          const resolution =\n            progress === 1\n              ? animation.targetResolution\n              : animation.sourceResolution +\n                progress *\n                  (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            const size = this.getViewportSize_(this.getRotation());\n            const constrainedResolution = this.constraints_.resolution(\n              resolution,\n              0,\n              size,\n              true\n            );\n            this.targetCenter_ = this.calculateCenterZoom(\n              constrainedResolution,\n              animation.anchor\n            );\n          }\n          this.nextResolution_ = animation.targetResolution;\n          this.targetResolution_ = resolution;\n          this.applyTargetState_(true);\n        }\n        if (\n          animation.sourceRotation !== undefined &&\n          animation.targetRotation !== undefined\n        ) {\n          const rotation =\n            progress === 1\n              ? modulo(animation.targetRotation + Math.PI, 2 * Math.PI) -\n                Math.PI\n              : animation.sourceRotation +\n                progress *\n                  (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            const constrainedRotation = this.constraints_.rotation(\n              rotation,\n              true\n            );\n            this.targetCenter_ = this.calculateCenterRotate(\n              constrainedRotation,\n              animation.anchor\n            );\n          }\n          this.nextRotation_ = animation.targetRotation;\n          this.targetRotation_ = rotation;\n        }\n        this.applyTargetState_(true);\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        this.nextCenter_ = null;\n        this.nextResolution_ = NaN;\n        this.nextRotation_ = NaN;\n        const callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(\n        this.updateAnimations_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  calculateCenterRotate(rotation, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  }\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  calculateCenterZoom(resolution, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    const currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      const x =\n        anchor[0] -\n        (resolution * (anchor[0] - currentCenter[0])) / currentResolution;\n      const y =\n        anchor[1] -\n        (resolution * (anchor[1] - currentCenter[1])) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  }\n\n  /**\n   * Returns the current viewport size.\n   * @private\n   * @param {number} [rotation] Take into account the rotation of the viewport when giving the size\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  getViewportSize_(rotation) {\n    const size = this.viewportSize_;\n    if (rotation) {\n      const w = size[0];\n      const h = size[1];\n      return [\n        Math.abs(w * Math.cos(rotation)) + Math.abs(h * Math.sin(rotation)),\n        Math.abs(w * Math.sin(rotation)) + Math.abs(h * Math.cos(rotation)),\n      ];\n    }\n    return size;\n  }\n\n  /**\n   * Stores the viewport size on the view. The viewport size is not read every time from the DOM\n   * to avoid performance hit and layout reflow.\n   * This should be done on map size change.\n   * Note: the constraints are not resolved during an animation to avoid stopping it\n   * @param {import(\"./size.js\").Size} [size] Viewport size; if undefined, [100, 100] is assumed\n   */\n  setViewportSize(size) {\n    this.viewportSize_ = Array.isArray(size) ? size.slice() : [100, 100];\n    if (!this.getAnimating()) {\n      this.resolveConstraints(0);\n    }\n  }\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  getCenter() {\n    const center = this.getCenterInternal();\n    if (!center) {\n      return center;\n    }\n    return toUserCoordinate(center, this.getProjection());\n  }\n\n  /**\n   * Get the view center without transforming to user projection.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   */\n  getCenterInternal() {\n    return /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (\n      this.get(ViewProperty.CENTER)\n    );\n  }\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  getConstraints() {\n    return this.constraints_;\n  }\n\n  /**\n   * @return {boolean} Resolution constraint is set\n   */\n  getConstrainResolution() {\n    return this.get('constrainResolution');\n  }\n\n  /**\n   * @param {Array<number>} [hints] Destination array.\n   * @return {Array<number>} Hint.\n   */\n  getHints(hints) {\n    if (hints !== undefined) {\n      hints[0] = this.hints_[0];\n      hints[1] = this.hints_[1];\n      return hints;\n    }\n    return this.hints_.slice();\n  }\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size. If not provided, the size\n   * of the map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  calculateExtent(size) {\n    const extent = this.calculateExtentInternal(size);\n    return toUserExtent(extent, this.getProjection());\n  }\n\n  /**\n   * @param {import(\"./size.js\").Size} [size] Box pixel size. If not provided,\n   * the map's last known viewport size will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  calculateExtentInternal(size) {\n    size = size || this.getViewportSizeMinusPadding_();\n    const center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (\n      this.getCenterInternal()\n    );\n    assert(center, 1); // The view center is not defined\n    const resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    const rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  }\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  getMaxResolution() {\n    return this.maxResolution_;\n  }\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  getMinResolution() {\n    return this.minResolution_;\n  }\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  getMaxZoom() {\n    return /** @type {number} */ (\n      this.getZoomForResolution(this.minResolution_)\n    );\n  }\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  setMaxZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  }\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  getMinZoom() {\n    return /** @type {number} */ (\n      this.getZoomForResolution(this.maxResolution_)\n    );\n  }\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  setMinZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  }\n\n  /**\n   * Set whether the view should allow intermediary zoom levels.\n   * @param {boolean} enabled Whether the resolution is constrained.\n   * @api\n   */\n  setConstrainResolution(enabled) {\n    this.applyOptions_(this.getUpdatedOptions_({constrainResolution: enabled}));\n  }\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  getProjection() {\n    return this.projection_;\n  }\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  getResolution() {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  }\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  getResolutionForExtent(extent, size) {\n    return this.getResolutionForExtentInternal(\n      fromUserExtent(extent, this.getProjection()),\n      size\n    );\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   */\n  getResolutionForExtentInternal(extent, size) {\n    size = size || this.getViewportSizeMinusPadding_();\n    const xResolution = getWidth(extent) / size[0];\n    const yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  }\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number} [power] Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  getResolutionForValueFunction(power) {\n    power = power || 2;\n    const maxResolution = this.getConstrainedResolution(this.maxResolution_);\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function (value) {\n        const resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      }\n    );\n  }\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  getRotation() {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  }\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number} [power] Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  getValueForResolutionFunction(power) {\n    const logPower = Math.log(power || 2);\n    const maxResolution = this.getConstrainedResolution(this.maxResolution_);\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / logPower;\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function (resolution) {\n        const value = Math.log(maxResolution / resolution) / logPower / max;\n        return value;\n      }\n    );\n  }\n\n  /**\n   * Returns the size of the viewport minus padding.\n   * @private\n   * @param {number} [rotation] Take into account the rotation of the viewport when giving the size\n   * @return {import(\"./size.js\").Size} Viewport size reduced by the padding.\n   */\n  getViewportSizeMinusPadding_(rotation) {\n    let size = this.getViewportSize_(rotation);\n    const padding = this.padding_;\n    if (padding) {\n      size = [\n        size[0] - padding[1] - padding[3],\n        size[1] - padding[0] - padding[2],\n      ];\n    }\n    return size;\n  }\n\n  /**\n   * @return {State} View state.\n   */\n  getState() {\n    const projection = this.getProjection();\n    const resolution = this.getResolution();\n    const rotation = this.getRotation();\n    let center = /** @type {import(\"./coordinate.js\").Coordinate} */ (\n      this.getCenterInternal()\n    );\n    const padding = this.padding_;\n    if (padding) {\n      const reducedSize = this.getViewportSizeMinusPadding_();\n      center = calculateCenterOn(\n        center,\n        this.getViewportSize_(),\n        [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],\n        resolution,\n        rotation\n      );\n    }\n    return {\n      center: center.slice(0),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      nextCenter: this.nextCenter_,\n      nextResolution: this.nextResolution_,\n      nextRotation: this.nextRotation_,\n      rotation: rotation,\n      zoom: this.getZoom(),\n    };\n  }\n\n  /**\n   * @return {ViewStateLayerStateExtent} Like `FrameState`, but just `viewState` and `extent`.\n   */\n  getViewStateAndExtent() {\n    return {\n      viewState: this.getState(),\n      extent: this.calculateExtent(),\n    };\n  }\n\n  /**\n   * Get the current zoom level. This method may return non-integer zoom levels\n   * if the view does not constrain the resolution, or if an interaction or\n   * animation is underway.\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  getZoom() {\n    let zoom;\n    const resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  }\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  getZoomForResolution(resolution) {\n    let offset = this.minZoom_ || 0;\n    let max, zoomFactor;\n    if (this.resolutions_) {\n      const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  }\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  getResolutionForZoom(zoom) {\n    if (this.resolutions_) {\n      if (this.resolutions_.length <= 1) {\n        return 0;\n      }\n      const baseLevel = clamp(\n        Math.floor(zoom),\n        0,\n        this.resolutions_.length - 2\n      );\n      const zoomFactor =\n        this.resolutions_[baseLevel] / this.resolutions_[baseLevel + 1];\n      return (\n        this.resolutions_[baseLevel] /\n        Math.pow(zoomFactor, clamp(zoom - baseLevel, 0, 1))\n      );\n    }\n    return (\n      this.maxResolution_ / Math.pow(this.zoomFactor_, zoom - this.minZoom_)\n    );\n  }\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions} [options] Options.\n   * @api\n   */\n  fit(geometryOrExtent, options) {\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    let geometry;\n    assert(\n      Array.isArray(geometryOrExtent) ||\n        typeof (/** @type {?} */ (geometryOrExtent).getSimplifiedGeometry) ===\n          'function',\n      24\n    ); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent), 25); // Cannot fit empty extent provided as `geometry`\n      const extent = fromUserExtent(geometryOrExtent, this.getProjection());\n      geometry = polygonFromExtent(extent);\n    } else if (geometryOrExtent.getType() === 'Circle') {\n      const extent = fromUserExtent(\n        geometryOrExtent.getExtent(),\n        this.getProjection()\n      );\n      geometry = polygonFromExtent(extent);\n      geometry.rotate(this.getRotation(), getCenter(extent));\n    } else {\n      const userProjection = getUserProjection();\n      if (userProjection) {\n        geometry = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (\n          geometryOrExtent\n            .clone()\n            .transform(userProjection, this.getProjection())\n        );\n      } else {\n        geometry = geometryOrExtent;\n      }\n    }\n\n    this.fitInternal(geometry, options);\n  }\n\n  /**\n   * Calculate rotated extent\n   * @param {import(\"./geom/SimpleGeometry.js\").default} geometry The geometry.\n   * @return {import(\"./extent\").Extent} The rotated extent for the geometry.\n   */\n  rotatedExtentForGeometry(geometry) {\n    const rotation = this.getRotation();\n    const cosAngle = Math.cos(rotation);\n    const sinAngle = Math.sin(-rotation);\n    const coords = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    let minRotX = +Infinity;\n    let minRotY = +Infinity;\n    let maxRotX = -Infinity;\n    let maxRotY = -Infinity;\n    for (let i = 0, ii = coords.length; i < ii; i += stride) {\n      const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n    return [minRotX, minRotY, maxRotX, maxRotY];\n  }\n\n  /**\n   * @param {import(\"./geom/SimpleGeometry.js\").default} geometry The geometry.\n   * @param {FitOptions} [options] Options.\n   */\n  fitInternal(geometry, options) {\n    options = options || {};\n    let size = options.size;\n    if (!size) {\n      size = this.getViewportSizeMinusPadding_();\n    }\n    const padding =\n      options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    const nearest = options.nearest !== undefined ? options.nearest : false;\n    let minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.getResolutionForZoom(options.maxZoom);\n    } else {\n      minResolution = 0;\n    }\n\n    const rotatedExtent = this.rotatedExtentForGeometry(geometry);\n\n    // calculate resolution\n    let resolution = this.getResolutionForExtentInternal(rotatedExtent, [\n      size[0] - padding[1] - padding[3],\n      size[1] - padding[0] - padding[2],\n    ]);\n    resolution = isNaN(resolution)\n      ? minResolution\n      : Math.max(resolution, minResolution);\n    resolution = this.getConstrainedResolution(resolution, nearest ? 0 : 1);\n\n    // calculate center\n    const rotation = this.getRotation();\n    const sinAngle = Math.sin(rotation);\n    const cosAngle = Math.cos(rotation);\n    const centerRot = getCenter(rotatedExtent);\n    centerRot[0] += ((padding[1] - padding[3]) / 2) * resolution;\n    centerRot[1] += ((padding[0] - padding[2]) / 2) * resolution;\n    const centerX = centerRot[0] * cosAngle - centerRot[1] * sinAngle;\n    const centerY = centerRot[1] * cosAngle + centerRot[0] * sinAngle;\n    const center = this.getConstrainedCenter([centerX, centerY], resolution);\n    const callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animateInternal(\n        {\n          resolution: resolution,\n          center: center,\n          duration: options.duration,\n          easing: options.easing,\n        },\n        callback\n      );\n    } else {\n      this.targetResolution_ = resolution;\n      this.targetCenter_ = center;\n      this.applyTargetState_(false, true);\n      animationCallback(callback, true);\n    }\n  }\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  centerOn(coordinate, size, position) {\n    this.centerOnInternal(\n      fromUserCoordinate(coordinate, this.getProjection()),\n      size,\n      position\n    );\n  }\n\n  /**\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   */\n  centerOnInternal(coordinate, size, position) {\n    this.setCenterInternal(\n      calculateCenterOn(\n        coordinate,\n        size,\n        position,\n        this.getResolution(),\n        this.getRotation()\n      )\n    );\n  }\n\n  /**\n   * Calculates the shift between map and viewport center.\n   * @param {import(\"./coordinate.js\").Coordinate} center Center.\n   * @param {number} resolution Resolution.\n   * @param {number} rotation Rotation.\n   * @param {import(\"./size.js\").Size} size Size.\n   * @return {Array<number>|undefined} Center shift.\n   */\n  calculateCenterShift(center, resolution, rotation, size) {\n    let centerShift;\n    const padding = this.padding_;\n    if (padding && center) {\n      const reducedSize = this.getViewportSizeMinusPadding_(-rotation);\n      const shiftedCenter = calculateCenterOn(\n        center,\n        size,\n        [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],\n        resolution,\n        rotation\n      );\n      centerShift = [\n        center[0] - shiftedCenter[0],\n        center[1] - shiftedCenter[1],\n      ];\n    }\n    return centerShift;\n  }\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  isDef() {\n    return !!this.getCenterInternal() && this.getResolution() !== undefined;\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   * @api\n   */\n  adjustCenter(deltaCoordinates) {\n    const center = toUserCoordinate(this.targetCenter_, this.getProjection());\n    this.setCenter([\n      center[0] + deltaCoordinates[0],\n      center[1] + deltaCoordinates[1],\n    ]);\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   */\n  adjustCenterInternal(deltaCoordinates) {\n    const center = this.targetCenter_;\n    this.setCenterInternal([\n      center[0] + deltaCoordinates[0],\n      center[1] + deltaCoordinates[1],\n    ]);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  adjustResolution(ratio, anchor) {\n    anchor = anchor && fromUserCoordinate(anchor, this.getProjection());\n    this.adjustResolutionInternal(ratio, anchor);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  adjustResolutionInternal(ratio, anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const size = this.getViewportSize_(this.getRotation());\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_ * ratio,\n      0,\n      size,\n      isMoving\n    );\n\n    if (anchor) {\n      this.targetCenter_ = this.calculateCenterZoom(newResolution, anchor);\n    }\n\n    this.targetResolution_ *= ratio;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Adds a value to the view zoom level, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom level.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  adjustZoom(delta, anchor) {\n    this.adjustResolution(Math.pow(this.zoomFactor_, -delta), anchor);\n  }\n\n  /**\n   * Adds a value to the view rotation, optionally using an anchor. Any rotation\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The rotation center.\n   * @api\n   */\n  adjustRotation(delta, anchor) {\n    if (anchor) {\n      anchor = fromUserCoordinate(anchor, this.getProjection());\n    }\n    this.adjustRotationInternal(delta, anchor);\n  }\n\n  /**\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The rotation center.\n   */\n  adjustRotationInternal(delta, anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const newRotation = this.constraints_.rotation(\n      this.targetRotation_ + delta,\n      isMoving\n    );\n    if (anchor) {\n      this.targetCenter_ = this.calculateCenterRotate(newRotation, anchor);\n    }\n    this.targetRotation_ += delta;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the center of the current view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  setCenter(center) {\n    this.setCenterInternal(\n      center ? fromUserCoordinate(center, this.getProjection()) : center\n    );\n  }\n\n  /**\n   * Set the center using the view projection (not the user projection).\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   */\n  setCenterInternal(center) {\n    this.targetCenter_ = center;\n    this.applyTargetState_();\n  }\n\n  /**\n   * @param {import(\"./ViewHint.js\").default} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  setHint(hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  }\n\n  /**\n   * Set the resolution for this view. Any resolution constraint will apply.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  setResolution(resolution) {\n    this.targetResolution_ = resolution;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the rotation for this view. Any rotation constraint will apply.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  setRotation(rotation) {\n    this.targetRotation_ = rotation;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Zoom to a specific zoom level. Any resolution constrain will apply.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  setZoom(zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  }\n\n  /**\n   * Recompute rotation/resolution/center based on target values.\n   * Note: we have to compute rotation first, then resolution and center considering that\n   * parameters can influence one another in case a view extent constraint is present.\n   * @param {boolean} [doNotCancelAnims] Do not cancel animations.\n   * @param {boolean} [forceMoving] Apply constraints as if the view is moving.\n   * @private\n   */\n  applyTargetState_(doNotCancelAnims, forceMoving) {\n    const isMoving =\n      this.getAnimating() || this.getInteracting() || forceMoving;\n\n    // compute rotation\n    const newRotation = this.constraints_.rotation(\n      this.targetRotation_,\n      isMoving\n    );\n    const size = this.getViewportSize_(newRotation);\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_,\n      0,\n      size,\n      isMoving\n    );\n    const newCenter = this.constraints_.center(\n      this.targetCenter_,\n      newResolution,\n      size,\n      isMoving,\n      this.calculateCenterShift(\n        this.targetCenter_,\n        newResolution,\n        newRotation,\n        size\n      )\n    );\n\n    if (this.get(ViewProperty.ROTATION) !== newRotation) {\n      this.set(ViewProperty.ROTATION, newRotation);\n    }\n    if (this.get(ViewProperty.RESOLUTION) !== newResolution) {\n      this.set(ViewProperty.RESOLUTION, newResolution);\n      this.set('zoom', this.getZoom(), true);\n    }\n    if (\n      !newCenter ||\n      !this.get(ViewProperty.CENTER) ||\n      !equals(this.get(ViewProperty.CENTER), newCenter)\n    ) {\n      this.set(ViewProperty.CENTER, newCenter);\n    }\n\n    if (this.getAnimating() && !doNotCancelAnims) {\n      this.cancelAnimations();\n    }\n    this.cancelAnchor_ = undefined;\n  }\n\n  /**\n   * If any constraints need to be applied, an animation will be triggered.\n   * This is typically done on interaction end.\n   * Note: calling this with a duration of 0 will apply the constrained values straight away,\n   * without animation.\n   * @param {number} [duration] The animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  resolveConstraints(duration, resolutionDirection, anchor) {\n    duration = duration !== undefined ? duration : 200;\n    const direction = resolutionDirection || 0;\n\n    const newRotation = this.constraints_.rotation(this.targetRotation_);\n    const size = this.getViewportSize_(newRotation);\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_,\n      direction,\n      size\n    );\n    const newCenter = this.constraints_.center(\n      this.targetCenter_,\n      newResolution,\n      size,\n      false,\n      this.calculateCenterShift(\n        this.targetCenter_,\n        newResolution,\n        newRotation,\n        size\n      )\n    );\n\n    if (duration === 0 && !this.cancelAnchor_) {\n      this.targetResolution_ = newResolution;\n      this.targetRotation_ = newRotation;\n      this.targetCenter_ = newCenter;\n      this.applyTargetState_();\n      return;\n    }\n\n    anchor = anchor || (duration === 0 ? this.cancelAnchor_ : undefined);\n    this.cancelAnchor_ = undefined;\n\n    if (\n      this.getResolution() !== newResolution ||\n      this.getRotation() !== newRotation ||\n      !this.getCenterInternal() ||\n      !equals(this.getCenterInternal(), newCenter)\n    ) {\n      if (this.getAnimating()) {\n        this.cancelAnimations();\n      }\n\n      this.animateInternal({\n        rotation: newRotation,\n        center: newCenter,\n        resolution: newResolution,\n        duration: duration,\n        easing: easeOut,\n        anchor: anchor,\n      });\n    }\n  }\n\n  /**\n   * Notify the View that an interaction has started.\n   * The view state will be resolved to a stable one if needed\n   * (depending on its constraints).\n   * @api\n   */\n  beginInteraction() {\n    this.resolveConstraints(0);\n\n    this.setHint(ViewHint.INTERACTING, 1);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number} [duration] Animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  endInteraction(duration, resolutionDirection, anchor) {\n    anchor = anchor && fromUserCoordinate(anchor, this.getProjection());\n    this.endInteractionInternal(duration, resolutionDirection, anchor);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number} [duration] Animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  endInteractionInternal(duration, resolutionDirection, anchor) {\n    if (!this.getInteracting()) {\n      return;\n    }\n    this.setHint(ViewHint.INTERACTING, -1);\n    this.resolveConstraints(duration, resolutionDirection, anchor);\n  }\n\n  /**\n   * Get a valid position for the view center according to the current constraints.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} targetCenter Target center position.\n   * @param {number} [targetResolution] Target resolution. If not supplied, the current one will be used.\n   * This is useful to guess a valid center position at a different zoom level.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Valid center position.\n   */\n  getConstrainedCenter(targetCenter, targetResolution) {\n    const size = this.getViewportSize_(this.getRotation());\n    return this.constraints_.center(\n      targetCenter,\n      targetResolution || this.getResolution(),\n      size\n    );\n  }\n\n  /**\n   * Get a valid zoom level according to the current view constraints.\n   * @param {number|undefined} targetZoom Target zoom.\n   * @param {number} [direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid zoom level.\n   */\n  getConstrainedZoom(targetZoom, direction) {\n    const targetRes = this.getResolutionForZoom(targetZoom);\n    return this.getZoomForResolution(\n      this.getConstrainedResolution(targetRes, direction)\n    );\n  }\n\n  /**\n   * Get a valid resolution according to the current view constraints.\n   * @param {number|undefined} targetResolution Target resolution.\n   * @param {number} [direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid resolution.\n   */\n  getConstrainedResolution(targetResolution, direction) {\n    direction = direction || 0;\n    const size = this.getViewportSize_(this.getRotation());\n\n    return this.constraints_.resolution(targetResolution, direction, size);\n  }\n}\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function () {\n    callback(returnValue);\n  }, 0);\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    const smooth =\n      options.smoothExtentConstraint !== undefined\n        ? options.smoothExtentConstraint\n        : true;\n    return createExtent(options.extent, options.constrainOnlyCenter, smooth);\n  }\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  if (options.multiWorld !== true && projection.isGlobal()) {\n    const extent = projection.getExtent().slice();\n    extent[0] = -Infinity;\n    extent[2] = Infinity;\n    return createExtent(extent, false, false);\n  }\n\n  return centerNone;\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom =\n    options.minZoom !== undefined ? options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom =\n    options.maxZoom !== undefined ? options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor =\n    options.zoomFactor !== undefined ? options.zoomFactor : defaultZoomFactor;\n\n  const multiWorld =\n    options.multiWorld !== undefined ? options.multiWorld : false;\n\n  const smooth =\n    options.smoothResolutionConstraint !== undefined\n      ? options.smoothResolutionConstraint\n      : true;\n\n  const showFullExtent =\n    options.showFullExtent !== undefined ? options.showFullExtent : false;\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  const projExtent = projection.getExtent();\n  let constrainOnlyCenter = options.constrainOnlyCenter;\n  let extent = options.extent;\n  if (!multiWorld && !extent && projection.isGlobal()) {\n    constrainOnlyCenter = false;\n    extent = projExtent;\n  }\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution =\n      resolutions[maxZoom] !== undefined\n        ? resolutions[maxZoom]\n        : resolutions[resolutions.length - 1];\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToResolutions(\n        resolutions,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    } else {\n      resolutionConstraint = createMinMaxResolution(\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    }\n  } else {\n    // calculate the default min and max resolution\n    const size = !projExtent\n      ? // use an extent that can fit the whole world if need be\n        (360 * METERS_PER_UNIT.degrees) / projection.getMetersPerUnit()\n      : Math.max(getWidth(projExtent), getHeight(projExtent));\n\n    const defaultMaxResolution =\n      size / DEFAULT_TILE_SIZE / Math.pow(defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution =\n      defaultMaxResolution /\n      Math.pow(defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom =\n      minZoom +\n      Math.floor(\n        Math.log(maxResolution / minResolution) / Math.log(zoomFactor)\n      );\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToPower(\n        zoomFactor,\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    } else {\n      resolutionConstraint = createMinMaxResolution(\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    }\n  }\n  return {\n    constraint: resolutionConstraint,\n    maxResolution: maxResolution,\n    minResolution: minResolution,\n    minZoom: minZoom,\n    zoomFactor: zoomFactor,\n  };\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation =\n    options.enableRotation !== undefined ? options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    }\n    if (constrainRotation === false) {\n      return rotationNone;\n    }\n    if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    }\n    return rotationNone;\n  }\n  return disable;\n}\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {import(\"./size.js\").Size} size Box pixel size.\n * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @return {import(\"./coordinate.js\").Coordinate} Shifted center.\n */\nfunction calculateCenterOn(coordinate, size, position, resolution, rotation) {\n  // calculate rotated position\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  rotX += (size[0] / 2 - position[0]) * resolution;\n  rotY += (position[1] - size[1] / 2) * resolution;\n\n  // go back to original angle\n  sinAngle = -sinAngle; // go back to original rotation\n  const centerX = rotX * cosAngle - rotY * sinAngle;\n  const centerY = rotY * cosAngle + rotX * sinAngle;\n\n  return [centerX, centerY];\n}\n\nexport default View;\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1,\n};\n"],"names":["earcut","data","holeIndices","dim","minX","minY","maxX","maxY","x","y","invSize","hasHoles","length","outerLen","outerNode","linkedList","triangles","next","prev","eliminateHoles","i","Math","max","earcutLinked","start","end","clockwise","last","signedArea","insertNode","equals","removeNode","filterPoints","again","p","steiner","area","ear","pass","indexCurve","stop","isEarHashed","isEar","push","cureLocalIntersections","splitEarcut","a","b","c","ax","bx","cx","ay","by","cy","x0","y0","x1","y1","pointInTriangle","minZ","zOrder","maxZ","prevZ","n","nextZ","z","intersects","locallyInside","isValidDiagonal","splitPolygon","len","list","queue","getLeftmost","sort","compareX","eliminateHole","hole","bridge","findHoleBridge","bridgeReverse","m","hx","hy","qx","Infinity","tan","mx","my","tanMin","abs","sectorContainsSector","sortLinked","q","e","tail","numMerges","pSize","qSize","inSize","leftmost","px","py","intersectsPolygon","middleInside","r","p1","p2","q1","q2","o1","sign","o2","o3","o4","onSegment","min","num","inside","a2","Node","b2","an","bp","this","sum","j","module","exports","deviation","polygonArea","trianglesArea","flatten","result","vertices","holes","dimensions","holeIndex","d","ol_control_LayerSwitcher","constructor","options","element","create","className","switcherClass","super","target","self","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","_layerGroup","layerGroup","getLayers","onchangeCheck","displayInLayerSwitcher","classList","add","collapsed","button","type","parent","addEventListener","toggle","dispatchEvent","contains","preventDefault","overflow","mouseover","remove","minibar","noScroll","topv","click","botv","_noScroll","panel_","panelContainer_","html","addListener","wheelDelta","detail","stopPropagation","header_","set","drawDelay","selection","setTimeout","mbar","scrollDiv","mousewheel","vertical","on","refresh","bind","layer","get","setMap","map","drawPanel","_listener","moveend","viewChange","size","change","getLayerGroup","show","hide","isOpen","setHeader","setHTML","dir","hidden","setStyle","height","h","outerHeight","hp","dh","offsetTop","top","li","querySelectorAll","lh","getStyle","round","_setLayerForLI","listeners","setLayerOpacity","setLayerVisibility","key","querySelector","style","left","getOpacity","checked","getVisible","_clearLayerForLI","forEach","l","_getLayerForLI","testLayerVisibility","getPanel","getMap","drawPanel_","dragging_","scrollTop","drawList","switchLayerVisibility","layers","setVisible","res","getView","getResolution","zoom","getZoom","getMaxResolution","getMinResolution","getMinZoom","getMaxZoom","ex0","getExtent","ex","calculateExtent","getSize","dragOrdering_","pageY","dragElt","group","elt","currentTarget","parentNode","panel","pageY0","touches","changedTouches","drop","isSelected","getSelection","collection","getArray","removeAt","insertAt","selectLayer","removeListener","document","move","innerHTML","position","offsetLeft","opacity","width","outerWidth","offsetRect","elementFromPoint","clientX","clientY","shadowRoot","composedPath","tagName","dragOpacity_","pageX","delta","nextElementSibling","setOpacity","ul","setVisibility","onInfo","zoomExtent","fit","removeLayer","getLength","call","createLi","_selectedLayer","layer_buttons","label","title","userSelect","tip","up","nb","plus","info","setprogress_","layerswitcher_progress","op","offsetX","ul2","getLayerClass","getFeatures","silent","item","loaded","loading","draw","toFixed","getSource","prototype","down","ol_ext_input_Base","ol_Object","tout","input","createElement","setAttribute","undefined","step","appendChild","disabled","val","value","display","clearTimeout","_listenDrag","cback","handle","moving","listen","removeEventListener","setValue","v","Event","getValue","getInputElement","ol_ext_input_Checkbox","Element","trim","insertBefore","after","createTextNode","isChecked","ol_ext_input_Switch","ol_ext_input_Radio","ol_ext_element","attr","test","innerText","text","opt","Object","assign","name","eventType","fn","useCapture","split","el","st","s","styleProp","defaultView","ownerDocument","getComputedStyle","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","offsetHeight","offsetWidth","rect","getBoundingClientRect","window","pageYOffset","documentElement","body","pageXOffset","scrollLeft","bottom","right","offset","getOffset","offsetParent","fixed","gleft","gtop","getRect","scale","isbar","scrollContainer","scrollbar","pos","speed","dt","onmove","page","scroll","updateCounter","updateMinibar","updateMinibarDelay","pheight","clientHeight","scrollHeight","onPointerDown","Date","onPointerMove","onPointerUp","animate","to","init","onMouseWheel","eventName","event","CustomEvent","createEvent","initCustomEvent","Property","LENGTH","CollectionEvent","index","Collection","array","once","un","unique_","unique","array_","ii","assertUnique_","updateLength_","clear","pop","extend","arr","f","elem","Error","splice","ADD","REMOVE","setAt","except","A","Disposable","disposed","dispose","disposeInternal","Feature","geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","addChangeListener","handleGeometryChanged_","geometry","setGeometry","properties","setProperties","clone","hasProperties","getProperties","setGeometryName","getGeometryName","getGeometry","getId","getStyleFunction","handleGeometryChange_","changed","CHANGE","createStyleFunction","setId","id","removeChangeListener","obj","styles","Array","isArray","listenImage","image","loadHandler","errorHandler","img","listening","decoding","listenerKeys","EventType","LOAD","src","decode","then","catch","error","ERROR","IDLE","LOADING","LOADED","EMPTY","ImageTile","tileCoord","state","crossOrigin","tileLoadFunction","crossOrigin_","src_","image_","Image","unlisten_","tileLoadFunction_","getImage","setImage","unlistenImage_","handleImageError_","getBlankImage","handleImageLoad_","naturalWidth","naturalHeight","load","ctx","fillStyle","fillRect","canvas","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","now","lastIndex","firstIndex","duration","dx","dy","atan2","sqrt","getDistance","getAngle","MapBrowserEventHandler","Target","moveTolerance","map_","clickTimeoutId_","emulateClicks_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","element_","pointerdownListenerKey_","POINTERDOWN","handlePointerDown_","originalPointerMoveEvent_","relayedListenerKey_","POINTERMOVE","relayMoveEvent_","boundHandleTouchMove_","handleTouchMove_","TOUCHMOVE","passive","emulateClick_","pointerEvent","newEvent","MapBrowserEvent","MapBrowserEventType","CLICK","DBLCLICK","SINGLECLICK","updateActivePointers_","pointerId","POINTERUP","POINTERCANCEL","values","handlePointerUp_","defaultPrevented","isMouseActionButton_","PointerEvent","defineProperty","writable","doc","getOwnerDocument","handlePointerMove_","getRootNode","isMoving_","POINTERDRAG","dragging","originalEvent","cancelable","TileQueue","PriorityQueue","tilePriorityFunction","tileChangeCallback","apply","getKey","boundHandleTileChange_","handleTileChange","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","tile","getTilesLoading","getState","TileState","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","getCount","dequeue","getTilePriority","frameState","tileSourceKey","tileCenter","tileResolution","wantedTiles","center","viewState","deltaX","deltaY","log","removeLayerMapProperty","Layer","setMapInternal","setLayerMapProperty","Map","optionsInternal","createOptionsInternal","renderComplete_","loaded_","boundHandleBrowserEvent_","handleBrowserEvent","maxTilesLoading_","maxTilesLoading","pixelRatio_","pixelRatio","postRenderTimeoutHandle_","animationDelayKey_","animationDelay_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","overlayContainer_","zIndex","pointerEvents","overlayContainerStopEvent_","mapBrowserEventHandler_","keyboardEventTarget_","keyboardEventTarget","targetChangeHandlerKeys_","targetElement_","resizeObserver_","ResizeObserver","updateSize","controls","interactions","onFocusOnly","overlays_","overlays","overlayIdIndex_","renderer_","postRenderFunctions_","tileQueue_","handleTileChange_","MapProperty","LAYERGROUP","handleLayerGroupChanged_","VIEW","handleViewChanged_","SIZE","handleSizeChanged_","TARGET","handleTargetChanged_","view","View","viewOptions","setView","CollectionEventType","addOverlayInternal_","toString","control","interaction","addControl","getControls","addInteraction","getInteractions","addLayer","handleLayerAdd_","addOverlay","overlay","getOverlays","disconnect","setTarget","forEachFeatureAtPixel","pixel","callback","coordinate","getCoordinateFromPixelInternal","hitTolerance","layerFilter","checkWrapped","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","feature","getAllLayers","addLayersFrom","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","getCoordinateFromPixel","getEventPixel","getEventCoordinateInternal","viewport","viewportPosition","viewportSize","scaleX","scaleY","eventPosition","getTarget","getTargetElement","toUserCoordinate","getProjection","pixelToCoordinateTransform","slice","getOverlayById","setLayers","getLoadingOrNotReady","layerStatesArray","getLayerStatesArray","visible","renderer","getRenderer","ready","source","getPixelFromCoordinate","viewCoordinate","fromUserCoordinate","getPixelFromCoordinateInternal","coordinateToPixelTransform","getOverlayContainer","getOverlayContainerStopEvent","targetElement","browserEvent","mapBrowserEvent","handleMapBrowserEvent","WHEEL","KEYDOWN","rootNode","interactionsArray","getActive","cont","handleEvent","propagationStopped","handlePostRender","tileQueue","isEmpty","hints","viewHints","ViewHint","ANIMATING","INTERACTING","lowOnFrameBudget","time","reprioritize","hasListener","RENDERCOMPLETE","dispatchRenderEvent","MapEvent","MapEventType","LOADEND","LOADSTART","postRenderFunctions","getAnimating","resolveConstraints","render","CONTEXTMENU","unobserve","ShadowRoot","host","setSize","getElementById","Composite","KEYPRESS","observe","cancelAnimationFrame","handleViewPropertyChanged_","updateViewportSize_","ObjectEventType","PROPERTYCHANGE","Group","handleLayerRemove_","isRendered","renderFrame_","renderSync","redrawText","layerStates","hasRenderer","handleFontsChanged","requestAnimationFrame","flushDeclutterItems","removeControl","removeInteraction","removeOverlay","previousFrameState","isDef","getHints","declutterTree","resolution","rotation","layerIndex","usedTiles","mapId","renderTargets","nextCenter","nextResolution","isNaN","nextRotation","nextExtent","renderFrame","moveStart","MOVESTART","idle","MOVEEND","POSTRENDER","setLayerGroup","oldLayerGroup","computedStyle","parseFloat","getClientRects","oldSize","setViewportSize","activePointers","pixel_","coordinate_","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","ObjectEvent","oldValue","BaseObject","values_","hasOwnProperty","getKeys","keys","notify","listener","applyProperties","unset","Observable","revision_","getRevision","onInternal","onceInternal","ol_key","unInternal","unByKey","Tile","interimTile","transition_","transition","transitionStarts_","interpolate","release","setState","getInterimTile","refreshInterimChain","getTileCoord","getAlpha","inTransition","endTransition","TileCache","expireCache","canExpireCache","peekLast","pruneExceptNewestZ","peekFirstKey","TileRange","containsXY","containsTileRange","tileRange","getHeight","getWidth","createOrUpdate","CENTER","RESOLUTION","ROTATION","DEFAULT_MIN_ZOOM","hints_","animations_","updateAnimationKey_","projection_","createProjection","projection","viewportSize_","targetCenter_","targetResolution_","targetRotation_","nextCenter_","nextResolution_","nextRotation_","cancelAnchor_","disableCoordinateWarning","fromUserExtent","applyOptions_","ViewProperty","resolutionConstraintInfo","createResolutionConstraint","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","padding_","padding","minZoom_","minZoom","centerConstraint","createCenterConstraint","resolutionConstraint","constraint","rotationConstraint","createRotationConstraint","constraints_","setRotation","setCenterInternal","setResolution","setZoom","oldPadding","getCenterInternal","newPadding","offsetY","getUpdatedOptions_","newOptions","getRotation","var_args","args","arguments","anchor","animateInternal","animationCount","animationCallback","series","animation","complete","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","getResolutionForZoom","sourceRotation","PI","targetRotation","isNoopAnimation","setHint","updateAnimations_","getInteracting","cancelAnimations","jj","NaN","more","seriesComplete","elapsed","fraction","progress","getViewportSize_","constrainedResolution","calculateCenterZoom","applyTargetState_","constrainedRotation","calculateCenterRotate","filter","Boolean","currentCenter","currentResolution","w","cos","sin","getCenter","getConstraints","getConstrainResolution","calculateExtentInternal","toUserExtent","getViewportSizeMinusPadding_","getZoomForResolution","setMaxZoom","maxZoom","setMinZoom","setConstrainResolution","enabled","constrainResolution","getResolutions","getResolutionForExtent","getResolutionForExtentInternal","xResolution","yResolution","getResolutionForValueFunction","power","getConstrainedResolution","pow","getValueForResolutionFunction","logPower","reducedSize","calculateCenterOn","getViewStateAndExtent","nearest","baseLevel","floor","geometryOrExtent","getType","rotate","userProjection","getUserProjection","transform","fitInternal","rotatedExtentForGeometry","cosAngle","sinAngle","coords","getFlatCoordinates","stride","getStride","minRotX","minRotY","maxRotX","maxRotY","rotX","rotY","rotatedExtent","centerRot","centerX","centerY","getConstrainedCenter","centerOn","centerOnInternal","calculateCenterShift","centerShift","shiftedCenter","adjustCenter","deltaCoordinates","setCenter","adjustCenterInternal","adjustResolution","ratio","adjustResolutionInternal","isMoving","newResolution","adjustZoom","adjustRotation","adjustRotationInternal","newRotation","hint","doNotCancelAnims","forceMoving","newCenter","resolutionDirection","direction","beginInteraction","endInteraction","endInteractionInternal","getConstrainedZoom","targetZoom","targetRes","returnValue","smooth","smoothExtentConstraint","constrainOnlyCenter","multiWorld","isGlobal","defaultMaxZoom","defaultZoomFactor","smoothResolutionConstraint","showFullExtent","projExtent","METERS_PER_UNIT","degrees","getMetersPerUnit","defaultMaxResolution","defaultMinResolution","enableRotation","constrainRotation"],"sourceRoot":""}