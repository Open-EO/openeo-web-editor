"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[9212],{48538:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(11887),r=class extends i.Z{constructor(e){e=e||{},e.className=(e.className||"")+" ol-text-button",super(e)}};const n=r},57340:(e,t,s)=>{s.d(t,{Z:()=>n});var i=s(11887),r=class extends i.Z{constructor(e){e=e||{},e.toggleFn&&(e.onToggle=e.toggleFn),e.handleClick=function(){t.toggle(),e.onToggle&&e.onToggle.call(t,t.getActive())},e.className=(e.className||"")+" ol-toggle",super(e);var t=this;this.interaction_=e.interaction,this.interaction_&&(this.interaction_.setActive(e.active),this.interaction_.on("change:active",(function(){t.setActive(t.interaction_.getActive())}))),this.set("title",e.title),this.set("autoActivate",e.autoActivate),e.bar&&this.setSubBar(e.bar),this.setActive(e.active),this.setDisable(e.disable)}setMap(e){!e&&this.getMap()&&(this.interaction_&&this.getMap().removeInteraction(this.interaction_),this.subbar_&&this.getMap().removeControl(this.subbar_)),super.setMap(e),e&&(this.interaction_&&e.addInteraction(this.interaction_),this.subbar_&&e.addControl(this.subbar_))}getSubBar(){return this.subbar_}setSubBar(e){var t=this.getMap();t&&this.subbar_&&t.removeControl(this.subbar_),this.subbar_=e,e&&(this.subbar_.setTarget(this.element),this.subbar_.element.classList.add("ol-option-bar"),t&&t.addControl(this.subbar_))}getDisable(){var e=this.element.querySelector("button");return e&&e.disabled}setDisable(e){this.getDisable()!=e&&(this.element.querySelector("button").disabled=e,e&&this.getActive()&&this.setActive(!1),this.dispatchEvent({type:"change:disable",key:"disable",oldValue:!e,disable:e}))}getActive(){return this.element.classList.contains("ol-active")}toggle(){this.getActive()?this.setActive(!1):this.setActive(!0)}setActive(e){this.interaction_&&this.interaction_.setActive(e),this.subbar_&&this.subbar_.setActive(e),this.getActive()!==e&&(e?this.element.classList.add("ol-active"):this.element.classList.remove("ol-active"),this.dispatchEvent({type:"change:active",key:"active",oldValue:!e,active:e}))}setInteraction(e){this.interaction_=e}getInteraction(){return this.interaction_}};const n=r},48747:(e,t,s)=>{s.d(t,{CT:()=>d,bj:()=>u,pJ:()=>g,wE:()=>_});var i,r=s(92083),n=s(7403),o=s(32562),a=s(2033),h=s(57276),c=s(28641),l=s(25108),d=function(e,t){var s=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(s*s+i*i)},u=function(e,t){return e[0]==t[0]&&e[1]==t[1]},_=function(e,t){var s,i,r,n,o,a,h,c,l,_,g,f,p,y=[],v=e.length-1,m=v,C=u(e[0],e[v]);C||(g=e[0],f=e[1],p=[g[0]+(f[1]-g[1])/d(g,f)*t,g[1]-(f[0]-g[0])/d(g,f)*t],y.push(p),e.push(e[v]),v++,m--);for(var w=0;w<m;w++)g=e[w],f=e[(w+1)%v],p=e[(w+2)%v],s=(f[1]-g[1])/(f[0]-g[0]),i=(p[1]-f[1])/(p[0]-f[0]),Math.abs(s-i)>1e-10&&(r=Math.sqrt((f[0]-g[0])*(f[0]-g[0])+(f[1]-g[1])*(f[1]-g[1])),n=Math.sqrt((p[0]-f[0])*(p[0]-f[0])+(p[1]-f[1])*(p[1]-f[1])),o=g[0]+t*(f[1]-g[1])/r,a=f[0]+t*(p[1]-f[1])/n,h=g[1]-t*(f[0]-g[0])/r,c=f[1]-t*(p[0]-f[0])/n,l=(i*a-s*o+h-c)/(i-s),_=(s*i*(a-o)+i*h-s*c)/(i-s),f[0]-g[0]==0&&(l=f[0]+t*(f[1]-g[1])/Math.abs(f[1]-g[1]),_=i*l-i*a+c),p[0]-f[0]==0&&(l=p[0]+t*(p[1]-f[1])/Math.abs(p[1]-f[1]),_=s*l-s*o+h),y.push([l,_]));return C?y.push(y[0]):(e.pop(),g=e[e.length-1],f=e[e.length-2],p=[g[0]-(f[1]-g[1])/d(g,f)*t,g[1]+(f[0]-g[0])/d(g,f)*t],y.push(p)),y},g=function(e,t){for(var s=0;s<t.length-1;s++){var i=t[s],r=t[s+1];if(u(e,i)||u(e,r))return{index:1,segment:[i,r]};var n=d(i,r),o=[(r[0]-i[0])/n,(r[1]-i[1])/n],a=d(i,e),h=[(e[0]-i[0])/a,(e[1]-i[1])/a];if(Math.abs(o[0]*h[1]-o[1]*h[0])<1e-10)return{index:1,segment:[i,r]}}return{index:-1}};(function(){function e(e,t){var s;for(let i=e.length-1;i>0;i--)(e[i][0]>t&&e[i-1][0]<t||e[i][0]<t&&e[i-1][0]>t)&&(s=[t,(t-e[i][0])/(e[i-1][0]-e[i][0])*(e[i-1][1]-e[i][1])+e[i][1]],e.splice(i,0,s))}function t(e,t){var s;for(let i=e.length-1;i>0;i--)(e[i][1]>t&&e[i-1][1]<t||e[i][1]<t&&e[i-1][1]>t)&&(s=[(t-e[i][1])/(e[i-1][1]-e[i][1])*(e[i-1][0]-e[i][0])+e[i][0],t],e.splice(i,0,s))}i=function(s,i){var r="Polygon"===i.getType();if(!r&&"MultiPolygon"!==i.getType())return null;var n=i.getCoordinates();return r&&(n=[n]),n.forEach((function(i){i.forEach((function(i){e(i,s[0]),e(i,s[2]),t(i,s[1]),t(i,s[3])}))})),n.forEach((function(e){e.forEach((function(e){e.forEach((function(e){e[0]<s[0]?e[0]=s[0]:e[0]>s[2]&&(e[0]=s[2]),e[1]<s[1]?e[1]=s[1]:e[1]>s[3]&&(e[1]=s[3])}))}))})),r?new a.ZP(n[0]):new o.Z(n)}})();var f=function(e,t,s,i){var r=[];!1!==i&&r.push(e);var n=d(e,t);if(n){var o=Math.round(n/s);if(o>1)for(var a=(t[0]-e[0])/o,h=(t[1]-e[1])/o,c=1;c<o;c++)r.push([e[0]+a*c,e[1]+h*c])}return r.push(t),r};r.Z.prototype.sampleAt=function(e){for(var t=this.getCoordinates(),s=[],i=1;i<t.length;i++)s=s.concat(f(t[i-1],t[i],e,1===i));return new r.Z(s)},n.Z.prototype.sampleAt=function(e){var t=this.getCoordinates(),s=[];return t.forEach((function(t){for(var i=[],r=1;r<t.length;r++)i=i.concat(f(t[r-1],t[r],e,1===r));s.push(i)})),new n.Z(s)},a.ZP.prototype.sampleAt=function(e){var t=this.getCoordinates(),s=[];return t.forEach((function(t){for(var i=[],r=1;r<t.length;r++)i=i.concat(f(t[r-1],t[r],e,1===r));s.push(i)})),new a.ZP(s)},o.Z.prototype.sampleAt=function(e){var t=this.getCoordinates(),s=[];return t.forEach((function(t){var i=[];s.push(i),t.forEach((function(t){for(var s=[],r=1;r<t.length;r++)s=s.concat(f(t[r-1],t[r],e,1===r));i.push(s)}))})),new o.Z(s)},h.Z.prototype.intersection=function(e,t){if(e.sampleAt){var s=(0,c.f3)(this.getCenter().concat(this.getCenter()),this.getRadius());e=i(s,e),e=e.simplify(t);var r=this.getCenter(),n=this.getRadius(),h=e.sampleAt(t).getCoordinates();switch(e.getType()){case"Polygon":h=[h];case"MultiPolygon":var u=!1,_=[];return h.forEach((function(e){var t=[];_.push(t),e.forEach((function(e){var s=[];t.push(s),e.forEach((function(e){var t=d(r,e);t>n?(u=!0,s.push([r[0]+n/t*(e[0]-r[0]),r[1]+n/t*(e[1]-r[1])])):s.push(e)}))}))})),u?"Polygon"===e.getType()?new a.ZP(_[0]):new o.Z(_):e}}else l.warn("[ol/geom/Circle~intersection] Unsupported geometry type: "+e.getType());return e}},10229:(e,t,s)=>{var i=s(48747),r=s(92083);r.Z.prototype.splitAt=function(e,t){var s;if(!e)return[this];if(t||(t=1e-10),e.length&&e[0].length){var n=[this];for(s=0;s<e.length;s++){for(var o=[],a=0;a<n.length;a++){var h=n[a].splitAt(e[s],t);o=o.concat(h)}n=o}return n}if((0,i.bj)(e,this.getFirstCoordinate())||(0,i.bj)(e,this.getLastCoordinate()))return[this];var c=this.getCoordinates(),l=[c[0]],d=[];for(s=0;s<c.length-1;s++)if(!(0,i.bj)(c[s],c[s+1])){if((0,i.bj)(e,c[s+1]))l.push(c[s+1]),d.push(new r.Z(l)),l=[];else if(!(0,i.bj)(e,c[s])){var u,_,g=!1;c[s][0]==c[s+1][0]?(u=(c[s][1]-e[1])/(c[s][1]-c[s+1][1]),g=c[s][0]==e[0]&&0<u&&u<=1):c[s][1]==c[s+1][1]?(u=(c[s][0]-e[0])/(c[s][0]-c[s+1][0]),g=c[s][1]==e[1]&&0<u&&u<=1):(u=(c[s][0]-e[0])/(c[s][0]-c[s+1][0]),_=(c[s][1]-e[1])/(c[s][1]-c[s+1][1]),g=Math.abs(u-_)<=t&&0<u&&u<=1),g&&(l.push(e),d.push(new r.Z(l)),l=[e])}l.push(c[s+1])}return l.length>1&&d.push(new r.Z(l)),d.length?d:[this]}},74073:(e,t,s)=>{s.d(t,{Z:()=>o});var i=s(7517),r=s(22556),n=class extends i.Z{constructor(e){super(e),this.on("select",function(e){this.getFeatures().clear(),this.delete(e.selected)}.bind(this))}_getSources(e){if(!this.getMap())return[];e||(e=this.getMap().getLayers());var t=[];return e.forEach(function(e){e.getLayers?t=t.concat(this._getSources(e.getLayers())):e.getSource&&e.getSource()instanceof r["default"]&&t.push(e.getSource())}.bind(this)),t}delete(e){if(e&&(e.length||e.getLength())){this.dispatchEvent({type:"deletestart",features:e});var t=[];this._getSources().forEach((function(s){try{e.forEach((function(e){s.removeFeature(e),t.push(e)}))}catch(i){}})),this.dispatchEvent({type:"deleteend",features:t})}}};const o=n},82702:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(2033),r=s(32562),n=s(67538),o=s(35010),a=s(7517),h=class extends o.ZP{constructor(e){e=e||{};var t=function(e,t){var s=e[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(s)||(this.lastOKCoord=[s[0],s[1]]),e[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),t?t.setCoordinates([e[0].concat([e[0][0]])]):t=new i.ZP(e),t},s=e.geometryFunction;if(e.geometryFunction=s?function(e,i){return i=t(e,i),s(e,i)}:t,e.type="Polygon",super(e),this._select=new a.Z({style:e.style}),this._select.setActive(!1),e.layers&&("function"===typeof e.layers?this.layers_=e.layers:e.layers.indexOf&&(this.layers_=function(t){return e.layers.indexOf(t)>=0})),"function"===typeof e.featureFilter)this._features=e.featureFilter;else if(e.featureFilter){var r=e.featureFilter;this._features=function(e){return r.indexOf?!!r[r.indexOf(e)]:!!r.item(r.getArray().indexOf(e))}}else this._features=function(){return!0};this.on("drawstart",this._startDrawing.bind(this)),this.on("drawend",this._finishDrawing.bind(this))}setMap(e){this.getMap()&&this.getMap().removeInteraction(this._select),e&&e.addInteraction(this._select),super.setMap.call(this,e)}setActive(e){this._select&&this._select.getFeatures().clear(),super.setActive.call(this,e)}removeLastPoint(){this._feature&&this._feature.getGeometry().getCoordinates()[0].length>2&&super.removeLastPoint.call(this)}getPolygon(){return this._polygon}_startDrawing(e){var t=this.getMap();this._feature=e.feature;var s=e.feature.getGeometry().getCoordinates()[0][0];this._current=null,t.forEachFeatureAtPixel(t.getPixelFromCoordinate(s),function(e,t){if(!this._current&&this._features(e,t)){var i=e.getGeometry();if("Polygon"===i.getType()&&i.intersectsCoordinate(s))this._polygonIndex=!1,this._polygon=i,this._current=e;else if("MultiPolygon"===i.getType()&&i.intersectsCoordinate(s))for(var r,n=0;r=i.getPolygon(n);n++)if(r.intersectsCoordinate(s)){this._polygonIndex=n,this._polygon=r,this._current=e;break}}}.bind(this),{layerFilter:this.layers_}),this._select.getFeatures().clear(),this._current?this._select.getFeatures().push(this._current):(this.setActive(!1),this.setActive(!0))}_finishDrawing(e){e.hole=e.feature,e.feature=this._select.getFeatures().item(0),this.dispatchEvent({type:"modifystart",features:[this._current]});var t=e.hole.getGeometry().getCoordinates()[0];if(t.length>3)if(!1!==this._polygonIndex){for(var s,i=e.feature.getGeometry(),o=new r.Z([]),a=0;s=i.getPolygon(a);a++)a===this._polygonIndex?(s.appendLinearRing(new n.Z(t)),o.appendPolygon(s)):o.appendPolygon(s);e.feature.setGeometry(o)}else this.getPolygon().appendLinearRing(new n.Z(t));this.dispatchEvent({type:"modifyend",features:[this._current]}),this._feature=null,this._select.getFeatures().clear()}_geometryFn(e,t){var s=e[0].pop();return this.getPolygon()&&!this.getPolygon().intersectsCoordinate(s)||(this.lastOKCoord=[s[0],s[1]]),e[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]),t?t.setCoordinates([e[0].concat([e[0][0]])]):t=new i.ZP(e),t}};const c=h},98883:(e,t,s)=>{s.d(t,{Z:()=>g});var i=s(47182),r=s(1614),n=s(78714),o=s(92371),a=s(22556),h=s(57276),c=s(2033),l=s(60188),d=s(92083),u=s(81090),_=class extends i.ZP{constructor(e){e=e||{},super({handleEvent:function(e){return t.handleEvent_(e)}});var t=this;this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.maxCircleCoordinates_=e.maxCircleCoordinates||100,this.features_=e.features,this.source_=e.source,this.conditionFn_=e.condition,this.squareFn_=e.squareCondition,this.centeredFn_=e.centerCondition,this.canRotate_=!1!==e.canRotate,this.geometryName_=e.geometryName||"geometry",this.setSides(e.sides);var s=(0,r.Z)(!0);this.sketch_=new n.Z,this.overlayLayer_=new o["default"]({source:new a["default"]({features:this.sketch_,useSpatialIndex:!1}),name:"DrawRegular overlay",displayInLayerSwitcher:!1,style:e.style||s})}setMap(e){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),super.setMap(e),this.overlayLayer_.setMap(e)}setActive(e){this.reset(),super.setActive(e)}reset(){this.overlayLayer_&&this.overlayLayer_.getSource().clear(),this.started_=!1}setSides(e){e=parseInt(e),this.sides_=e>2?e:0}canRotate(e){return!0!==e&&!1!==e||(this.canRotate_=e),this.canRotate_}getSides(){return this.sides_}getGeom_(){if(this.overlayLayer_.getSource().clear(),!this.center_)return!1;var e;if(this.coord_){var t,s,i,r,n,o=this.center_,a=this.coord_;if(!this.sides_&&this.square_&&!this.centered_)return o=[(a[0]+o[0])/2,(a[1]+o[1])/2],t=[a[0]-o[0],a[1]-o[1]],i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),r=new h.Z(o,i,"XY"),n=this.getMap().getPixelFromCoordinate(o),s=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),s=Math.min(this.maxCircleCoordinates_,Math.round(s/3)),(0,c.Bb)(r,s,0);var d=this.canRotate_&&this.centered_&&this.square_;if(t=[a[0]-o[0],a[1]-o[1]],this.square_&&!d){var u=Math.max(Math.abs(t[0]),Math.abs(t[1]));a=[o[0]+(t[0]>0?u:-u),o[1]+(t[1]>0?u:-u)]}if(i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i>0){var _;if(r=new h.Z(o,i,"XY"),_=d?Math.atan2(t[1],t[0]):this.startAngle[this.sides_]||this.startAngle["default"],this.sides_?e=(0,c.Bb)(r,this.sides_,_):(n=this.getMap().getPixelFromCoordinate(this.center_),s=Math.max(100,Math.abs(n[0]-this.coordPx_[0]),Math.abs(n[1]-this.coordPx_[1])),s=Math.min(this.maxCircleCoordinates_,Math.round(s/(this.centered_?3:5))),e=(0,c.Bb)(r,s,0)),d)return e;var g=e.getExtent();o=this.centered_?[2*this.center_[0]-this.coord_[0],2*this.center_[1]-this.coord_[1]]:this.center_;var f=(o[0]-a[0])/(g[0]-g[2]),p=(o[1]-a[1])/(g[1]-g[3]);if(this.square_){var y=Math.min(Math.abs(f),Math.abs(p));f=Math.sign(f)*y,p=Math.sign(p)*y}var v=[o[0]-g[0]*f,o[1]-g[1]*p];return e.applyTransform((function(e,t,s){for(var i=0;i<e.length;i+=s)t[i]=e[i]*f+v[0],t[i+1]=e[i+1]*p+v[1];return t})),e}}return new l["default"](this.center_)}drawSketch_(e){if(this.overlayLayer_.getSource().clear(),e){this.square_=this.squareFn_?this.squareFn_(e):e.originalEvent.shiftKey,this.centered_=this.centeredFn_?this.centeredFn_(e):e.originalEvent.metaKey||e.originalEvent.ctrlKey;var t=this.getGeom_();if(t){var s=this.feature_;return"Polygon"===t.getType()&&s.getGeometry().setCoordinates(t.getCoordinates()),this.overlayLayer_.getSource().addFeature(s),this.coord_&&this.square_&&(this.canRotate_&&this.centered_&&this.coord_||!this.sides_&&!this.centered_)&&this.overlayLayer_.getSource().addFeature(new u["default"](new d.Z([this.center_,this.coord_]))),s}}}drawPoint_(e,t){t||this.overlayLayer_.getSource().clear(),this.overlayLayer_.getSource().addFeature(new u["default"](new l["default"](e)))}handleEvent_(e){var t,s;switch(this._eventTime=new Date,e.type){case"pointerdown":if(this.conditionFn_&&!this.conditionFn_(e))break;this.downPx_=e.pixel,this.start_(e);var i=500;this._longTouch=!1,setTimeout(function(){this._longTouch=new Date-this._eventTime>.9*i,this._longTouch&&this.handleMoveEvent_(e)}.bind(this),i);break;case"pointerup":this.started_&&this.coord_&&(t=this.downPx_[0]-e.pixel[0],s=this.downPx_[1]-e.pixel[1],t*t+s*s<=this.squaredClickTolerance_&&("pointermove"==this.lastEvent||"keydown"==this.lastEvent?this.end_(e):(t=this.upPx_[0]-e.pixel[0],s=this.upPx_[1]-e.pixel[1],t*t+s*s<=this.squaredClickTolerance_?this.end_(e):(this.handleMoveEvent_(e),this.drawPoint_(e.coordinate,!0))))),this.upPx_=e.pixel;break;case"pointerdrag":if(this.started_){var r=this.getMap().getPixelFromCoordinate(this.center_);t=r[0]-e.pixel[0],s=r[1]-e.pixel[1],t*t+s*s<=this.squaredClickTolerance_&&this.reset()}return!this._longTouch;case"pointermove":this.started_&&(t=this.downPx_[0]-e.pixel[0],s=this.downPx_[1]-e.pixel[1],t*t+s*s>this.squaredClickTolerance_&&(this.handleMoveEvent_(e),this.lastEvent=e.type));break;default:if(this.lastEvent=e.type,this.started_&&"dblclick"===e.type)return!1;break}return!0}finishDrawing(){this.started_&&this.coord_&&this.end_({pixel:this.upPx_,coordinate:this.coord_})}handleMoveEvent_(e){if(this.started_){this.coord_=e.coordinate,this.coordPx_=e.pixel;var t=this.drawSketch_(e);this.dispatchEvent({type:"drawing",feature:t,pixel:e.pixel,startCoordinate:this.center_,coordinate:e.coordinate,square:this.square_,centered:this.centered_})}else this.drawPoint_(e.coordinate)}start_(e){if(this.started_)this.coord_=e.coordinate;else{this.started_=!0,this.center_=e.coordinate,this.coord_=null;var t=this.feature_=new u["default"]({});t.setGeometryName(this.geometryName_||"geometry"),t.setGeometry(new c.ZP([[e.coordinate,e.coordinate,e.coordinate]])),this.drawSketch_(e),this.dispatchEvent({type:"drawstart",feature:t,pixel:e.pixel,coordinate:e.coordinate})}}end_(e){if(this.coord_=e.coordinate,this.started_=!1,!this.coord_||this.center_[0]===this.coord_[0]&&this.center_[1]===this.coord_[1])this.dispatchEvent({type:"drawcancel",feature:null,pixel:e.pixel,coordinate:e.coordinate,square:this.square_,centered:this.centered_});else{var t=this.feature_;t.setGeometry(this.getGeom_()),this.source_?this.source_.addFeature(t):this.features_&&this.features_.push(t),this.dispatchEvent({type:"drawend",feature:t,pixel:e.pixel,coordinate:e.coordinate,square:this.square_,centered:this.centered_})}this.center_=this.coord_=null,this.drawSketch_()}};_.prototype.startAngle={default:Math.PI/2,3:-Math.PI/2,4:Math.PI/4};const g=_},56255:(e,t,s)=>{s.d(t,{Z:()=>v});var i=s(47539),r=s(58958),n=s(22556),o=s(51345),a=s(30283),h=s(92371),c=s(60188),l=s(81090),d=s(92083),u=s(47182),_=s(48747),g=s(28641),f=s(98683),p=(s(10229),s(25108)),y=class extends u.ZP{constructor(e){var t,s;e=e||{},super({handleEvent:function(e){switch(e.type){case"pointerdown":return t=this.handleDownEvent(e),s=t||this._deleteCondition(e),!t;case"pointerup":return t=!1,this.handleUpEvent(e);case"pointerdrag":return!t||this.handleDragEvent(e);case"pointermove":return!t&&this.handleMoveEvent(e);case"singleclick":case"click":return!s;default:return!0}}}),this.snapDistance_=e.pixelTolerance||10,this.tolerance_=1e-10,this.cursor_=e.cursor,this.sources_=e.sources?e.sources instanceof Array?e.sources:[e.sources]:[],e.source&&this.sources_.push(e.source),e.features&&this.sources_.push(new n["default"]({features:e.features})),this.filterSplit_=e.filter||function(){return!0},this._condition=e.condition||f.Xp,this._deleteCondition=e.deleteCondition||f.Ko,this._insertVertexCondition=e.insertVertexCondition||f.Bx;var c=function(){return[new i["default"]({image:new a.Z({radius:6,fill:new o.Z({color:[0,153,255,1]}),stroke:new r.Z({color:"#FFF",width:1.25})})})]};e.style&&(c="function"===typeof e.style?e.style:function(){return e.style}),this.overlayLayer_=new h["default"]({source:new n["default"]({useSpatialIndex:!1}),name:"Modify overlay",displayInLayerSwitcher:!1,style:c,wrapX:e.wrapX})}setMap(e){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),super.setMap(e),this.overlayLayer_.setMap(e)}setActive(e){super.setActive(e),this.overlayLayer_&&this.overlayLayer_.getSource().clear()}setFilter(e){"function"===typeof e?this.filterSplit_=e:void 0===e&&(this.filterSplit_=function(){return!0})}getClosestFeature(e){for(var t,s,i=this.snapDistance_+1,r=0;r<this.sources_.length;r++){var n=this.sources_[r];if(t=n.getClosestFeatureToCoordinate(e.coordinate),t&&this.filterSplit_(t)){var o=t.getGeometry().getClosestPoint(e.coordinate),a=(0,_.CT)(e.coordinate,o)/e.frameState.viewState.resolution;a<i&&(i=a,s=o);break}}if(i>this.snapDistance_)return this.currentFeature&&this.dispatchEvent({type:"select",selected:[],deselected:[this.currentFeature]}),this.currentFeature=null,!1;var h=this.getNearestCoord(s,t.getGeometry());if(h){h=h.coord;var c=this.getMap().getPixelFromCoordinate(h);return(0,_.CT)(e.pixel,c)<this.snapDistance_&&(s=h),this.currentFeature!==t&&this.dispatchEvent({type:"select",selected:[t],deselected:[this.currentFeature]}),this.currentFeature=t,{source:n,feature:t,coord:s}}}getNearestCoord(e,t){var s,i,r,n,o;switch(t.getType()){case"Point":return{coord:t.getCoordinates(),dist:(0,_.CT)(t.getCoordinates(),e)};case"MultiPoint":return this.getNearestCoord(e,new d.Z(t.getCoordinates()));case"LineString":case"LinearRing":var a;o=Number.MAX_VALUE;var h=t.getCoordinates();for(s=0;s<h.length;s++)a=(0,_.CT)(e,h[s]),a<o&&(o=a,n=h[s]);return{coord:n,dist:o};case"MultiLineString":var c=t.getLineStrings();for(n=!1,o=Number.MAX_VALUE,s=0;i=c[s];s++)r=this.getNearestCoord(e,i),r&&r.dist<o&&(n=r,o=r.dist,n.ring=s);return n;case"Polygon":var l=t.getLinearRings();for(n=!1,o=Number.MAX_VALUE,s=0;i=l[s];s++)r=this.getNearestCoord(e,i),r&&r.dist<o&&(n=r,o=r.dist,n.ring=s);return n;case"MultiPolygon":var u=t.getPolygons();for(n=!1,o=Number.MAX_VALUE,s=0;i=u[s];s++)r=this.getNearestCoord(e,i),r&&r.dist<o&&(n=r,o=r.dist,n.poly=s);return n;case"GeometryCollection":var g=t.getGeometries();for(n=!1,o=Number.MAX_VALUE,s=0;i=g[s];s++)r=this.getNearestCoord(e,i),r&&r.dist<o&&(n=r,o=r.dist,n.geom=s);return n;default:return!1}}getArcs(e,t){var s,i,r,n,o,a=!1;switch(e.getType()){case"Point":(0,_.bj)(t,e.getCoordinates())&&(a={geom:e,type:e.getType(),coord1:[],coord2:[],node:!0});break;case"MultiPoint":for(s=e.getCoordinates(),i=0;i<s.length;i++)if((0,_.bj)(t,s[i])){a={geom:e,type:e.getType(),index:i,coord1:[],coord2:[],node:!0};break}break;case"LinearRing":case"LineString":var h=e.getClosestPoint(t);if((0,_.CT)(h,t)<1.5*this.tolerance_){var c;if("LinearRing"===e.getType()?(o=new d.Z(e.getCoordinates()),c=o.splitAt(t,this.tolerance_)):c=e.splitAt(t,this.tolerance_),c.length>2){for(s=c[1].getCoordinates(),i=2;r=c[i];i++){var l=r.getCoordinates();l.shift(),s=s.concat(l)}c=[c[0],new d.Z(s)]}if(2===c.length){var u=c[0].getCoordinates(),g=c[1].getCoordinates(),f=u.length+g.length-1;u.pop(),g.shift(),a={geom:e,type:e.getType(),coord1:u,coord2:g,node:e.getCoordinates().length===f,closed:!1}}else if(1===c.length){r=c[0].getCoordinates();var y=(0,_.bj)(r[0],t),v=(0,_.bj)(r[r.length-1],t);y?(r.shift(),v&&r.pop(),a={geom:e,type:e.getType(),coord1:[],coord2:r,node:!0,closed:v}):v&&(r.pop(),a={geom:e,type:e.getType(),coord1:r,coord2:[],node:!0,closed:!1})}}break;case"MultiLineString":var m=e.getLineStrings();for(i=0;n=m[i];i++)if(a=this.getArcs(n,t),a){a.geom=e,a.type=e.getType(),a.lstring=i;break}break;case"Polygon":var C=e.getLinearRings();for(i=0;n=C[i];i++)if(a=this.getArcs(n,t),a){a.geom=e,a.type=e.getType(),a.index=i;break}break;case"MultiPolygon":var w=e.getPolygons();for(i=0;n=w[i];i++)if(a=this.getArcs(n,t),a){a.geom=e,a.type=e.getType(),a.poly=i;break}break;case"GeometryCollection":for(o=e.getGeometries(),i=0;n=o[i];i++)if(a=this.getArcs(n,t),a){a.geom=e,a.g=i,a.typeg=a.type,a.type=e.getType();break}break;default:p.error("ol/interaction/ModifyFeature "+e.getType()+" not supported!");break}return a}handleDownEvent(e){if(!this.getActive())return!1;var t=this.getClosestFeature(e);if(t&&(this._condition(e)||this._deleteCondition(e))){var s=[];return this.arcs=[],this.sources_.forEach(function(e){var i=(0,g.f3)((0,g.hI)([t.coord]),this.tolerance_);s=s.concat(s,e.getFeaturesInExtent(i))}.bind(this)),this._modifiedFeatures=[],s.forEach(function(s){var i=this.getArcs(s.getGeometry(),t.coord);i&&(this._insertVertexCondition(e)||i.node)&&(i.feature=s,this._modifiedFeatures.push(s),this.arcs.push(i))}.bind(this)),!this._modifiedFeatures.length||(this._deleteCondition(e)?!this._removePoint(t,e):(this.dispatchEvent({type:"modifystart",coordinate:t.coord,originalEvent:e.originalEvent,features:this._modifiedFeatures}),this.handleDragEvent({coordinate:t.coord,originalEvent:e.originalEvent}),!0))}return!1}getModifiedFeatures(){return this._modifiedFeatures||[]}removePoint(){this._removePoint({},{})}_getModification(e){var t=e.coord1.concat(e.coord2);switch(e.type){case"LineString":if(e.closed&&t.push(t[0]),t.length>1&&e.geom.getCoordinates().length!=t.length)return e.coords=t,!0;break;case"MultiLineString":if(e.closed&&t.push(t[0]),t.length>1){var s=e.geom.getCoordinates();if(s[e.lstring].length!=t.length)return s[e.lstring]=t,e.coords=s,!0}break;case"Polygon":if(e.closed&&t.push(t[0]),t.length>3&&(s=e.geom.getCoordinates(),s[e.index].length!=t.length))return s[e.index]=t,e.coords=s,!0;break;case"MultiPolygon":if(e.closed&&t.push(t[0]),t.length>3&&(s=e.geom.getCoordinates(),s[e.poly][e.index].length!=t.length))return s[e.poly][e.index]=t,e.coords=s,!0;break;case"GeometryCollection":e.type=e.typeg;var i=e.geom,r=i.getGeometries();e.geom=r[e.g];var n=this._getModification(e);return i.setGeometries(r),e.geom=i,e.type="GeometryCollection",n;default:break}return!1}_removePoint(e,t){if(!this.arcs)return!1;this.overlayLayer_.getSource().clear();var s=!1;return this.arcs.forEach(function(e){s=s||this._getModification(e)}.bind(this)),s&&(this.dispatchEvent({type:"modifystart",coordinate:e.coord,originalEvent:t.originalEvent,features:this._modifiedFeatures}),this.arcs.forEach(function(e){if("GeometryCollection"===e.geom.getType()){if(e.coords){var t=e.geom.getGeometries();t[e.g].setCoordinates(e.coords),e.geom.setGeometries(t)}}else e.coords&&e.geom.setCoordinates(e.coords)}.bind(this)),this.dispatchEvent({type:"modifyend",coordinate:e.coord,originalEvent:t.originalEvent,features:this._modifiedFeatures})),this.arcs=[],s}handleUpEvent(e){return!!this.getActive()&&(!this.arcs||!this.arcs.length||(this.overlayLayer_.getSource().clear(),this.dispatchEvent({type:"modifyend",coordinate:e.coordinate,originalEvent:e.originalEvent,features:this._modifiedFeatures}),this.arcs=[],!0))}setArcCoordinates(e,t){var s;switch(e.type){case"Point":e.geom.setCoordinates(t[0]);break;case"MultiPoint":s=e.geom.getCoordinates(),s[e.index]=t[0],e.geom.setCoordinates(s);break;case"LineString":e.geom.setCoordinates(t);break;case"MultiLineString":s=e.geom.getCoordinates(),s[e.lstring]=t,e.geom.setCoordinates(s);break;case"Polygon":s=e.geom.getCoordinates(),s[e.index]=t,e.geom.setCoordinates(s);break;case"MultiPolygon":s=e.geom.getCoordinates(),s[e.poly][e.index]=t,e.geom.setCoordinates(s);break;case"GeometryCollection":e.type=e.typeg;var i=e.geom,r=i.getGeometries();e.geom=r[e.g],this.setArcCoordinates(e,t),i.setGeometries(r),e.geom=i,e.type="GeometryCollection";break}}handleDragEvent(e){if(!this.getActive())return!1;if(!this.arcs)return!0;this.overlayLayer_.getSource().clear();var t=new l["default"](new c["default"](e.coordinate));return this.overlayLayer_.getSource().addFeature(t),!this.arcs.length||(this.arcs.forEach(function(t){var s=t.coord1.concat([e.coordinate],t.coord2);t.closed&&s.push(e.coordinate),this.setArcCoordinates(t,s)}.bind(this)),this.dispatchEvent({type:"modifying",coordinate:e.coordinate,originalEvent:e.originalEvent,features:this._modifiedFeatures}),!0)}handleMoveEvent(e){if(!this.getActive())return!0;this.overlayLayer_.getSource().clear();var t=this.getClosestFeature(e);if(t){var s=new l["default"](new c["default"](t.coord));this.overlayLayer_.getSource().addFeature(s)}var i=e.map.getTargetElement();return this.cursor_&&(t?i.style.cursor!=this.cursor_&&(this.previousCursor_=i.style.cursor,i.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(i.style.cursor=this.previousCursor_,this.previousCursor_=void 0)),!0}getCurrentFeature(){return this.currentFeature}};const v=y},95775:(e,t,s)=>{s.d(t,{Z:()=>c});var i=s(14515),r=s(92083),n=s(2033),o=s(48747),a=s(1614),h=class extends i.Z{constructor(e){e=e||{},super({handleDownEvent:function(e){return t.handleDownEvent_(e)},handleDragEvent:function(e){return t.handleDragEvent_(e)},handleMoveEvent:function(e){return t.handleMoveEvent_(e)},handleUpEvent:function(e){return t.handleUpEvent_(e)}});var t=this;this._filter=e.filter,this.features_=e.features,this.layers_=e.layers?e.layers instanceof Array?e.layers:[e.layers]:null,this.set("duplicate",e.duplicate),this.source_=e.source,this._style="function"===typeof e.style?e.style:function(){return e.style?e.style:(0,a.Z)(!0)},this.previousCursor_=!1}getFeatureAtPixel_(e){var t=this;return this.getMap().forEachFeatureAtPixel(e.pixel,(function(s,i){var r;if(t._filter&&!t._filter(s,i))return!1;if(t.layers_){for(var n=0;n<t.layers_.length;n++)if(t.layers_[n]===i){r=s;break}}else t.features_?t.features_.forEach((function(e){e===s&&(r=s)})):r=s;var o=r.getGeometry().getType();if(r&&/Polygon|LineString/.test(o)){if("Polygon"===o&&r.getGeometry().getCoordinates().length>1)return!1;var a=r.getGeometry().getClosestPoint(e.coordinate),h=a[0]-e.coordinate[0],c=a[1]-e.coordinate[1],l=Math.sqrt(h*h+c*c)/e.frameState.viewState.resolution;return l<5&&{feature:r,hit:a,coordinates:r.getGeometry().getCoordinates(),geom:r.getGeometry().clone(),geomType:o}}return!1}),{hitTolerance:5})}handleDownEvent_(e){return this.current_=this.getFeatureAtPixel_(e),!!this.current_&&(this.currentStyle_=this.current_.feature.getStyle(),this.source_&&(this.get("duplicate")||e.originalEvent.ctrlKey)?(this.current_.feature=this.current_.feature.clone(),this.current_.feature.setStyle(this._style(this.current_.feature)),this.source_.addFeature(this.current_.feature)):(this.current_.feature.setStyle(this._style(this.current_.feature)),this._modifystart=!0),this.dispatchEvent({type:"offsetstart",feature:this.current_.feature,offset:0}),!0)}handleDragEvent_(e){this._modifystart&&(this.dispatchEvent({type:"modifystart",features:[this.current_.feature]}),this._modifystart=!1);var t,s,i,a,h=this.current_.geom.getClosestPoint(e.coordinate),c=(0,o.CT)(h,e.coordinate);switch(this.current_.geomType){case"Polygon":if(t=(0,o.pJ)(h,this.current_.coordinates[0]).segment,t){s=[t[1][0]-t[0][0],t[1][1]-t[0][1]],i=[e.coordinate[0]-h[0],e.coordinate[1]-h[1]],s[0]*i[1]-s[1]*i[0]>0&&(c=-c),a=[];for(var l=0;l<this.current_.coordinates.length;l++)a.push((0,o.wE)(this.current_.coordinates[l],0==l?c:-c));this.current_.feature.setGeometry(new n.ZP(a))}break;case"LineString":t=(0,o.pJ)(h,this.current_.coordinates).segment,t&&(s=[t[1][0]-t[0][0],t[1][1]-t[0][1]],i=[e.coordinate[0]-h[0],e.coordinate[1]-h[1]],s[0]*i[1]-s[1]*i[0]>0&&(c=-c),a=(0,o.wE)(this.current_.coordinates,c),this.current_.feature.setGeometry(new r.Z(a)));break;default:break}this.dispatchEvent({type:"offsetting",feature:this.current_.feature,offset:c,segment:[h,e.coordinate],coordinate:e.coordinate})}handleUpEvent_(e){this._modifystart||this.dispatchEvent({type:"offsetend",feature:this.current_.feature,coordinate:e.coordinate}),this.current_.feature.setStyle(this.currentStyle_),this.current_=!1}handleMoveEvent_(e){var t=this.getFeatureAtPixel_(e);t?(!1===this.previousCursor_&&(this.previousCursor_=e.map.getTargetElement().style.cursor),e.map.getTargetElement().style.cursor="pointer"):(e.map.getTargetElement().style.cursor=this.previousCursor_,this.previousCursor_=!1)}};const c=h},46623:(e,t,s)=>{s.d(t,{Z:()=>f});var i=s(47182),r=s(47539),n=s(58958),o=s(22556),a=s(51345),h=s(30283),c=s(92371),l=s(60188),d=s(81090),u=s(92083),_=s(48747),g=(s(10229),class extends i.ZP{constructor(e){e||(e={}),super({handleEvent:function(e){switch(e.type){case"singleclick":return this.handleDownEvent(e);case"pointermove":return this.handleMoveEvent(e);default:return!0}}}),this.snapDistance_=e.snapDistance||25,this.tolerance_=e.tolerance||1e-10,this.cursor_=e.cursor,this.setSources(e.sources),e.features&&(this.sources_||(this.sources_=[]),this.sources_.push(new o["default"]({features:e.features}))),this.filterSplit_=e.filter||function(){return!0};var t=[255,255,255,1],s=[0,153,255,1],i=3,l=new a.Z({color:"rgba(255,255,255,0.4)"}),d=new n.Z({color:"#3399CC",width:1.25}),u=[new r["default"]({image:new h.Z({fill:l,stroke:d,radius:5}),fill:l,stroke:d})],_=[new r["default"]({stroke:new n.Z({color:t,width:i+2})}),new r["default"]({image:new h.Z({radius:2*i,fill:new a.Z({color:s}),stroke:new n.Z({color:t,width:i/2})}),stroke:new n.Z({color:s,width:i})})];e.sketchStyle&&(u=e.sketchStyle instanceof Array?e.sketchStyle:[e.sketchStyle]),e.featureStyle&&(_=e.featureStyle instanceof Array?e.featureStyle:[e.featureStyle]),this.overlayLayer_=new c["default"]({source:new o["default"]({useSpatialIndex:!1}),name:"Split overlay",displayInLayerSwitcher:!1,style:function(e){return e._sketch_?u:_}})}setMap(e){this.getMap()&&this.getMap().removeLayer(this.overlayLayer_),super.setMap(e),this.overlayLayer_.setMap(e)}getSources(){if(!this.sources_&&this.getMap()){var e=[],t=function(s){s.forEach((function(s){s.getVisible()&&(s.getSource&&s.getSource()instanceof o["default"]?e.unshift(s.getSource()):s.getLayers&&t(s.getLayers()))}))};return t(this.getMap().getLayers()),e}return this.sources_||[]}setSources(e){this.sources_=!!e&&(e instanceof Array?e||!1:[e])}getClosestFeature(e){var t,s,i,r,n=this.snapDistance_+1;if(this.getSources().forEach((function(o){var a=o.getClosestFeatureToCoordinate(e.coordinate);if(a&&a.getGeometry().splitAt){var h=a.getGeometry().getClosestPoint(e.coordinate),c=new u.Z([e.coordinate,h]),l=c.getLength()/e.frameState.viewState.resolution;l<n&&(t=o,n=l,s=a,r=c,i=h)}})),n>this.snapDistance_)return!1;var o=this.getNearestCoord(i,s.getGeometry().getCoordinates()),a=this.getMap().getPixelFromCoordinate(o);return(0,_.CT)(e.pixel,a)<this.snapDistance_&&(i=o),{source:t,feature:s,coord:i,link:r}}getNearestCoord(e,t){for(var s,i,r=Number.MAX_VALUE,n=0;n<t.length;n++)s=(0,_.CT)(e,t[n]),s<r&&(r=s,i=t[n]);return i}handleDownEvent(e){var t=this.getClosestFeature(e);if(t){var s=this;s.overlayLayer_.getSource().clear();var i,r=t.feature.getGeometry().splitAt(t.coord,this.tolerance_);if(r.length>1){var n=[];for(i=0;i<r.length;i++){var o=t.feature.clone();o.setGeometry(r[i]),n.push(o)}for(s.dispatchEvent({type:"beforesplit",original:t.feature,features:n}),t.source.dispatchEvent({type:"beforesplit",original:t.feature,features:n}),t.source.removeFeature(t.feature),i=0;i<n.length;i++)t.source.addFeature(n[i]);s.dispatchEvent({type:"aftersplit",original:t.feature,features:n}),t.source.dispatchEvent({type:"aftersplit",original:t.feature,features:n})}}return!1}handleMoveEvent(e){var t=e.map;this.overlayLayer_.getSource().clear();var s,i,r=this.getClosestFeature(e);r&&this.filterSplit_(r.feature)?(this.overlayLayer_.getSource().addFeature(r.feature),s=new d["default"](new l["default"](r.coord)),s._sketch_=!0,this.overlayLayer_.getSource().addFeature(s),i=new d["default"](r.link),i._sketch_=!0,this.overlayLayer_.getSource().addFeature(i),this.dispatchEvent({type:"pointermove",coordinate:e.coordinate,frameState:e.frameState,originalEvent:e.originalEvent,map:e.map,pixel:e.pixel,feature:r.feature,linkGeometry:r.link})):this.dispatchEvent(e);var n=t.getTargetElement();this.cursor_&&(r?n.style.cursor!=this.cursor_&&(this.previousCursor_=n.style.cursor,n.style.cursor=this.cursor_):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0))}});const f=g},70710:(e,t,s)=>{s.d(t,{Z:()=>y});var i=s(47539),r=s(58958),n=s(22556),o=s(51345),a=s(92371),h=s(60188),c=s(81090),l=s(78714),d=s(14515),u=s(35393),_=s(2033),g=s(28641),f=s(62706),p=class extends d.Z{constructor(e){e=e||{},super({handleDownEvent:function(e){return t.handleDownEvent_(e)},handleDragEvent:function(e){return this.handleDragEvent_(e)},handleMoveEvent:function(e){return this.handleMoveEvent_(e)},handleUpEvent:function(e){return this.handleUpEvent_(e)}});var t=this;this.selection_=new l.Z,this.handles_=new l.Z,this.overlayLayer_=new a["default"]({source:new n["default"]({features:this.handles_,useSpatialIndex:!1,wrapX:!1}),name:"Transform overlay",displayInLayerSwitcher:!1,style:function(e){return t.style[(e.get("handle")||"default")+(e.get("constraint")||"")+(e.get("option")||"")]}}),this.features_=e.features,"function"===typeof e.filter&&(this._filter=e.filter),this.layers_=e.layers?e.layers instanceof Array?e.layers:[e.layers]:null,this._handleEvent=e.condition||function(){return!0},this.addFn_=e.addCondition||function(){return!1},this.setPointRadius(e.pointRadius),this.set("translateFeature",!1!==e.translateFeature),this.set("translate",!1!==e.translate),this.set("translateBBox",!0===e.translateBBox),this.set("stretch",!1!==e.stretch),this.set("scale",!1!==e.scale),this.set("rotate",!1!==e.rotate),this.set("keepAspectRatio",e.keepAspectRatio||function(e){return e.originalEvent.shiftKey}),this.set("modifyCenter",e.modifyCenter||function(e){return e.originalEvent.metaKey||e.originalEvent.ctrlKey}),this.set("noFlip",e.noFlip||!1),this.set("selection",!1!==e.selection),this.set("hitTolerance",e.hitTolerance||0),this.set("enableRotatedTransform",e.enableRotatedTransform||!1),this.set("keepRectangle",e.keepRectangle||!1),this.set("buffer",e.buffer||0),this.on("propertychange",(function(){this.drawSketch_()})),this.setDefaultStyle()}setMap(e){var t=this.getMap();if(t){var s=t.getTargetElement();t.removeLayer(this.overlayLayer_),this.previousCursor_&&s&&(s.style.cursor=this.previousCursor_),this.previousCursor_=void 0}super.setMap(e),this.overlayLayer_.setMap(e),null===e&&this.select(null),null!==e&&(this.isTouch=/touch/.test(e.getViewport().className),this.setDefaultStyle())}setActive(e){this.select(null),this.overlayLayer_&&this.overlayLayer_.setVisible(e),super.setActive(e)}setDefaultStyle(e){e=e||{};var t=e.pointStroke||new r.Z({color:[255,0,0,1],width:1}),s=e.stroke||new r.Z({color:[255,0,0,1],width:1,lineDash:[4,4]}),n=e.fill||new o.Z({color:[255,0,0,.01]}),a=e.pointFill||new o.Z({color:[255,255,255,.8]}),h=new u.Z({fill:a,stroke:t,radius:this.isTouch?12:6,displacement:this.isTouch?[24,-24]:[12,-12],points:15});h.setDisplacement||(h.getAnchor()[0]=this.isTouch?-10:-5);var c=new u.Z({fill:a,stroke:t,radius:this.isTouch?16:8,points:4,angle:Math.PI/4}),l=new u.Z({fill:a,stroke:t,radius:this.isTouch?12:6,points:4,angle:Math.PI/4});function d(e,t,s){return[new i["default"]({image:e,stroke:t,fill:s})]}this.style={default:d(c,s,n),translate:d(c,t,a),rotate:d(h,t,a),rotate0:d(c,t,a),scale:d(c,t,a),scale1:d(c,t,a),scale2:d(c,t,a),scale3:d(c,t,a),scalev:d(l,t,a),scaleh1:d(l,t,a),scalev2:d(l,t,a),scaleh3:d(l,t,a)},this.drawSketch_()}setStyle(e,t){if(t){this.style[e]=t instanceof Array?t:[t];for(var s=0;s<this.style[e].length;s++){var i=this.style[e][s].getImage();i&&("rotate"==e&&(i.getAnchor()[0]=-5),this.isTouch&&i.setScale(1.8));var r=this.style[e][s].getText();r&&("rotate"==e&&r.setOffsetX(this.isTouch?14:7),this.isTouch&&r.setScale(1.8))}this.drawSketch_()}}getFeatureAtPixel_(e){var t=this;return this.getMap().forEachFeatureAtPixel(e,(function(e,s){var i=!1;if(!s){if(e===t.bbox_)return!!t.get("translateBBox")&&{feature:e,handle:"translate",constraint:"",option:""};if(t.handles_.forEach((function(t){t===e&&(i=!0)})),i)return{feature:e,handle:e.get("handle"),constraint:e.get("constraint"),option:e.get("option")}}if(!t.get("selection"))return t.selection_.getArray().some((function(t){return e===t}))?{feature:e}:null;if(t._filter)return t._filter(e,s)?{feature:e}:null;if(t.layers_){for(var r=0;r<t.layers_.length;r++)if(t.layers_[r]===s)return{feature:e};return null}return t.features_?(t.features_.forEach((function(t){t===e&&(i=!0)})),i?{feature:e}:null):{feature:e}}),{hitTolerance:this.get("hitTolerance")})||{}}getGeometryRotateToZero_(e,t){var s=e.getGeometry(),i=this.getMap().getView().getRotation();if(0===i||!this.get("enableRotatedTransform"))return t?s.clone():s;var r=s.clone();return r.rotate(-1*i,this.getMap().getView().getCenter()),r}_isRectangle(e){if(this.get("keepRectangle")&&"Polygon"===e.getType()){var t=e.getCoordinates()[0];return 5===t.length}return!1}drawSketch_(e){var t,s,i,r=this.selection_.item(0)&&this._isRectangle(this.selection_.item(0).getGeometry());if(this.overlayLayer_.getSource().clear(),this.selection_.getLength()){var n,o=this.getMap().getView().getRotation(),a=this.getGeometryRotateToZero_(this.selection_.item(0)).getExtent();r&&(n=this.getGeometryRotateToZero_(this.selection_.item(0)).getCoordinates()[0].slice(0,4),n.unshift(n[3])),a=(0,g.f3)(a,this.get("buffer")),this.selection_.forEach(function(e){var t=this.getGeometryRotateToZero_(e).getExtent();(0,g.l7)(a,t)}.bind(this));var l=1===this.selection_.getLength()?this._pointRadius(this.selection_.item(0)):0;if(!l||l instanceof Array||(l=[l,l]),!0===e)this.ispt_||(this.overlayLayer_.getSource().addFeature(new c["default"]({geometry:new h["default"](this.center_),handle:"rotate0"})),i=(0,_.oJ)(a),this.get("enableRotatedTransform")&&0!==o&&i.rotate(o,this.getMap().getView().getCenter()),s=this.bbox_=new c["default"](i),this.overlayLayer_.getSource().addFeature(s));else{if(this.ispt_){var d=this.getMap().getPixelFromCoordinate([a[0],a[1]]);if(d){var u=l&&l[0]||10,f=l&&l[1]||10;a=(0,g.hI)([this.getMap().getCoordinateFromPixel([d[0]-u,d[1]-f]),this.getMap().getCoordinateFromPixel([d[0]+u,d[1]+f])])}}i=r?new _.ZP([n]):(0,_.oJ)(a),this.get("enableRotatedTransform")&&0!==o&&i.rotate(o,this.getMap().getView().getCenter()),s=this.bbox_=new c["default"](i);var p=[],y=i.getCoordinates()[0];if(!this.ispt_||l){if(p.push(s),!this.iscircle_&&!this.ispt_&&this.get("stretch")&&this.get("scale"))for(t=0;t<y.length-1;t++)s=new c["default"]({geometry:new h["default"]([(y[t][0]+y[t+1][0])/2,(y[t][1]+y[t+1][1])/2]),handle:"scale",constraint:t%2?"h":"v",option:t}),p.push(s);if(this.get("scale"))for(t=0;t<y.length-1;t++)s=new c["default"]({geometry:new h["default"](y[t]),handle:"scale",option:t}),p.push(s);this.get("translate")&&!this.get("translateFeature")&&(s=new c["default"]({geometry:new h["default"]([(y[0][0]+y[2][0])/2,(y[0][1]+y[2][1])/2]),handle:"translate"}),p.push(s))}!this.iscircle_&&this.get("rotate")&&(s=new c["default"]({geometry:new h["default"](y[3]),handle:"rotate"}),p.push(s)),this.overlayLayer_.getSource().addFeatures(p)}}}select(e,t){if(e){if(e.getGeometry&&e.getGeometry()){if(t)this.selection_.push(e);else{var s=this.selection_.getArray().indexOf(e);this.selection_.removeAt(s)}this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:e,features:this.selection_})}}else this.selection_&&(this.selection_.clear(),this.drawSketch_())}setSelection(e){this.selection_.clear(),e.forEach(function(e){this.selection_.push(e)}.bind(this)),this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",features:this.selection_})}watchFeatures_(){this._featureListeners&&this._featureListeners.forEach((function(e){(0,f.B)(e)})),this._featureListeners=[],this.selection_.forEach(function(e){this._featureListeners.push(e.on("change",function(){this.isUpdating_||this.drawSketch_()}.bind(this)))}.bind(this))}handleDownEvent_(e){if(this._handleEvent(e,this.selection_)){var t=this.getFeatureAtPixel_(e.pixel),s=t.feature;if(this.selection_.getLength()&&this.selection_.getArray().indexOf(s)>=0&&(this.ispt_&&this.get("translate")||this.get("translateFeature"))&&(t.handle="translate"),t.handle){this.mode_=t.handle,this.opt_=t.option,this.constraint_=t.constraint;var i=this.getMap().getView().getRotation();this.coordinate_=e.coordinate,this.pixel_=e.pixel,this.geoms_=[],this.rotatedGeoms_=[];for(var r,n=(0,g.lJ)(),o=(0,g.lJ)(),a=0;r=this.selection_.item(a);a++)if(this.geoms_.push(r.getGeometry().clone()),n=(0,g.l7)(n,r.getGeometry().getExtent()),this.get("enableRotatedTransform")&&0!==i){var h=this.getGeometryRotateToZero_(r,!0);this.rotatedGeoms_.push(h),o=(0,g.l7)(o,h.getExtent())}if(this.extent_=(0,_.oJ)(n).getCoordinates()[0],this.get("enableRotatedTransform")&&0!==i&&(this.rotatedExtent_=(0,_.oJ)(o).getCoordinates()[0]),"rotate"===this.mode_){this.center_=this.getCenter()||(0,g.qg)(n);var c=e.map.getTargetElement();c.style.cursor=this.Cursors.rotate0,this.previousCursor_=c.style.cursor}else this.center_=(0,g.qg)(n);return this.angle_=Math.atan2(this.center_[1]-e.coordinate[1],this.center_[0]-e.coordinate[0]),this.dispatchEvent({type:this.mode_+"start",feature:this.selection_.item(0),features:this.selection_,pixel:e.pixel,coordinate:e.coordinate}),!0}if(this.get("selection")){if(s){this.addFn_(e)||this.selection_.clear();var l=this.selection_.getArray().indexOf(s);l<0?this.selection_.push(s):this.selection_.removeAt(l)}else this.selection_.clear();return this.ispt_=1===this.selection_.getLength()&&"Point"==this.selection_.item(0).getGeometry().getType(),this.iscircle_=1===this.selection_.getLength()&&"Circle"==this.selection_.item(0).getGeometry().getType(),this.drawSketch_(),this.watchFeatures_(),this.dispatchEvent({type:"select",feature:s,features:this.selection_,pixel:e.pixel,coordinate:e.coordinate}),!1}}}getCenter(){return this.get("center")}setCenter(e){return this.set("center",e)}handleDragEvent_(e){if(this._handleEvent(e,this.features_)){var t,s,i,r,n=this.getMap().getView().getRotation(),o=[this.coordinate_[0],this.coordinate_[1]],a=[e.coordinate[0],e.coordinate[1]];switch(this.isUpdating_=!0,this.mode_){case"rotate":var c=Math.atan2(this.center_[1]-a[1],this.center_[0]-a[0]);if(!this.ispt)for(t=0,i;i=this.selection_.item(t);t++)r=this.geoms_[t].clone(),r.rotate(c-this.angle_,this.center_),"Circle"==r.getType()&&r.setCenterAndRadius(r.getCenter(),r.getRadius()),i.setGeometry(r);this.drawSketch_(!0),this.dispatchEvent({type:"rotating",feature:this.selection_.item(0),features:this.selection_,angle:c-this.angle_,pixel:e.pixel,coordinate:e.coordinate});break;case"translate":var l=a[0]-o[0],d=a[1]-o[1];for(t=0,i;i=this.selection_.item(t);t++)i.getGeometry().translate(l,d);this.handles_.forEach((function(e){e.getGeometry().translate(l,d)})),this.coordinate_=e.coordinate,this.dispatchEvent({type:"translating",feature:this.selection_.item(0),features:this.selection_,delta:[l,d],pixel:e.pixel,coordinate:e.coordinate});break;case"scale":var u=this.center_;if(this.get("modifyCenter")(e)){var _=this.extent_;this.get("enableRotatedTransform")&&0!==n&&(_=this.rotatedExtent_),u=_[(Number(this.opt_)+2)%4]}var g=1==this.geoms_.length&&this._isRectangle(this.geoms_[0]),f=this.constraint_,p=this.opt_,y=this.coordinate_,v=e.coordinate;if(this.get("enableRotatedTransform")&&0!==n){var m=new h["default"](this.coordinate_);m.rotate(-1*n,u),y=m.getCoordinates();var C=new h["default"](e.coordinate);C.rotate(-1*n,u),v=C.getCoordinates()}var w=(v[0]-u[0])/(y[0]-u[0]),x=(v[1]-u[1])/(y[1]-u[1]),E=[v[0]-y[0],v[1]-y[1]];if(this.get("enableRotatedTransform")&&0!==n){var k=new h["default"](u);k.rotate(-1*n,this.getMap().getView().getCenter()),u=k.getCoordinates()}for(this.get("noFlip")&&(w<0&&(w=-w),x<0&&(x=-x)),this.constraint_?"h"==this.constraint_?w=1:x=1:this.get("keepAspectRatio")(e)&&(w=x=Math.min(w,x)),t=0,i;i=this.selection_.item(t);t++)r=0!==n&&this.get("enableRotatedTransform")?this.rotatedGeoms_[t].clone():this.geoms_[t].clone(),r.applyTransform(function(e,t,i){if(i<2)return t;if(g){var n=[[6],[0,8],[2],[4]],o=[e[0],e[1]],a=[e[2],e[3]],h=[e[4],e[5]],c=[e[6],e[7]],l=[e[8],e[9]];if(f){var d=p%2===0?this._countVector(o,a):this._countVector(c,o),_=this._projectVectorOnVector(E,d),y=p+1<n.length?p+1:0,m=[...n[p],...n[y]];for(s=0;s<e.length;s+=i)t[s]=m.includes(s)?e[s]+_[0]:e[s],t[s+1]=m.includes(s)?e[s+1]+_[1]:e[s+1]}else{var C,k;switch(p){case 0:E=this._countVector(c,v),C=this._projectVectorOnVector(E,this._countVector(h,c)),k=this._projectVectorOnVector(E,this._countVector(o,c)),[t[0],t[1]]=this._movePoint(o,C),[t[4],t[5]]=this._movePoint(h,k),[t[6],t[7]]=this._movePoint(c,E),[t[8],t[9]]=this._movePoint(l,C);break;case 1:E=this._countVector(o,v),C=this._projectVectorOnVector(E,this._countVector(c,o)),k=this._projectVectorOnVector(E,this._countVector(a,o)),[t[0],t[1]]=this._movePoint(o,E),[t[2],t[3]]=this._movePoint(a,C),[t[6],t[7]]=this._movePoint(c,k),[t[8],t[9]]=this._movePoint(l,E);break;case 2:E=this._countVector(a,v),C=this._projectVectorOnVector(E,this._countVector(o,a)),k=this._projectVectorOnVector(E,this._countVector(h,a)),[t[0],t[1]]=this._movePoint(o,k),[t[2],t[3]]=this._movePoint(a,E),[t[4],t[5]]=this._movePoint(h,C),[t[8],t[9]]=this._movePoint(l,k);break;case 3:E=this._countVector(h,v),C=this._projectVectorOnVector(E,this._countVector(a,h)),k=this._projectVectorOnVector(E,this._countVector(c,h)),[t[2],t[3]]=this._movePoint(a,k),[t[4],t[5]]=this._movePoint(h,E),[t[6],t[7]]=this._movePoint(c,C);break}}}else for(s=0;s<e.length;s+=i)1!=w&&(t[s]=u[0]+(e[s]-u[0])*w),1!=x&&(t[s+1]=u[1]+(e[s+1]-u[1])*x);return"Circle"==r.getType()&&r.setCenterAndRadius(r.getCenter(),r.getRadius()),t}.bind(this)),this.get("enableRotatedTransform")&&0!==n&&r.rotate(n,this.getMap().getView().getCenter()),i.setGeometry(r);this.drawSketch_(),this.dispatchEvent({type:"scaling",feature:this.selection_.item(0),features:this.selection_,scale:[w,x],pixel:e.pixel,coordinate:e.coordinate});break;default:break}this.isUpdating_=!1}}handleMoveEvent_(e){if(this._handleEvent(e,this.features_)&&!this.mode_){var t=this.getFeatureAtPixel_(e.pixel),s=e.map.getTargetElement();if(t.feature){var i=t.handle?this.Cursors[(t.handle||"default")+(t.constraint||"")+(t.option||"")]:this.Cursors.select;void 0===this.previousCursor_&&(this.previousCursor_=s.style.cursor),s.style.cursor=i}else void 0!==this.previousCursor_&&(s.style.cursor=this.previousCursor_),this.previousCursor_=void 0}}handleUpEvent_(e){if("rotate"===this.mode_){var t=e.map.getTargetElement();t.style.cursor=this.Cursors.default,this.previousCursor_=void 0}return this.dispatchEvent({type:this.mode_+"end",feature:this.selection_.item(0),features:this.selection_,oldgeom:this.geoms_[0],oldgeoms:this.geoms_}),this.drawSketch_(),this.mode_=null,!1}setPointRadius(e){this._pointRadius="function"===typeof e?e:function(){return e}}getFeatures(){return this.selection_}_projectVectorOnVector(e,t){var s=(e[0]*t[0]+e[1]*t[1])/(t[0]*t[0]+t[1]*t[1]);return[t[0]*s,t[1]*s]}_countVector(e,t){return[t[0]-e[0],t[1]-e[1]]}_movePoint(e,t){return[e[0]+t[0],e[1]+t[1]]}};p.prototype.Cursors={default:"auto",select:"pointer",translate:"move",rotate:"move",rotate0:"move",scale:"nesw-resize",scale1:"nwse-resize",scale2:"nesw-resize",scale3:"nwse-resize",scalev:"ew-resize",scaleh1:"ns-resize",scalev2:"ew-resize",scaleh3:"ns-resize"};const y=p},39606:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(78714),r=s(47182),n=s(92371),o=s(62706),a=s(22556);(function(){var e=a["default"].prototype.clear;a["default"].prototype.clear=function(t){this.dispatchEvent({type:"clearstart"}),e.call(this,t),this.dispatchEvent({type:"clearend"})}})();var h=s(25108),c=class extends r.ZP{constructor(e){e=e||{},super({handleEvent:function(){return!0}}),this._layers=e.layers,this._undoStack=new i.Z,this._redoStack=new i.Z,this._undo=[],this._redo=[],this._undoStack.on("add",function(e){void 0===e.element.level?(e.element.level=this._level,e.element.level||(e.element.view={center:this.getMap().getView().getCenter(),zoom:this.getMap().getView().getZoom()},this._undo.push(e.element))):e.element.level||this._undo.push(this._redo.shift()),e.element.level||this.dispatchEvent({type:"stack:add",action:e.element}),this._reduce()}.bind(this)),this._undoStack.on("remove",function(e){e.element.level||(this._doShift?this._undo.shift():this._undo.length&&this._redo.push(this._undo.pop()),this._doClear||this.dispatchEvent({type:"stack:remove",action:e.element,shift:this._doShift}))}.bind(this)),this._block=0,this._level=0,this._doShift=!1,this._record=!0,this._defs={}}define(e,t,s){this._defs[e]={undo:t,redo:s}}length(e){return"redo"===e?this._redo.length:this._undo.length}setMaxLength(e){e=parseInt(e),e&&e<0&&(e=0),this.set("maxLength",e),this._reduce()}size(e){return"redo"===e?this._redoStack.getLength():this._undoStack.getLength()}setMaxSize(e){e=parseInt(e),e&&e<0&&(e=0),this.set("maxSize",e),this._reduce()}_reduce(){if(this.get("maxLength"))while(this.length()>this.get("maxLength"))this.shift();if(this.get("maxSize"))while(this.length()>1&&this.size()>this.get("maxSize"))this.shift()}getStack(e){return"redo"===e?this._redo:this._undo}push(e,t,s){return this._defs[e]?(this._undoStack.push({type:e,name:s,custom:!0,prop:t}),!0):(h.warn('[UndoRedoInteraction]: "'+e+'" is not defined.'),!1)}shift(){this._doShift=!0;var e=this._undoStack.removeAt(0);if(this._doShift=!1,"blockstart"===e.type){e=this._undoStack.item(0);while(this._undoStack.getLength()&&e.level>0)this._undoStack.removeAt(0),e=this._undoStack.item(0)}}setActive(e){super.setActive(e),this._record=e}setMap(e){this._mapListener&&this._mapListener.forEach((function(e){(0,o.B)(e)})),this._mapListener=[],super.setMap(e),e&&(this._mapListener.push(e.on("undoblockstart",this.blockStart.bind(this))),this._mapListener.push(e.on("undoblockend",this.blockEnd.bind(this)))),this._watchSources(),this._watchInteractions()}_watchSources(){var e=this.getMap();this._sourceListener&&this._sourceListener.forEach((function(e){(0,o.B)(e)})),this._sourceListener=[];var t=this;function s(e,i){return i||(i=[]),e.forEach((function(e){e instanceof n["default"]?(!t._layers||t._layers.indexOf(e)>=0)&&i.push(e):e.getLayers&&s(e.getLayers(),i)})),i}if(e){var i=s(e.getLayers());i.forEach(function(e){var t=e.getSource();this._sourceListener.push(t.on(["addfeature","removefeature"],this._onAddRemove.bind(this))),this._sourceListener.push(t.on("clearstart",function(){this.blockStart("clear")}.bind(this))),this._sourceListener.push(t.on("clearend",this.blockEnd.bind(this)))}.bind(this)),this._sourceListener.push(e.getLayers().on(["add","remove"],this._watchSources.bind(this)))}}_watchInteractions(){var e=this.getMap();this._interactionListener&&this._interactionListener.forEach((function(e){(0,o.B)(e)})),this._interactionListener=[],e&&(e.getInteractions().forEach(function(e){this._interactionListener.push(e.on(["setattributestart","modifystart","rotatestart","translatestart","scalestart","deletestart","deleteend","beforesplit","aftersplit"],this._onInteraction.bind(this)))}.bind(this)),this._interactionListener.push(e.getInteractions().on(["add","remove"],this._watchInteractions.bind(this))))}_onAddRemove(e){this._record&&(this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:e.type,source:e.target,feature:e.feature}))}_onInteraction(e){var t=this._onInteraction[e.type];t&&t.call(this,e)}blockStart(e){this._redoStack.clear(),this._redo.length=0,this._undoStack.push({type:"blockstart",name:e}),this._level++}blockEnd(){this._undoStack.push({type:"blockend"}),this._level--}_handleDo(e,t){if(this.getActive()){if(this._record=!1,e.custom)this._defs[e.type]?t?this._defs[e.type].undo(e.prop):this._defs[e.type].redo(e.prop):h.warn('[UndoRedoInteraction]: "'+e.type+'" is not defined.');else switch(e.type){case"addfeature":t?e.source.removeFeature(e.feature):e.source.addFeature(e.feature);break;case"removefeature":t?e.source.addFeature(e.feature):e.source.removeFeature(e.feature);break;case"changegeometry":var s=e.feature.getGeometry();e.feature.setGeometry(e.oldGeom),e.oldGeom=s;break;case"changeattribute":var i=e.newProperties,r=e.oldProperties;for(var n in r)void 0===r?e.feature.unset(n):e.feature.set(n,r[n]);e.oldProperties=i,e.newProperties=r;break;case"blockstart":this._block+=t?-1:1;break;case"blockend":this._block+=t?1:-1;break;default:h.warn('[UndoRedoInteraction]: "'+e.type+'" is not defined.')}this._block<0&&(this._block=0),this._block&&(t?this.undo():this.redo()),this._record=!0,this.dispatchEvent({type:t?"undo":"redo",action:e})}}undo(){var e=this._undoStack.item(this._undoStack.getLength()-1);e&&(this._redoStack.push(e),this._undoStack.pop(),this._handleDo(e,!0))}redo(){var e=this._redoStack.item(this._redoStack.getLength()-1);e&&(this._undoStack.push(e),this._redoStack.pop(),this._handleDo(e,!1))}clear(){this._doClear=!0,this._undo.length=this._redo.length=0,this._undoStack.clear(),this._redoStack.clear(),this._doClear=!1,this.dispatchEvent({type:"stack:clear"})}hasUndo(){return this._undoStack.getLength()}hasRedo(){return this._redoStack.getLength()}};c.prototype._onInteraction.setattributestart=function(e){this.blockStart(e.target.get("name")||"setattribute");var t=Object.assign({},e.properties);e.features.forEach(function(e){var s={};for(var i in t)s[i]=e.get(i);this._undoStack.push({type:"changeattribute",feature:e,newProperties:t,oldProperties:s})}.bind(this)),this.blockEnd()},c.prototype._onInteraction.rotatestart=c.prototype._onInteraction.translatestart=c.prototype._onInteraction.scalestart=c.prototype._onInteraction.modifystart=function(e){this.blockStart(e.type.replace(/start$/,"")),e.features.forEach(function(e){this._undoStack.push({type:"changegeometry",feature:e,oldGeom:e.getGeometry().clone()})}.bind(this)),this.blockEnd()},c.prototype._onInteraction.beforesplit=function(){var e=this._undoStack.getLength();e>2&&"blockend"===this._undoStack.item(e-1).type&&"changegeometry"===this._undoStack.item(e-2).type?this._undoStack.pop():this.blockStart("split")},c.prototype._onInteraction.deletestart=function(){this.blockStart("delete")},c.prototype._onInteraction.aftersplit=c.prototype._onInteraction.deleteend=c.prototype.blockEnd;const l=c},1614:(e,t,s)=>{s.d(t,{Z:()=>h});var i,r=s(47539),n=s(30283),o=s(58958),a=s(51345);(function(){var e=[255,255,255,1],t=[0,153,255,1],s=3,h=[new r["default"]({stroke:new o.Z({color:e,width:s+2})}),new r["default"]({image:new n.Z({radius:2*s,fill:new a.Z({color:t}),stroke:new o.Z({color:e,width:s/2})}),stroke:new o.Z({color:t,width:s}),fill:new a.Z({color:[255,255,255,.5]})})];i=function(e){if(!0===e)return h;e=e||{};var t=new a.Z({color:e.fillColor||"rgba(255,255,255,0.4)"}),s=new o.Z({color:e.color||"#3399CC",width:1.25}),i=new r["default"]({image:new n.Z({fill:t,stroke:s,radius:5}),fill:t,stroke:s});return[i]}})();const h=i},57276:(e,t,s)=>{s.d(t,{Z:()=>h});var i=s(72967),r=s(28641),n=s(41931),o=s(76442);class a extends i.ZP{constructor(e,t,s){super(),void 0!==s&&void 0===t?this.setFlatCoordinates(s,e):(t=t||0,this.setCenterAndRadius(e,t,s))}clone(){const e=new a(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,t,s,i){const r=this.flatCoordinates,n=e-r[0],o=t-r[1],a=n*n+o*o;if(a<i){if(0===a)for(let e=0;e<this.stride;++e)s[e]=r[e];else{const e=this.getRadius()/Math.sqrt(a);s[0]=r[0]+e*n,s[1]=r[1]+e*o;for(let t=2;t<this.stride;++t)s[t]=r[t]}return s.length=this.stride,a}return i}containsXY(e,t){const s=this.flatCoordinates,i=e-s[0],r=t-s[1];return i*i+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const t=this.flatCoordinates,s=t[this.stride]-t[0];return(0,r.T9)(t[0]-s,t[1]-s,t[0]+s,t[1]+s,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],t=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+t*t}getType(){return"Circle"}intersectsExtent(e){const t=this.getExtent();if((0,r.kK)(e,t)){const t=this.getCenter();return e[0]<=t[0]&&e[2]>=t[0]||(e[1]<=t[1]&&e[3]>=t[1]||(0,r.H6)(e,this.intersectsCoordinate.bind(this)))}return!1}setCenter(e){const t=this.stride,s=this.flatCoordinates[t]-this.flatCoordinates[0],i=e.slice();i[t]=i[0]+s;for(let r=1;r<t;++r)i[t+r]=e[r];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,t,s){this.setLayout(s,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const i=this.flatCoordinates;let r=(0,n.IG)(i,0,e,this.stride);i[r++]=i[0]+t;for(let n=1,o=this.stride;n<o;++n)i[r++]=i[n];i.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,t){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,t){const s=this.getCenter(),i=this.getStride();this.setCenter((0,o.U1)(s,0,s.length,i,e,t,s)),this.changed()}}a.prototype.transform;const h=a},35010:(e,t,s)=>{s.d(t,{ZP:()=>B});var i=s(57276),r=s(291),n=s(85487),o=s(81090),a=s(13958),h=s(54049),c=s(92083),l=s(48630),d=s(92217),u=s(7403),_=s(36259),g=s(32562),f=s(60188),p=s(14515),y=s(2033),v=s(92371),m=s(22556),C=s(36885),w=s(98683),x=s(28641),E=s(33983),k=s(47539),P=s(91900),b=s(63432),S=s(72967);const T={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class M extends r.ZP{constructor(e,t){super(e),this.feature=t}}function F(e,t){const s=[];for(let i=0;i<t.length;++i){const r=t[i],n=r.getGeometry();Z(e,n,s)}return s}function L(e,t){return(0,E.bI)(e[0],e[1],t[0],t[1])}function A(e,t){const s=e.length;return t<0?e[t+s]:t>=s?e[t-s]:e[t]}function I(e,t,s){let i,r;t<s?(i=t,r=s):(i=s,r=t);const n=Math.ceil(i),o=Math.floor(r);if(n>o){const t=N(e,i),s=N(e,r);return L(t,s)}let a=0;if(i<n){const t=N(e,i),s=A(e,n);a+=L(t,s)}if(o<r){const t=A(e,o),s=N(e,r);a+=L(t,s)}for(let h=n;h<o-1;++h){const t=A(e,h),s=A(e,h+1);a+=L(t,s)}return a}function Z(e,t,s){if(t instanceof c.Z)R(e,t.getCoordinates(),!1,s);else if(t instanceof u.Z){const i=t.getCoordinates();for(let t=0,r=i.length;t<r;++t)R(e,i[t],!1,s)}else if(t instanceof y.ZP){const i=t.getCoordinates();for(let t=0,r=i.length;t<r;++t)R(e,i[t],!0,s)}else if(t instanceof g.Z){const i=t.getCoordinates();for(let t=0,r=i.length;t<r;++t){const r=i[t];for(let t=0,i=r.length;t<i;++t)R(e,r[t],!0,s)}}else if(t instanceof a.Z){const i=t.getGeometries();for(let t=0;t<i.length;++t)Z(e,i[t],s)}else;}const G={index:-1,endIndex:NaN};function D(e,t,s,i){const r=e[0],n=e[1];let o=1/0,a=-1,h=NaN;for(let d=0;d<t.targets.length;++d){const e=t.targets[d],s=e.coordinates;let i,c=1/0;for(let t=0;t<s.length-1;++t){const e=s[t],o=s[t+1],a=O(r,n,e,o);a.squaredDistance<c&&(c=a.squaredDistance,i=t+a.along)}c<o&&(o=c,e.ring&&t.targetIndex===d&&(e.endIndex>e.startIndex?i<e.startIndex&&(i+=s.length):e.endIndex<e.startIndex&&i>e.startIndex&&(i-=s.length)),h=i,a=d)}const c=t.targets[a];let l=c.ring;if(t.targetIndex===a&&l){const e=N(c.coordinates,h),r=s.getPixelFromCoordinate(e);(0,P.TE)(r,t.startPx)>i&&(l=!1)}if(l){const e=c.coordinates,t=e.length,s=c.startIndex,i=h;if(s<i){const r=I(e,s,i),n=I(e,s,i-t);n<r&&(h-=t)}else{const r=I(e,s,i),n=I(e,s,i+t);n<r&&(h+=t)}}return G.index=a,G.endIndex=h,G}function R(e,t,s,i){const r=e[0],n=e[1];for(let o=0,a=t.length-1;o<a;++o){const e=t[o],a=t[o+1],h=O(r,n,e,a);if(0===h.squaredDistance){const e=o+h.along;return void i.push({coordinates:t,ring:s,startIndex:e,endIndex:e})}}}const V={along:0,squaredDistance:0};function O(e,t,s,i){const r=s[0],n=s[1],o=i[0],a=i[1],h=o-r,c=a-n;let l=0,d=r,u=n;return 0===h&&0===c||(l=(0,E.uZ)(((e-r)*h+(t-n)*c)/(h*h+c*c),0,1),d+=h*l,u+=c*l),V.along=l,V.squaredDistance=(0,E.FH)((0,E.bI)(e,t,d,u),10),V}function N(e,t){const s=e.length;let i=Math.floor(t);const r=t-i;i>=s?i-=s:i<0&&(i+=s);let n=i+1;n>=s&&(n-=s);const o=e[i],a=o[0],h=o[1],c=e[n],l=c[0]-a,d=c[1]-h;return[a+l*r,h+d*r]}class U extends p.Z{constructor(e){const t=e;t.stopDown||(t.stopDown=C.Dv),super(t),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=j(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:"Polygon"===this.mode_?3:2,this.maxPoints_="Circle"===this.mode_?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:C.uX,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let s=e.geometryFunction;if(!s){const e=this.mode_;if("Circle"===e)s=function(e,t,s){const r=t||new i.Z([NaN,NaN]),n=(0,b.fromUserCoordinate)(e[0],s),o=(0,P.bI)(n,(0,b.fromUserCoordinate)(e[e.length-1],s));r.setCenterAndRadius(n,Math.sqrt(o),this.geometryLayout_);const a=(0,b.getUserProjection)();return a&&r.transform(s,a),r};else{let t;"Point"===e?t=f["default"]:"LineString"===e?t=c.Z:"Polygon"===e&&(t=y.ZP),s=function(s,i,r){return i?"Polygon"===e?s[0].length?i.setCoordinates([s[0].concat([s[0][0]])],this.geometryLayout_):i.setCoordinates([],this.geometryLayout_):i.setCoordinates(s,this.geometryLayout_):i=new t(s,this.geometryLayout_),i}}}this.geometryFunction_=s,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new v["default"]({source:new m["default"]({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:q(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:w.rM,this.freehandCondition_,e.freehand?this.freehandCondition_=w.Bx:this.freehandCondition_=e.freehandCondition?e.freehandCondition:w.vY,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(h.Z.ACTIVE,this.updateState_)}setTrace(e){let t;t=e?!0===e?w.Bx:e:w.Fi,this.traceCondition_=t}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===n.Z.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_="Point"!==this.mode_&&this.freehandCondition_(e);let t=e.type===d.Z.POINTERMOVE,s=!0;if(!this.freehand_&&this.lastDragTime_&&e.type===d.Z.POINTERDRAG){const s=Date.now();s-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,t=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)}return this.freehand_&&e.type===d.Z.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e.coordinate),s=!1):this.freehand_&&e.type===d.Z.POINTERDOWN?s=!1:t&&this.getPointerCount()<2?(s=e.type===d.Z.POINTERMOVE,s&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):("mouse"===e.originalEvent.pointerType||e.type===d.Z.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e)):e.type===d.Z.DBLCLICK&&(s=!1),super.handleEvent(e)&&s}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout((()=>{this.handlePointerMove_(new l.Z(d.Z.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))}),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active)return void this.deactivateTrace_();const t=this.getMap(),s=t.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=t.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=(0,x.hI)([s,i]),n=this.traceSource_.getFeaturesInExtent(r);if(0===n.length)return;const o=F(e.coordinate,n);o.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:o,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,t){const s=e.startIndex<=e.endIndex,i=e.startIndex<=t;s===i?s&&t>e.endIndex||!s&&t<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,t):(s&&t<e.endIndex||!s&&t>e.endIndex)&&this.removeTracedCoordinates_(t,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,t))}removeTracedCoordinates_(e,t){if(e===t)return;let s=0;if(e<t){const i=Math.ceil(e);let r=Math.floor(t);r===t&&(r-=1),s=r-i+1}else{const i=Math.floor(e);let r=Math.ceil(t);r===t&&(r+=1),s=i-r+1}s>0&&this.removeLastPoints_(s)}addTracedCoordinates_(e,t,s){if(t===s)return;const i=[];if(t<s){const r=Math.ceil(t);let n=Math.floor(s);n===s&&(n-=1);for(let t=r;t<=n;++t)i.push(A(e.coordinates,t))}else{const r=Math.floor(t);let n=Math.ceil(s);n===s&&(n+=1);for(let t=r;t>=n;--t)i.push(A(e.coordinates,t))}i.length&&this.appendCoordinates(i)}updateTrace_(e){const t=this.traceState_;if(!t.active)return;if(-1===t.targetIndex&&(0,P.TE)(t.startPx,e.pixel)<this.snapTolerance_)return;const s=D(e.coordinate,t,this.getMap(),this.snapTolerance_);if(t.targetIndex!==s.index){if(-1!==t.targetIndex){const e=t.targets[t.targetIndex];this.removeTracedCoordinates_(e.startIndex,e.endIndex)}const e=t.targets[s.index];this.addTracedCoordinates_(e,e.startIndex,s.endIndex)}else{const e=t.targets[t.targetIndex];this.addOrRemoveTracedCoordinates_(e,s.endIndex)}t.targetIndex=s.index;const i=t.targets[t.targetIndex];i.endIndex=s.endIndex;const r=N(i.coordinates,i.endIndex),n=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(n[0]),Math.round(n[1])]}handleUpEvent(e){let t=!0;if(0===this.getPointerCount()){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const s=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():this.freehand_||i&&"Point"!==this.mode_||(this.atFinish_(e.pixel,s)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),t=!1}else this.freehand_&&this.abortDrawing()}return!t&&this.stopClick_&&e.preventDefault(),t}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const t=this.downPx_,s=e.pixel,i=t[0]-s[0],r=t[1]-s[1],n=i*i+r*r;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return}this.finishCoordinate_?(this.updateTrace_(e),this.modifyDrawing_(e.coordinate)):this.createOrUpdateSketchPoint_(e.coordinate.slice())}atFinish_(e,t){let s=!1;if(this.sketchFeature_){let i=!1,r=[this.finishCoordinate_];const n=this.mode_;if("Point"===n)s=!0;else if("Circle"===n)s=2===this.sketchCoords_.length;else if("LineString"===n)i=!t&&this.sketchCoords_.length>this.minPoints_;else if("Polygon"===n){const e=this.sketchCoords_;i=e[0].length>this.minPoints_,r=[e[0][0],e[0][e[0].length-2]],r=t?[e[0][0]]:[e[0][0],e[0][e[0].length-2]]}if(i){const t=this.getMap();for(let i=0,n=r.length;i<n;i++){const n=r[i],o=t.getPixelFromCoordinate(n),a=e[0]-o[0],h=e[1]-o[1],c=this.freehand_?1:this.snapTolerance_;if(s=Math.sqrt(a*a+h*h)<=c,s){this.finishCoordinate_=n;break}}}}return s}createOrUpdateSketchPoint_(e){if(this.sketchPoint_){const t=this.sketchPoint_.getGeometry();t.setCoordinates(e)}else this.sketchPoint_=new o["default"](new f["default"](e)),this.updateSketchFeatures_()}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new o["default"]);const t=e.getLinearRing(0);let s=this.sketchLine_.getGeometry();s?(s.setFlatCoordinates(t.getLayout(),t.getFlatCoordinates()),s.changed()):(s=new c.Z(t.getFlatCoordinates(),t.getLayout()),this.sketchLine_.setGeometry(s))}startDrawing_(e){const t=this.getMap().getView().getProjection(),s=(0,S.tP)(this.geometryLayout_);while(e.length<s)e.push(0);this.finishCoordinate_=e,"Point"===this.mode_?this.sketchCoords_=e.slice():"Polygon"===this.mode_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new o["default"](new c.Z(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_,void 0,t);this.sketchFeature_=new o["default"],this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new M(T.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const t=this.getMap(),s=this.sketchFeature_.getGeometry(),i=t.getView().getProjection(),r=(0,S.tP)(this.geometryLayout_);let n,o;while(e.length<r)e.push(0);if("Point"===this.mode_?o=this.sketchCoords_:"Polygon"===this.mode_?(n=this.sketchCoords_[0],o=n[n.length-1],this.atFinish_(t.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(n=this.sketchCoords_,o=n[n.length-1]),o[0]=e[0],o[1]=e[1],this.geometryFunction_(this.sketchCoords_,s,i),this.sketchPoint_){const t=this.sketchPoint_.getGeometry();t.setCoordinates(e)}if("Polygon"===s.getType()&&"Polygon"!==this.mode_)this.createOrUpdateCustomSketchLine_(s);else if(this.sketchLineCoords_){const e=this.sketchLine_.getGeometry();e.setCoordinates(this.sketchLineCoords_)}this.updateSketchFeatures_()}addToDrawing_(e){const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection();let i,r;const n=this.mode_;"LineString"===n||"Circle"===n?(this.finishCoordinate_=e.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():i=!0),r.push(e.slice()),this.geometryFunction_(r,t,s)):"Polygon"===n&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():i=!0),r.push(e.slice()),i&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,t,s)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),i&&this.finishDrawing()}removeLastPoints_(e){if(!this.sketchFeature_)return;const t=this.sketchFeature_.getGeometry(),s=this.getMap().getView().getProjection(),i=this.mode_;for(let r=0;r<e;++r){let e;if("LineString"===i||"Circle"===i){if(e=this.sketchCoords_,e.splice(-2,1),e.length>=2){this.finishCoordinate_=e[e.length-2].slice();const t=this.finishCoordinate_.slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}this.geometryFunction_(e,t,s),"Polygon"===t.getType()&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(t)}else if("Polygon"===i){e=this.sketchCoords_[0],e.splice(-2,1);const i=this.sketchLine_.getGeometry();if(e.length>=2){const t=e[e.length-2].slice();e[e.length-1]=t,this.createOrUpdateSketchPoint_(t)}i.setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t,s)}if(1===e.length){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return;let t=this.sketchCoords_;const s=e.getGeometry(),i=this.getMap().getView().getProjection();"LineString"===this.mode_?(t.pop(),this.geometryFunction_(t,s,i)):"Polygon"===this.mode_&&(t[0].pop(),this.geometryFunction_(t,s,i),t=s.getCoordinates()),"MultiPoint"===this.type_?e.setGeometry(new _.Z([t])):"MultiLineString"===this.type_?e.setGeometry(new u.Z([t])):"MultiPolygon"===this.type_&&e.setGeometry(new g.Z([t])),this.dispatchEvent(new M(T.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new M(T.DRAWABORT,e))}appendCoordinates(e){const t=this.mode_,s=!this.sketchFeature_;let i;if(s&&this.startDrawing_(e[0]),"LineString"===t||"Circle"===t)i=this.sketchCoords_;else{if("Polygon"!==t)return;i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]}s&&i.shift(),i.pop();for(let n=0;n<e.length;n++)this.addToDrawing_(e[n]);const r=e[e.length-1];this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){const t=e.getGeometry(),s=t;this.sketchFeature_=e,this.sketchCoords_=s.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new o["default"](new f["default"](i)),this.updateSketchFeatures_(),this.dispatchEvent(new M(T.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)}updateState_(){const e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)}}function q(){const e=(0,k.createEditingStyle)();return function(t,s){return e[t.getGeometry().getType()]}}function j(e){switch(e){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+e)}}const B=U},92420:(e,t,s)=>{s.d(t,{Z:()=>k});var i=s(291),r=s(81090),n=s(92217),o=s(60188),a=s(14515),h=s(92371),c=s(22556),l=s(98683),d=s(28641),u=s(91900),_=s(47539),g=s(2033),f=s(63432);const p={EXTENTCHANGED:"extentchanged"};class y extends i.ZP{constructor(e){super(p.EXTENTCHANGED),this.extent=e}}class v extends a.Z{constructor(e){e=e||{},super(e),this.on,this.once,this.un,this.condition_=e.condition?e.condition:l.Bx,this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new h["default"]({source:new c["default"]({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:m(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new h["default"]({source:new c["default"]({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:C(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}snapToVertex_(e,t){const s=t.getCoordinateFromPixelInternal(e),i=function(e,t){return(0,u.Bs)(s,e)-(0,u.Bs)(s,t)},r=this.getExtentInternal();if(r){const n=E(r);n.sort(i);const o=n[0];let a=(0,u.oL)(s,o);const h=t.getPixelFromCoordinateInternal(a);if((0,u.TE)(e,h)<=this.pixelTolerance_){const e=t.getPixelFromCoordinateInternal(o[0]),s=t.getPixelFromCoordinateInternal(o[1]),i=(0,u.bI)(h,e),r=(0,u.bI)(h,s),n=Math.sqrt(Math.min(i,r));return this.snappedToVertex_=n<=this.pixelTolerance_,this.snappedToVertex_&&(a=i>r?o[1]:o[0]),a}}return null}handlePointerMove_(e){const t=e.pixel,s=e.map;let i=this.snapToVertex_(t,s);i||(i=s.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(i)}createOrUpdateExtentFeature_(e){let t=this.extentFeature_;return t?e?t.setGeometry((0,g.oJ)(e)):t.setGeometry(void 0):(t=e?new r["default"]((0,g.oJ)(e)):new r["default"]({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t}createOrUpdatePointerFeature_(e){let t=this.vertexFeature_;if(t){const s=t.getGeometry();s.setCoordinates(e)}else t=new r["default"](new o["default"](e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t);return t}handleEvent(e){return!e.originalEvent||!this.condition_(e)||(e.type!=n.Z.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),super.handleEvent(e),!1)}handleDownEvent(e){const t=e.pixel,s=e.map,i=this.getExtentInternal();let r=this.snapToVertex_(t,s);const n=function(e){let t=null,s=null;return e[0]==i[0]?t=i[2]:e[0]==i[2]&&(t=i[0]),e[1]==i[1]?s=i[3]:e[1]==i[3]&&(s=i[1]),null!==t&&null!==s?[t,s]:null};if(r&&i){const e=r[0]==i[0]||r[0]==i[2]?r[0]:null,t=r[1]==i[1]||r[1]==i[3]?r[1]:null;null!==e&&null!==t?this.pointerHandler_=w(n(r)):null!==e?this.pointerHandler_=x(n([e,i[1]]),n([e,i[3]])):null!==t&&(this.pointerHandler_=x(n([i[0],t]),n([i[2],t])))}else r=s.getCoordinateFromPixelInternal(t),this.setExtent([r[0],r[1],r[0],r[1]]),this.pointerHandler_=w(r);return!0}handleDragEvent(e){if(this.pointerHandler_){const t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}}handleUpEvent(e){this.pointerHandler_=null;const t=this.getExtentInternal();return t&&0!==(0,d.bg)(t)||this.setExtent(null),!1}setMap(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),super.setMap(e)}getExtent(){return(0,f.toUserExtent)(this.getExtentInternal(),this.getMap().getView().getProjection())}getExtentInternal(){return this.extent_}setExtent(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new y(this.extent_))}}function m(){const e=(0,_.createEditingStyle)();return function(t,s){return e["Polygon"]}}function C(){const e=(0,_.createEditingStyle)();return function(t,s){return e["Point"]}}function w(e){return function(t){return(0,d.hI)([e,t])}}function x(e,t){return e[0]==t[0]?function(s){return(0,d.hI)([e,[s[0],t[1]]])}:e[1]==t[1]?function(s){return(0,d.hI)([e,[t[0],s[1]]])}:null}function E(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}const k=v},6002:(e,t,s)=>{s.d(t,{Z:()=>v});var i=s(42071),r=s(85487),n=s(14515),o=s(39781),a=s(22796),h=s(36885),c=s(28641),l=s(91900),d=s(2033),u=s(63432),_=s(74187),g=s(65818);function f(e){return e.feature?e.feature:e.element?e.element:null}const p=[];class y extends n.Z{constructor(e){e=e||{};const t=e;t.handleDownEvent||(t.handleDownEvent=h.uX),t.stopDown||(t.stopDown=h.Dv),super(t),this.source_=e.source?e.source:null,this.vertex_=void 0===e.vertex||e.vertex,this.edge_=void 0===e.edge||e.edge,this.features_=e.features?e.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.rBush_=new o.Z,this.GEOMETRY_SEGMENTERS_={Point:this.segmentPointGeometry_.bind(this),LineString:this.segmentLineStringGeometry_.bind(this),LinearRing:this.segmentLineStringGeometry_.bind(this),Polygon:this.segmentPolygonGeometry_.bind(this),MultiPoint:this.segmentMultiPointGeometry_.bind(this),MultiLineString:this.segmentMultiLineStringGeometry_.bind(this),MultiPolygon:this.segmentMultiPolygonGeometry_.bind(this),GeometryCollection:this.segmentGeometryCollectionGeometry_.bind(this),Circle:this.segmentCircleGeometry_.bind(this)}}addFeature(e,t){t=void 0===t||t;const s=(0,_.sq)(e),i=e.getGeometry();if(i){const t=this.GEOMETRY_SEGMENTERS_[i.getType()];if(t){this.indexedFeaturesExtents_[s]=i.getExtent((0,c.lJ)());const r=[];if(t(r,i),1===r.length)this.rBush_.insert((0,c.hI)(r[0]),{feature:e,segment:r[0]});else if(r.length>1){const t=r.map((e=>(0,c.hI)(e))),s=r.map((t=>({feature:e,segment:t})));this.rBush_.load(t,s)}}}t&&(this.featureChangeListenerKeys_[s]=(0,g.oL)(e,r.Z.CHANGE,this.handleFeatureChange_,this))}getFeatures_(){let e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e}handleEvent(e){const t=this.snapTo(e.pixel,e.coordinate,e.map);return t&&(e.coordinate=t.vertex.slice(0,2),e.pixel=t.vertexPixel),super.handleEvent(e)}handleFeatureAdd_(e){const t=f(e);t&&this.addFeature(t)}handleFeatureRemove_(e){const t=f(e);t&&this.removeFeature(t)}handleFeatureChange_(e){const t=e.target;if(this.handlingDownUpSequence){const e=(0,_.sq)(t);e in this.pendingFeatures_||(this.pendingFeatures_[e]=t)}else this.updateFeature_(t)}handleUpEvent(e){const t=Object.values(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}removeFeature(e,t){const s=void 0===t||t,i=(0,_.sq)(e),r=this.indexedFeaturesExtents_[i];if(r){const t=this.rBush_,s=[];t.forEachInExtent(r,(function(t){e===t.feature&&s.push(t)}));for(let e=s.length-1;e>=0;--e)t.remove(s[e])}s&&((0,g.bN)(this.featureChangeListenerKeys_[i]),delete this.featureChangeListenerKeys_[i])}setMap(e){const t=this.getMap(),s=this.featuresListenerKeys_,r=this.getFeatures_();t&&(s.forEach(g.bN),s.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(g.bN),this.featureChangeListenerKeys_={}),super.setMap(e),e&&(this.features_?s.push((0,g.oL)(this.features_,i.Z.ADD,this.handleFeatureAdd_,this),(0,g.oL)(this.features_,i.Z.REMOVE,this.handleFeatureRemove_,this)):this.source_&&s.push((0,g.oL)(this.source_,a.Z.ADDFEATURE,this.handleFeatureAdd_,this),(0,g.oL)(this.source_,a.Z.REMOVEFEATURE,this.handleFeatureRemove_,this)),r.forEach((e=>this.addFeature(e))))}snapTo(e,t,s){const i=s.getView().getProjection(),r=(0,u.fromUserCoordinate)(t,i),n=(0,u.toUserExtent)((0,c.f3)((0,c.hI)([r]),s.getView().getResolution()*this.pixelTolerance_),i),o=this.rBush_.getInExtent(n),a=o.length;if(0===a)return null;let h,d=1/0;const _=this.pixelTolerance_*this.pixelTolerance_,g=()=>{if(h){const t=s.getPixelFromCoordinate(h),i=(0,l.bI)(e,t);if(i<=_)return{vertex:h,vertexPixel:[Math.round(t[0]),Math.round(t[1])]}}return null};if(this.vertex_){for(let t=0;t<a;++t){const e=o[t];"Circle"!==e.feature.getGeometry().getType()&&e.segment.forEach((e=>{const t=(0,u.fromUserCoordinate)(e,i),s=(0,l.bI)(r,t);s<d&&(h=e,d=s)}))}const e=g();if(e)return e}if(this.edge_){for(let t=0;t<a;++t){let e=null;const s=o[t];if("Circle"===s.feature.getGeometry().getType()){let t=s.feature.getGeometry();const n=(0,u.getUserProjection)();n&&(t=t.clone().transform(n,i)),e=(0,l.Ed)(r,t)}else{const[t,n]=s.segment;n&&(p[0]=(0,u.fromUserCoordinate)(t,i),p[1]=(0,u.fromUserCoordinate)(n,i),e=(0,l.oL)(r,p))}if(e){const t=(0,l.bI)(r,e);t<d&&(h=(0,u.toUserCoordinate)(e,i),d=t)}}const e=g();if(e)return e}return null}updateFeature_(e){this.removeFeature(e,!1),this.addFeature(e,!1)}segmentCircleGeometry_(e,t){const s=this.getMap().getView().getProjection();let i=t;const r=(0,u.getUserProjection)();r&&(i=i.clone().transform(r,s));const n=(0,d.Bb)(i);r&&n.transform(s,r);const o=n.getCoordinates()[0];for(let a=0,h=o.length-1;a<h;++a)e.push(o.slice(a,a+2))}segmentGeometryCollectionGeometry_(e,t){const s=t.getGeometriesArray();for(let i=0;i<s.length;++i){const t=this.GEOMETRY_SEGMENTERS_[s[i].getType()];t&&t(e,s[i])}}segmentLineStringGeometry_(e,t){const s=t.getCoordinates();for(let i=0,r=s.length-1;i<r;++i)e.push(s.slice(i,i+2))}segmentMultiLineStringGeometry_(e,t){const s=t.getCoordinates();for(let i=0,r=s.length;i<r;++i){const t=s[i];for(let s=0,i=t.length-1;s<i;++s)e.push(t.slice(s,s+2))}}segmentMultiPointGeometry_(e,t){t.getCoordinates().forEach((t=>{e.push([t])}))}segmentMultiPolygonGeometry_(e,t){const s=t.getCoordinates();for(let i=0,r=s.length;i<r;++i){const t=s[i];for(let s=0,i=t.length;s<i;++s){const i=t[s];for(let t=0,s=i.length-1;t<s;++t)e.push(i.slice(t,t+2))}}}segmentPointGeometry_(e,t){e.push([t.getCoordinates()])}segmentPolygonGeometry_(e,t){const s=t.getCoordinates();for(let i=0,r=s.length;i<r;++i){const t=s[i];for(let s=0,i=t.length-1;s<i;++s)e.push(t.slice(s,s+2))}}}const v=y}}]);
//# sourceMappingURL=9212.07597ad1.js.map