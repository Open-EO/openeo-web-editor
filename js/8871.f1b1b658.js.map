{"version":3,"file":"js/8871.f1b1b658.js","mappings":"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","sources":["webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/ModelBuilder.vue?3e1f","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Block.vue?9cdd","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue?5d1f","webpack://@openeo/web-editor/node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue?c62f","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/BlockParameter.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/config.js","webpack://@openeo/web-editor/node_modules/@openeo/vue-components/components/model-builder/Block.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Block.vue?0c0a","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Block.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Edge.vue?86a1","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/segment.js","webpack://@openeo/web-editor/node_modules/@openeo/vue-components/components/model-builder/Edge.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Edge.vue?9654","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/model-builder/Edge.vue","webpack://@openeo/web-editor/node_modules/@openeo/vue-components/components/ModelBuilder.vue","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/ModelBuilder.vue?8e67","webpack://@openeo/web-editor/./node_modules/@openeo/vue-components/components/ModelBuilder.vue","webpack://@openeo/web-editor/./node_modules/intersects/box-box.js","webpack://@openeo/web-editor/./node_modules/intersects/box-line.js","webpack://@openeo/web-editor/./node_modules/intersects/box-point.js","webpack://@openeo/web-editor/./node_modules/intersects/line-box.js","webpack://@openeo/web-editor/./node_modules/intersects/line-line.js","webpack://@openeo/web-editor/./node_modules/intersects/line-point.js","webpack://@openeo/web-editor/./node_modules/intersects/line-polygon.js","webpack://@openeo/web-editor/./node_modules/intersects/lineToLine.js","webpack://@openeo/web-editor/./node_modules/intersects/lineToPolygon.js","webpack://@openeo/web-editor/./node_modules/intersects/polygon-point.js","webpack://@openeo/web-editor/./node_modules/intersects/polygon-polygon.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"div\",class:_vm.classes,style:(_vm.style),attrs:{\"id\":_vm.id,\"tabindex\":\"0\"},on:{\"mousemove\":_vm.onMouseMove,\"mousedown\":_vm.onMouseDown,\"wheel\":_vm.onMouseWheel,\"keydown\":_vm.onKeyDown,\"focus\":function($event){_vm.hasFocus = true},\"blur\":function($event){_vm.hasFocus = false}}},[_c('svg',{staticClass:\"canvas\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"version\":\"1.1\"}},[_vm._l((_vm.edges),function(edge){return _c('Edge',{key:edge.id,attrs:{\"id\":edge.id,\"parameter1\":edge.parameter1,\"parameter2\":edge.parameter2,\"selected\":edge.selected,\"inactive\":edge.inactive,\"issues\":edge.issues,\"state\":_vm.state},on:{\"mounted\":node => _vm.mount(edge, node),\"unmounted\":() => _vm.mount(edge),\"position\":function($event){return _vm.updateEdgePos(edge, arguments)}}})}),_vm._l((_vm.hiddenParameterRefEdges),function(edge){return _c('Edge',{key:edge.id,attrs:{\"id\":edge.id,\"parameter1\":edge.parameter1,\"parameter2\":edge.parameter2,\"inactive\":true,\"lineColor\":[200,200,200,1],\"lineWidth\":2,\"state\":_vm.state},on:{\"mounted\":node => _vm.mount(edge, node),\"unmounted\":() => _vm.mount(edge)}})}),(_vm.linkingLine)?_c('line',_vm._b({},'line',_vm.linkingLine,false)):_vm._e(),(_vm.selectRect)?_c('rect',_vm._b({},'rect',_vm.selectRect,false)):_vm._e()],2),_c('div',{staticClass:\"blocks\"},_vm._l((_vm.blocks),function(block){return _c('Block',{key:block.id,attrs:{\"id\":block.id,\"type\":block.type,\"spec\":block.spec,\"state\":_vm.state,\"selected\":block.selected,\"position\":block.position,\"origin\":block.origin,\"process_id\":block.process_id,\"namespace\":block.namespace,\"result\":block.result,\"args\":block.arguments,\"description\":block.description},on:{\"update\":(...args) => _vm.updateBlock(block, ...args),\"mounted\":node => _vm.mount(block, node),\"unmounted\":() => _vm.mount(block),\"move\":_vm.startDragBlock}})}),1),(_vm.state.scale < 0.7 || _vm.showZoomInfo)?_c('div',{staticClass:\"zoomInfo\"},[(_vm.state.scale < 0.7)?_c('div',[_vm._v(\" Zoom in for more details. \")]):_vm._e(),(_vm.showZoomInfo)?_c('div',[_vm._v(\" Zoom with \"),_c('kbd',[_vm._v(\"STRG\")]),_vm._v(\" or \"),_c('kbd',[_vm._v(\"Meta\")]),_vm._v(\" key and the mouse wheel. \")]):_vm._e()]):_vm._e(),(_vm.parameterViewer)?_c('ParameterViewer',_vm._b({on:{\"close\":function($event){_vm.parameterViewer = null}}},'ParameterViewer',_vm.parameterViewer,false)):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"div\",class:_vm.containerClasses,style:(_vm.styles),attrs:{\"id\":'block' + this.id},on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"]))return null;$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0)return null;return _vm.onMouseDown.apply(null, arguments)}}},[_c('div',{staticClass:\"blockTitle\",on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"]))return null;$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0)return null;return _vm.emitDrag.apply(null, arguments)}}},[_c('span',{staticClass:\"titleText\",attrs:{\"title\":_vm.plainTitle}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.invalid),expression:\"invalid\"}],staticClass:\"invalid\",attrs:{\"title\":\"Process or Collection not supported!\"}},[_c('i',{staticClass:\"fas fa-exclamation-triangle\"})]),_vm._v(\" \"+_vm._s(_vm.name)+\" \"),(_vm.showId)?_c('span',{staticClass:\"blockId\"},[_vm._v(_vm._s(_vm.id))]):_vm._e()]),_c('div',{staticClass:\"blockicon\",on:{\"mousedown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"left\",37,$event.key,[\"Left\",\"ArrowLeft\"]))return null;$event.preventDefault();$event.stopPropagation();if('button' in $event && $event.button !== 0)return null;return _vm.focus()}}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsDescription && !_vm.showDescriptionField),expression:\"allowsDescription && !showDescriptionField\"}],staticClass:\"addDescription\",attrs:{\"title\":\"Add description\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.addDescription()}}},[_c('i',{staticClass:\"fas fa-comment-medical\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsDuplicate),expression:\"allowsDuplicate\"}],staticClass:\"duplicate\",attrs:{\"title\":\"Duplicate\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.duplicate.apply(null, arguments)}}},[_c('i',{staticClass:\"fas fa-clone\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsDelete),expression:\"allowsDelete\"}],staticClass:\"delete\",attrs:{\"title\":\"Remove (DEL)\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.remove()}}},[_c('i',{staticClass:\"fas fa-trash\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsInfo),expression:\"allowsInfo\"}],staticClass:\"info\",attrs:{\"title\":\"Details\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.showInfo()}}},[_c('i',{staticClass:\"fas fa-info\"})]),_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.allowsParameterChange),expression:\"allowsParameterChange\"}],staticClass:\"settings\",attrs:{\"title\":_vm.isParameter ? 'Edit parameter' : 'Change parameter values'},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.edit.apply(null, arguments)}}},[_c('i',{staticClass:\"fas fa-edit\"})])])]),_c('div',{staticClass:\"inout\"},[_c('div',{staticClass:\"inputs\"},_vm._l((_vm.parameters),function(param,i){return _c('BlockParameter',{key:i,ref:\"parameters\",refInFor:true,attrs:{\"state\":_vm.state,\"value\":_vm.args[param.name],\"name\":param.name,\"description\":param.description,\"optional\":param.optional,\"deprecated\":param.deprecated,\"experimental\":param.experimental,\"default\":param.default,\"schema\":param.schema},on:{\"input\":value => _vm.updateArgument(param.name, value),\"edgesChanged\":function($event){return _vm.edgesChanged(param, $event)}}})}),1),_c('div',{staticClass:\"outputs\"},[_c('BlockParameter',_vm._b({ref:\"output\",attrs:{\"state\":_vm.state,\"label\":_vm.outputLabel},on:{\"input\":_vm.updateResult}},'BlockParameter',_vm.output,false))],1)]),(_vm.showDescriptionField)?_c('textarea',{ref:\"descriptionField\",staticClass:\"editDescription\",attrs:{\"readonly\":!_vm.state.editable,\"placeholder\":\"Type description here...\"},domProps:{\"value\":_vm.description},on:{\"input\":_vm.updateDescription,\"blur\":_vm.updateDescription,\"mousedown\":function($event){$event.stopPropagation();}}}):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{class:_vm.classes},[(!_vm.output)?_c('div',_vm._g({ref:\"circle\",class:_vm.circleClasses},_vm.circleListeners)):_vm._e(),_c('span',_vm._g({staticClass:\"text\"},_vm.textListeners),[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.unspecified),expression:\"unspecified\"}],staticClass:\"unspecified\",attrs:{\"title\":\"Parameter is likely unsupported!\"}},[_c('i',{staticClass:\"fas fa-exclamation-triangle\"})]),_c('span',{staticClass:\"label\"},[_vm._v(_vm._s(_vm.displayLabel))]),(_vm.displayValue.length)?[_vm._v(\": \")]:_vm._e(),_c('span',{staticClass:\"value\",domProps:{\"innerHTML\":_vm._s(_vm.displayValue)}})],2),(_vm.output)?_c('div',_vm._g({ref:\"circle\",class:_vm.circleClasses,attrs:{\"title\":\"Output of the process\"}},_vm.circleListeners)):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div :class=\"classes\">\r\n        <div v-if=\"!output\" ref=\"circle\" :class=\"circleClasses\" v-on=\"circleListeners\"></div>\r\n        <span class=\"text\" v-on=\"textListeners\">\r\n            <span v-show=\"unspecified\" class=\"unspecified\" title=\"Parameter is likely unsupported!\">\r\n                <i class=\"fas fa-exclamation-triangle\"></i>\r\n            </span>\r\n            <span class=\"label\">{{ displayLabel }}</span><template v-if=\"displayValue.length\">: </template>\r\n            <span class=\"value\" v-html=\"displayValue\"></span>\r\n        </span>\r\n        <div v-if=\"output\" ref=\"circle\" :class=\"circleClasses\" v-on=\"circleListeners\" title=\"Output of the process\"></div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { ProcessSchema } from '@openeo/js-commons';\r\nimport { ProcessGraph } from '@openeo/js-processgraphs';\r\nimport Utils from '../../utils.js';\r\n\r\nexport default {\r\n    name: 'BlockParameter',\r\n    props: {\r\n        name: {\r\n            type: String,\r\n            default: 'output'\r\n        },\r\n        description: {\r\n            type: String,\r\n            default: ''\r\n        },\r\n        optional: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        deprecated: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        experimental: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        default: {},\r\n        value: {},\r\n        schema: {\r\n            type: [Object, Array],\r\n            default: null\r\n        },\r\n        label: {\r\n            type: String\r\n        },\r\n        output: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            // The attached edges\r\n            edges: []\r\n        };\r\n    },\r\n    computed: {\r\n        schemas() {\r\n            if (this.schema instanceof ProcessSchema) {\r\n                return this.schema;\r\n            }\r\n            else {\r\n                return new ProcessSchema(this.schema);\r\n            }\r\n        },\r\n        hasValue() {\r\n            return (this.value !== undefined);\r\n        },\r\n        textListeners() {\r\n            if (this.allowsArgumentChange) {\r\n                return {\r\n                    click: this.openEditorForArguments\r\n                };\r\n            }\r\n            else {\r\n                return {};\r\n            }\r\n        },\r\n        circleListeners() {\r\n            var listeners = {};\r\n            if (this.state.editable) {\r\n                listeners.mousedown = event => {\r\n                    if (event.which == 1) {\r\n                        this.state.root.link(this);\r\n                        event.preventDefault();\r\n                        event.stopPropagation();\r\n                    }\r\n                };\r\n\r\n                if (this.output) {\r\n                    // Allow specifying the result node\r\n                    listeners.dblclick = event => {\r\n                        if (event.which == 1) {\r\n                            this.$emit('input', true);\r\n                        }\r\n                    };\r\n                }\r\n\r\n                // Handle focus on the I/Os\r\n                listeners.mouseover = () => this.state.linkFrom && this.state.root.link(this);\r\n                listeners.mouseout = () => this.state.linkTo && this.state.root.unlink(this);\r\n            }\r\n            return listeners;\r\n        },\r\n        classes() {\r\n            let classes = [\r\n                this.output ? 'output' : 'input',\r\n                'connector',\r\n                'field_' + this.name,\r\n                (this.hasValue || this.optional || this.output || this.getEdgeCount() > 0) ? 'hasValue' : 'noValue',\r\n            ];\r\n            if (this.allowsArgumentChange) {\r\n                classes.push(\"editable\");\r\n            }\r\n            return classes;\r\n        },\r\n        unspecified() {\r\n            return !this.$parent.invalid && this.state.root.hasProcesses && this.schemas.unspecified;\r\n        },\r\n        circleClasses() {\r\n            var classes = ['circle'];\r\n            if (this.getEdgeCount() > 0) {\r\n                classes.push('io_active');\r\n            }\r\n\r\n            for (var edge of this.edges) {\r\n                if (edge.selected) {\r\n                    classes.push('io_selected');\r\n                }\r\n                else if (edge.issues.length > 0) {\r\n                    classes.push('io_issues');\r\n                }\r\n            }\r\n\r\n            if (this.state.linkFrom == this || this.state.linkTo == this) {\r\n                classes.push('io_selected');\r\n            }\r\n            return classes;\r\n        },\r\n        displayValue() {\r\n            var maxLength = 38 - this.displayLabel.length;\r\n            var formattedValue = null;\r\n            if (this.isEditable && !this.state.compactMode && !Utils.isRef(this.value)) {\r\n                let value = typeof this.value !== 'undefined' ? this.value : this.default;\r\n                if (typeof value !== 'undefined') {\r\n                    formattedValue = this.formatValue(value, maxLength, true);\r\n                }\r\n            }\r\n\r\n            if (typeof formattedValue === 'string') {\r\n                if (formattedValue.length === 0) {\r\n                    formattedValue = '<em>Empty</em>';\r\n                }\r\n            }\r\n            else {\r\n                formattedValue = '';\r\n            }\r\n            return formattedValue;\r\n        },\r\n        displayLabel() {\r\n            if (this.output && this.state.compactMode) {\r\n                return '';\r\n            }\r\n            else if (typeof this.label === 'string' && (this.label.length > 0 || this.output)) {\r\n                return this.label;\r\n            }\r\n            else {\r\n                return this.name;\r\n            }\r\n        },\r\n        isArrayType() {\r\n            return this.schemas.nativeDataType() === 'array';\r\n        },\r\n        isObjectType() {\r\n            return this.schemas.nativeDataType() === 'object';\r\n        },\r\n        isEditable() {\r\n            return !this.output && this.schemas.isEditable();\r\n        },\r\n        allowsArgumentChange() {\r\n            return (!this.output && this.schemas.isEditable());\r\n        },\r\n        allowsMultipleInputs() {\r\n            // Is there any type that potentially allows multiple inputs?\r\n            return this.isArrayType || this.isObjectType || this.schemas.nativeDataType() === 'any';\r\n        },\r\n    },\r\n    watch: {\r\n        edges() {\r\n            this.updateEdgeStatus();\r\n            this.$emit('edgesChanged', this.edges, this);\r\n        },\r\n        value: {\r\n            immediate: true,\r\n            handler() {\r\n                this.updateEdgeStatus();\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        updateEdgeStatus() {\r\n            if (!this.output) {\r\n                for(var edge of this.edges) {\r\n                    edge.inactive = !this.isEdgeUsed(edge);\r\n                }\r\n            }\r\n        },\r\n        getCirclePosition() {\r\n            try {\r\n                var dim = this.state.root.domBoundingBox(this.$refs.circle);\r\n                var blocksDim = this.state.root.getDimensions();\r\n                var x = (dim.offsetLeft - blocksDim.offsetLeft) + dim.width / 2;\r\n                var y = (dim.offsetTop - blocksDim.offsetTop) + dim.height / 2;\r\n                return [x, y];\r\n            } catch (error) {\r\n                console.warn(error);\r\n                return null;\r\n            }\r\n        },\r\n        openEditorForArguments() {\r\n            if (this.allowsArgumentChange) {\r\n                this.$parent.showArguments(this.name);\r\n            }\r\n        },\r\n        jsonSchema() {\r\n            return this.schemas.toJSON();\r\n        },\r\n        setValue(value) {\r\n            if (this.schemas.nativeDataType() == 'boolean' && !Utils.isRef(value)) {\r\n                value = !!value;\r\n            }\r\n            this.$emit('input', value);\r\n        },\r\n        resetValue() {\r\n            if (typeof this.default !== 'undefined') {\r\n                this.setValue(this.default);\r\n                return;\r\n            }\r\n            \r\n            var value;\r\n            if (this.schemas.nullable()) {\r\n                value = null;\r\n            }\r\n            else {\r\n                var dataType = this.schemas.nativeDataType();\r\n                switch(dataType) {\r\n                    case 'object':\r\n                        value = {};\r\n                        break;\r\n                    case 'array':\r\n                        value = [];\r\n                        break;\r\n                    case 'string':\r\n                        value = '';\r\n                        break;\r\n                    case 'integer':\r\n                    case 'number':\r\n                        value = 0;\r\n                        break;\r\n                    case 'boolean':\r\n                        value = false;\r\n                        break;\r\n                    default:\r\n                        value = undefined;\r\n                }\r\n            }\r\n            this.setValue(value);\r\n        },\r\n        getEdgeRef(edge) {\r\n            if (this.output) {\r\n                return this.value;\r\n            }\r\n            else {\r\n                return edge.parameter1.value;\r\n            }\r\n        },\r\n        addRefToValue(edge) {\r\n            var ref = this.getEdgeRef(edge);\r\n            if (!ref) {\r\n                return;\r\n            }\r\n            else if (!this.allowsMultipleInputs) {\r\n                this.setValue(ref);\r\n            }\r\n            else if (this.isArrayType) {\r\n                if (Utils.isRef(this.value)) {\r\n                    this.setValue([this.value, ref]);\r\n                }\r\n                else if (Array.isArray(this.value) && this.value.length > 0) {\r\n                    var value = this.value;\r\n                    value.push(ref);\r\n                    this.setValue(value);\r\n                }\r\n                else {\r\n                    this.setValue(ref);\r\n                }\r\n            }\r\n            else if (this.isObjectType) {\r\n                var propertyCount = Utils.size(this.value);\r\n                if (this.getEdgeCount() === 1 && (!this.hasValue || !propertyCount)) {\r\n                    this.setValue(ref);\r\n                }\r\n                else if (!propertyCount) {\r\n                    this.resetValue();\r\n                }\r\n                else {\r\n                    // Don't change value\r\n                }\r\n            }\r\n            else {\r\n                // ToDo: This is probably of data type mixed or any, how to handle?\r\n                this.setValue(ref);\r\n            }\r\n        },\r\n        removeRefFromValue(edge) {\r\n            if (!this.output) {\r\n                var ref = this.getEdgeRef(edge);\r\n                if (Utils.isRefEqual(ref, this.value)) {\r\n                    this.resetValue();\r\n                }\r\n                else if (this.isArrayType || this.isObjectType) {\r\n                    this.setValue(this.removeRefFromValueDeep(this.value, ref));\r\n                }\r\n            }\r\n        },\r\n        removeRefFromValueDeep(value, ref) {\r\n            if (Array.isArray(value)) {\r\n                var i = value.length;\r\n                while(--i >= 0) {\r\n                    if (value[i] === null || typeof value[i] !== 'object') {\r\n                        continue;\r\n                    }\r\n                    else if (Utils.isRefEqual(ref, value[i])) {\r\n                        value.splice(i, 1);\r\n                    }\r\n                    else {\r\n                        value[i] = this.removeRefFromValueDeep(value[i], ref);\r\n                    }\r\n                }\r\n\r\n            }\r\n            else if (Utils.isObject(value)) {\r\n                for(var key in value) {\r\n                    if (!value.hasOwnProperty(key) || value[key] === null || typeof value[key] !== 'object') {\r\n                        continue;\r\n                    }\r\n                    else if (Utils.isRefEqual(ref, value[key])) {\r\n                        delete value[key];\r\n                    }\r\n                    else {\r\n                        value[i] = this.removeRefFromValueDeep(value[key], ref);\r\n                    }\r\n                }\r\n            }\r\n            return value;\r\n        },\r\n        addEdge(edge) {\r\n            this.edges.push(edge);\r\n            if (!this.isEdgeUsed(edge) && !this.output) {\r\n                this.addRefToValue(edge);\r\n            }\r\n        },\r\n        eraseEdge(edge) {\r\n            for (var k in this.edges) {\r\n                if (this.edges[k] == edge) {\r\n                    this.removeRefFromValue(edge);\r\n                    this.$delete(this.edges, k);\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        isEdgeUsed(edge) {\r\n            var ref = this.getEdgeRef(edge);\r\n            if (Utils.isRefEqual(ref, this.value)) {\r\n                return true;\r\n            }\r\n            return this.hasRefInValue(ref, this.value);\r\n        },\r\n        hasRefInValue(ref, value) {\r\n            if (!value || typeof value !== 'object') {\r\n                return false;\r\n            }\r\n            else if (Utils.isRefEqual(ref, value)) {\r\n                return true;\r\n            }\r\n            for(let key in value) {\r\n                if (this.hasRefInValue(ref, value[key])) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        getEdgeCount() {\r\n            return this.edges.length;\r\n        },\r\n        formatProcess(pg, maxLength) {\r\n            if (pg instanceof ProcessGraph && pg.getNodeCount() === 1) {\r\n                return this.formatValue(pg.getResultNode().process_id, maxLength);\r\n            }\r\n            var nodes = Object.values(pg.process_graph);\r\n            if (nodes.length === 1) {\r\n                return this.formatValue(nodes[0].process_id, maxLength);\r\n            }\r\n            else {\r\n                return 'Process';\r\n            }\r\n        },\r\n        formatValue(value, maxLength, html = true) {\r\n            if (typeof value === 'object') {\r\n                if (value === null) {\r\n                    return 'n/a';\r\n                }\r\n                else if (Array.isArray(value)) {\r\n                    return this.formatArray(value, maxLength, html);\r\n                }\r\n                else {\r\n                    return this.formatObject(value, maxLength, html);\r\n                }\r\n            }\r\n            else if (typeof value === 'string') {\r\n                if (value.length > maxLength) {\r\n                    var text = Utils.htmlentities(value.substr(0, maxLength));\r\n                    return html ? text + '<span title=\"' + Utils.htmlentities(value) + '\"></span>' : text;\r\n                }\r\n                else {\r\n                    return Utils.htmlentities(value);\r\n                }\r\n            }\r\n            else if (typeof value === 'boolean') {\r\n                return value ? '' : '';\r\n            }\r\n            else if (typeof value === 'number') {\r\n                return value.toString();\r\n            }\r\n            else {\r\n                return Utils.htmlentities(JSON.stringify(value));\r\n            }\r\n        },\r\n        formatArray(values, maxLength, html = true) {\r\n            let parts = [];\r\n            for(let i in values) {\r\n                let value = values[i];\r\n                let formatted = this.formatValue(value, 10, html);\r\n                let unformatted = Utils.htmlentities_decode(this.formatValue(value, 10, false));\r\n\r\n                if (unformatted.length > maxLength) {\r\n                    if (parts.length === 0) {\r\n                        return this.formatArraySimple(values, 'List(' + values.length + ')');\r\n                    }\r\n                    else {\r\n                        parts.push(this.formatArraySimple(values, ''));\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                parts.push(formatted);\r\n                maxLength -= unformatted.length + 2;\r\n            }\r\n            \r\n            return parts.join(\", \");\r\n        },\r\n        formatArraySimple(values, text, html = true) {\r\n            if (html && values.length < 10) {\r\n                let title = values.map(v => this.formatValue(v, 25, false)).join(', ');\r\n                return '<span title=\"' + title + '\">' + text + '</span>';\r\n            }\r\n            else {\r\n                return text;\r\n            }\r\n        },\r\n        formatObject(value, maxLength, html = true) {\r\n            if (Object.keys(value).length === 0) {\r\n                return 'None';\r\n            }\r\n            else if (value instanceof ProcessGraph || Utils.isObject(value.process_graph)) {\r\n                return this.formatProcess(value, maxLength);\r\n            }\r\n            else if (Utils.isRef(value)) {\r\n                return this.formatValue(Utils.formatRef(value), maxLength);\r\n            }\r\n            else if (typeof value.west !== 'undefined' && typeof value.east !== 'undefined' && typeof value.south !== 'undefined' && typeof value.north !== 'undefined') {\r\n                return maxLength >= 12 ? 'Bounding Box' : 'BBox';\r\n            }\r\n            else if (Utils.detectGeoJson(value)) {\r\n                return this.formatValue(value.type, maxLength);\r\n            }\r\n\r\n            // Fallback to default\r\n            return html ? '<span title=\"' + Utils.htmlentities(JSON.stringify(value)) + '\">Object</span>' : 'Object';\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n    .block .connector {\r\n        font-size: 0.9em;\r\n        margin: 0.2em 0;\r\n        white-space: nowrap;\r\n        \r\n        &.noValue {\r\n            color: red;\r\n        }\r\n        &.editable .label,\r\n        &.editable .value {\r\n            cursor: pointer;\r\n        }\r\n        span[title] {\r\n            cursor: help;\r\n        }\r\n        .input {\r\n            max-width: 100%;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n        }\r\n        .output {\r\n            text-align: right;\r\n        }\r\n        .unspecified {\r\n            color: red;\r\n            margin-right: 0.3em;\r\n        }\r\n        .circle {\r\n            width: 0.8em;\r\n            height: 0.8em;\r\n            margin: 0 0.2em;\r\n            border: 1px solid #888;\r\n            background-color: transparent;\r\n            display: inline-block;\r\n\r\n            &.io_active {\r\n                background-color: #FFC800;\r\n            }\r\n            &.io_selected {\r\n                background-color: #00C800 !important;\r\n            }\r\n            &.io_issues {\r\n                background-color: #FF0000;\r\n            }\r\n        }\r\n    }\r\n\r\n    &.editable .circle {\r\n        cursor: pointer;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BlockParameter.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./BlockParameter.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BlockParameter.vue?vue&type=template&id=70b6715c&\"\nimport script from \"./BlockParameter.vue?vue&type=script&lang=js&\"\nexport * from \"./BlockParameter.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BlockParameter.vue?vue&type=style&index=0&id=70b6715c&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\r\n\tdefaultScale: 1.3,\r\n\tblockWidth: {\r\n\t\tcompactParams: 110,\r\n\t\tcompact: 60,\r\n\t\tnormalParams: 220,\r\n\t\tnormal: 110\r\n\t}\r\n};","<template>\r\n    <div :id=\"'block' + this.id\" ref=\"div\" :class=\"containerClasses\" @mousedown.prevent.stop.left=\"onMouseDown\" :style=\"styles\">\r\n        <div class=\"blockTitle\" @mousedown.prevent.stop.left=\"emitDrag\">\r\n            <span class=\"titleText\" :title=\"plainTitle\">\r\n                <span v-show=\"invalid\" class=\"invalid\" title=\"Process or Collection not supported!\">\r\n                    <i class=\"fas fa-exclamation-triangle\"></i>\r\n                </span>\r\n                {{ name }}\r\n                <span v-if=\"showId\" class=\"blockId\">{{ id }}</span>\r\n            </span>\r\n            <div class=\"blockicon\" @mousedown.prevent.stop.left=\"focus()\">\r\n                <span v-show=\"allowsDescription && !showDescriptionField\" class=\"addDescription\" title=\"Add description\" @click.stop.prevent=\"addDescription()\">\r\n                    <i class=\"fas fa-comment-medical\"></i>\r\n                </span>\r\n                <span v-show=\"allowsDuplicate\" class=\"duplicate\" title=\"Duplicate\" @click.stop.prevent=\"duplicate\">\r\n                    <i class=\"fas fa-clone\"></i>\r\n                </span>\r\n                <span v-show=\"allowsDelete\" class=\"delete\" title=\"Remove (DEL)\" @click.stop.prevent=\"remove()\">\r\n                    <i class=\"fas fa-trash\"></i>\r\n                </span>\r\n                <span v-show=\"allowsInfo\" class=\"info\" title=\"Details\" @click.stop.prevent=\"showInfo()\">\r\n                    <i class=\"fas fa-info\"></i>\r\n                </span>\r\n                <span v-show=\"allowsParameterChange\" class=\"settings\" :title=\"isParameter ? 'Edit parameter' : 'Change parameter values'\" @click.stop.prevent=\"edit\">\r\n                    <i class=\"fas fa-edit\"></i>\r\n                </span>\r\n            </div>\r\n        </div>\r\n        <div class=\"inout\">\r\n            <div class=\"inputs\">\r\n                <BlockParameter v-for=\"(param, i) in parameters\" :key=\"i\" ref=\"parameters\" :state=\"state\" :value=\"args[param.name]\" @input=\"value => updateArgument(param.name, value)\" @edgesChanged=\"edgesChanged(param, $event)\" :name=\"param.name\" :description=\"param.description\" :optional=\"param.optional\" :deprecated=\"param.deprecated\" :experimental=\"param.experimental\" :default=\"param.default\" :schema=\"param.schema\" />\r\n            </div>\r\n            <div class=\"outputs\">\r\n                <BlockParameter ref=\"output\" :state=\"state\" :label=\"outputLabel\" v-bind=\"output\" @input=\"updateResult\" />\r\n            </div>\r\n        </div>\r\n        <textarea ref=\"descriptionField\" v-if=\"showDescriptionField\" :value=\"description\" :readonly=\"!state.editable\" class=\"editDescription\" placeholder=\"Type description here...\" @input=\"updateDescription\" @blur=\"updateDescription\" @mousedown.stop=\"\"></textarea>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport BlockParameter from './BlockParameter.vue';\r\nimport Utils from '../../utils.js';\r\nimport { ProcessParameter, ProcessUtils } from '@openeo/js-commons';\r\nimport { Utils as PgUtils } from '@openeo/js-processgraphs';\r\nimport Config from './config.js';\r\n\r\n/*\r\nEvents:\r\n\r\nEmits locally:\r\n- moved(x, y) - The block has been moved\r\n- input(value) - The value has been updated\r\n- move() - A block is now being moved\r\n- mounted(node) - The block is now part of the DOM.\r\n- unmounted(node) - The block not not part of the DOM anylonger.\r\n*/\r\n\r\nconst defaultFontSize = 10;\r\n\r\nexport default {\r\n    name: 'Block',\r\n    components: {\r\n        BlockParameter\r\n    },\r\n    props: {\r\n        id: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        type: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        selected: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        position: {\r\n            type: Array,\r\n            required: true\r\n        },\r\n        process_id: {\r\n            type: String\r\n        },\r\n        namespace: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        description: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        args: {\r\n            type: Object,\r\n            default: () => ({})\r\n        },\r\n        result: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        origin: {\r\n            type: String,\r\n            default: null\r\n        },\r\n        spec: {\r\n            type: Object,\r\n            default: () => null\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            showDescriptionField: false,\r\n            drag: null // Is the user dragging ?\r\n        };\r\n    },\r\n    watch: {\r\n        'state.compactMode'() {\r\n            this.$emit('moved', this.position);\r\n        },\r\n        description: {\r\n            immediate: true,\r\n            handler() {\r\n                this.showDescriptionField = (this.description !== null);\r\n            }\r\n        }\r\n    },\r\n    computed: {\r\n        // Visualizations\r\n        width() {\r\n            let size = Config.blockWidth;\r\n            if (this.parameters.length > 0) {\r\n                return this.state.compactMode ? size.compactParams : size.normalParams;\r\n            }\r\n            else {\r\n                return this.state.compactMode ? size.compact : size.normal;\r\n            }\r\n        },\r\n        styles() {\r\n            return {\r\n                marginLeft: Math.round(this.state.center[0] + this.position[0] * this.state.scale) + 'px',\r\n                marginTop: Math.round(this.state.center[1] + this.position[1] * this.state.scale) + 'px',\r\n                fontSize: Math.round(this.state.scale * defaultFontSize) + 'px',\r\n                width: Math.round(this.state.scale * this.width) + 'px',\r\n            };\r\n        },\r\n        plainTitle() {\r\n            let parts = [];\r\n            parts.push(this.name);\r\n            if (this.namespace) {\r\n                parts.push(`@${this.namespace}`);\r\n            }\r\n            if (this.showId) {\r\n                parts.push(` ${this.id}`);\r\n            }\r\n            return parts.join('');\r\n        },\r\n        name() {\r\n            switch(this.type) {\r\n                case 'process':\r\n                    if (this.collectionId) {\r\n                        return this.collectionId;\r\n                    }\r\n                    else {\r\n                        return this.processId;\r\n                    }\r\n                case 'parameter':\r\n                    return this.spec.name;\r\n                default:\r\n                    return this.id.substr(1);\r\n            }\r\n        },\r\n        outputLabel() {\r\n            if (this.result) {\r\n                return \"Result\";\r\n            }\r\n            else if (this.isParameter) {\r\n                return \"Process Parameter\";\r\n            }\r\n            else {\r\n                return \"\";\r\n            }\r\n        },\r\n        containerClasses() {\r\n            var classes = ['block'];\r\n            if (this.collectionId) {\r\n                classes.push('block_collection');\r\n            }\r\n            else if (this.isParameter) {\r\n                classes.push('block_argument');\r\n            }\r\n            if (this.result) {\r\n                classes.push('block_result');\r\n            }\r\n            if (this.selected) {\r\n                classes.push('block_selected');\r\n            }\r\n            if (this.invalid) {\r\n                classes.push('block_invalid');\r\n            }\r\n\r\n            return classes;\r\n        },\r\n        invalid() {\r\n            if (this.type !== 'process' || !this.$parent.hasProcesses) {\r\n                // We can only check processes for validity\r\n                // Also, don't check for validity if no processes to validate against are given\r\n                return false;\r\n            }\r\n            else if (this.namespace && Utils.isUrl(this.namespace)) {\r\n                // If the namespace is a URL, then don't complain about a missing process\r\n                return false;\r\n            }\r\n            else if (!this.processId) {\r\n                return true;\r\n            }\r\n\r\n            // Check that the process exists\r\n            if (!this.spec) {\r\n                return true;\r\n            }\r\n\r\n            // Check that the collection exists\r\n            if (this.processId === 'load_collection' && !Utils.isRef(this.args.id)) {\r\n                for(let collection of this.$parent.collections) {\r\n                    if (this.args.id === collection.id) {\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        },\r\n        processId() {\r\n            if (this.type === 'process') {\r\n                if (this.process_id) {\r\n                    return this.process_id;\r\n                }\r\n                else if (Utils.isObject(this.spec) && this.spec.id) {\r\n                    return this.spec.id;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        collectionId() {\r\n            if (this.type === 'process' && this.processId === 'load_collection' && !Utils.isRef(this.args.id)) {\r\n                return this.args.id;\r\n            }\r\n            return null;\r\n        },\r\n        isParameter() {\r\n            return this.type === 'parameter';\r\n        },\r\n        allowsParameterChange() {\r\n            if (this.isParameter) {\r\n                return this.state.editable && this.origin !== 'schema' && !!this.$parent.supports('editParameter');\r\n            }\r\n            else {\r\n                return this.parameters.filter(p => p.isEditable()).length > 0;\r\n            }\r\n        },\r\n        allowsDuplicate() {\r\n            return (this.state.editable && this.type === 'process' && this.origin !== 'schema');\r\n        },\r\n        allowsDelete() {\r\n            return (this.state.editable && (!this.spec || (Utils.isObject(this.spec) && this.origin !== 'schema')));\r\n        },\r\n        allowsInfo() {\r\n            if (this.collectionId) {\r\n                return this.$parent.supports('showCollection');\r\n            }\r\n            else if (this.isParameter) {\r\n                return Utils.isObject(this.spec) && this.$parent.supports('showParameter');\r\n            }\r\n            else {\r\n                return this.$parent.supports('showProcess');\r\n            }\r\n        },\r\n        allowsDescription() {\r\n            // ToDo: Remove type restriction and store description for parameters.\r\n            return (this.state.editable && this.type === 'process');\r\n        },\r\n        showId() {\r\n            return (this.type !== 'parameter');\r\n        },\r\n        // Parameters and related\r\n        hasParametersDefined() {\r\n            return Boolean(Utils.isObject(this.spec) && Array.isArray(this.spec.parameters) && this.spec.parameters.length > 0);\r\n        },\r\n        parameters() {\r\n            let names = [];\r\n            let parameters = [];\r\n            if (this.hasParametersDefined) {\r\n                parameters = this.spec.parameters.map(p => new ProcessParameter(p));\r\n                names = parameters.map(p => p.name);\r\n            }\r\n            if (Utils.size(this.args) > 0) {\r\n                for(var key in this.args) {\r\n                    if (!names.includes(key)) {\r\n                        parameters.push(new ProcessParameter({\r\n                            name: key,\r\n                            description: ''\r\n                        }));\r\n                    }\r\n                }\r\n            }\r\n            return parameters;\r\n        },\r\n        fields() {\r\n            var fields = {};\r\n            for(var p of this.parameters) {\r\n                fields[p.name] = p;\r\n            }\r\n            fields.output = this.output;\r\n            return fields;\r\n        },\r\n        output() {\r\n            var spec = {};\r\n            if (Utils.isObject(this.spec)) {\r\n                if (this.isParameter) {\r\n                    spec = this.spec;\r\n                }\r\n                else if (Utils.isObject(this.spec.returns)) {\r\n                    spec = this.spec.returns;\r\n                }\r\n            }\r\n            var output = {\r\n                name: \"output\",\r\n                schema: spec.schema || {},\r\n                description: spec.description || '',\r\n                optional: true,\r\n                output: true,\r\n                value: {}\r\n            };\r\n            if (this.isParameter) {\r\n                output.value.from_parameter = this.id.substr(1);\r\n            }\r\n            else {\r\n                output.value.from_node = this.id.substr(1);\r\n            }\r\n            return output;\r\n        }\r\n    },\r\n    mounted() {\r\n        // ToDo: Move mousemove listener for dragging to Blocks?\r\n        this.draggingFn = this.dragging.bind(this);\r\n        document.addEventListener('mousemove', this.draggingFn);\r\n        // ToDO: Replace with mouseleave?\r\n        this.stopDragFn = this.stopDrag.bind(this);\r\n        document.addEventListener('mouseup', this.stopDragFn);\r\n\r\n        this.$emit('mounted', this);\r\n    },\r\n    beforeDestroy() {\r\n        document.removeEventListener('mousemove', this.draggingFn);\r\n        document.removeEventListener('mouseup', this.stopDragFn);\r\n\r\n        this.$emit('unmounted', this);\r\n    },\r\n    methods: {\r\n        edit() {\r\n            if (this.isParameter) {\r\n                this.editParameter();\r\n            }\r\n            else {\r\n                this.showArguments();\r\n            }\r\n        },\r\n        duplicate() {\r\n            this.$parent.$emit('duplicate', {\r\n                position: this.position,\r\n                process_id: this.process_id,\r\n                namespace: this.namespace,\r\n                arguments: this.args,\r\n                description: this.description\r\n            });\r\n        },\r\n        hasParameter(name) {\r\n            return this.hasParametersDefined && !!this.spec.parameters.find(p => p.name === name);\r\n        },\r\n        updateDescription(event) {\r\n\t\t\tlet elem = event.composedPath()[0]; // event.target doesn't work in web components\r\n            let value;\r\n            if (elem && typeof elem.value === 'string' && (elem.value.length > 0 || event.type === 'input')) {\r\n                value = elem.value;\r\n            }\r\n            else {\r\n                value = null;\r\n            }\r\n            this.showDescriptionField = (value !== null);\r\n            if (this.description !== value) {\r\n                this.$emit('update', 'description', value);\r\n            }\r\n        },\r\n        updatePosition(pos, saveHistory = true) {\r\n            pos = Utils.ensurePoint(pos);\r\n            if (this.position[0] !== pos[0] || this.position[1] !== pos[1]) {\r\n                this.$emit('update', 'position', pos, saveHistory);\r\n            }\r\n        },\r\n        updateArguments(value) {\r\n            let removeParameters = Object.keys(this.args)\r\n                    .filter(key => typeof value[key] === 'undefined' && (!this.hasParametersDefined || this.hasParameter(key)));\r\n            // Remove default values\r\n            for(let p of this.parameters) {\r\n                if (typeof value[p.name] !== 'undefined' && p.optional && typeof p.default !== 'undefined' && Utils.equals(p.default, value[p.name]))  {\r\n                    delete value[p.name];\r\n                }\r\n            }\r\n            this.$emit('update', 'arguments', value, removeParameters);\r\n        },\r\n        updateArgument(key, value) {\r\n            let args = Utils.deepClone(this.args);\r\n            args[key] = value;\r\n            this.updateArguments(args);\r\n        },\r\n        updateResult(value) {\r\n            if (this.hasOutputEdges()) {\r\n                this.state.root.$emit(\"error\", \"A result node can't have outgoing edges.\");\r\n                return;\r\n            }\r\n            if (value !== this.result) {\r\n                this.$emit('update', 'result', value);\r\n            }\r\n        },\r\n        focus() {\r\n            this.$parent.focus();\r\n        },\r\n        onMouseDown(event) {\r\n            this.select(!this.selected, !event.shiftKey);\r\n        },\r\n        select(selected = true, unselectOthers = true) {\r\n            this.$emit('update', 'selected', selected, unselectOthers);\r\n            this.focus();\r\n        },\r\n        getDimensions() {\r\n            let dim = this.$parent.domBoundingBox(this.$refs.div);\r\n            var blocksDim = this.$parent.getDimensions();\r\n            dim.x = dim.offsetLeft - blocksDim.offsetLeft;\r\n            dim.y = dim.offsetTop - blocksDim.offsetTop;\r\n            return dim;\r\n        },\r\n        edgesChanged(parameter, edges) {\r\n            parameter.refs = edges.map(edge => edge.parameter1.value);\r\n        },\r\n        editParameter() {\r\n            this.$parent.$emit('editParameter', this.spec, \"Edit Parameter: \" + this.plainTitle, data => this.$emit('update', 'spec', data));\r\n        },\r\n        showArguments(parameterName = null) {\r\n            this.$parent.$emit('editArguments', this.parameters.filter(p => p.isEditable()), this.args, this.plainTitle, this.state.editable, parameterName, data => this.updateArguments(data), this);\r\n        },\r\n        showInfo() {\r\n            if(this.collectionId) {\r\n                this.$parent.$emit('showCollection', this.collectionId);\r\n            }\r\n            else if (this.isParameter) {\r\n                this.$parent.$emit('showParameter', this.spec, this.origin);\r\n            }\r\n            else {\r\n                this.$parent.$emit('showProcess', this.processId, this.namespace);\r\n            }\r\n        },\r\n        async addDescription() {\r\n            this.select();\r\n            this.showDescriptionField = true;\r\n            await this.$nextTick();\r\n            this.$refs.descriptionField.focus();\r\n        },\r\n        async emitDrag(event) {\r\n            this.select(true, !event.shiftKey);\r\n            this.focus();\r\n            await this.$nextTick();\r\n            this.$emit('move', event);\r\n        },\r\n        getDragPos(pos, mouse) {\r\n            return [mouse[0]/this.state.scale-pos[0], mouse[1]/this.state.scale-pos[1]];\r\n        },\r\n        startDrag(event) {\r\n            if (!this.selected) {\r\n                return;\r\n            }\r\n\r\n            let mousePos = this.$parent.getMousePos(event);\r\n            this.drag = {\r\n                origin: this.position,\r\n                mouse: this.getDragPos(this.position, mousePos)\r\n            };\r\n        },\r\n        stopDrag() {\r\n            if (!this.drag) {\r\n                return;\r\n            }\r\n\r\n            var delta = 5 / this.state.scale; // Only store History if block was moved enough\r\n            if (Math.abs(this.drag.origin[0] - this.position[0]) > delta || Math.abs(this.drag.origin[1] - this.position[1]) > delta) {\r\n                this.updatePosition(this.position);\r\n            }\r\n            this.drag = null;\r\n        },\r\n        dragging(event) {\r\n            if (!this.drag) {\r\n                return;\r\n            }\r\n            \r\n            let mousePos = this.$parent.getMousePos(event);\r\n            let drapPos = this.getDragPos(this.drag.mouse, mousePos);\r\n            // Don't store for each run a history step...\r\n            this.updatePosition(drapPos, false);\r\n        },\r\n\r\n        hasOutputEdges() {\r\n            return this.$refs.output && this.$refs.output.getEdgeCount() > 0;\r\n        },\r\n\r\n        async remove() {\r\n            await this.$parent.removeBlock(this);\r\n        },\r\n\r\n        /**\r\n         * Getting a field by name\r\n         */\r\n        getBlockParameter(name) {\r\n            if (name === 'output' && this.$refs.output) {\r\n                return this.$refs.output;\r\n            }\r\n            else if (Array.isArray(this.$refs.parameters)) {\r\n                var params = this.$refs.parameters.filter(param => param.name === name);\r\n                if (params.length > 0) {\r\n                    return params[0];\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n\r\n        isParameterScoped(parameterName, referenceName) {\r\n            let parameterBlock = this.getBlockParameter(parameterName);\r\n            let cbParams = ProcessUtils.getCallbackParameters(parameterBlock).map(cbParam => cbParam.name);\r\n            return cbParams.includes(referenceName);\r\n        },\r\n\r\n        hiddenParameterRef(parameterBlock) {\r\n            if (this.type !== 'process') {\r\n                return null;\r\n            }\r\n            let globalParam = parameterBlock.id.substr(1);\r\n            for (let argName in this.args) {\r\n                let value = this.args[argName];\r\n                if (Utils.isObject(value) && Utils.isObject(value.process_graph)) {\r\n                    let refs = PgUtils.getRefs(value, true, true);\r\n                    if (refs.find(r => r.from_parameter === globalParam && !this.isParameterScoped(argName, r.from_parameter))) {\r\n                        return argName;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n    .block {\r\n        position:absolute;\r\n        border:2px solid #ccc;\r\n        margin-left:0px;\r\n        margin-top:0px;\r\n        background-color:#fafafa;\r\n        opacity:0.8;\r\n        font-size:14px;\r\n        user-select:none;\r\n        -moz-user-select:none;\r\n        -khtml-user-select:none;\r\n        -webkit-user-select:none;\r\n        -o-user-select:none;\r\n        color: #000;\r\n\r\n        .description {\r\n            display:none;\r\n            width:200px;\r\n            padding:3px;\r\n            border:1px solid #083776;\r\n            border-radius:5px;\r\n            color:#001531;\r\n            background-color:#91bcf6;\r\n            margin-top:15px;\r\n            position:absolute;\r\n            font-weight:normal;\r\n        }\r\n\r\n        .blockTitle {\r\n            display: flex;\r\n            padding: 0.3em 0.1em;\r\n            font-weight:bold;\r\n            background-color:#ddd;\r\n            margin-bottom: 0.1em;\r\n            cursor: move;\r\n            font-size: 0.9em;\r\n            \r\n            .blockId {\r\n                opacity: 0.4;\r\n                margin-left: 0.25em;\r\n                font-weight: normal;\r\n            }\r\n            \r\n            .namespace {\r\n                font-weight: normal;\r\n            }\r\n\r\n            .titleText {\r\n                flex-grow: 1;\r\n                white-space: nowrap;\r\n                overflow: hidden;\r\n                text-overflow: ellipsis;\r\n            }\r\n            \r\n            .blockicon {\r\n                white-space: nowrap;\r\n                text-align: center;\r\n\r\n                i.fas {\r\n                    min-width: 1.4em;\r\n                    cursor: pointer;\r\n                    opacity: 0.5;\r\n                    margin-left: 0.1em;\r\n\r\n                    &:hover {\r\n                        opacity:1.0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .invalid {\r\n            color: red;\r\n            cursor: help;\r\n        }\r\n\r\n        .inout {\r\n            display: flex;\r\n        }\r\n\r\n        .inputs {\r\n            flex-grow: 1;\r\n            max-width: 100%;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n        }\r\n\r\n        .editDescription {\r\n            padding: 0.3em 0.2em;\r\n            box-sizing: border-box;\r\n            font-size: 0.9em;\r\n            line-height: 1em;\r\n            overflow: auto;\r\n            border: 0;\r\n            border-top: 1px dotted #ccc;\r\n            background-color: transparent;\r\n            width: 100%;\r\n            max-width: 100%;\r\n            height: 3.7em;\r\n            min-height: 2.5em;\r\n            resize: none;\r\n\r\n            &:focus {\r\n                outline: 0;\r\n            }\r\n        }\r\n    }\r\n\r\n    .block_collection {\r\n        border:2px solid #6B8DAF;\r\n\r\n        .blockTitle {\r\n            background-color:#A3B7CC;\r\n        }\r\n        .field_id { /* Hide collection ID as it's shown in the title */\r\n            display: none;\r\n        }\r\n    }\r\n\r\n    .block_result {\r\n        border:2px solid #888;\r\n\r\n        .field_output .circle {\r\n            background-color: #888;\r\n            cursor: auto;\r\n        }\r\n    }\r\n\r\n    .block_argument {\r\n        border:2px solid #B28C6B;\r\n\r\n        .blockTitle {\r\n            background-color:#CCB7A3;\r\n        }\r\n    }\r\n\r\n    .block_selected {\r\n        border:2px solid #0a0 !important; /* important is used to override the styles for block_collection and block_argument above */\r\n\r\n        .blockTitle {\r\n            background-color:#0c0 !important;\r\n        }\r\n    }\r\n\r\n    .block_invalid {\r\n        border:2px solid #ff0000 !important; /* important is used to override the styles for block_selected above */\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Block.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Block.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Block.vue?vue&type=template&id=ec7ff252&\"\nimport script from \"./Block.vue?vue&type=script&lang=js&\"\nexport * from \"./Block.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Block.vue?vue&type=style&index=0&id=ec7ff252&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('g',_vm._l((_vm.lines),function(line,i){return _c('line',_vm._b({key:i},'line',line,false))}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default class Segment {\r\n\r\n    constructor(x, y, dx, dy) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.dx = dx;\r\n        this.dy = dy;\r\n    }\r\n\r\n    /**\r\n     * Distance\r\n     */\r\n    distance(point1, point2) {\r\n        return Math.sqrt(Math.pow(point2.x-point1.x,2) + Math.pow(point2.y-point1.y,2));\r\n    }\r\n\r\n    /**\r\n     * Distance with a point\r\n     */\r\n    distanceP(point) {\r\n        var normal = this.normal();\r\n        normal.x = point.x;\r\n        normal.y = point.y;\r\n        var intersection = this.intersection(normal);\r\n\r\n        return [intersection[0], this.distance(normal.alpha(intersection[1]), point)];\r\n    }\r\n\r\n    /**\r\n     * Normal\r\n     */\r\n    normal() {\r\n        return new Segment(this.x, this.y, this.dy, -this.dx);\r\n    }\r\n\r\n    /**\r\n     * Gets the intersection alpha with another \r\n     */\r\n    intersection(other) {\r\n        var a = this.dx;\r\n        var b = -other.dx;\r\n        var c = this.dy;\r\n        var d = -other.dy;\r\n        var b0 = other.x-this.x;\r\n        var b1 = other.y-this.y;\r\n        var det = a*d - b*c;\r\n\r\n        if (det == 0) {\r\n            return null;\r\n        }\r\n\r\n        var r1 = (d*b0 - b*b1)/det;\r\n        var r2 = (-c*b0 + a*b1)/det;\r\n\r\n        return [r1, r2];\r\n    }\r\n\r\n    /**\r\n     * Gets the alpha point\r\n     */\r\n    alpha(a) {\r\n        var point = {};\r\n        point.x = this.x+this.dx*a;\r\n        point.y = this.y+this.dy*a;\r\n\r\n        return point;\r\n    }\r\n\r\n}","<template>\r\n    <g>\r\n        <line v-for=\"(line, i) in lines\" :key=\"i\" v-bind=\"line\" />\r\n    </g>\r\n</template>\r\n\r\n<script>\r\nimport Segment from './segment.js';\r\n\r\nexport default {\r\n    name: 'Edge',\r\n    props: {\r\n        id: {},\r\n        parameter1: {\r\n            type: Object,\r\n            required: true\r\n        },\r\n        parameter2: {\r\n            type: Object,\r\n            required: true\r\n        },\r\n        selected: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        inactive: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        issues: {\r\n            type: Array,\r\n            default: () => ([])\r\n        },\r\n        lineWidth: {\r\n            type: Number,\r\n            default: 3\r\n        },\r\n        lineColor: {\r\n            type: Array,\r\n            default: () => ([255, 200, 0, 1])\r\n        },\r\n        state: {\r\n            type: Object,\r\n            required: true\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            position1: null,\r\n            position2: null\r\n        }\r\n    },\r\n    computed: {\r\n        segment() {\r\n            return new Segment(\r\n                this.position1[0],\r\n                this.position1[1], \r\n                this.position2[0] - this.position1[0],\r\n                this.position2[1] - this.position1[1]\r\n            );\r\n        },\r\n        scaledLineWidth() {\r\n            return this.lineWidth * this.state.scale;\r\n        },\r\n        lines() {\r\n            // Drawing the arrow\r\n            var xM = ((this.position1[0]+this.position2[0])/2.0);\r\n            var yM = ((this.position1[1]+this.position2[1])/2.0);\r\n\r\n            var alpha = (35*Math.PI/180.0);\r\n            var cos = Math.cos(alpha);\r\n            var sin = Math.sin(alpha);\r\n            var cosB = Math.cos(-alpha);\r\n            var sinB = Math.sin(-alpha);\r\n\r\n            var norm = Math.sqrt(Math.pow(this.position1[0]-this.position2[0],2)+Math.pow(this.position1[1]-this.position2[1],2));\r\n            var arrowLength = this.state.scale*10/(norm/1.5);\r\n            var xA = (this.position1[0]-xM)*arrowLength;\r\n            var yA = (this.position1[1]-yM)*arrowLength;\r\n\r\n            var lineStyle = this.getLineStyle(this.scaledLineWidth, this.selected, this.inactive);\r\n            var arrowStyle = this.getLineStyle(this.scaledLineWidth / 1.5, this.selected);\r\n\r\n            var mainLine = this.getLine(this.position1[0], this.position1[1], this.position2[0], this.position2[1], lineStyle);\r\n            if (this.inactive || norm/this.state.scale < 25) {\r\n                // Hide arrow\r\n                return [mainLine];\r\n            }\r\n            else {\r\n                return [\r\n                    mainLine,\r\n                    this.getLine(xM, yM, xM+(xA*cos-yA*sin), yM+(yA*cos+xA*sin), arrowStyle),\r\n                    this.getLine(xM, yM, xM+(xA*cosB-yA*sinB), yM+(yA*cosB+xA*sinB), arrowStyle)\r\n                ];\r\n            }\r\n        }\r\n    },\r\n    watch: {\r\n        'state.center'() {\r\n            this.updatePositions();\r\n        },\r\n        'state.scale'() {\r\n            this.updatePositions();\r\n        },\r\n        'state.moving'() {\r\n            this.updatePositions();\r\n        }\r\n    },\r\n    created() {\r\n        this.updatePositions();\r\n    },\r\n    mounted() {\r\n        this.$emit('mounted', this);\r\n    },\r\n    beforeDestroy() {\r\n        this.$emit('unmounted', this);\r\n    },\r\n    methods: {\r\n        updatePositions() {\r\n            let pos1 = this.parameter1.getCirclePosition();\r\n            let pos2 = this.parameter2.getCirclePosition();\r\n            if (!pos1 || !pos2) {\r\n                return;\r\n            }\r\n            if (!this.position1 || !this.position2 || pos1[0] !== this.position1[0] || pos1[1] !== this.position1[1] || pos2[0] !== this.position2[0] || pos2[1] !== this.position2[1]) {\r\n                this.position1 = Object.freeze(pos1);\r\n                this.position2 = Object.freeze(pos2);\r\n                this.$emit('position', this.position1, this.position2);\r\n            }\r\n        },\r\n        getLineStyle(lineWidth, selected = false, dashed = false) {\r\n            let dashLength = 2 * this.state.scale;\r\n            let color = this.lineColor;\r\n            if (selected) {\r\n                color = [0, 200, 0, 1];\r\n            }\r\n            else if (this.issues.length > 0) {\r\n                color = [255, 0, 0, 1];\r\n            }\r\n            return {\r\n                'stroke': `rgba(${color.join(', ')})`,\r\n                'stroke-width': lineWidth,\r\n                'stroke-dasharray': dashed ? dashLength * 3 + ' ' + dashLength * 2 : 'none'\r\n            }\r\n        },\r\n        /**\r\n         * Get line options.\r\n         * \r\n         * @param x1 {number} The x-coordinate for the start of the line.\r\n         * @param y1 {number} The y-coordinate for the start of the line.\r\n         * @param x2 {number} The x-coordinate for the end of the line.\r\n         * @param y2 {number} The y-coordinate for the end of the line.\r\n         * @param [settings] {object} Additional settings for this node.\r\n         * @return {object} Options for SVG Line\r\n         */\r\n        getLine(x1, y1, x2, y2, settings = {}) {\r\n            return Object.assign({x1, y1, x2, y2}, settings);\r\n        },\r\n        /**\r\n         * Does the position collide the line ?\r\n         */\r\n        collide(x, y) {\r\n            if (!this.segment) {\r\n                return false;\r\n            }\r\n\r\n            var dp = this.segment.distanceP({x: x, y: y});\r\n\r\n            if (dp[0] >= 0 && dp[0] <= 1) {\r\n                if (dp[1] < (this.lineWidth*this.state.scale)*2) {\r\n                    return dp[0];\r\n                }\r\n            }\r\n\r\n            return false;\r\n        },\r\n        /**\r\n         * Test if this edge is the same than another\r\n         */\r\n        equals(other) {\r\n            if (this.parameter1 == other.parameter1 && this.parameter2 == other.parameter2) {\r\n                return true;\r\n            }\r\n            else if (this.parameter1 == other.parameter2 && this.parameter2 == other.parameter1) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        }\r\n    }\r\n\r\n}\r\n</script>","import mod from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Edge.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Edge.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Edge.vue?vue&type=template&id=83b3fc4e&\"\nimport script from \"./Edge.vue?vue&type=script&lang=js&\"\nexport * from \"./Edge.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <div ref=\"div\" :id=\"id\" :class=\"classes\" tabindex=\"0\" :style=\"style\"\r\n        @mousemove=\"onMouseMove\"\r\n        @mousedown=\"onMouseDown\"\r\n        @wheel=\"onMouseWheel\"\r\n        @keydown=\"onKeyDown\"\r\n        @focus=\"hasFocus = true\"\r\n        @blur=\"hasFocus = false\">\r\n        <!-- tabindex is to allow focus for delete keystroke etc -->\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" class=\"canvas\">\r\n            <Edge v-for=\"edge in edges\" :key=\"edge.id\" :id=\"edge.id\"\r\n                :parameter1=\"edge.parameter1\" :parameter2=\"edge.parameter2\"\r\n                :selected=\"edge.selected\" :inactive=\"edge.inactive\" :issues=\"edge.issues\" :state=\"state\"\r\n                @mounted=\"node => mount(edge, node)\" @unmounted=\"() => mount(edge)\"\r\n                @position=\"updateEdgePos(edge, arguments)\" />\r\n            <Edge v-for=\"edge in hiddenParameterRefEdges\" :key=\"edge.id\" :id=\"edge.id\"\r\n                :parameter1=\"edge.parameter1\" :parameter2=\"edge.parameter2\"\r\n                @mounted=\"node => mount(edge, node)\" @unmounted=\"() => mount(edge)\"\r\n                :inactive=\"true\" :lineColor=\"[200,200,200,1]\" :lineWidth=\"2\" :state=\"state\" />\r\n            <line v-if=\"linkingLine\" v-bind=\"linkingLine\" />\r\n            <rect v-if=\"selectRect\" v-bind=\"selectRect\" />\r\n        </svg>\r\n        <div class=\"blocks\">\r\n            <Block v-for=\"(block) in blocks\" :key=\"block.id\"\r\n                :id=\"block.id\" :type=\"block.type\" :spec=\"block.spec\" :state=\"state\"\r\n                :selected=\"block.selected\" :position=\"block.position\" :origin=\"block.origin\"\r\n                :process_id=\"block.process_id\" :namespace=\"block.namespace\" :result=\"block.result\" :args=\"block.arguments\" :description=\"block.description\" \r\n                @update=\"(...args) => updateBlock(block, ...args)\"\r\n                @mounted=\"node => mount(block, node)\" @unmounted=\"() => mount(block)\"\r\n                @move=\"startDragBlock\" />\r\n        </div>\r\n        <div v-if=\"state.scale < 0.7 || showZoomInfo\" class=\"zoomInfo\">\r\n            <div v-if=\"state.scale < 0.7\">\r\n                Zoom in for more details.\r\n            </div>\r\n            <div v-if=\"showZoomInfo\">\r\n                Zoom with <kbd>STRG</kbd> or <kbd>Meta</kbd> key and the mouse wheel.\r\n            </div>\r\n        </div>\r\n        <ParameterViewer v-if=\"parameterViewer\" v-bind=\"parameterViewer\" @close=\"parameterViewer = null\" />\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport Block from './model-builder/Block.vue';\r\nimport Edge from './model-builder/Edge.vue';\r\nimport Utils from '../utils.js';\r\nimport { ProcessRegistry } from '@openeo/js-commons';\r\nimport { JsonSchemaValidator, ProcessGraph, Utils as PgUtils } from '@openeo/js-processgraphs';\r\nimport Vue from 'vue';\r\nimport boxIntersectsBox from 'intersects/box-box';\r\nimport boxIntersectsLine from 'intersects/box-line';\r\nimport Config from './model-builder/config.js';\r\n\r\nconst getDefaultState = function(blocks) {\r\n    return Vue.observable({\r\n        root: blocks,\r\n        editable: false,\r\n        compactMode: false,\r\n        moving: null, // Is the user dragging the view?\r\n        selecting: null, // Is the user multi-selecting?\r\n        center: [0,0],\r\n        mouse: [0,0],\r\n        scale: Config.defaultScale,\r\n        linkFrom: null, // Array\r\n        linkTo: null // Array\r\n    });\r\n};\r\nconst MARGIN = 20;\r\n\r\nconst selectionChangeWatcher = function (newVal, oldVal) {\r\n    if (!Array.isArray(newVal) || !Array.isArray(oldVal) || newVal.length !== oldVal.length || !newVal.every((value,i) => value.id === oldVal[i].id)) {\r\n        this.$emit('selectionChanged', this.selectedBlocks, this.selectedEdges);\r\n    }\r\n};\r\n\r\nexport default {\r\n    name: 'ModelBuilder',\r\n    components: {\r\n        Block,\r\n        Edge,\r\n        ParameterViewer: () => import('./model-builder/ParameterViewer.vue')\r\n    },\r\n    props: {\r\n        id: {\r\n            type: String,\r\n            required: true\r\n        },\r\n        editable: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        value: {\r\n            type: Object,\r\n            default: () => ({})\r\n        },\r\n        collections: {\r\n            type: Array,\r\n            default: () => []\r\n        },\r\n        processes: {\r\n            type: [Array, Object],\r\n            default: () => []\r\n        },\r\n\t\tparent: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n\t\tparentSchema: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: null\r\n\t\t},\r\n        historySize: {\r\n            type: Number,\r\n            default: 30\r\n        },\r\n        explicitZoom: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        height: {\r\n            type: String,\r\n            default: null\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            isMounted: false,\r\n            allMounted: false,\r\n\r\n            // Current offset for block that are generated without specific coordinates so that not all block occur on the same position\r\n            newBlockOffset: 0,\r\n\r\n            // History\r\n            history: [],\r\n            historyPointer: null,\r\n\r\n            process: Object.freeze(this.value),\r\n            // Metadata for blocks to show\r\n            blocks: [],\r\n            // Metadata for edges to show\r\n            edges: [],\r\n            hiddenParameterRefEdges: {},\r\n\r\n            processGraph: null,\r\n\r\n            // Next block id\r\n            nextBlockId: 1,\r\n            // Next edge id\r\n            nextEdgeId: 1,\r\n            // Copy&Paste\r\n            clipboard: null,\r\n\r\n            activeTransactions: 0,\r\n            hasFocus: false,\r\n            linkingLine: null,\r\n            parameterViewer: null,\r\n\r\n            showZoomInfo: this.explicitZoom,\r\n            \r\n            // State specific to this blocks instance including all children\r\n            state: getDefaultState(this)\r\n        };\r\n    },\r\n    computed: {\r\n        style() {\r\n            let style = {};\r\n            if (typeof this.height === 'string') {\r\n                style.height = this.height;\r\n            }\r\n            return style;\r\n        },\r\n        classes() {\r\n            let classes = [\r\n                'vue-component',\r\n                'model-builder'\r\n            ];\r\n            if (this.hasFocus) {\r\n                classes.push('focus');\r\n            }\r\n            if (this.editable) {\r\n                classes.push('editable');\r\n            }\r\n\r\n            if (this.state.compactMode) {\r\n                classes.push('compact');\r\n            }\r\n\r\n            if (this.state.scale < 0.5) {\r\n                classes.push('scale_xs');\r\n            }\r\n            else if (this.state.scale < 0.7) {\r\n                classes.push('scale_s');\r\n            }\r\n            else if (this.state.scale < 0.9) {\r\n                classes.push('scale_m');\r\n            }\r\n            else if (this.state.scale < 1.1) {\r\n                classes.push('scale_l');\r\n            }\r\n            else {\r\n                classes.push('scale_xl');\r\n            }\r\n\r\n            return classes;\r\n        },\r\n        selectRect() {\r\n            if (!this.state.selecting) {\r\n                return null;\r\n            }\r\n            return {\r\n                x: Math.min(this.state.selecting.current[0], this.state.selecting.start[0]),\r\n                y: Math.min(this.state.selecting.current[1], this.state.selecting.start[1]),\r\n                width: Math.abs(this.state.selecting.current[0] - this.state.selecting.start[0]),\r\n                height: Math.abs(this.state.selecting.current[1] - this.state.selecting.start[1]),\r\n                'stroke': 'rgba(0,0,0,0.8)',\r\n                'stroke-width': 1,\r\n                'fill': 'rgba(0,0,0,0.05)'\r\n            };\r\n        },\r\n        processRegistry() {\r\n            // If I link between openeo-web-editor and openeo-vue-components, instanceof ProcessRegistry fails.\r\n            // Webpack seems to mangle names and thus I need to check for specific processes alternatively to detect whether this could be a ProcessRegistry.\r\n            if (this.processes instanceof ProcessRegistry || (typeof this.processes.count === 'function' && typeof this.processes.get === 'function')) {\r\n                return this.processes;\r\n            }\r\n            else if (Array.isArray(this.processes)) {\r\n                return new ProcessRegistry(this.processes);\r\n            }\r\n            else {\r\n                throw new Error('Invalid processes specified, must be ProcessRegistry or Array');\r\n            }\r\n        },\r\n        hasProcesses() {\r\n            return this.processRegistry.count() > 0;\r\n        },\r\n        processBlocks() {\r\n            return this.blocks.filter(b => b.type === 'process');\r\n        },\r\n        selectedBlocks() {\r\n            return this.blocks.filter(block => block.selected);\r\n        },\r\n        selectedEdges() {\r\n            return this.edges.filter(edge => edge.selected);\r\n        },\r\n        selectedSideEdge() {\r\n            if (this.selectedEdges.length === 1 && this.selectedEdges[0].selectedParameter) {\r\n                return this.selectedEdges[0];\r\n            }\r\n            return null;\r\n        },\r\n        hasSelection() {\r\n            return this.selectedBlocks.length > 0 || this.selectedEdges.length > 0;\r\n        },\r\n        processParametersFromSchemas() {\r\n            // Get all process parameters from the parent process\r\n            // this.parent.$parent => ModelBuilder instance\r\n\t\t\tlet parentParams = [];\r\n\t\t\tif (this.parent && this.parent.$parent && typeof this.parent.$parent.getPgParameters === 'function') {\r\n\t\t\t\tparentParams = this.parent.$parent.getPgParameters().map(block => block.spec);\r\n\t\t\t}\r\n\r\n            let callbackParams = [];\r\n            // If we have a parameter schema given, go through the parameter schema and get the available process parameters from there.\r\n            if (this.parentSchema) {\r\n\t\t\t    callbackParams = this.parentSchema.getCallbackParameters();\r\n            }\r\n\r\n            // Remove all parameters from the parent that are overridden by the more specific parameters.\r\n            let filteredParentParams = parentParams.filter(p1 => !callbackParams.find(p2 => p1.name === p2.name));\r\n            // Add the filtered parameters from the parent to the more specific parameters\r\n            return callbackParams.concat(filteredParentParams);\r\n        }\r\n    },\r\n    watch: {\r\n        parentSchema() {\r\n            this.importPgParameters(this.processParametersFromSchemas, 'schema');\r\n        },\r\n        async value(value) {\r\n            // Only run if component has been mounted\r\n            if (!this.allMounted) {\r\n                return;\r\n            }\r\n\r\n            // Only import when user changes data (i.e. not a BlocksProcess exported from export())\r\n            if (!(value instanceof BlocksProcess)) {\r\n                this.process = value;\r\n                await this.import(value, { propagate: false, undoOnError: false }); // don't propagate, otherwise results in an infinite loop\r\n            }\r\n        },\r\n        editable: {\r\n            immediate: true,\r\n            handler(editable) {\r\n                this.state.editable = editable;\r\n            }\r\n        },\r\n        selectedEdges: selectionChangeWatcher,\r\n        selectedBlocks: selectionChangeWatcher,\r\n        allMounted() {\r\n            this.updateHiddenParameterRefEdges();\r\n        },\r\n        isMounted() {\r\n            this.checkAllMounted();\r\n        }\r\n    },\r\n\tbeforeCreate() {\r\n\t\tUtils.enableHtmlProps(this);\r\n\t},\r\n    async created() {\r\n        if (!this.supports('error')) {\r\n            // Print error to console if event is not supported by implementing context\r\n            this.$on('error', (msg, title = null) => console.error(msg, title));\r\n        }\r\n        if (!this.supports('editArguments')) {\r\n            this.$on('editArguments', (...args) => this.showParameterViewer(...args));\r\n        }\r\n        this.$on('duplicate', this.duplicate.bind(this));\r\n    },\r\n    async mounted() {\r\n        Utils.loadFontAwesome(this);\r\n\r\n        // Setting up default viewer center\r\n        this.moveCenter(0, 0, true);\r\n\r\n        // ToDo: Replace with mouseleave?\r\n        this.onDocumentMouseUpFn = this.onDocumentMouseUp.bind(this)\r\n        document.addEventListener('mouseup', this.onDocumentMouseUpFn);\r\n\r\n        await this.importPgParameters(this.processParametersFromSchemas, 'schema');\r\n        if (!await this.import(this.value, { propagate: false, undoOnError: false })) {\r\n            this.perfectScale();\r\n        }\r\n        selectionChangeWatcher.bind(this)();\r\n\r\n        this.isMounted = true;\r\n    },\r\n    beforeDestroy() {\r\n        document.removeEventListener('mouseup', this.onDocumentMouseUpFn);\r\n    },\r\n    methods: {\r\n        updateEdgePos(edge, pos) {\r\n            edge.position1 = pos[0];\r\n            edge.position2 = pos[1];\r\n        },\r\n        mount(elem, node = null) {\r\n            elem.$el = node;\r\n            this.checkAllMounted();\r\n        },\r\n        checkAllMounted() {\r\n            if (!this.isMounted) {\r\n                this.allMounted = false;\r\n            }\r\n            else {\r\n                this.allMounted = !this.blocks.find(block => !block.$el) || !this.edges.find(edge => !edge.$el);\r\n            }\r\n        },\r\n        updateBlockArguments(block, args, removedParams) {\r\n            if (removedParams.length > 0) {\r\n                this.parameterRemoved(block, removedParams);\r\n            }\r\n            this.$set(block, 'arguments', args);\r\n            this.commit();\r\n            if(removedParams.length > 0) {\r\n                this.$nextTick(() => this.refreshEdges());\r\n            }\r\n        },\r\n        updateBlockDescription(block, description) {\r\n            this.$set(block, 'description', description);\r\n            this.commit();\r\n        },\r\n        updateBlockPos(block, pos, saveHistory = true) {\r\n            this.$set(block, 'position', pos);\r\n            this.commit(null, saveHistory, false);\r\n        },\r\n        updateBlockResult(block, result) {\r\n            this.$set(block, 'result', result);\r\n            this.commit();\r\n        },\r\n        updateBlockSelected(block, selected, unselectOthers = true) {\r\n            if (unselectOthers) {\r\n                this.unselectAll();\r\n            }\r\n            this.$set(block, 'selected', selected);\r\n            this.commit(null, false, false);\r\n        },\r\n        updateBlockSpec(block, data) {\r\n            let parameterFields = ['name', 'schema', 'description', 'optional', 'deprecated', 'experimental', 'default'];\r\n            let newBlock = Utils.omitFromObject(block.spec, parameterFields);\r\n            Object.assign(newBlock, data);\r\n            // Remove default values (and unset default value if parameter is required)\r\n            if (!newBlock.optional) {\r\n                delete newBlock.optional;\r\n                delete newBlock.default;\r\n            }\r\n            if (!newBlock.deprecated) {\r\n                delete newBlock.deprecated;\r\n            }\r\n            if (!newBlock.experimental) {\r\n                delete newBlock.experimental;\r\n            }\r\n            this.$set(block, 'spec', newBlock);\r\n            this.commit();\r\n        },\r\n        updateBlock(block, key, value, extra) {\r\n            switch(key) {\r\n                case 'arguments':\r\n                    this.updateBlockArguments(block, value, extra);\r\n                    break;\r\n                case 'description':\r\n                    this.updateBlockDescription(block, value);\r\n                    break;\r\n                case 'position':\r\n                    this.updateBlockPos(block, value, extra);\r\n                    break;\r\n                case 'result':\r\n                    this.setResultNode(block, value);\r\n                    break;\r\n                case 'selected':\r\n                    this.updateBlockSelected(block, value, extra);\r\n                    break;\r\n                case 'spec':\r\n                    this.updateBlockSpec(block, value);\r\n                    break;\r\n            }\r\n        },\r\n        updateHiddenParameterRefEdges() {\r\n            // We can only reliably detect parameter refs if we know which parameters a process makes available to the child process\r\n            // So if we don't have process schemas, don't offer this functionality.\r\n            // Also don't execute (yet) if no parameters are given or not all elements are mounted yet.\r\n            if (!this.hasProcesses || !this.allMounted || !this.blocks.find(block => block.type === 'parameter')) {\r\n                this.hiddenParameterRefEdges = {};\r\n                return;\r\n            }\r\n\r\n            let hiddenRefs = {};\r\n            for(let process of this.processBlocks) {\r\n                for (let argName in process.arguments) {\r\n                    let value = process.arguments[argName];\r\n                    if (!Utils.isObject(value) || !Utils.isObject(value.process_graph)) {\r\n                        continue; // Process can only have hidden refs it it contains a process graph\r\n                    }\r\n                    \r\n                    let refs = PgUtils.getRefs(value, true, true).filter(ref => typeof ref.from_parameter !== 'undefined');\r\n                    for(let ref of refs) {\r\n                        try {\r\n                            if(!process.$el) {\r\n                                continue;\r\n                            }\r\n                            if (process.$el.isParameterScoped(argName, ref.from_parameter)) {\r\n                                continue; // Skip if the parameter usage is scoped (i.e. defined as process parameetr for the children)\r\n                            }\r\n                            let parameter = this.getPgParameterById('$' + ref.from_parameter);\r\n                            if (!parameter) {\r\n                                continue; // Skip if parameter can't be found\r\n                            }\r\n                            let parameter1 = parameter.$el.getBlockParameter('output');\r\n                            let parameter2 = process.$el.getBlockParameter(argName);\r\n                            let id = `${parameter.id}->${process.id}:${argName}`;\r\n                            if (parameter1 && parameter2) {\r\n                                if (this.hiddenParameterRefEdges[id]) {\r\n                                    hiddenRefs[id] = this.hiddenParameterRefEdges[id];\r\n                                }\r\n                                else {\r\n                                    hiddenRefs[id] = {\r\n                                        $el: null,\r\n                                        id,\r\n                                        parameter1,\r\n                                        parameter2\r\n                                    };\r\n                                }\r\n                            }\r\n                        } catch(error) {\r\n                             console.warn(error);\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n            this.hiddenParameterRefEdges = hiddenRefs;\r\n        },\r\n        parameterRemoved(block, parameterNames) {\r\n            for(let edge of this.edges.slice(0)) {\r\n                if(edge.parameter2.$parent.id === block.id && parameterNames.includes(edge.parameter2.name)) {\r\n                    this.removeEdge(edge);\r\n                }\r\n            }\r\n        },\r\n        startDragBlock(event) {\r\n            for(let block of this.blocks) {\r\n                if (block.$el) {\r\n                    block.$el.startDrag(event);\r\n                }\r\n            }\r\n        },\r\n        refreshEdges() {\r\n            this.refreshEdgesFor(this.edges);\r\n            this.refreshEdgesFor(Object.values(this.hiddenParameterRefEdges));\r\n        },\r\n        refreshEdgesFor(edges) {\r\n            for(let edge of edges) {\r\n                if (edge.$el) {\r\n                    edge.$el.updatePositions();\r\n                }\r\n            }\r\n        },\r\n        supports(event) {\r\n            return Boolean(this.$listeners && this.$listeners[event]);\r\n        },\r\n        focus() {\r\n            this.$refs.div.focus();\r\n        },\r\n        link(parameter) {\r\n            if (this.state.linkFrom) {\r\n                this.state.linkTo = parameter;\r\n            }\r\n            else {\r\n                this.state.linkFrom = parameter;\r\n            }\r\n        },\r\n        unlink(parameter = null) {\r\n            if (parameter) {\r\n                if (this.state.linkTo == parameter) {\r\n                    this.state.linkTo = null;\r\n                }\r\n                else if (this.state.linkFrom == parameter) {\r\n                    this.state.linkFrom = null;\r\n                    this.linkingLine = null;\r\n                }\r\n            }\r\n            else {\r\n                this.state.linkTo = null;\r\n                this.state.linkFrom = null;\r\n                this.linkingLine = null;\r\n            }\r\n        },\r\n        multiSelect() {\r\n            let box = this.selectRect;\r\n            this.blocks\r\n                .filter(b => {\r\n                    if (Array.isArray(b.position) && b.$el) {\r\n                        let pos = b.$el.getDimensions();\r\n                        return boxIntersectsBox(box.x, box.y, box.width, box.height, pos.x, pos.y, pos.width, pos.height);\r\n                    }\r\n                    return false;\r\n                })\r\n                .map(b => b.selected = true);\r\n            this.edges\r\n                .filter(e => Array.isArray(e.position1) && Array.isArray(e.position2) && boxIntersectsLine(box.x, box.y, box.width, box.height, e.position1[0], e.position1[1], e.position2[0], e.position2[1]))\r\n                .map(e => e.selected = true);\r\n        },\r\n        toJSON() {\r\n            let process = this.export();\r\n            return JSON.stringify(process, null, 2);\r\n        },\r\n        async onDocumentMouseUp(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            if (this.selectedSideEdge) {\r\n                this.selectEdge(this.selectedSideEdge, null); // Reset selectedParameter, but don't change selected state.\r\n            }\r\n            if (this.state.selecting) {\r\n                this.multiSelect();\r\n                this.state.selecting = null;\r\n            }\r\n            if (this.state.moving) {\r\n                this.state.moving = null;\r\n            }\r\n            if (this.state.editable && this.state.linkFrom) {\r\n                if (event.which == 1 && this.state.linkTo) {\r\n                    try {\r\n                        await this.addEdge(this.state.linkFrom, this.state.linkTo);\r\n                    } catch (error) {\r\n                        this.$emit(\"error\", error);\r\n                    }\r\n                }\r\n                this.unlink();\r\n            }\r\n        },\r\n        async onKeyDown(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            var allInputs = document.querySelectorAll('input, textarea, button, select, datalist');\r\n            for(let el of allInputs) {\r\n                if (el === document.activeElement) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let captured = false;\r\n            if (this.state.editable) {\r\n                // delete selected blocks/edges\r\n                if (event.code === 'Delete') {\r\n                    this.deleteSelected();\r\n                    captured = true;\r\n                }\r\n                else if (event.ctrlKey || event.metaKey) { // STRG for Win/Linux, meta/cmd from Mac\r\n                    if (event.code === 'KeyV') {\r\n                        if (!navigator || !navigator.clipboard || typeof navigator.clipboard.readText !== 'function') {\r\n                            this.$emit('error', 'Pasting is not supported by your browser.');\r\n                            return;\r\n                        }\r\n                        if (this.hasSelection && this.clipboard) {\r\n                            if (this.clipboard.edges.length > 0) {\r\n                                this.$emit('error', 'Pasting edges is not supported yet.');\r\n                                return;\r\n                            }\r\n                            if (this.clipboard.blocks.length > 0) {\r\n                                this.clipboard.blocks.forEach(block => {\r\n                                    if (block.type === 'process' && block.origin !== 'schema') {\r\n                                        this.duplicate(Utils.pickFromObject(block, [\"arguments\", \"description\", \"namespace\", \"position\", \"process_id\"]));\r\n                                    }\r\n                                    else {\r\n                                        this.$emit('error', `Pasting block '${block.id}' is not supported.`);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                        else {\r\n                            try {\r\n                                const text = await navigator.clipboard.readText();\r\n                                let process = JSON.parse(text);\r\n                                await this.import(process);\r\n                            } catch(error) {\r\n                                this.$emit('error', error, 'Paste Error');\r\n                            }\r\n                        }\r\n                        captured = true;\r\n                    }\r\n                    else if (event.code === 'KeyC') {\r\n                        if (!navigator || !navigator.clipboard || typeof navigator.clipboard.writeText !== 'function') {\r\n                            this.$emit('error', 'Copying is not supported by your browser.');\r\n                            return;\r\n                        }\r\n                        if (this.hasSelection) {\r\n                            this.clipboard = {\r\n                                blocks: this.selectedBlocks.slice(0),\r\n                                edges: this.selectedEdges.slice(0)\r\n                            };\r\n                        }\r\n                        else {\r\n                            try {\r\n                                let json = this.toJSON();\r\n                                await navigator.clipboard.writeText(json);\r\n                                captured = true;\r\n                            } catch(error) {\r\n                                this.$emit('error', error, 'Copy Error');\r\n                            }\r\n                        }\r\n                        captured = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (captured) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            }\r\n        },\r\n        onMouseWheel(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            if (!this.explicitZoom || this.hasFocus || event.ctrlKey || event.metaKey) { // STRG for Win/Linux, meta/cmd for Mac\r\n                let mouse = this.getMousePos(event);\r\n                var dX = mouse[0] - this.state.center[0];\r\n                var dY = mouse[1] - this.state.center[1];\r\n                var deltaScale = Math.pow(1.1, Math.sign(event.deltaY)*-1);\r\n                this.moveCenter(-dX*(deltaScale-1), -dY*(deltaScale-1));\r\n                this.state.scale *= deltaScale;\r\n                event.preventDefault();\r\n                this.showZoomInfo = false;\r\n            }\r\n        },\r\n        domBoundingBox(el) {\r\n            var rect = el.getBoundingClientRect();\r\n            rect.offsetTop = rect.top + Math.max(document.documentElement.scrollTop, document.body.scrollTop);\r\n            rect.offsetLeft = rect.left + Math.max(document.documentElement.scrollLeft, document.body.scrollLeft);\r\n            return rect;\r\n        },\r\n        getMousePos(event) {\r\n            let root = this.$refs.div.getBoundingClientRect();\r\n            return [\r\n                event.clientX - root.left,\r\n                event.clientY - root.top\r\n            ];\r\n        },\r\n        onMouseMove(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            try {\r\n                let mousePos = this.getMousePos(event);\r\n\r\n                if (this.state.editable && this.selectedSideEdge) {\r\n                    var origin = this.selectedSideEdge.selectedParameter.getCirclePosition();\r\n                    if (origin) {\r\n                        var distance = Math.sqrt(Math.pow(mousePos[0]-origin[0], 2)+Math.pow(mousePos[1]-origin[1], 2));\r\n                        if (distance > 10) {\r\n                            this.link(this.selectedSideEdge.selectedParameter);\r\n                            this.removeEdge(this.selectedSideEdge);\r\n                            this.commit();\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (this.state.selecting) {\r\n                    this.state.selecting.current = mousePos;\r\n                }\r\n\r\n                if (this.state.moving) {\r\n                    this.moveCenter((mousePos[0]-this.state.moving[0]), (mousePos[1]-this.state.moving[1]));\r\n                    this.state.moving = mousePos;\r\n                }\r\n\r\n                if (this.state.linkFrom) {\r\n                    var position = this.state.linkFrom.getCirclePosition();\r\n                    if (position) {\r\n                        this.linkingLine = {\r\n                            x1: position[0],\r\n                            y1: position[1],\r\n                            x2: mousePos[0],\r\n                            y2: mousePos[1],\r\n                            'stroke': 'rgba(0,0,0,0.4)',\r\n                            'stroke-width': 3 * this.state.scale\r\n                        };\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                this.$emit(\"error\", error);\r\n            }\r\n        },\r\n        onMouseDown(event) {\r\n            if (this.parameterViewer) {\r\n                return;\r\n            }\r\n            let sideSelected = null;\r\n            let mousePos = this.getMousePos(event);\r\n\r\n            if (event.which == 1) {\r\n                if (event.shiftKey) {\r\n                    // Start multi select via box\r\n                    this.state.selecting = {\r\n                        start: mousePos,\r\n                        current: mousePos\r\n                    }\r\n                }\r\n                else {\r\n                    // No multiselect: unselect all\r\n                    this.unselectAll();\r\n                }\r\n\r\n                // Select edges\r\n                for (var edge of this.edges) {\r\n                    if (!edge.$el) {\r\n                        continue;\r\n                    }\r\n                    var collide = edge.$el.collide(mousePos[0], mousePos[1]);\r\n                    if (collide != false) {\r\n                        if (this.selectedEdges.length === 0 && !event.shiftKey) {\r\n                            if (collide < 0.3) {\r\n                                sideSelected = edge.parameter2;\r\n                            }\r\n                            else if (collide > 0.7) {\r\n                                sideSelected = edge.parameter1;\r\n                            }\r\n                        }\r\n                        this.selectEdge(edge, true, sideSelected);\r\n                        if (edge.issues.length > 0) {\r\n                            for(let issue of edge.issues) {\r\n                                this.$emit('error', issue);\r\n                            }\r\n                        }\r\n                        event.preventDefault();\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (event.which == 2 || (event.which == 1 && !sideSelected && !event.shiftKey)) {\r\n                this.state.moving = mousePos;\r\n            }\r\n\r\n            this.focus();\r\n        },\r\n\r\n        getDimensions() {\r\n            return this.domBoundingBox(this.$refs.div);\r\n        },\r\n\r\n        async clear() {\r\n            return await this.startTransaction(async () => {\r\n                this.edges = [];\r\n                // Don't remove parameters injected by props (fixed callback parameters)\r\n                this.blocks = this.blocks.filter(b => b.type === 'parameter' && Utils.isObject(b.spec) && b.origin === 'schema');\r\n                this.nextBlockId = 1;\r\n                this.nextEdgeId = 1;\r\n                this.process = {};\r\n                this.updateHiddenParameterRefEdges();\r\n                return true;\r\n            });\r\n        },\r\n\r\n        commit(data = null, history = true, propagate = true) {\r\n            // Don't commit when in a transaction\r\n            if (this.activeTransactions > 0) {\r\n                return;\r\n            }\r\n\r\n            if (history !== false) {\r\n                this.saveHistory();\r\n            }\r\n            if (propagate !== false) {\r\n                this.$emit('input', data === null ? this.export() : data);\r\n                this.updateHiddenParameterRefEdges();\r\n            }\r\n            else {\r\n                this.refreshEdges();\r\n            }\r\n        },\r\n    \r\n        /**\r\n         * Save the current situation to the history\r\n         */\r\n        saveHistory() {\r\n            var data = this.export(true);\r\n            this.history.splice(this.historyPointer + 1, this.historySize, Object.freeze(data));\r\n            if (this.history.length > this.historySize) {\r\n                this.history.shift();\r\n            }\r\n            this.historyPointer = this.history.length - 1;\r\n            this.$emit('historyChanged', this.history, this.historyPointer);\r\n        },\r\n        async undo() {\r\n            await this.historyStep(-1);\r\n        },\r\n        async redo() {\r\n            await this.historyStep(1);\r\n        },\r\n        async historyStep(step) {\r\n            var index = this.historyPointer + step;\r\n            var element = this.history[index];\r\n            if (element) {\r\n                this.historyPointer = index;\r\n                this.import(element, { saveHistory: false, undoOnError: false, perfectScale: false });\r\n                this.$emit('historyChanged', this.history, this.historyPointer);\r\n            }\r\n        },\r\n\r\n        setResultNode(block, result = true) {\r\n            block = this.getBlockById(block.id);\r\n            if (!block || block.result === result) {\r\n                return; // Nothing to change\r\n            }\r\n\r\n            this.updateBlockResult(block, result);\r\n            var foundNewResultNode = false;\r\n            var hasOtherBlocks = false;\r\n            for(var other of this.processBlocks) {\r\n                if (block && other.id === block.id) {\r\n                    continue;\r\n                }\r\n                \r\n                hasOtherBlocks = true;\r\n                // If we set a new result node, ensure that only that node is a result node and no other.\r\n                if (result) {\r\n                    this.updateBlockResult(other, false);\r\n                }\r\n                // Find a potential result node if we don't want this to be the result node\r\n                else {\r\n                    if (other.$el && !other.$el.hasOutputEdges()) {\r\n                        this.updateBlockResult(other, true);\r\n                        foundNewResultNode = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            // If we have no new potential result node, communicate to the user.\r\n            if (hasOtherBlocks && !result && !foundNewResultNode) {\r\n                this.$emit(\"error\", \"No result node available, please specify one.\");\r\n            }\r\n        },\r\n\r\n        getPositionForPageXY(x, y) {\r\n            var rect = this.getDimensions();\r\n            if (x !== null) {\r\n                x = (x - rect.offsetLeft - this.state.center[0]) / this.state.scale;\r\n            }\r\n            if (y !== null) {\r\n                y = (y - rect.offsetTop - this.state.center[1]) / this.state.scale;\r\n            }\r\n            return [x, y];\r\n        },\r\n\r\n        duplicate(data) {\r\n            data = Utils.deepClone(data);\r\n            if (data.position) {\r\n                data.position[1] += 100;\r\n            }\r\n            let block = this.addBlock(data);\r\n            this.$nextTick(() => this.createEdgesForArguments(block.id, data.arguments));\r\n        },\r\n\r\n        addProcess(process_id, args = {}, position = [], namespace = null) {\r\n            return this.addBlock({\r\n                process_id,\r\n                namespace,\r\n                arguments: args,\r\n                position\r\n            });\r\n        },\r\n\r\n        addBlock(node, id = null) {\r\n            let num = String(this.incrementId(id));\r\n            if (id === null && Utils.hasText(node.process_id)) {\r\n                id = node.process_id.replace(/^([a-z]*).*$/i, \"$1\") + num;\r\n                if (this.getBlockById('#' + id)) {\r\n                    id = num;\r\n                }\r\n            }\r\n            else {\r\n                id = num;\r\n            }\r\n            if (typeof node.toJSON === 'function') {\r\n                node = node.toJSON();\r\n            }\r\n            var block = {\r\n                id: '#' + id,\r\n                type: 'process',\r\n                selected: false,\r\n                position: node.position,\r\n                process_id: node.process_id,\r\n                namespace: node.namespace,\r\n                arguments: node.arguments,\r\n                description: node.description || null,\r\n                result: node.result || false\r\n            };\r\n            if (this.processRegistry) {\r\n                block.spec = this.processRegistry.get(node.process_id, node.namespace);\r\n            }\r\n\r\n            var size = this.getBlockSize(block);\r\n            block.position = Utils.ensurePoint(block.position, () => this.getNewBlockDefaultPosition(size));\r\n\r\n            // If there's already a result node, remove the flag here\r\n            if (block.result && this.blocks.filter(b => b.result === true).length) {\r\n                delete block.result;\r\n            }\r\n            // Make this the result node if there's no node yet\r\n            else if (this.processBlocks.length === 0) {\r\n                block.result = true;\r\n            }\r\n            \r\n            this.blocks.push(Vue.observable(block));\r\n            this.commit();\r\n            return block;\r\n        },\r\n\r\n        getNewBlockDefaultPosition(blockSize) {\r\n            var rect = this.getDimensions();\r\n            var position = [\r\n                (-this.state.center[0] + rect.width/2)/this.state.scale - blockSize[0]/2 + this.newBlockOffset,\r\n                (-this.state.center[1] + rect.height/2)/this.state.scale - blockSize[1]/2 + this.newBlockOffset\r\n            ];\r\n            if (this.newBlockOffset < 150) {\r\n                this.newBlockOffset += 10;\r\n            }\r\n            return position;\r\n        },\r\n\r\n        getBlockSize(block) {\r\n            if (block.$el) {\r\n                let dim = block.$el.getDimensions();\r\n                return [dim.width / this.state.scale, dim.height / this.state.scale];\r\n            }\r\n\r\n            let inputs = Math.max(\r\n                Utils.size(block.arguments),\r\n                Utils.isObject(block.spec) ? Utils.size(block.spec.parameters) : 0\r\n            );\r\n\r\n            let size = Config.blockWidth;\r\n            let width;\r\n            if (inputs > 0) {\r\n                width = this.state.compactMode ? size.compactParams : size.normalParams;\r\n            }\r\n            else {\r\n                width = this.state.compactMode ? size.compact : size.normal;\r\n            }\r\n\r\n            let commentHeight = typeof block.description === 'string' ? 40 : 0;\r\n            let height = MARGIN + inputs * 15 + commentHeight;\r\n\r\n            return [width, height];\r\n        },\r\n\r\n        moveCenter(dX, dY, reset = false) {\r\n            var rect = this.getDimensions();\r\n            this.state.center = [\r\n                (reset ? rect.width/2 : this.state.center[0]) + dX,\r\n                (reset ? rect.height/2 : this.state.center[1]) + dY\r\n            ];\r\n            this.newBlockOffset = 0;\r\n        },\r\n\r\n        unselectAll() {\r\n            for(var block of this.blocks) {\r\n                this.updateBlockSelected(block, false, false);\r\n            }\r\n            for(var edge of this.edges) {\r\n                this.selectEdge(edge, false);\r\n            }\r\n        },\r\n\r\n        selectEdge(edge, select = true, parameter = null) {\r\n            if (!Utils.isObject(edge)) {\r\n                edge = this.edges[edge];\r\n            }\r\n            if (edge.selected === select) {\r\n                return false; // Nothing to change\r\n            }\r\n            if (select !== null) {\r\n                this.$set(edge, \"selected\", select);\r\n            }\r\n            this.$set(edge, \"selectedParameter\", parameter);\r\n            return true;\r\n        },\r\n\r\n        /**\r\n         * Edge to remove\r\n         */\r\n        removeEdge(edge) {\r\n            edge.parameter1.eraseEdge(edge);\r\n            edge.parameter2.eraseEdge(edge);\r\n            this.$delete(this.edges, this.edges.indexOf(edge));\r\n        },\r\n            \r\n        /**\r\n         * Remove a block\r\n         */\r\n        async removeBlock(block) {\r\n            // Check if the parameter for this block is used in child processes (callbacks).\r\n            // Then don't delete, but give error instead.\r\n            if (block.type === 'parameter') {\r\n                let param = null;\r\n                let conflictBlock = this.blocks.find(otherBlock => {\r\n                    param = otherBlock.$el.hiddenParameterRef(block);\r\n                    return (param !== null);\r\n                });\r\n                if (conflictBlock) {\r\n                    throw new Error(`Parameter is still used in '${conflictBlock.id}', parameter '${param}'. Only unused parameters can be deleted.`);\r\n                }\r\n            }\r\n\r\n            // now start deleting the block\r\n            return await this.startTransaction(async () => {\r\n                var i = this.blocks.findIndex(b => b.id == block.id);\r\n                if (i < 0) {\r\n                    return false;\r\n                }\r\n\r\n                for (var edge of this.edges.slice(0)) {\r\n                    if (edge.parameter1.$parent.id === block.id || edge.parameter2.$parent.id === block.id) {\r\n                        this.removeEdge(edge);\r\n                    }\r\n                }\r\n\r\n                if (block.result) {\r\n                    this.setResultNode(block, false);\r\n                }\r\n\r\n                this.$delete(this.blocks, i);\r\n                return true;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Retreive a block by ID\r\n         */\r\n        getBlockById(blockId) {\r\n            var blocks = this.blocks.filter(block => block.id === blockId);\r\n            if (blocks.length > 0) {\r\n                return blocks[0];\r\n            }\r\n            return null;\r\n        },\r\n\r\n        /**\r\n         * Delete the current link\r\n         */\r\n        async deleteSelected() {\r\n            if (!this.hasSelection) {\r\n                return false;\r\n            }\r\n\r\n            return await this.startTransaction(async () => {\r\n                // Remove the selected blocks and its edges\r\n                for(var block of this.selectedBlocks.slice(0)) { // copy to avoid race condition\r\n                    if (block.$el.allowsDelete) {\r\n                        await this.removeBlock(block);\r\n                    }\r\n                }\r\n\r\n                // Removes the selected edges\r\n                for(var edge of this.selectedEdges.slice(0)) { // copy to avoid race condition\r\n                    this.removeEdge(edge);\r\n                }\r\n                return true;\r\n            });\r\n        },\r\n\r\n        async addEdgeByNames(b1, p1, b2, p2) {\r\n            var blocks = [];\r\n            for(var id of [b1, b2]) {\r\n                var block = this.getBlockById(id);\r\n                if (!block) {\r\n                    throw \"Can't find block: \" + id;\r\n                }\r\n                else if (!block.$el) {\r\n                    throw \"Block not mounted yet: \" + id;\r\n                }\r\n                blocks.push(block.$el);\r\n            }\r\n            await this.addEdge(\r\n                blocks[0].getBlockParameter(p1),\r\n                blocks[1].getBlockParameter(p2)\r\n            );\r\n        },\r\n \r\n        async addEdge(p1, p2) {\r\n            if (!p1 || !p2) {\r\n                throw 'One of the parameters is invalid.';\r\n            }\r\n            // Check whether you want to connect the same parameters\r\n            if (p1 == p2) {\r\n                return; // Probably by mistake, don't show an error to not annoy people\r\n            }\r\n            // Check whether you want to connect the block to itself\r\n            if (p1.$parent == p2.$parent) {\r\n                throw 'You can\\'t link a block to itself';\r\n            }\r\n\r\n            var id = this.nextEdgeId++;\r\n            var edge = {id, selected: false, inactive: false, issues: [], $el: null};\r\n            if (p1.output) {\r\n                edge.parameter1 = p1;\r\n                edge.parameter2 = p2;\r\n            }\r\n            else {\r\n                // Reverse the order of in and out\r\n                edge.parameter1 = p2;\r\n                edge.parameter2 = p1;\r\n            }\r\n\r\n            // You have to link an input with an output\r\n            if (edge.parameter1.output === edge.parameter2.output) {\r\n                throw 'You have to link an input with an output';\r\n            }\r\n            // Check for non-recursiveness\r\n            if (this.allSuccessors(edge.parameter1).indexOf(edge.parameter2.id) !== -1) {\r\n                throw 'You can not create a loop';\r\n            }\r\n            // Check whether the data type allows multiple input edges\r\n            if (edge.parameter2.getEdgeCount() > 0 && !edge.parameter2.allowsMultipleInputs) {\r\n                throw 'Parameter accepts only one input';\r\n            }\r\n\r\n            // Check whether the edge exists\r\n            for (var other of this.edges) {\r\n                if (other.$el && other.$el.equals(edge)) {\r\n                    throw 'This connection exists already';\r\n                }\r\n            }\r\n\r\n            // Check type compatibility\r\n            if (!JsonSchemaValidator.isSchemaCompatible(edge.parameter2.schema || {}, edge.parameter1.schema || {}, false, true)) {\r\n                let issue = 'Incoming data type is not compatible for parameter \"' + edge.parameter2.name + '\"';\r\n                edge.issues.push(issue);\r\n                this.$emit('error', issue);\r\n            }\r\n\r\n            return await this.startTransaction(async () => {\r\n                this.unlink();\r\n\r\n                // Create edge\r\n                this.edges.push(Vue.observable(edge));\r\n                edge.parameter1.addEdge(edge);\r\n                edge.parameter2.addEdge(edge);\r\n\r\n                // Update result node\r\n                this.setResultNode(edge.parameter1.$parent, false);\r\n                return true;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Find all successors of a block, and their successors\r\n         */\r\n        allSuccessors(outputParameter) {\r\n            var block = outputParameter.$parent;\r\n            // Blocks already explored\r\n            var explored = {};\r\n            var exploreList = [block];\r\n            explored[block.id] = true;\r\n        \r\n            while (exploreList.length > 0) {\r\n                var currentBlock = exploreList.pop();\r\n                for (var key in currentBlock.edges) {\r\n                    for (var i in currentBlock.edges[key]) {\r\n                        var edge = currentBlock.edges[key][i];\r\n                        if (edge.block1 == currentBlock) {\r\n                            var target = edge.block2;\r\n                            if (!(target.id in explored)) {\r\n                                explored[target.id] = true;\r\n                                exploreList.push(target);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return Object.values(explored);\r\n        },\r\n\r\n        /**\r\n         * Changing the compact mode\r\n         */\r\n        async toggleCompact() {\r\n            this.state.compactMode = !this.state.compactMode;\r\n            this.$emit('compactMode', this.state.compactMode);\r\n            await this.$nextTick();\r\n            this.refreshEdges();\r\n        },\r\n\r\n        export(internal = false) {\r\n            let data = {\r\n                process_graph: {}\r\n            };\r\n\r\n            for(let block of this.processBlocks) {\r\n                let keys = ['process_id', 'namespace', 'arguments', 'description', 'result'];\r\n                if (internal) {\r\n                    // Keep internal state for history\r\n                    keys.push('position');\r\n                }\r\n                let copy = Utils.pickFromObject(block, keys);\r\n                // Remove default values for simplicity\r\n                if (copy.description === null) {\r\n                    delete copy.description;\r\n                }\r\n                if (copy.result !== true) {\r\n                    delete copy.result;\r\n                }\r\n                if (!copy.namespace) {\r\n                    delete copy.namespace;\r\n                }\r\n                let nodeId = block.id.substr(1);\r\n                data.process_graph[nodeId] = copy;\r\n            }\r\n\r\n            if (!this.parent) {\r\n                data.parameters = [];\r\n                let parameterBlocks = this.getPgParameters();\r\n                for(let param of parameterBlocks) {\r\n                    data.parameters.push(param.spec);\r\n                }\r\n            }\r\n\r\n            // ToDo: Currently, we just use the id, categories, result value etc from the original process.\r\n            // Implement to allow custom settings from users.\r\n            return new BlocksProcess(Object.assign({}, this.process, data));\r\n        },\r\n\r\n        // Options may contain:\r\n        // - undoOnError: don't undo changes when an error occured (default: true)\r\n        // - saveHistory: commit the changes to the history (default: true)\r\n        // - propagate: emit the changes to the parent v-model (default: true)\r\n        async startTransaction(fn, options = {}, ...args) {\r\n            let success;\r\n            this.activeTransactions++;\r\n\r\n            try {\r\n                success = await fn(args);\r\n            } catch (error) {\r\n                // If an error occured: show it and restore the last working state from history.\r\n                this.$emit('error', error, \"Model is invalid\");\r\n                if (options.undoOnError !== false) {\r\n                    try {\r\n                        await this.undo();\r\n                    } catch (error2) {\r\n                        this.$emit('error', error, \"Revert failed\");\r\n                    }\r\n                }\r\n                success = false;\r\n            }\r\n\r\n            this.activeTransactions--;\r\n            this.commit(null, options.saveHistory, options.propagate);\r\n\r\n            return success;\r\n        },\r\n\r\n        // Options may contain:\r\n        // - all from startTransaction()\r\n        // - clear: Clear the model builder before import (default: true)\r\n        // - perfectScale: Apply perfect scale after import (default: true)\r\n        async import(process, options = {}) {\r\n            return await this.startTransaction(async () => {\r\n                // clear screen...\r\n                if (options.clear !== false) {\r\n                    await this.clear();\r\n                    this.process = process instanceof ProcessGraph ? process.toJSON() : process;\r\n                }\r\n\r\n                if (!Utils.isObject(process)) {\r\n                    return false;\r\n                }\r\n\r\n                // Parse process\r\n                let pg;\r\n                if (process instanceof ProcessGraph) {\r\n                    // Make a copy\r\n                    pg = new ProcessGraph(process.toJSON(), this.processRegistry);\r\n                    pg.setParent(process.parentProcessId, process.parentParameterName);\r\n                }\r\n                else {\r\n                    pg = new ProcessGraph(process, this.processRegistry);\r\n                }\r\n                pg.allowEmpty();\r\n                pg.parse();\r\n                this.processGraph = Object.freeze(pg);\r\n\r\n                await this.importPgParameters(this.processGraph.getProcessParameters(true), 'user', options.clear !== false);\r\n                await this.importNodes(this.processGraph.getStartNodes());\r\n                await this.importEdges(this.processGraph);\r\n\r\n                if (options.perfectScale !== false) {\r\n                    this.perfectScale();\r\n                }\r\n\r\n                this.$nextTick(() => this.updateHiddenParameterRefEdges());\r\n\r\n                return true;\r\n            }, options);\r\n        },\r\n\r\n        async importPgParameters(params, origin, clear = true) {\r\n            if (!Array.isArray(params)) {\r\n                return;\r\n            }\r\n\r\n            let options = {\r\n                undoOnError: false,\r\n                saveHistory: false,\r\n                propagate: false\r\n            };\r\n            return await this.startTransaction(async () => {\r\n                // Remove existing parameters from the given origin\r\n                if (clear) {\r\n                    this.blocks = this.blocks.filter(b => b.type !== 'parameter' || b.origin !== origin);\r\n                }\r\n\r\n                let size = this.getBlockSize({}); // Estimate base size for an empty block\r\n                let position = [0,0];\r\n                for(var i in params) {\r\n                    position = [\r\n                        -size[0] - MARGIN,\r\n                        i * (size[1] + MARGIN)\r\n                    ];\r\n\r\n                    await this.addPgParameter(params[i], origin, position);\r\n                }\r\n            }, options);\r\n        },\r\n\r\n        async addPgParameter(param, origin = 'user', position = null) {\r\n            return await this.startTransaction(async () => {\r\n                let id = '$' + param.name;\r\n                // Check a parameter with the same name exists\r\n                if (this.blocks.findIndex(p => p.type === 'parameter' && p.id == id) >= 0) {\r\n                    return false;\r\n                }\r\n                param = Utils.deepClone(param);\r\n                if (typeof param.schema === 'undefined') {\r\n                    param.schema = {};\r\n                }\r\n                this.blocks.push(Vue.observable({\r\n                    id,\r\n                    type: 'parameter',\r\n                    origin,\r\n                    position: Utils.ensurePoint(position, () => this.getNewBlockDefaultPosition(this.getBlockSize({}))),\r\n                    spec: Object.freeze(param)\r\n                }));\r\n                return true;\r\n            });\r\n        },\r\n\r\n        getPgParameters() {\r\n            return this.blocks.filter(b => b.type === 'parameter');\r\n        },\r\n\r\n        getPgParameterById(id) {\r\n            return this.blocks.find(b => b.type === 'parameter' && b.id === id);\r\n        },\r\n\r\n        async importEdges(pg) {\r\n            var nodes = pg.getNodes();\r\n            return Promise.all(Object.values(nodes).map(node => this.importEdgesForNode(node)));\r\n        },\r\n\r\n        async importEdgesForNode(node) {\r\n            var args = node.getArgumentNames();\r\n            for(let i in args) {\r\n                let arg = args[i];\r\n                let val = node.getRawArgument(arg);\r\n                let ref = '#' + node.id;\r\n                switch(node.getArgumentType(arg)) {\r\n                    case 'result':\r\n                        await this.addEdgeByNames('#' + val.from_node, \"output\", ref, arg, false);\r\n                        break;\r\n                    case 'parameter':\r\n                        await this.addEdgeByNames('$' + val.from_parameter, \"output\", ref, arg, false);\r\n                        break;\r\n                    case 'object':\r\n                    case 'array':\r\n                        await this.importEdgeDeep(val, ref, arg);\r\n                        break;\r\n                }\r\n            }\r\n        },\r\n\r\n        async importEdgeDeep(val, nodeId, arg) {\r\n            for(let k in val) {\r\n                // k !== 'process_graph' prevents importing sub process graphs like in load_collection, see #118\r\n                if(val[k] && typeof val[k] === \"object\" && k !== 'process_graph') {\r\n                    await this.importEdgeDeep(val[k], nodeId, arg);\r\n                }\r\n                else if (!Utils.isRef(val)) {\r\n                    continue;\r\n                }\r\n                else if (val.from_node) {\r\n                    await this.addEdgeByNames('#' + val.from_node, \"output\", nodeId, arg, false);\r\n                }\r\n                else if (val.from_parameter) {\r\n                    await this.addEdgeByNames('$' + val.from_parameter, \"output\", nodeId, arg, false);\r\n                }\r\n            }\r\n        },\r\n\r\n        async createEdgesForArguments(nodeId, args) {\r\n            for(let arg in args) {\r\n                await this.importEdgeDeep(args[arg], nodeId, arg);\r\n            }\r\n        },\r\n\r\n        async importNodes(nodes, x = 0, y = 0, imported = []) {\r\n            let nextNodes = [];\r\n            let maxX = 0;\r\n            for(let node of nodes) {\r\n                // `node` is a Node class instance as defined by the js-processgraphs library\r\n                // `data` is the simple object that is defined by JSON process graphs\r\n                // `block` is the representation used by the Block component to render the block\r\n\r\n                // To get a better layout, only add the block once all previous nodes are added\r\n                if (imported.includes(node.id) || node.getPreviousNodes().find(prev => !imported.includes(prev.id)) !== undefined) {\r\n                    y += MARGIN / 2; // add a small offset so that lines going through a box are easier to see\r\n                    continue;\r\n                }\r\n\r\n                let data = typeof node.toJSON === 'function' ? node.toJSON() : node;\r\n                data.position = Utils.ensurePoint(data.position, () => [x,y]);\r\n\r\n                let block = this.addBlock(data, node.id);\r\n                imported.push(node.id);\r\n\r\n                let size = this.getBlockSize(block);\r\n                maxX = Math.max(maxX, data.position[0] + size[0]);\r\n                y = data.position[1] + size[1] + MARGIN;\r\n\r\n                nextNodes = nextNodes.concat(node.getNextNodes());\r\n            }\r\n            if (nextNodes.length) {\r\n                await this.importNodes(nextNodes, maxX + MARGIN, 0, imported);\r\n            }\r\n        },\r\n\r\n        incrementId(id = null) {\r\n            if (typeof id !== 'number' && (typeof id !== 'string' || id.length === 0)) {\r\n                id = this.nextBlockId;\r\n                this.nextBlockId++;\r\n            }\r\n            let int = Number.parseInt(id, 10);\r\n            if (!Number.isNaN(int)) {\r\n                this.nextBlockId = Math.max(this.nextBlockId, int+1);\r\n            }\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Go to the perfect scale\r\n         */\r\n        perfectScale() {\r\n            if (!this.$refs.div || this.blocks.length === 0) {\r\n                return;\r\n            }\r\n\r\n            var xMin = null, xMax = null;\r\n            var yMin = null, yMax = null;\r\n\r\n            for (let block of this.blocks) {\r\n                let size = this.getBlockSize(block);\r\n                let pos = Utils.ensurePoint(block.position);\r\n                if (xMin == null) {\r\n                    xMin = pos[0]-15\r\n                    xMax = pos[0]+size[0]+15;\r\n                    yMin = pos[1]-15\r\n                    yMax = pos[1]+size[1]+15;\r\n                } else {\r\n                    xMin = Math.min(xMin, pos[0]-15);\r\n                    xMax = Math.max(xMax, pos[0]+size[0]+15);\r\n                    yMin = Math.min(yMin, pos[1]-15);\r\n                    yMax = Math.max(yMax, pos[1]+size[1]+15);\r\n                }\r\n            }\r\n\r\n            var rect = this.$refs.div.getBoundingClientRect();\r\n            var scaleA = rect.width/(xMax-xMin);\r\n            var scaleB = rect.height/(yMax-yMin);\r\n            this.state.scale = Math.min(scaleA, scaleB, 1.5); // Don't scale higher than 1.5\r\n            this.state.center = [\r\n                rect.width/2 - this.state.scale*(xMin+xMax)/2.0,\r\n                rect.height/2 - this.state.scale*(yMin+yMax)/2.0\r\n            ];\r\n            this.newBlockOffset = 0;\r\n        },\r\n\r\n        showParameterViewer(parameters, values, title, isEditable, selectParameterName, saveCallback, parent) {\r\n            this.parameterViewer = {\r\n                parameters,\r\n                values,\r\n                title,\r\n                selectParameterName,\r\n                parent\r\n            };\r\n        }\r\n    }\r\n};\r\n\r\nclass BlocksProcess {\r\n    constructor(process) {\r\n        Object.assign(this, process);\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.vue-component.model-builder {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tposition: relative;\r\n\r\n    &.editable.focus .blocks {\r\n        border-color: rgba(22, 102, 182, 0.3);\r\n    }\r\n\r\n    &:focus,\r\n    .blocks:focus,\r\n    .canvas:focus {\r\n        outline: 0;\r\n    }\r\n    \r\n    .canvas {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        z-index: 1;\r\n    }\r\n    \r\n    .blocks {\r\n        box-sizing: border-box;\r\n        border: 1px solid transparent;\r\n        overflow: hidden;\r\n        position: absolute;\r\n        z-index: 3;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    &.compact .blockicon .delete,\r\n    &.compact .blockicon .info,\r\n    &.compact .blockicon .addDescription,\r\n    &.compact .blockId,\r\n    &.compact .editDescription, \r\n    &.scale_xs .blockicon,\r\n    &.scale_s .blockicon,\r\n    &.scale_xs .connector .text {\r\n        display: none;\r\n    }\r\n    .zoomInfo {\r\n        position: absolute;\r\n        top: 0;\r\n        right: 0;\r\n        display: inline-block;\r\n        padding: 0.3em;\r\n        background-color: #f9f9f9;\r\n        color: #000;\r\n        border-radius: 0 0 0 0.3em;\r\n        z-index: 5;\r\n    }\r\n    &.scale_xs .editDescription {\r\n        visibility: hidden;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ModelBuilder.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ModelBuilder.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ModelBuilder.vue?vue&type=template&id=3477c0e2&\"\nimport script from \"./ModelBuilder.vue?vue&type=script&lang=js&\"\nexport * from \"./ModelBuilder.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ModelBuilder.vue?vue&type=style&index=0&id=3477c0e2&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict'\n\n/**\n * box-box collision\n * @param {number} x1 top-left corner of first box\n * @param {number} y1 top-left corner of first box\n * @param {number} w1 width of first box\n * @param {number} h1 height of first box\n * @param {number} x2 top-left corner of second box\n * @param {number} y2 top-left corner of second box\n * @param {number} w2 width of second box\n * @param {number} h2 height of second box\n */\nmodule.exports = function boxBox(x1, y1, w1, h1, x2, y2, w2, h2)\n{\n    return x1 < x2 + w2 && x1 + w1 > x2 && y1 < y2 + h2 && y1 + h1 > y2\n}\n","'use strict'\n\nvar lineBox = require('./line-box')\n\n/**\n * box-line collision\n * @param {number} xb top-left corner of box\n * @param {number} yb top-left corner of box\n * @param {number} wb width of box\n * @param {number} hb height of box\n * @param {number} x1 first point of line\n * @param {number} y1 first point of line\n * @param {number} x2 second point of line\n * @param {number} y2 second point of line\n */\nmodule.exports = function boxLine(xb, yb, wb, hb, x1, y1, x2, y2)\n{\n    return lineBox(x1, y1, x2, y2, xb, yb, wb, hb)\n}\n","'use strict'\n\n/**\n * box-point collision\n * @param {number} x1 top-left corner of box\n * @param {number} y1 top-left corner of box\n * @param {number} w1 width of box\n * @param {number} h1 height of box\n * @param {number} x2 of point\n * @param {number} y2 of point\n * @return {boolean}\n */\nmodule.exports = function boxPoint(x1, y1, w1, h1, x2, y2)\n{\n    return x2 >= x1 && x2 <= x1 + w1 && y2 >= y1 && y2 <= y1 + h1\n}\n","'use strict'\n\nvar boxPoint = require('./box-point')\nvar lineLine = require('./line-line')\n\n/**\n * line-box collision\n number @param {number} x1 point 1 of line\n number @param {number} y1 point 1 of line\n number @param {number} x2 point 2 of line\n number @param {number} y2 point 2 of line\n number @param {number} xb top-left of box\n number @param {number} yb top-left of box\n number @param {number} wb width of box\n number @param {number} hb height of box\n */\nmodule.exports = function lineBox(x1, y1, x2, y2, xb, yb, wb, hb)\n{\n    if (boxPoint(xb, yb, wb, hb, x1, y1) || boxPoint(xb, yb, wb, hb, x2, y2))\n    {\n        return true\n    }\n    return lineLine(x1, y1, x2, y2, xb, yb, xb + wb, yb) ||\n        lineLine(x1, y1, x2, y2, xb + wb, yb, xb + wb, yb + hb) ||\n        lineLine(x1, y1, x2, y2, xb, yb + hb, xb + wb, yb + hb) ||\n        lineLine(x1, y1, x2, y2, xb, yb, xb, yb + hb)\n}\n","'use strict'\n\nconst lineToPolygon = require('./lineToPolygon')\nconst polygonPolygon = require('./polygon-polygon')\nconst linePolygon = require('./line-polygon')\nconst lineToLine = require('./lineToLine')\n\n/**\n * line-line collision\n * from http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect\n * @param {number} x1 first point in line 1\n * @param {number} y1 first point in line 1\n * @param {number} x2 second point in line 1\n * @param {number} y2 second point in line 1\n * @param {number} x3 first point in line 2\n * @param {number} y3 first point in line 2\n * @param {number} x4 second point in line 2\n * @param {number} y4 second point in line 2\n * @param {number} [thickness1] of line 1 (the line is centered in its thickness--see demo)\n * @param {number} [thickness2] of line 2 (the line is centered in its thickness--see demo)\n * @return {boolean}\n */\nmodule.exports = function lineLine(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n{\n    if (thickness1 || thickness2)\n    {\n        return lineLineThickness(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n    }\n    else\n    {\n        return lineToLine(x1, y1, x2, y2, x3, y3, x4, y4)\n    }\n}\n\nfunction lineLineThickness(x1, y1, x2, y2, x3, y3, x4, y4, thickness1, thickness2)\n{\n    if (thickness1 && thickness2)\n    {\n        return polygonPolygon(lineToPolygon(x1, y1, x2, y2, thickness1), lineToPolygon(x3, y3, x4, y4, thickness2))\n    }\n    else if (thickness1)\n    {\n        return linePolygon(x3, y3, x4, y4, lineToPolygon(x1, y1, x2, y2, thickness1))\n    }\n    else if (thickness2)\n    {\n        return linePolygon(x1, y1, x2, y2, lineToPolygon(x3, y3, x4, y4, thickness1))\n    }\n}","'use strict'\n\nfunction distanceSquared(x1, y1, x2, y2)\n{\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2))\n}\n\n/**\n * line-point collision\n * from https://stackoverflow.com/a/17693146/1955997\n * @param {number} x1 first point in line\n * @param {number} y1 first point in line\n * @param {number} x2 second point in line\n * @param {number} y2 second point in line\n * @param {number} xp point\n * @param {number} yp point\n * @param {number} [tolerance=1]\n * @return {boolean}\n */\nmodule.exports = function linePoint(x1, y1, x2, y2, xp, yp, tolerance)\n{\n    tolerance = tolerance || 1\n    return Math.abs(distanceSquared(x1, y1, x2, y2) - (distanceSquared(x1, y1, xp, yp) + distanceSquared(x2, y2, xp, yp))) <= tolerance\n}","var polygonPoint = require('./polygon-point')\nvar lineLine = require('./lineToLine')\n\n/**\n * line-polygon collision\n @param {number} x1 point 1 of line\n @param {number} y1 point 1 of line\n @param {number} x2 point 2 of line\n @param {number} y2 point 2 of line\n @param {number[]} points of polygon\n @param {tolerance=1} maximum distance of point to polygon's edges that triggers collision (see pointLine)\n */\nmodule.exports = function linePolygon(x1, y1, x2, y2, points, tolerance)\n{\n    var length = points.length\n\n    // check if first point is inside the shape (this covers if the line is completely enclosed by the shape)\n    if (polygonPoint(points, x1, y1, tolerance))\n    {\n        return true\n    }\n\n    // check for intersections for all of the sides\n    for (var i = 0; i < length; i += 2)\n    {\n        var j = (i + 2) % length\n        if (lineLine(x1, y1, x2, y2, points[i], points[i + 1], points[j], points[j + 1]))\n        {\n            return true\n        }\n    }\n    return false\n}\n","'use strict'\n\n/**\n * lineToLine helper function (to avoid circular dependencies)\n * from http://stackoverflow.com/questions/563198/how-do-you-detect-where-two-line-segments-intersect\n * @param {number} x1 first point in line 1\n * @param {number} y1 first point in line 1\n * @param {number} x2 second point in line 1\n * @param {number} y2 second point in line 1\n * @param {number} x3 first point in line 2\n * @param {number} y3 first point in line 2\n * @param {number} x4 second point in line 2\n * @param {number} y4 second point in line 2\n * @return {boolean}\n */\nmodule.exports = function lineToLine(x1, y1, x2, y2, x3, y3, x4, y4)\n{\n    var s1_x = x2 - x1\n    var s1_y = y2 - y1\n    var s2_x = x4 - x3\n    var s2_y = y4 - y3\n    var s = (-s1_y * (x1 - x3) + s1_x * (y1 - y3)) / (-s2_x * s1_y + s1_x * s2_y)\n    var t = (s2_x * (y1 - y3) - s2_y * (x1 - x3)) / (-s2_x * s1_y + s1_x * s2_y)\n    return s >= 0 && s <= 1 && t >= 0 && t <= 1\n}","'use strict'\n\n/**\n * turns a line into a polygon using thickness\n * @param {number} x1 first point of line\n * @param {number} y1 first point of line\n * @param {number} x2 second point of line\n * @param {number} y2 second point of line\n * @param {number} thickness of line\n */\nmodule.exports = function lineToPolygon(x1, y1, x2, y2, thickness)\n{\n    const angle = Math.atan2(y2 - y1, x2 - x1) - Math.PI / 2\n    const half = thickness / 2\n    const cos = Math.cos(angle) * half\n    const sin = Math.sin(angle) * half\n    return [\n        x1 - cos, y1 - sin,\n        x2 - cos, y2 - sin,\n        x2 + cos, y2 + sin,\n        x1 + cos, y1 + sin\n    ]\n}","'use strict'\n\nconst linePoint = require('./line-point')\n\n/**\n * polygon-point collision\n * based on https://stackoverflow.com/a/17490923/1955997\n * @param {number[]} points [x1, y1, x2, y2, ... xn, yn] of polygon\n * @param {number} x of point\n * @param {number} y of point\n * @param {number} [tolerance=1] maximum distance of point to polygon's edges that triggers collision (see pointLine)\n */\nmodule.exports = function polygonPoint(points, x, y, tolerance)\n{\n    var length = points.length\n    var c = false\n    var i, j\n    for (i = 0, j = length - 2; i < length; i += 2)\n    {\n        if (((points[i + 1] > y) !== (points[j + 1] > y)) && (x < (points[j] - points[i]) * (y - points[i + 1]) / (points[j + 1] - points[i + 1]) + points[i]))\n        {\n            c = !c\n        }\n        j = i\n    }\n    if (c)\n    {\n        return true\n    }\n    for (i = 0; i < length; i += 2)\n    {\n        var p1x = points[i]\n        var p1y = points[i + 1]\n        var p2x, p2y\n        if (i === length - 2)\n        {\n            p2x = points[0]\n            p2y = points[1]\n        }\n        else\n        {\n            p2x = points[i + 2]\n            p2y = points[i + 3]\n        }\n        if (linePoint(p1x, p1y, p2x, p2y, x, y, tolerance))\n        {\n            return true\n        }\n    }\n    return false\n}\n","'use strict'\n\n/**\n * polygon-polygon collision\n * based on http://stackoverflow.com/questions/10962379/how-to-check-intersection-between-2-rotated-rectangles\n * @param {number[]} points1 [x1, y1, x2, y2, ... xn, yn] of first polygon\n * @param {number[]} points2 [x1, y1, x2, y2, ... xn, yn] of second polygon\n * @return {boolean}\n */\nmodule.exports = function polygonPolygon(points1, points2)\n{\n    var a = points1\n    var b = points2\n    var polygons = [a, b]\n    var minA, maxA, projected, minB, maxB, j\n    for (var i = 0; i < polygons.length; i++)\n    {\n        var polygon = polygons[i]\n        for (var i1 = 0; i1 < polygon.length; i1 += 2)\n        {\n            var i2 = (i1 + 2) % polygon.length\n            var normal = { x: polygon[i2 + 1] - polygon[i1 + 1], y: polygon[i1] - polygon[i2] }\n            minA = maxA = null\n            for (j = 0; j < a.length; j += 2)\n            {\n                projected = normal.x * a[j] + normal.y * a[j + 1]\n                if (minA === null || projected < minA)\n                {\n                    minA = projected\n                }\n                if (maxA === null || projected > maxA)\n                {\n                    maxA = projected\n                }\n            }\n            minB = maxB = null\n            for (j = 0; j < b.length; j += 2)\n            {\n                projected = normal.x * b[j] + normal.y * b[j + 1]\n                if (minB === null || projected < minB)\n                {\n                    minB = projected\n                }\n                if (maxB === null || projected > maxB)\n                {\n                    maxB = projected\n                }\n            }\n            if (maxA < minB || maxB < minA)\n            {\n                return false\n            }\n        }\n    }\n    return true\n}\n"],"names":["render","_vm","this","_c","_self","ref","class","classes","style","attrs","id","on","onMouseMove","onMouseDown","onMouseWheel","onKeyDown","$event","hasFocus","staticClass","_l","edge","key","parameter1","parameter2","selected","inactive","issues","state","node","mount","updateEdgePos","arguments","_b","linkingLine","_e","selectRect","block","type","spec","position","origin","process_id","namespace","result","description","args","updateBlock","startDragBlock","scale","showZoomInfo","_v","parameterViewer","staticRenderFns","containerClasses","indexOf","_k","keyCode","preventDefault","stopPropagation","button","apply","emitDrag","plainTitle","directives","name","rawName","value","expression","_s","focus","allowsDescription","showDescriptionField","addDescription","duplicate","remove","showInfo","isParameter","edit","param","i","refInFor","optional","deprecated","experimental","default","schema","updateArgument","edgesChanged","outputLabel","updateResult","output","editable","domProps","updateDescription","_g","circleClasses","circleListeners","textListeners","displayLabel","displayValue","props","String","Boolean","Object","Array","label","required","data","edges","computed","schemas","ProcessSchema","hasValue","undefined","allowsArgumentChange","click","openEditorForArguments","listeners","mousedown","event","which","root","link","dblclick","$emit","mouseover","linkFrom","mouseout","linkTo","unlink","getEdgeCount","push","unspecified","$parent","invalid","hasProcesses","length","maxLength","formattedValue","isEditable","compactMode","formatValue","isArrayType","nativeDataType","isObjectType","allowsMultipleInputs","watch","updateEdgeStatus","immediate","handler","methods","isEdgeUsed","getCirclePosition","dim","domBoundingBox","$refs","circle","blocksDim","getDimensions","x","offsetLeft","width","y","offsetTop","height","error","console","warn","showArguments","jsonSchema","toJSON","setValue","resetValue","nullable","dataType","getEdgeRef","addRefToValue","isArray","propertyCount","removeRefFromValue","removeRefFromValueDeep","splice","hasOwnProperty","addEdge","eraseEdge","k","$delete","hasRefInValue","formatProcess","pg","ProcessGraph","getNodeCount","getResultNode","nodes","values","process_graph","html","formatArray","formatObject","text","substr","toString","JSON","stringify","parts","formatted","unformatted","formatArraySimple","join","title","map","v","keys","west","east","south","north","component","defaultScale","blockWidth","compactParams","compact","normalParams","normal","defaultFontSize","components","BlockParameter","drag","size","parameters","styles","marginLeft","Math","round","center","marginTop","fontSize","showId","collectionId","processId","collection","collections","allowsParameterChange","supports","filter","p","allowsDuplicate","allowsDelete","allowsInfo","hasParametersDefined","names","ProcessParameter","includes","fields","returns","from_parameter","from_node","mounted","draggingFn","dragging","bind","document","addEventListener","stopDragFn","stopDrag","beforeDestroy","removeEventListener","editParameter","hasParameter","find","elem","composedPath","updatePosition","pos","saveHistory","updateArguments","removeParameters","hasOutputEdges","select","shiftKey","unselectOthers","div","parameter","refs","parameterName","async","$nextTick","descriptionField","getDragPos","mouse","startDrag","mousePos","getMousePos","delta","abs","drapPos","removeBlock","getBlockParameter","params","isParameterScoped","referenceName","parameterBlock","cbParams","ProcessUtils","cbParam","hiddenParameterRef","globalParam","argName","r","line","Segment","constructor","dx","dy","distance","point1","point2","sqrt","pow","distanceP","point","intersection","alpha","other","a","b","c","d","b0","b1","det","r1","r2","lineWidth","Number","lineColor","position1","position2","segment","scaledLineWidth","lines","xM","yM","PI","cos","sin","cosB","sinB","norm","arrowLength","xA","yA","lineStyle","getLineStyle","arrowStyle","mainLine","getLine","updatePositions","created","pos1","pos2","freeze","dashed","dashLength","color","x1","y1","x2","y2","settings","assign","collide","dp","equals","getDefaultState","blocks","moving","selecting","MARGIN","selectionChangeWatcher","newVal","oldVal","every","selectedBlocks","selectedEdges","Block","Edge","ParameterViewer","processes","parent","parentSchema","historySize","explicitZoom","isMounted","allMounted","newBlockOffset","history","historyPointer","process","hiddenParameterRefEdges","processGraph","nextBlockId","nextEdgeId","clipboard","activeTransactions","min","current","start","processRegistry","ProcessRegistry","count","get","Error","processBlocks","selectedSideEdge","selectedParameter","hasSelection","processParametersFromSchemas","parentParams","getPgParameters","callbackParams","getCallbackParameters","filteredParentParams","p1","p2","concat","importPgParameters","BlocksProcess","import","propagate","undoOnError","updateHiddenParameterRefEdges","checkAllMounted","beforeCreate","$on","msg","showParameterViewer","moveCenter","onDocumentMouseUpFn","onDocumentMouseUp","perfectScale","$el","updateBlockArguments","removedParams","parameterRemoved","$set","commit","refreshEdges","updateBlockDescription","updateBlockPos","updateBlockResult","updateBlockSelected","unselectAll","updateBlockSpec","parameterFields","newBlock","extra","setResultNode","hiddenRefs","getPgParameterById","parameterNames","slice","removeEdge","refreshEdgesFor","$listeners","multiSelect","box","e","export","selectEdge","allInputs","querySelectorAll","el","activeElement","captured","code","deleteSelected","ctrlKey","metaKey","navigator","readText","forEach","parse","writeText","json","dX","dY","deltaScale","sign","deltaY","rect","getBoundingClientRect","top","max","documentElement","scrollTop","body","left","scrollLeft","clientX","clientY","sideSelected","issue","startTransaction","shift","historyStep","step","index","element","getBlockById","foundNewResultNode","hasOtherBlocks","getPositionForPageXY","addBlock","createEdgesForArguments","addProcess","num","incrementId","replace","getBlockSize","getNewBlockDefaultPosition","blockSize","inputs","commentHeight","reset","conflictBlock","otherBlock","findIndex","blockId","b2","allSuccessors","JsonSchemaValidator","outputParameter","explored","exploreList","currentBlock","pop","block1","target","block2","internal","copy","nodeId","parameterBlocks","fn","options","success","undo","error2","clear","setParent","parentProcessId","parentParameterName","allowEmpty","getProcessParameters","importNodes","getStartNodes","importEdges","addPgParameter","getNodes","Promise","all","importEdgesForNode","getArgumentNames","arg","val","getRawArgument","getArgumentType","addEdgeByNames","importEdgeDeep","imported","nextNodes","maxX","getPreviousNodes","prev","getNextNodes","int","parseInt","isNaN","xMin","xMax","yMin","yMax","scaleA","scaleB","selectParameterName","saveCallback","module","exports","w1","h1","w2","h2","lineBox","xb","yb","wb","hb","boxPoint","lineLine","lineToPolygon","polygonPolygon","linePolygon","lineToLine","lineLineThickness","x3","y3","x4","y4","thickness1","thickness2","distanceSquared","xp","yp","tolerance","polygonPoint","points","j","s1_x","s1_y","s2_x","s2_y","s","t","thickness","angle","atan2","half","linePoint","p2x","p2y","p1x","p1y","points1","points2","minA","maxA","projected","minB","maxB","polygons","polygon","i1","i2"],"sourceRoot":""}