{"version":3,"file":"js/4943.9a834b12.js","mappings":"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","sources":["webpack://@openeo/web-editor/./node_modules/@kirtandesai/ol-geocoder/dist/ol-geocoder.js","webpack://@openeo/web-editor/./node_modules/ol-ext/control/Timeline.js","webpack://@openeo/web-editor/./node_modules/ol/DataTile.js","webpack://@openeo/web-editor/./node_modules/ol/xml.js","webpack://@openeo/web-editor/./node_modules/ol/format/XML.js","webpack://@openeo/web-editor/./node_modules/ol/format/xlink.js","webpack://@openeo/web-editor/./node_modules/ol/format/xsd.js","webpack://@openeo/web-editor/./node_modules/ol/format/OWS.js","webpack://@openeo/web-editor/./node_modules/ol/format/WMTSCapabilities.js","webpack://@openeo/web-editor/./node_modules/ol/webgl/TileTexture.js","webpack://@openeo/web-editor/./node_modules/ol/renderer/webgl/TileLayer.js","webpack://@openeo/web-editor/./node_modules/ol/webgl/PaletteTexture.js","webpack://@openeo/web-editor/./node_modules/ol/style/expressions.js","webpack://@openeo/web-editor/./node_modules/ol/layer/WebGLTile.js","webpack://@openeo/web-editor/./node_modules/ol/reproj/DataTile.js","webpack://@openeo/web-editor/./node_modules/ol/source/DataTile.js","webpack://@openeo/web-editor/./node_modules/geotiff/dist-module/pool.js","webpack://@openeo/web-editor/./node_modules/ol/source/GeoTIFF.js","webpack://@openeo/web-editor/./node_modules/ol/uri.js","webpack://@openeo/web-editor/./node_modules/ol/tilegrid/WMTS.js","webpack://@openeo/web-editor/./node_modules/ol/source/WMTS.js"],"sourcesContent":["/*!\n * @kirtandesai/ol-geocoder - v5.0.3\n * A geocoder extension compatible with OpenLayers v7.\n * https://github.com/kirtan-desai/ol-geocoder\n * Built: Thu Nov 17 2022 14:58:35 GMT-0500 (Eastern Standard Time)\n */\n!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t(require(\"ol/control/Control\"),require(\"ol/style/Style\"),require(\"ol/style/Icon\"),require(\"ol/layer/Vector\"),require(\"ol/source/Vector\"),require(\"ol/geom/Point\"),require(\"ol/Feature\"),require(\"ol/proj\")):\"function\"==typeof define&&define.amd?define([\"ol/control/Control\",\"ol/style/Style\",\"ol/style/Icon\",\"ol/layer/Vector\",\"ol/source/Vector\",\"ol/geom/Point\",\"ol/Feature\",\"ol/proj\"],t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).Geocoder=t(e.ol.control.Control,e.ol.style.Style,e.ol.style.Icon,e.ol.layer.Vector,e.ol.source.Vector,e.ol.geom.Point,e.ol.Feature,e.ol.proj)}(this,(function(e,t,s,r,n,o,a,i){\"use strict\";function l(e){return e&&\"object\"==typeof e&&\"default\"in e?e:{default:e}}var c=l(e),d=l(t),u=l(s),p=l(r),h=l(n),m=l(o),g=l(a),y=l(i),f=\"gcd-container\",b=\"gcd-button-control\",w=\"gcd-input-query\",v=\"gcd-input-reset\",$={namespace:\"ol-geocoder\",spin:\"gcd-pseudo-rotate\",hidden:\"gcd-hidden\",address:\"gcd-address\",country:\"gcd-country\",city:\"gcd-city\",road:\"gcd-road\",olControl:\"ol-control\",glass:{container:\"gcd-gl-container\",control:\"gcd-gl-control\",button:\"gcd-gl-btn\",input:\"gcd-gl-input\",expanded:\"gcd-gl-expanded\",reset:\"gcd-gl-reset\",result:\"gcd-gl-result\"},inputText:{container:\"gcd-txt-container\",control:\"gcd-txt-control\",input:\"gcd-txt-input\",reset:\"gcd-txt-reset\",icon:\"gcd-txt-glass\",result:\"gcd-txt-result\"}},k={containerId:f,buttonControlId:b,inputQueryId:w,inputResetId:v,cssClasses:$};const x=Object.freeze({__proto__:null,containerId:f,buttonControlId:b,inputQueryId:w,inputResetId:v,cssClasses:$,default:k}),q=\"addresschosen\",C=\"nominatim\",S=\"reverse\",L=\"glass-button\",j=\"text-input\",E=\"osm\",T=\"mapquest\",N=\"photon\",R=\"bing\",A=\"opencage\",P={provider:E,placeholder:\"Search for an address\",featureStyle:null,targetType:L,lang:\"en-US\",limit:5,keepOpen:!1,preventDefault:!1,autoComplete:!1,autoCompleteMinLength:2,autoCompleteTimeout:200,debug:!1};function I(e,t=\"Assertion failed\"){if(!e){if(\"undefined\"!=typeof Error)throw new Error(t);throw t}}function _(e){const t=function(){if(\"performance\"in window==0&&(window.performance={}),\"now\"in window.performance==0){let e=Date.now();performance.timing&&performance.timing.navigationStart&&(e=performance.timing.navigationStart),window.performance.now=()=>Date.now()-e}return window.performance.now()}().toString(36);return e?e+t:t}function M(e){return/^\\d+$/u.test(e)}function O(e,t,s){if(Array.isArray(e))return void e.forEach((e=>O(e,t)));const r=Array.isArray(t)?t:t.split(/\\s+/u);let n=r.length;for(;n--;)V(e,r[n])||U(e,r[n],s)}function F(e,t,s){if(Array.isArray(e))return void e.forEach((e=>F(e,t,s)));const r=Array.isArray(t)?t:t.split(/\\s+/u);let n=r.length;for(;n--;)V(e,r[n])&&G(e,r[n],s)}function V(e,t){return e.classList?e.classList.contains(t):B(t).test(e.className)}function D(e,t){return e.replace(/\\{\\s*([\\w-]+)\\s*\\}/gu,((e,s)=>{const r=void 0===t[s]?\"\":t[s];return String(r).replaceAll(\"&\",\"&amp;\").replaceAll(\"<\",\"&lt;\").replaceAll(\">\",\"&gt;\").replaceAll('\"',\"&quot;\").replaceAll(\"'\",\"&#039;\")}))}function Q(e,t){let s;if(Array.isArray(e)){if(s=document.createElement(e[0]),e[1].id&&(s.id=e[1].id),e[1].classname&&(s.className=e[1].classname),e[1].attr){const{attr:t}=e[1];if(Array.isArray(t)){let e=-1;for(;++e<t.length;)s.setAttribute(t[e].name,t[e].value)}else s.setAttribute(t.name,t.value)}}else s=document.createElement(e);s.innerHTML=t;const r=document.createDocumentFragment();for(;s.childNodes[0];)r.append(s.childNodes[0]);return s.append(r),s}function B(e){return new RegExp(`(^|\\\\s+) ${e} (\\\\s+|$)`,\"u\")}function U(e,t,s){e.classList?e.classList.add(t):e.className=`${e.className} ${t}`.trim(),s&&M(s)&&window.setTimeout((()=>G(e,t)),s)}function G(e,t,s){e.classList?e.classList.remove(t):e.className=e.className.replace(B(t),\" \").trim(),s&&M(s)&&window.setTimeout((()=>U(e,t)),s)}const z=x.cssClasses;class H{constructor(e){this.options=e,this.els=this.createControl()}createControl(){let e,t,s;return this.options.targetType===j?(t=`${z.namespace} ${z.inputText.container}`,e=Q([\"div\",{id:x.containerId,classname:t}],H.input),s={container:e,control:e.querySelector(`.${z.inputText.control}`),input:e.querySelector(`.${z.inputText.input}`),reset:e.querySelector(`.${z.inputText.reset}`),result:e.querySelector(`.${z.inputText.result}`)}):(t=`${z.namespace} ${z.glass.container}`,e=Q([\"div\",{id:x.containerId,classname:t}],H.glass),s={container:e,control:e.querySelector(`.${z.glass.control}`),button:e.querySelector(`.${z.glass.button}`),input:e.querySelector(`.${z.glass.input}`),reset:e.querySelector(`.${z.glass.reset}`),result:e.querySelector(`.${z.glass.result}`)}),s.input.placeholder=this.options.placeholder,s}}H.glass=`\\n  <div class=\"${z.glass.control} ${z.olControl}\">\\n    <button type=\"button\" id=\"${x.buttonControlId}\" class=\"${z.glass.button}\"></button>\\n    <input type=\"text\" id=\"${x.inputQueryId}\" class=\"${z.glass.input}\" autocomplete=\"off\" placeholder=\"Search ...\">\\n    <a id=\"${x.inputResetId}\" class=\"${z.glass.reset} ${z.hidden}\"></a>\\n  </div>\\n  <ul class=\"${z.glass.result}\"></ul>\\n`,H.input=`\\n  <div class=\"${z.inputText.control}\">\\n    <input type=\"text\" id=\"${x.inputQueryId}\" class=\"${z.inputText.input}\" autocomplete=\"off\" placeholder=\"Search ...\">\\n    <span class=\"${z.inputText.icon}\"></span>\\n    <button type=\"button\" id=\"${x.inputResetId}\" class=\"${z.inputText.reset} ${z.hidden}\"></button>\\n  </div>\\n  <ul class=\"${z.inputText.result}\"></ul>\\n`;class K{constructor(){this.settings={url:\"https://photon.komoot.io/api/\",params:{q:\"\",limit:10,lang:\"en\"},langs:[\"de\",\"it\",\"fr\",\"en\"]}}getParameters(e){return e.lang=e.lang.toLowerCase(),{url:this.settings.url,params:{q:e.query,limit:e.limit||this.settings.params.limit,lang:this.settings.langs.includes(e.lang)?e.lang:this.settings.params.lang}}}handleResponse(e){return 0===e.features.length?[]:e.features.map((e=>({lon:e.geometry.coordinates[0],lat:e.geometry.coordinates[1],address:{name:e.properties.name,postcode:e.properties.postcode,city:e.properties.city,state:e.properties.state,country:e.properties.country},original:{formatted:e.properties.name,details:e.properties}})))}}class J{constructor(){this.settings={url:\"https://nominatim.openstreetmap.org/search/\",params:{q:\"\",format:\"json\",addressdetails:1,limit:10,countrycodes:\"\",\"accept-language\":\"en-US\"}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,format:this.settings.params.format,addressdetails:this.settings.params.addressdetails,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,\"accept-language\":e.lang||this.settings.params[\"accept-language\"]}}}handleResponse(e){return 0===e.length?[]:e.map((e=>({lon:e.lon,lat:e.lat,bbox:e.boundingbox,address:{name:e.display_name,road:e.address.road||\"\",houseNumber:e.address.house_number||\"\",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}})))}}class W{constructor(){this.settings={url:\"https://open.mapquestapi.com/nominatim/v1/search.php\",params:{q:\"\",key:\"\",format:\"json\",addressdetails:1,limit:10,countrycodes:\"\",\"accept-language\":\"en-US\"}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,key:e.key,format:\"json\",addressdetails:1,limit:e.limit||this.settings.params.limit,countrycodes:e.countrycodes||this.settings.params.countrycodes,\"accept-language\":e.lang||this.settings.params[\"accept-language\"]}}}handleResponse(e){return 0===e.length?[]:e.map((e=>({lon:e.lon,lat:e.lat,address:{name:e.address.neighbourhood||\"\",road:e.address.road||\"\",postcode:e.address.postcode,city:e.address.city||e.address.town,state:e.address.state,country:e.address.country},original:{formatted:e.display_name,details:e.address}})))}}class X{constructor(){this.settings={url:\"https://dev.virtualearth.net/REST/v1/Locations\",callbackName:\"jsonp\",params:{query:\"\",key:\"\",includeNeighborhood:0,maxResults:10}}}getParameters(e){return{url:this.settings.url,callbackName:this.settings.callbackName,params:{query:e.query,key:e.key,includeNeighborhood:e.includeNeighborhood||this.settings.params.includeNeighborhood,maxResults:e.maxResults||this.settings.params.maxResults}}}handleResponse(e){const{resources:t}=e.resourceSets[0];return 0===t.length?[]:t.map((e=>({lon:e.point.coordinates[1],lat:e.point.coordinates[0],address:{name:e.name},original:{formatted:e.address.formattedAddress,details:e.address}})))}}class Y{constructor(){this.settings={url:\"https://api.opencagedata.com/geocode/v1/json?\",params:{q:\"\",key:\"\",limit:10,countrycode:\"\",pretty:1,no_annotations:1}}}getParameters(e){return{url:this.settings.url,params:{q:e.query,key:e.key,limit:e.limit||this.settings.params.limit,countrycode:e.countrycodes||this.settings.params.countrycodes}}}handleResponse(e){return 0===e.results.length?[]:e.results.map((e=>({lon:e.geometry.lng,lat:e.geometry.lat,address:{name:e.components.house_number||\"\",road:e.components.road||\"\",postcode:e.components.postcode,city:e.components.city||e.components.town,state:e.components.state,country:e.components.country},original:{formatted:e.formatted,details:e.components}})))}}function Z(e){return new Promise(((t,s)=>{const r=function(e,t){t&&\"object\"==typeof t&&(e+=(/\\?/u.test(e)?\"&\":\"?\")+ee(t));return e}(e.url,e.data),n={method:\"GET\",mode:\"cors\",credentials:\"same-origin\"};e.jsonp?function(e,t,s){const{head:r}=document,n=document.createElement(\"script\"),o=`f${Math.round(Math.random()*Date.now())}`;n.setAttribute(\"src\",`${e+(e.indexOf(\"?\")>0?\"&\":\"?\")+t}=${o}`),window[o]=e=>{window[o]=void 0,setTimeout((()=>r.removeChild(n)),0),s(e)},r.append(n)}(r,e.callbackName,t):fetch(r,n).then((e=>e.json())).then(t).catch(s)}))}function ee(e){return Object.keys(e).reduce(((t,s)=>(t.push(\"object\"==typeof e[s]?ee(e[s]):`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`),t)),[]).join(\"&\")}const te=x.cssClasses;class se{constructor(e,t){this.Base=e,this.layerName=_(\"geocoder-layer-\"),this.layer=new p.default({name:this.layerName,source:new h.default}),this.options=e.options,this.options.provider=\"string\"==typeof this.options.provider?this.options.provider.toLowerCase():this.options.provider,this.provider=this.newProvider(),this.els=t,this.lastQuery=\"\",this.container=this.els.container,this.registeredListeners={mapClick:!1},this.setListeners()}setListeners(){let e,t;const s=e=>{e.stopPropagation(),V(this.els.control,te.glass.expanded)?this.collapse():this.expand()};this.els.input.addEventListener(\"keypress\",(e=>{const t=e.target.value.trim();(e.key?\"Enter\"===e.key:e.which?13===e.which:!!e.keyCode&&13===e.keyCode)&&(e.preventDefault(),this.query(t))}),!1),this.els.input.addEventListener(\"click\",(e=>e.stopPropagation()),!1),this.els.input.addEventListener(\"input\",(s=>{const r=s.target.value.trim();0!==r.length?F(this.els.reset,te.hidden):O(this.els.reset,te.hidden),this.options.autoComplete&&r!==t&&(t=r,e&&clearTimeout(e),e=setTimeout((()=>{r.length>=this.options.autoCompleteMinLength&&this.query(r)}),this.options.autoCompleteTimeout))}),!1),this.els.reset.addEventListener(\"click\",(e=>{this.els.input.focus(),this.els.input.value=\"\",this.lastQuery=\"\",O(this.els.reset,te.hidden),this.clearResults()}),!1),this.options.targetType===L&&this.els.button.addEventListener(\"click\",s,!1)}query(e){this.provider||(this.provider=this.newProvider());const t=this.provider.getParameters({query:e,key:this.options.key,lang:this.options.lang,countrycodes:this.options.countrycodes,limit:this.options.limit});if(this.lastQuery===e&&this.els.result.firstChild)return;this.lastQuery=e,this.clearResults(),O(this.els.reset,te.spin);const s={url:t.url,data:t.params};t.callbackName&&(s.jsonp=!0,s.callbackName=t.callbackName),Z(s).then((e=>{this.options.debug&&console.info(e),F(this.els.reset,te.spin);const t=this.provider.handleResponse(e);t&&(this.createList(t),this.listenMapClick())})).catch((e=>{F(this.els.reset,te.spin);const t=Q(\"li\",\"<h5>Error! No internet connection?</h5>\");this.els.result.append(t)}))}createList(e){const t=this.els.result;e.forEach((e=>{let s;if(this.options.provider===E)s=`<span class=\"${te.road}\">${e.address.name}</span>`;else s=this.addressTemplate(e.address);const r=Q(\"li\",`<a href=\"#\">${s}</a>`);r.addEventListener(\"click\",(t=>{t.preventDefault(),this.chosen(e,s,e.address,e.original)}),!1),t.append(r)}))}chosen(e,t,s,r){const n=this.Base.getMap(),o=[Number.parseFloat(e.lon),Number.parseFloat(e.lat)],a=n.getView().getProjection(),i=y.default.transform(o,\"EPSG:4326\",a);let{bbox:l}=e;l&&(l=y.default.transformExtent([l[2],l[1],l[3],l[0]],\"EPSG:4326\",a));const c={formatted:t,details:s,original:r};if(!1===this.options.keepOpen&&this.clearResults(!0),!0===this.options.preventDefault)this.Base.dispatchEvent({type:q,address:c,coordinate:i,bbox:l,place:e});else{l?n.getView().fit(l,{duration:500}):function(e,t,s=500,r=2.388657133911758){e.getView().animate({duration:s,resolution:r},{duration:s,center:t})}(n,i);const t=this.createFeature(i,c);this.Base.dispatchEvent({type:q,address:c,feature:t,coordinate:i,bbox:l,place:e})}}createFeature(e){const t=new g.default(new m.default(e));return this.addLayer(),t.setStyle(this.options.featureStyle),t.setId(_(\"geocoder-ft-\")),this.getSource().addFeature(t),t}addressTemplate(e){const t=[];return e.name&&t.push(['<span class=\"',te.road,'\">{name}</span>'].join(\"\")),(e.road||e.building||e.house_number)&&t.push(['<span class=\"',te.road,'\">{building} {road} {house_number}</span>'].join(\"\")),(e.city||e.town||e.village)&&t.push(['<span class=\"',te.city,'\">{postcode} {city} {town} {village}</span>'].join(\"\")),(e.state||e.country)&&t.push(['<span class=\"',te.country,'\">{state} {country}</span>'].join(\"\")),D(t.join(\"<br>\"),e)}newProvider(){switch(this.options.provider){case E:return new J;case T:return new W;case N:return new K;case R:return new X;case A:return new Y;default:return this.options.provider}}expand(){F(this.els.input,te.spin),O(this.els.control,te.glass.expanded),window.setTimeout((()=>this.els.input.focus()),100),this.listenMapClick()}collapse(){this.els.input.value=\"\",this.els.input.blur(),O(this.els.reset,te.hidden),F(this.els.control,te.glass.expanded),this.clearResults()}listenMapClick(){if(this.registeredListeners.mapClick)return;const e=this,t=this.Base.getMap().getTargetElement();this.registeredListeners.mapClick=!0,t.addEventListener(\"click\",{handleEvent(s){e.clearResults(!0),t.removeEventListener(s.type,this,!1),e.registeredListeners.mapClick=!1}},!1)}clearResults(e){e&&this.options.targetType===L?this.collapse():function(e){for(;e.firstChild;)e.firstChild.remove()}(this.els.result)}getSource(){return this.layer.getSource()}addLayer(){let e=!1;const t=this.Base.getMap();t.getLayers().forEach((t=>{t===this.layer&&(e=!0)})),e||t.addLayer(this.layer)}}class re extends c.default{constructor(e=C,t={}){let s,r;I(\"string\"==typeof e,\"@param `type` should be string!\"),I(e===C||e===S,`@param 'type' should be '${C}'\\n      or '${S}'!`),I(\"object\"==typeof t,\"@param `options` should be object!\"),P.featureStyle=[new d.default({image:new u.default({scale:.7,src:\"//cdn.rawgit.com/jonataswalker/map-utils/master/images/marker.png\"})})];const n=new H(t);if(e===C&&(s=n.els.container),super({element:s}),!(this instanceof re))return new re;this.options=function(e,t){const s={};return Object.keys(e).forEach((t=>{Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=e[t])})),Object.keys(t).forEach((e=>{Object.prototype.hasOwnProperty.call(t,e)&&(s[e]=t[e])})),s}(P,t),this.container=s,e===C&&(r=new se(this,n.els),this.layer=r.layer)}getLayer(){return this.layer}getSource(){return this.getLayer().getSource()}setProvider(e){this.options.provider=e}setProviderKey(e){this.options.key=e}}return re}));\n//# sourceMappingURL=ol-geocoder.js.map\n","/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\r\nimport ol_source_Vector from 'ol/source/Vector.js'\r\nimport ol_control_Control from 'ol/control/Control.js'\r\nimport ol_ext_element from '../util/element.js'\r\n\r\n/** Timeline control\r\n *\r\n * @constructor\r\n * @extends {ol.control.Control}\r\n * @fires select\r\n * @fires scroll\r\n * @fires collapse\r\n * @param {Object=} options Control options.\r\n *\t@param {String} options.className class of the control\r\n *\t@param {Array<ol.Feature>} options.features Features to show in the timeline\r\n *\t@param {ol.SourceImageOptions.vector} options.source class of the control\r\n *\t@param {Number} options.interval time interval length in ms or a text with a format d, h, mn, s (31 days = '31d'), default none\r\n *\t@param {String} options.maxWidth width of the time line in px, default 2000px\r\n *\t@param {String} options.minDate minimum date \r\n *\t@param {String} options.maxDate maximum date \r\n *\t@param {Number} options.minZoom Minimum zoom for the line, default .2\r\n *\t@param {Number} options.maxZoom Maximum zoom for the line, default 4\r\n *\t@param {boolean} options.zoomButton Are zoom buttons avaliable, default false\r\n *\t@param {function} options.getHTML a function that takes a feature and returns the html to display\r\n *\t@param {function} options.getFeatureDate a function that takes a feature and returns its date, default the date propertie\r\n *\t@param {function} options.endFeatureDate a function that takes a feature and returns its end date, default no end date\r\n *\t@param {String} options.graduation day|month to show month or day graduation, default show only years\r\n *\t@param {String} options.scrollTimeout Time in milliseconds to get a scroll event, default 15ms\r\n */\r\nvar ol_control_Timeline = class olcontrolTimeline extends ol_control_Control {\r\n  constructor(options) {\r\n\r\n    var element = ol_ext_element.create('DIV', {\r\n      className: (options.className || '') + ' ol-timeline'\r\n        + (options.target ? '' : ' ol-unselectable ol-control')\r\n        + (options.zoomButton ? ' ol-hasbutton' : '')\r\n    });\r\n\r\n    // Initialize\r\n    super({\r\n      element: element,\r\n      target: options.target\r\n    });\r\n\r\n    // Scroll div\r\n    this._scrollDiv = ol_ext_element.create('DIV', {\r\n      className: 'ol-scroll',\r\n      parent: this.element\r\n    });\r\n\r\n    // Add a button bar\r\n    this._buttons = ol_ext_element.create('DIV', {\r\n      className: 'ol-buttons',\r\n      parent: this.element\r\n    });\r\n    // Zoom buttons\r\n    if (options.zoomButton) {\r\n      // Zoom in\r\n      this.addButton({\r\n        className: 'ol-zoom-in',\r\n        handleClick: function () {\r\n          var zoom = this.get('zoom');\r\n          if (zoom >= 1) {\r\n            zoom++;\r\n          } else {\r\n            zoom = Math.min(1, zoom + 0.1);\r\n          }\r\n          zoom = Math.round(zoom * 100) / 100;\r\n          this.refresh(zoom);\r\n        }.bind(this)\r\n      });\r\n      // Zoom out\r\n      this.addButton({\r\n        className: 'ol-zoom-out',\r\n        handleClick: function () {\r\n          var zoom = this.get('zoom');\r\n          if (zoom > 1) {\r\n            zoom--;\r\n          } else {\r\n            zoom -= 0.1;\r\n          }\r\n          zoom = Math.round(zoom * 100) / 100;\r\n          this.refresh(zoom);\r\n        }.bind(this)\r\n      });\r\n    }\r\n\r\n    // Draw center date\r\n    this._intervalDiv = ol_ext_element.create('DIV', {\r\n      className: 'ol-center-date',\r\n      parent: this.element\r\n    });\r\n\r\n    // Remove selection\r\n    this.element.addEventListener('mouseover', function () {\r\n      if (this._select)\r\n        this._select.elt.classList.remove('ol-select');\r\n    }.bind(this));\r\n\r\n    // Trigger scroll event\r\n    var scrollListener = null;\r\n    this._scrollDiv.addEventListener('scroll', function () {\r\n      this._setScrollLeft();\r\n      if (scrollListener) {\r\n        clearTimeout(scrollListener);\r\n        scrollListener = null;\r\n      }\r\n      scrollListener = setTimeout(function () {\r\n        this.dispatchEvent({\r\n          type: 'scroll',\r\n          date: this.getDate(),\r\n          dateStart: this.getDate('start'),\r\n          dateEnd: this.getDate('end')\r\n        });\r\n      }.bind(this), options.scrollTimeout || 15);\r\n    }.bind(this));\r\n    // Magic to give \"live\" scroll events on touch devices\r\n    // this._scrollDiv.addEventListener('gesturechange', function() {});\r\n    // Scroll timeline\r\n    ol_ext_element.scrollDiv(this._scrollDiv, {\r\n      onmove: function (b) {\r\n        // Prevent selection on moving\r\n        this._moving = b;\r\n      }.bind(this)\r\n    });\r\n\r\n    this._tline = [];\r\n\r\n    // Parameters\r\n    this._scrollLeft = 0;\r\n    this.set('maxWidth', options.maxWidth || 2000);\r\n    this.set('minDate', options.minDate || Infinity);\r\n    this.set('maxDate', options.maxDate || -Infinity);\r\n    this.set('graduation', options.graduation);\r\n    this.set('minZoom', options.minZoom || .2);\r\n    this.set('maxZoom', options.maxZoom || 4);\r\n    this.setInterval(options.interval);\r\n    if (options.getHTML)\r\n      this._getHTML = options.getHTML;\r\n    if (options.getFeatureDate)\r\n      this._getFeatureDate = options.getFeatureDate;\r\n    if (options.endFeatureDate)\r\n      this._endFeatureDate = options.endFeatureDate;\r\n\r\n    // Feature source \r\n    this.setFeatures(options.features || options.source, options.zoom);\r\n  }\r\n  /**\r\n   * Set the map instance the control is associated with\r\n   * and add interaction attached to it to this map.\r\n   * @param {_ol_Map_} map The map instance.\r\n   */\r\n  setMap(map) {\r\n    super.setMap(map);\r\n    this.refresh(this.get('zoom') || 1, true);\r\n  }\r\n  /** Add a button on the timeline\r\n   * @param {*} button\r\n   *  @param {string} button.className\r\n   *  @param {title} button.className\r\n   *  @param {Element|string} button.html Content of the element\r\n   *  @param {function} button.click a function called when the button is clicked\r\n   */\r\n  addButton(button) {\r\n    this.element.classList.add('ol-hasbutton');\r\n    ol_ext_element.create('BUTTON', {\r\n      className: button.className || undefined,\r\n      title: button.title,\r\n      html: button.html,\r\n      click: button.handleClick,\r\n      parent: this._buttons\r\n    });\r\n  }\r\n  /** Set an interval\r\n   * @param {number|string} length the interval length in ms or a farmatted text ie. end with y, 1d, h, mn, s (31 days = '31d'), default none\r\n   */\r\n  setInterval(length) {\r\n    if (typeof (length) === 'string') {\r\n      if (/s$/.test(length)) {\r\n        length = parseFloat(length) * 1000;\r\n      } else if (/mn$/.test(length)) {\r\n        length = parseFloat(length) * 1000 * 60;\r\n      } else if (/h$/.test(length)) {\r\n        length = parseFloat(length) * 1000 * 3600;\r\n      } else if (/d$/.test(length)) {\r\n        length = parseFloat(length) * 1000 * 3600 * 24;\r\n      } else if (/y$/.test(length)) {\r\n        length = parseFloat(length) * 1000 * 3600 * 24 * 365;\r\n      } else {\r\n        length = 0;\r\n      }\r\n    }\r\n    this.set('interval', length || 0);\r\n    if (length)\r\n      this.element.classList.add('ol-interval');\r\n    else\r\n      this.element.classList.remove('ol-interval');\r\n    this.refresh(this.get('zoom'));\r\n  }\r\n  /** Default html to show in the line\r\n   * @param {ol.Feature} feature\r\n   * @return {DOMElement|string}\r\n   * @private\r\n   */\r\n  _getHTML(feature) {\r\n    return feature.get('name') || '';\r\n  }\r\n  /** Default function to get the date of a feature, returns the date attribute\r\n   * @param {ol.Feature} feature\r\n   * @return {Data|string}\r\n   * @private\r\n   */\r\n  _getFeatureDate(feature) {\r\n    return (feature && feature.get) ? feature.get('date') : null;\r\n  }\r\n  /** Default function to get the end date of a feature, return undefined\r\n   * @param {ol.Feature} feature\r\n   * @return {Data|string}\r\n   * @private\r\n   */\r\n  _endFeatureDate( /* feature */) {\r\n    return undefined;\r\n  }\r\n  /** Is the line collapsed\r\n   * @return {boolean}\r\n   */\r\n  isCollapsed() {\r\n    return this.element.classList.contains('ol-collapsed');\r\n  }\r\n  /** Collapse the line\r\n   * @param {boolean} b\r\n   */\r\n  collapse(b) {\r\n    if (b)\r\n      this.element.classList.add('ol-collapsed');\r\n    else\r\n      this.element.classList.remove('ol-collapsed');\r\n    this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\r\n  }\r\n  /** Collapse the line\r\n   */\r\n  toggle() {\r\n    this.element.classList.toggle('ol-collapsed');\r\n    this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\r\n  }\r\n  /** Set the features to display in the timeline\r\n   * @param {Array<ol.Features>|ol.source.Vector} features An array of features or a vector source\r\n   * @param {number} zoom zoom to draw the line default 1\r\n   */\r\n  setFeatures(features, zoom) {\r\n    this._features = this._source = null;\r\n    if (features instanceof ol_source_Vector)\r\n      this._source = features;\r\n    else if (features instanceof Array)\r\n      this._features = features;\r\n    else\r\n      this._features = [];\r\n    this.refresh(zoom);\r\n  }\r\n  /**\r\n   * Get features\r\n   * @return {Array<ol.Feature>}\r\n   */\r\n  getFeatures() {\r\n    return this._features || this._source.getFeatures();\r\n  }\r\n  /**\r\n   * Refresh the timeline with new data\r\n   * @param {Number} zoom Zoom factor from 0.25 to 10, default 1\r\n   */\r\n  refresh(zoom, first) {\r\n    if (!this.getMap())\r\n      return;\r\n    if (!zoom)\r\n      zoom = this.get('zoom');\r\n    zoom = Math.min(this.get('maxZoom'), Math.max(this.get('minZoom'), zoom || 1));\r\n    this.set('zoom', zoom);\r\n    this._scrollDiv.innerHTML = '';\r\n    var features = this.getFeatures();\r\n    var d, d2;\r\n\r\n    // Get features sorted by date\r\n    var tline = this._tline = [];\r\n    features.forEach(function (f) {\r\n      if (d = this._getFeatureDate(f)) {\r\n        if (!(d instanceof Date)) {\r\n          d = new Date(d);\r\n        }\r\n        if (this._endFeatureDate) {\r\n          d2 = this._endFeatureDate(f);\r\n          if (!(d2 instanceof Date)) {\r\n            d2 = new Date(d2);\r\n          }\r\n        }\r\n        if (!isNaN(d)) {\r\n          tline.push({\r\n            date: d,\r\n            end: isNaN(d2) ? null : d2,\r\n            feature: f\r\n          });\r\n        }\r\n      }\r\n    }.bind(this));\r\n\r\n    tline.sort(function (a, b) {\r\n      return (a.date < b.date ? -1 : (a.date === b.date ? 0 : 1));\r\n    });\r\n\r\n    // Draw\r\n    var div = ol_ext_element.create('DIV', {\r\n      parent: this._scrollDiv\r\n    });\r\n\r\n    // Calculate width\r\n    var min = this._minDate = Math.min(this.get('minDate'), tline.length ? tline[0].date : Infinity);\r\n    var max = this._maxDate = Math.max(this.get('maxDate'), tline.length ? tline[tline.length - 1].date : -Infinity);\r\n    if (!isFinite(min))\r\n      this._minDate = min = new Date();\r\n    if (!isFinite(max))\r\n      this._maxDate = max = new Date();\r\n    var delta = (max - min);\r\n    var maxWidth = this.get('maxWidth');\r\n    var scale = this._scale = (delta > maxWidth ? maxWidth / delta : 1) * zoom;\r\n    // Leave 10px on right\r\n    min = this._minDate = this._minDate - 10 / scale;\r\n    delta = (max - min) * scale;\r\n    ol_ext_element.setStyle(div, {\r\n      width: delta,\r\n      maxWidth: 'unset'\r\n    });\r\n\r\n    // Draw time's bar\r\n    this._drawTime(div, min, max, scale);\r\n\r\n    // Set interval\r\n    if (this.get('interval')) {\r\n      ol_ext_element.setStyle(this._intervalDiv, { width: this.get('interval') * scale });\r\n    } else {\r\n      ol_ext_element.setStyle(this._intervalDiv, { width: '' });\r\n    }\r\n\r\n    // Draw features\r\n    var line = [];\r\n    var lineHeight = ol_ext_element.getStyle(this._scrollDiv, 'lineHeight');\r\n\r\n    // Wrapper\r\n    var fdiv = ol_ext_element.create('DIV', {\r\n      className: 'ol-features',\r\n      parent: div\r\n    });\r\n\r\n    // Add features on the line\r\n    tline.forEach(function (f) {\r\n      var d = f.date;\r\n      var t = f.elt = ol_ext_element.create('DIV', {\r\n        className: 'ol-feature',\r\n        style: {\r\n          left: Math.round((d - min) * scale),\r\n        },\r\n        html: this._getHTML(f.feature),\r\n        parent: fdiv\r\n      });\r\n      // Prevent image dragging\r\n      var img = t.querySelectorAll('img');\r\n      for (var i = 0; i < img.length; i++) {\r\n        img[i].ondragstart = function () { return false; };\r\n      }\r\n\r\n      // Calculate image width\r\n      if (f.end) {\r\n        ol_ext_element.setStyle(t, {\r\n          minWidth: (f.end - d) * scale,\r\n          width: (f.end - d) * scale,\r\n          maxWidth: 'unset'\r\n        });\r\n      }\r\n      var left = ol_ext_element.getStyle(t, 'left');\r\n      // Select on click\r\n      t.addEventListener('click', function () {\r\n        if (!this._moving) {\r\n          this.dispatchEvent({ type: 'select', feature: f.feature });\r\n        }\r\n      }.bind(this));\r\n\r\n      // Find first free Y position\r\n      var pos, l;\r\n      for (pos = 0; l = line[pos]; pos++) {\r\n        if (left > l) {\r\n          break;\r\n        }\r\n      }\r\n      line[pos] = left + ol_ext_element.getStyle(t, 'width');\r\n      ol_ext_element.setStyle(t, { top: pos * lineHeight });\r\n    }.bind(this));\r\n    this._nbline = line.length;\r\n\r\n    if (first)\r\n      this.setDate(this._minDate, { anim: false, position: 'start' });\r\n    // Dispatch scroll event\r\n    this.dispatchEvent({\r\n      type: 'scroll',\r\n      date: this.getDate(),\r\n      dateStart: this.getDate('start'),\r\n      dateEnd: this.getDate('end')\r\n    });\r\n  }\r\n  /** Get offset given a date\r\n   * @param {Date} date\r\n   * @return {number}\r\n   * @private\r\n   */\r\n  _getOffsetFromDate(date) {\r\n    return (date - this._minDate) * this._scale;\r\n  }\r\n  /** Get date given an offset\r\n   * @param {Date} date\r\n   * @return {number}\r\n   * @private\r\n   */\r\n  _getDateFromOffset(offset) {\r\n    return offset / this._scale + this._minDate;\r\n  }\r\n  /** Set the current position\r\n   * @param {number} scrollLeft current position (undefined when scrolling)\r\n   * @returns {number}\r\n   * @private\r\n   */\r\n  _setScrollLeft(scrollLeft) {\r\n    this._scrollLeft = scrollLeft;\r\n    if (scrollLeft !== undefined) {\r\n      this._scrollDiv.scrollLeft = scrollLeft;\r\n    }\r\n  }\r\n  /** Get the current position\r\n   * @returns {number}\r\n   * @private\r\n   */\r\n  _getScrollLeft() {\r\n    // Unset when scrolling\r\n    if (this._scrollLeft === undefined) {\r\n      return this._scrollDiv.scrollLeft;\r\n    } else {\r\n      // St by user\r\n      return this._scrollLeft;\r\n    }\r\n  }\r\n  /**\r\n   * Draw dates on line\r\n   * @private\r\n   */\r\n  _drawTime(div, min, max, scale) {\r\n    // Times div\r\n    var tdiv = ol_ext_element.create('DIV', {\r\n      className: 'ol-times',\r\n      parent: div\r\n    });\r\n    var d, dt, month, dmonth;\r\n    var dx = ol_ext_element.getStyle(tdiv, 'left');\r\n    var heigth = ol_ext_element.getStyle(tdiv, 'height');\r\n    // Year\r\n    var year = (new Date(this._minDate)).getFullYear();\r\n    dt = ((new Date(0)).setFullYear(String(year)) - new Date(0).setFullYear(String(year - 1))) * scale;\r\n    var dyear = Math.round(2 * heigth / dt) + 1;\r\n    while (true) {\r\n      d = new Date(0).setFullYear(year);\r\n      if (d > this._maxDate)\r\n        break;\r\n      ol_ext_element.create('DIV', {\r\n        className: 'ol-time ol-year',\r\n        style: {\r\n          left: this._getOffsetFromDate(d) - dx\r\n        },\r\n        html: year,\r\n        parent: tdiv\r\n      });\r\n      year += dyear;\r\n    }\r\n    // Month\r\n    if (/day|month/.test(this.get('graduation'))) {\r\n      dt = ((new Date(0, 0, 1)).setFullYear(String(year)) - new Date(0, 0, 1).setFullYear(String(year - 1))) * scale;\r\n      dmonth = Math.max(1, Math.round(12 / Math.round(dt / heigth / 2)));\r\n      if (dmonth < 12) {\r\n        year = (new Date(this._minDate)).getFullYear();\r\n        month = dmonth + 1;\r\n        while (true) {\r\n          d = new Date(0, 0, 1);\r\n          d.setFullYear(year);\r\n          d.setMonth(month - 1);\r\n          if (d > this._maxDate)\r\n            break;\r\n          ol_ext_element.create('DIV', {\r\n            className: 'ol-time ol-month',\r\n            style: {\r\n              left: this._getOffsetFromDate(d) - dx\r\n            },\r\n            html: d.toLocaleDateString(undefined, { month: 'short' }),\r\n            parent: tdiv\r\n          });\r\n          month += dmonth;\r\n          if (month > 12) {\r\n            year++;\r\n            month = dmonth + 1;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    // Day\r\n    if (this.get('graduation') === 'day') {\r\n      dt = (new Date(0, 1, 1) - new Date(0, 0, 1)) * scale;\r\n      var dday = Math.max(1, Math.round(31 / Math.round(dt / heigth / 2)));\r\n      if (dday < 31) {\r\n        year = (new Date(this._minDate)).getFullYear();\r\n        month = 0;\r\n        var day = dday;\r\n        while (true) {\r\n          d = new Date(0, 0, 1);\r\n          d.setFullYear(year);\r\n          d.setMonth(month);\r\n          d.setDate(day);\r\n          if (isNaN(d)) {\r\n            month++;\r\n            if (month > 12) {\r\n              month = 1;\r\n              year++;\r\n            }\r\n            day = dday;\r\n          } else {\r\n            if (d > this._maxDate)\r\n              break;\r\n            if (day > 1) {\r\n              var offdate = this._getOffsetFromDate(d);\r\n              if (this._getOffsetFromDate(new Date(year, month + 1, 1)) - offdate > heigth) {\r\n                ol_ext_element.create('DIV', {\r\n                  className: 'ol-time ol-day',\r\n                  style: {\r\n                    left: offdate - dx\r\n                  },\r\n                  html: day,\r\n                  parent: tdiv\r\n                });\r\n              }\r\n            }\r\n            year = d.getFullYear();\r\n            month = d.getMonth();\r\n            day = d.getDate() + dday;\r\n            if (day > new Date(year, month + 1, 0).getDate()) {\r\n              month++;\r\n              day = dday;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  /** Center timeline on a date\r\n   * @param {Date|String|ol.feature} feature a date or a feature with a date\r\n   * @param {Object} options\r\n   *  @param {boolean} options.anim animate scroll\r\n   *  @param {string} options.position start, end or middle, default middle\r\n   */\r\n  setDate(feature, options) {\r\n    var date;\r\n    options = options || {};\r\n    // It's a date\r\n    if (feature instanceof Date) {\r\n      date = feature;\r\n    } else {\r\n      // Get date from Feature\r\n      if (this.getFeatures().indexOf(feature) >= 0) {\r\n        date = this._getFeatureDate(feature);\r\n      }\r\n      if (date && !(date instanceof Date)) {\r\n        date = new Date(date);\r\n      }\r\n      if (!date || isNaN(date)) {\r\n        date = new Date(String(feature));\r\n      }\r\n    }\r\n    if (!isNaN(date)) {\r\n      if (options.anim === false)\r\n        this._scrollDiv.classList.add('ol-move');\r\n      var scrollLeft = this._getOffsetFromDate(date);\r\n      if (options.position === 'start') {\r\n        scrollLeft += ol_ext_element.outerWidth(this._scrollDiv) / 2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n      } else if (options.position === 'end') {\r\n        scrollLeft -= ol_ext_element.outerWidth(this._scrollDiv) / 2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n      }\r\n      this._setScrollLeft(scrollLeft);\r\n      if (options.anim === false)\r\n        this._scrollDiv.classList.remove('ol-move');\r\n      if (feature) {\r\n        for (var i = 0, f; f = this._tline[i]; i++) {\r\n          if (f.feature === feature) {\r\n            f.elt.classList.add('ol-select');\r\n            this._select = f;\r\n          } else {\r\n            f.elt.classList.remove('ol-select');\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  /** Get round date (sticked to mn, hour day or month)\r\n   * @param {Date} d\r\n   * @param {string} stick sticking option to stick date to: 'mn', 'hour', 'day', 'month', default no stick\r\n   * @return {Date}\r\n   */\r\n  roundDate(d, stick) {\r\n    switch (stick) {\r\n      case 'mn': {\r\n        return new Date(this._roundTo(d, 60 * 1000));\r\n      }\r\n      case 'hour': {\r\n        return new Date(this._roundTo(d, 60 * 60 * 1000));\r\n      }\r\n      case 'day': {\r\n        return new Date(this._roundTo(d, 24 * 60 * 60 * 1000));\r\n      }\r\n      case 'month': {\r\n        d = new Date(this._roundTo(d, 24 * 60 * 60 * 1000));\r\n        if (d.getDate() > 15) {\r\n          d = new Date(d.setMonth(d.getMonth() + 1));\r\n        }\r\n        d = d.setDate(1);\r\n        return new Date(d);\r\n      }\r\n      default: return new Date(d);\r\n    }\r\n  }\r\n  /** Get the date of the center\r\n   * @param {string} position position to get 'start', 'end' or 'middle', default middle\r\n   * @param {string} stick sticking option to stick date to: 'mn', 'hour', 'day', 'month', default no stick\r\n   * @return {Date}\r\n   */\r\n  getDate(position, stick) {\r\n    var pos;\r\n    if (!stick)\r\n      stick = position;\r\n    switch (position) {\r\n      case 'start': {\r\n        if (this.get('interval')) {\r\n          pos = -ol_ext_element.getStyle(this._intervalDiv, 'width') / 2 + ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n        } else {\r\n          pos = -ol_ext_element.outerWidth(this._scrollDiv) / 2 + ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n        }\r\n        break;\r\n      }\r\n      case 'end': {\r\n        if (this.get('interval')) {\r\n          pos = ol_ext_element.getStyle(this._intervalDiv, 'width') / 2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n        } else {\r\n          pos = ol_ext_element.outerWidth(this._scrollDiv) / 2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft') / 2;\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        pos = 0;\r\n        break;\r\n      }\r\n    }\r\n    var d = this._getDateFromOffset(this._getScrollLeft() + pos);\r\n    d = this.roundDate(d, stick);\r\n    return new Date(d);\r\n  }\r\n  /** Round number to\r\n   * @param {number} d\r\n   * @param {number} r\r\n   * @return {number}\r\n   * @private\r\n   */\r\n  _roundTo(d, r) {\r\n    return Math.round(d / r) * r;\r\n  }\r\n  /** Get the start date of the control\r\n   * @return {Date}\r\n   */\r\n  getStartDate() {\r\n    return new Date(this.get('minDate'));\r\n  }\r\n  /** Get the end date of the control\r\n   * @return {Date}\r\n   */\r\n  getEndDate() {\r\n    return new Date(this.get('maxDate'));\r\n  }\r\n}\r\n\r\nexport default ol_control_Timeline","/**\n * @module ol/DataTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\n\n/**\n * @typedef {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} ImageLike\n */\n\n/**\n * @typedef {Uint8Array|Uint8ClampedArray|Float32Array|DataView} ArrayLike\n */\n\n/**\n * Data that can be used with a DataTile.\n * @typedef {ArrayLike|ImageLike} Data\n */\n\n/**\n * @param {Data} data Tile data.\n * @return {ImageLike|null} The image-like data.\n */\nexport function asImageLike(data) {\n  return data instanceof Image ||\n    data instanceof HTMLCanvasElement ||\n    data instanceof HTMLVideoElement\n    ? data\n    : null;\n}\n\n/**\n * @param {Data} data Tile data.\n * @return {ArrayLike|null} The array-like data.\n */\nexport function asArrayLike(data) {\n  return data instanceof Uint8Array ||\n    data instanceof Uint8ClampedArray ||\n    data instanceof Float32Array ||\n    data instanceof DataView\n    ? data\n    : null;\n}\n\n/**\n * @type {CanvasRenderingContext2D|null}\n */\nlet sharedContext = null;\n\n/**\n * @param {ImageLike} image The image.\n * @return {Uint8ClampedArray} The data.\n */\nexport function toArray(image) {\n  if (!sharedContext) {\n    sharedContext = createCanvasContext2D(\n      image.width,\n      image.height,\n      undefined,\n      {willReadFrequently: true}\n    );\n  }\n  const canvas = sharedContext.canvas;\n  const width = image.width;\n  if (canvas.width !== width) {\n    canvas.width = width;\n  }\n  const height = image.height;\n  if (canvas.height !== height) {\n    canvas.height = height;\n  }\n  sharedContext.drawImage(image, width, height);\n  return sharedContext.getImageData(0, 0, width, height).data;\n}\n\n/**\n * @type {import('./size.js').Size}\n */\nconst defaultSize = [256, 256];\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @property {function(): Promise<Data>} loader Data loader.  For loaders that generate images,\n * the promise should not resolve until the image is loaded.\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @property {import('./size.js').Size} [size=[256, 256]] Tile size.\n * @api\n */\n\nclass DataTile extends Tile {\n  /**\n   * @param {Options} options Tile options.\n   */\n  constructor(options) {\n    const state = TileState.IDLE;\n\n    super(options.tileCoord, state, {\n      transition: options.transition,\n      interpolate: options.interpolate,\n    });\n\n    /**\n     * @type {function(): Promise<Data>}\n     * @private\n     */\n    this.loader_ = options.loader;\n\n    /**\n     * @type {Data}\n     * @private\n     */\n    this.data_ = null;\n\n    /**\n     * @type {Error}\n     * @private\n     */\n    this.error_ = null;\n\n    /**\n     * @type {import('./size.js').Size|null}\n     * @private\n     */\n    this.size_ = options.size || null;\n  }\n\n  /**\n   * Get the tile size.\n   * @return {import('./size.js').Size} Tile size.\n   */\n  getSize() {\n    if (this.size_) {\n      return this.size_;\n    }\n    const imageData = asImageLike(this.data_);\n    if (imageData) {\n      return [imageData.width, imageData.height];\n    }\n    return defaultSize;\n  }\n\n  /**\n   * Get the data for the tile.\n   * @return {Data} Tile data.\n   * @api\n   */\n  getData() {\n    return this.data_;\n  }\n\n  /**\n   * Get any loading error.\n   * @return {Error} Loading error.\n   * @api\n   */\n  getError() {\n    return this.error_;\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * @api\n   */\n  load() {\n    if (this.state !== TileState.IDLE && this.state !== TileState.ERROR) {\n      return;\n    }\n    this.state = TileState.LOADING;\n    this.changed();\n\n    const self = this;\n    this.loader_()\n      .then(function (data) {\n        self.data_ = data;\n        self.state = TileState.LOADED;\n        self.changed();\n      })\n      .catch(function (error) {\n        self.error_ = error;\n        self.state = TileState.ERROR;\n        self.changed();\n      });\n  }\n}\n\nexport default DataTile;\n","/**\n * @module ol/xml\n */\nimport {extend} from './array.js';\n\n/**\n * When using {@link module:ol/xml.makeChildAppender} or\n * {@link module:ol/xml.makeSimpleNodeFactory}, the top `objectStack` item needs\n * to have this structure.\n * @typedef {Object} NodeStackItem\n * @property {Element} node Node.\n */\n\n/**\n * @typedef {function(Element, Array<*>): void} Parser\n */\n\n/**\n * @typedef {function(Element, *, Array<*>): void} Serializer\n */\n\n/**\n * @type {string}\n */\nexport const XML_SCHEMA_INSTANCE_URI =\n  'http://www.w3.org/2001/XMLSchema-instance';\n\n/**\n * @param {string} namespaceURI Namespace URI.\n * @param {string} qualifiedName Qualified name.\n * @return {Element} Node.\n */\nexport function createElementNS(namespaceURI, qualifiedName) {\n  return getDocument().createElementNS(namespaceURI, qualifiedName);\n}\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @return {string} All text content.\n * @api\n */\nexport function getAllTextContent(node, normalizeWhitespace) {\n  return getAllTextContent_(node, normalizeWhitespace, []).join('');\n}\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @param {Array<string>} accumulator Accumulator.\n * @private\n * @return {Array<string>} Accumulator.\n */\nexport function getAllTextContent_(node, normalizeWhitespace, accumulator) {\n  if (\n    node.nodeType == Node.CDATA_SECTION_NODE ||\n    node.nodeType == Node.TEXT_NODE\n  ) {\n    if (normalizeWhitespace) {\n      accumulator.push(String(node.nodeValue).replace(/(\\r\\n|\\r|\\n)/g, ''));\n    } else {\n      accumulator.push(node.nodeValue);\n    }\n  } else {\n    let n;\n    for (n = node.firstChild; n; n = n.nextSibling) {\n      getAllTextContent_(n, normalizeWhitespace, accumulator);\n    }\n  }\n  return accumulator;\n}\n\n/**\n * @param {Object} object Object.\n * @return {boolean} Is a document.\n */\nexport function isDocument(object) {\n  return 'documentElement' in object;\n}\n\n/**\n * @param {Element} node Node.\n * @param {?string} namespaceURI Namespace URI.\n * @param {string} name Attribute name.\n * @return {string} Value\n */\nexport function getAttributeNS(node, namespaceURI, name) {\n  return node.getAttributeNS(namespaceURI, name) || '';\n}\n\n/**\n * Parse an XML string to an XML Document.\n * @param {string} xml XML.\n * @return {Document} Document.\n * @api\n */\nexport function parse(xml) {\n  return new DOMParser().parseFromString(xml, 'application/xml');\n}\n\n/**\n * Make an array extender function for extending the array at the top of the\n * object stack.\n * @param {function(this: T, Node, Array<*>): (Array<*>|undefined)} valueReader Value reader.\n * @param {T} [thisArg] The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeArrayExtender(valueReader, thisArg) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function (node, objectStack) {\n      const value = valueReader.call(\n        thisArg !== undefined ? thisArg : this,\n        node,\n        objectStack\n      );\n      if (value !== undefined) {\n        const array = /** @type {Array<*>} */ (\n          objectStack[objectStack.length - 1]\n        );\n        extend(array, value);\n      }\n    }\n  );\n}\n\n/**\n * Make an array pusher function for pushing to the array at the top of the\n * object stack.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {T} [thisArg] The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeArrayPusher(valueReader, thisArg) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function (node, objectStack) {\n      const value = valueReader.call(\n        thisArg !== undefined ? thisArg : this,\n        node,\n        objectStack\n      );\n      if (value !== undefined) {\n        const array = /** @type {Array<*>} */ (\n          objectStack[objectStack.length - 1]\n        );\n        array.push(value);\n      }\n    }\n  );\n}\n\n/**\n * Make an object stack replacer function for replacing the object at the\n * top of the stack.\n * @param {function(this: T, Node, Array<*>): *} valueReader Value reader.\n * @param {T} [thisArg] The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeReplacer(valueReader, thisArg) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function (node, objectStack) {\n      const value = valueReader.call(\n        thisArg !== undefined ? thisArg : this,\n        node,\n        objectStack\n      );\n      if (value !== undefined) {\n        objectStack[objectStack.length - 1] = value;\n      }\n    }\n  );\n}\n\n/**\n * Make an object property pusher function for adding a property to the\n * object at the top of the stack.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {string} [property] Property.\n * @param {T} [thisArg] The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertyPusher(valueReader, property, thisArg) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function (node, objectStack) {\n      const value = valueReader.call(\n        thisArg !== undefined ? thisArg : this,\n        node,\n        objectStack\n      );\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (\n          objectStack[objectStack.length - 1]\n        );\n        const name = property !== undefined ? property : node.localName;\n        let array;\n        if (name in object) {\n          array = object[name];\n        } else {\n          array = [];\n          object[name] = array;\n        }\n        array.push(value);\n      }\n    }\n  );\n}\n\n/**\n * Make an object property setter function.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {string} [property] Property.\n * @param {T} [thisArg] The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertySetter(valueReader, property, thisArg) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function (node, objectStack) {\n      const value = valueReader.call(\n        thisArg !== undefined ? thisArg : this,\n        node,\n        objectStack\n      );\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (\n          objectStack[objectStack.length - 1]\n        );\n        const name = property !== undefined ? property : node.localName;\n        object[name] = value;\n      }\n    }\n  );\n}\n\n/**\n * Create a serializer that appends nodes written by its `nodeWriter` to its\n * designated parent. The parent is the `node` of the\n * {@link module:ol/xml~NodeStackItem} at the top of the `objectStack`.\n * @param {function(this: T, Node, V, Array<*>): void} nodeWriter Node writer.\n * @param {T} [thisArg] The object to use as `this` in `nodeWriter`.\n * @return {Serializer} Serializer.\n * @template T, V\n */\nexport function makeChildAppender(nodeWriter, thisArg) {\n  return function (node, value, objectStack) {\n    nodeWriter.call(\n      thisArg !== undefined ? thisArg : this,\n      node,\n      value,\n      objectStack\n    );\n    const parent = /** @type {NodeStackItem} */ (\n      objectStack[objectStack.length - 1]\n    );\n    const parentNode = parent.node;\n    parentNode.appendChild(node);\n  };\n}\n\n/**\n * Create a serializer that calls the provided `nodeWriter` from\n * {@link module:ol/xml.serialize}. This can be used by the parent writer to have the\n * `nodeWriter` called with an array of values when the `nodeWriter` was\n * designed to serialize a single item. An example would be a LineString\n * geometry writer, which could be reused for writing MultiLineString\n * geometries.\n * @param {function(this: T, Element, V, Array<*>): void} nodeWriter Node writer.\n * @param {T} [thisArg] The object to use as `this` in `nodeWriter`.\n * @return {Serializer} Serializer.\n * @template T, V\n */\nexport function makeArraySerializer(nodeWriter, thisArg) {\n  let serializersNS, nodeFactory;\n  return function (node, value, objectStack) {\n    if (serializersNS === undefined) {\n      serializersNS = {};\n      const serializers = {};\n      serializers[node.localName] = nodeWriter;\n      serializersNS[node.namespaceURI] = serializers;\n      nodeFactory = makeSimpleNodeFactory(node.localName);\n    }\n    serialize(serializersNS, nodeFactory, value, objectStack);\n  };\n}\n\n/**\n * Create a node factory which can use the `keys` passed to\n * {@link module:ol/xml.serialize} or {@link module:ol/xml.pushSerializeAndPop} as node names,\n * or a fixed node name. The namespace of the created nodes can either be fixed,\n * or the parent namespace will be used.\n * @param {string} [fixedNodeName] Fixed node name which will be used for all\n *     created nodes. If not provided, the 3rd argument to the resulting node\n *     factory needs to be provided and will be the nodeName.\n * @param {string} [fixedNamespaceURI] Fixed namespace URI which will be used for\n *     all created nodes. If not provided, the namespace of the parent node will\n *     be used.\n * @return {function(*, Array<*>, string=): (Node|undefined)} Node factory.\n */\nexport function makeSimpleNodeFactory(fixedNodeName, fixedNamespaceURI) {\n  return (\n    /**\n     * @param {*} value Value.\n     * @param {Array<*>} objectStack Object stack.\n     * @param {string} [newNodeName] Node name.\n     * @return {Node} Node.\n     */\n    function (value, objectStack, newNodeName) {\n      const context = /** @type {NodeStackItem} */ (\n        objectStack[objectStack.length - 1]\n      );\n      const node = context.node;\n      let nodeName = fixedNodeName;\n      if (nodeName === undefined) {\n        nodeName = newNodeName;\n      }\n\n      const namespaceURI =\n        fixedNamespaceURI !== undefined ? fixedNamespaceURI : node.namespaceURI;\n      return createElementNS(namespaceURI, /** @type {string} */ (nodeName));\n    }\n  );\n}\n\n/**\n * A node factory that creates a node using the parent's `namespaceURI` and the\n * `nodeName` passed by {@link module:ol/xml.serialize} or\n * {@link module:ol/xml.pushSerializeAndPop} to the node factory.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nexport const OBJECT_PROPERTY_NODE_FACTORY = makeSimpleNodeFactory();\n\n/**\n * Create an array of `values` to be used with {@link module:ol/xml.serialize} or\n * {@link module:ol/xml.pushSerializeAndPop}, where `orderedKeys` has to be provided as\n * `key` argument.\n * @param {Object<string, *>} object Key-value pairs for the sequence. Keys can\n *     be a subset of the `orderedKeys`.\n * @param {Array<string>} orderedKeys Keys in the order of the sequence.\n * @return {Array<*>} Values in the order of the sequence. The resulting array\n *     has the same length as the `orderedKeys` array. Values that are not\n *     present in `object` will be `undefined` in the resulting array.\n */\nexport function makeSequence(object, orderedKeys) {\n  const length = orderedKeys.length;\n  const sequence = new Array(length);\n  for (let i = 0; i < length; ++i) {\n    sequence[i] = object[orderedKeys[i]];\n  }\n  return sequence;\n}\n\n/**\n * Create a namespaced structure, using the same values for each namespace.\n * This can be used as a starting point for versioned parsers, when only a few\n * values are version specific.\n * @param {Array<string>} namespaceURIs Namespace URIs.\n * @param {T} structure Structure.\n * @param {Object<string, T>} [structureNS] Namespaced structure to add to.\n * @return {Object<string, T>} Namespaced structure.\n * @template T\n */\nexport function makeStructureNS(namespaceURIs, structure, structureNS) {\n  structureNS = structureNS !== undefined ? structureNS : {};\n  let i, ii;\n  for (i = 0, ii = namespaceURIs.length; i < ii; ++i) {\n    structureNS[namespaceURIs[i]] = structure;\n  }\n  return structureNS;\n}\n\n/**\n * Parse a node using the parsers and object stack.\n * @param {Object<string, Object<string, Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @param {*} [thisArg] The object to use as `this`.\n */\nexport function parseNode(parsersNS, node, objectStack, thisArg) {\n  let n;\n  for (n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const parsers = parsersNS[n.namespaceURI];\n    if (parsers !== undefined) {\n      const parser = parsers[n.localName];\n      if (parser !== undefined) {\n        parser.call(thisArg, n, objectStack);\n      }\n    }\n  }\n}\n\n/**\n * Push an object on top of the stack, parse and return the popped object.\n * @param {T} object Object.\n * @param {Object<string, Object<string, Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @param {*} [thisArg] The object to use as `this`.\n * @return {T} Object.\n * @template T\n */\nexport function pushParseAndPop(object, parsersNS, node, objectStack, thisArg) {\n  objectStack.push(object);\n  parseNode(parsersNS, node, objectStack, thisArg);\n  return /** @type {T} */ (objectStack.pop());\n}\n\n/**\n * Walk through an array of `values` and call a serializer for each value.\n * @param {Object<string, Object<string, Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array<*>} objectStack Node stack.\n * @param {Array<string>} [keys] Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `keys` has\n *     to match the length of `values`. For serializing a sequence, `keys`\n *     determines the order of the sequence.\n * @param {T} [thisArg] The object to use as `this` for the node factory and\n *     serializers.\n * @template T\n */\nexport function serialize(\n  serializersNS,\n  nodeFactory,\n  values,\n  objectStack,\n  keys,\n  thisArg\n) {\n  const length = (keys !== undefined ? keys : values).length;\n  let value, node;\n  for (let i = 0; i < length; ++i) {\n    value = values[i];\n    if (value !== undefined) {\n      node = nodeFactory.call(\n        thisArg !== undefined ? thisArg : this,\n        value,\n        objectStack,\n        keys !== undefined ? keys[i] : undefined\n      );\n      if (node !== undefined) {\n        serializersNS[node.namespaceURI][node.localName].call(\n          thisArg,\n          node,\n          value,\n          objectStack\n        );\n      }\n    }\n  }\n}\n\n/**\n * @param {O} object Object.\n * @param {Object<string, Object<string, Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array<*>} objectStack Node stack.\n * @param {Array<string>} [keys] Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `keys` has\n *     to match the length of `values`. For serializing a sequence, `keys`\n *     determines the order of the sequence.\n * @param {T} [thisArg] The object to use as `this` for the node factory and\n *     serializers.\n * @return {O|undefined} Object.\n * @template O, T\n */\nexport function pushSerializeAndPop(\n  object,\n  serializersNS,\n  nodeFactory,\n  values,\n  objectStack,\n  keys,\n  thisArg\n) {\n  objectStack.push(object);\n  serialize(serializersNS, nodeFactory, values, objectStack, keys, thisArg);\n  return /** @type {O|undefined} */ (objectStack.pop());\n}\n\nlet xmlSerializer_ = undefined;\n\n/**\n * Register a XMLSerializer. Can be used  to inject a XMLSerializer\n * where there is no globally available implementation.\n *\n * @param {XMLSerializer} xmlSerializer A XMLSerializer.\n * @api\n */\nexport function registerXMLSerializer(xmlSerializer) {\n  xmlSerializer_ = xmlSerializer;\n}\n\n/**\n * @return {XMLSerializer} The XMLSerializer.\n */\nexport function getXMLSerializer() {\n  if (xmlSerializer_ === undefined && typeof XMLSerializer !== 'undefined') {\n    xmlSerializer_ = new XMLSerializer();\n  }\n  return xmlSerializer_;\n}\n\nlet document_ = undefined;\n\n/**\n * Register a Document to use when creating nodes for XML serializations. Can be used\n * to inject a Document where there is no globally available implementation.\n *\n * @param {Document} document A Document.\n * @api\n */\nexport function registerDocument(document) {\n  document_ = document;\n}\n\n/**\n * Get a document that should be used when creating nodes for XML serializations.\n * @return {Document} The document.\n */\nexport function getDocument() {\n  if (document_ === undefined && typeof document !== 'undefined') {\n    document_ = document.implementation.createDocument('', '', null);\n  }\n  return document_;\n}\n","/**\n * @module ol/format/XML\n */\nimport {isDocument, parse} from '../xml.js';\n\n/**\n * @classdesc\n * Generic format for reading non-feature XML data\n *\n * @abstract\n */\nclass XML {\n  /**\n   * Read the source document.\n   *\n   * @param {Document|Element|string} source The XML source.\n   * @return {Object} An object representing the source.\n   * @api\n   */\n  read(source) {\n    if (!source) {\n      return null;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readFromDocument(/** @type {Document} */ (source));\n    }\n    return this.readFromNode(/** @type {Element} */ (source));\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {Object} Object\n   */\n  readFromDocument(doc) {\n    for (let n = doc.firstChild; n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readFromNode(/** @type {Element} */ (n));\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @abstract\n   * @param {Element} node Node.\n   * @return {Object} Object\n   */\n  readFromNode(node) {}\n}\n\nexport default XML;\n","/**\n * @module ol/format/xlink\n */\n\n/**\n * @const\n * @type {string}\n */\nconst NAMESPACE_URI = 'http://www.w3.org/1999/xlink';\n\n/**\n * @param {Element} node Node.\n * @return {string|undefined} href.\n */\nexport function readHref(node) {\n  return node.getAttributeNS(NAMESPACE_URI, 'href');\n}\n","/**\n * @module ol/format/xsd\n */\nimport {getAllTextContent, getDocument} from '../xml.js';\nimport {padNumber} from '../string.js';\n\n/**\n * @param {Node} node Node.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBoolean(node) {\n  const s = getAllTextContent(node, false);\n  return readBooleanString(s);\n}\n\n/**\n * @param {string} string String.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBooleanString(string) {\n  const m = /^\\s*(true|1)|(false|0)\\s*$/.exec(string);\n  if (m) {\n    return m[1] !== undefined || false;\n  }\n  return undefined;\n}\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} DateTime in seconds.\n */\nexport function readDateTime(node) {\n  const s = getAllTextContent(node, false);\n  const dateTime = Date.parse(s);\n  return isNaN(dateTime) ? undefined : dateTime / 1000;\n}\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimal(node) {\n  const s = getAllTextContent(node, false);\n  return readDecimalString(s);\n}\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimalString(string) {\n  // FIXME check spec\n  const m = /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*$/i.exec(string);\n  if (m) {\n    return parseFloat(m[1]);\n  }\n  return undefined;\n}\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Non negative integer.\n */\nexport function readPositiveInteger(node) {\n  const s = getAllTextContent(node, false);\n  return readNonNegativeIntegerString(s);\n}\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Non negative integer.\n */\nexport function readNonNegativeIntegerString(string) {\n  const m = /^\\s*(\\d+)\\s*$/.exec(string);\n  if (m) {\n    return parseInt(m[1], 10);\n  }\n  return undefined;\n}\n\n/**\n * @param {Node} node Node.\n * @return {string|undefined} String.\n */\nexport function readString(node) {\n  return getAllTextContent(node, false).trim();\n}\n\n/**\n * @param {Node} node Node to append a TextNode with the boolean to.\n * @param {boolean} bool Boolean.\n */\nexport function writeBooleanTextNode(node, bool) {\n  writeStringTextNode(node, bool ? '1' : '0');\n}\n\n/**\n * @param {Node} node Node to append a CDATA Section with the string to.\n * @param {string} string String.\n */\nexport function writeCDATASection(node, string) {\n  node.appendChild(getDocument().createCDATASection(string));\n}\n\n/**\n * @param {Node} node Node to append a TextNode with the dateTime to.\n * @param {number} dateTime DateTime in seconds.\n */\nexport function writeDateTimeTextNode(node, dateTime) {\n  const date = new Date(dateTime * 1000);\n  const string =\n    date.getUTCFullYear() +\n    '-' +\n    padNumber(date.getUTCMonth() + 1, 2) +\n    '-' +\n    padNumber(date.getUTCDate(), 2) +\n    'T' +\n    padNumber(date.getUTCHours(), 2) +\n    ':' +\n    padNumber(date.getUTCMinutes(), 2) +\n    ':' +\n    padNumber(date.getUTCSeconds(), 2) +\n    'Z';\n  node.appendChild(getDocument().createTextNode(string));\n}\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} decimal Decimal.\n */\nexport function writeDecimalTextNode(node, decimal) {\n  const string = decimal.toPrecision();\n  node.appendChild(getDocument().createTextNode(string));\n}\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} nonNegativeInteger Non negative integer.\n */\nexport function writeNonNegativeIntegerTextNode(node, nonNegativeInteger) {\n  const string = nonNegativeInteger.toString();\n  node.appendChild(getDocument().createTextNode(string));\n}\n\n/**\n * @param {Node} node Node to append a TextNode with the string to.\n * @param {string} string String.\n */\nexport function writeStringTextNode(node, string) {\n  node.appendChild(getDocument().createTextNode(string));\n}\n","/**\n * @module ol/format/OWS\n */\nimport XML from './XML.js';\nimport {\n  makeObjectPropertyPusher,\n  makeObjectPropertySetter,\n  makeStructureNS,\n  pushParseAndPop,\n} from '../xml.js';\nimport {readHref} from './xlink.js';\nimport {readString} from './xsd.js';\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [null, 'http://www.opengis.net/ows/1.1'];\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'ServiceIdentification': makeObjectPropertySetter(readServiceIdentification),\n  'ServiceProvider': makeObjectPropertySetter(readServiceProvider),\n  'OperationsMetadata': makeObjectPropertySetter(readOperationsMetadata),\n});\n\nclass OWS extends XML {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Object} Object\n   */\n  readFromNode(node) {\n    const owsObject = pushParseAndPop({}, PARSERS, node, []);\n    return owsObject ? owsObject : null;\n  }\n}\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ADDRESS_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'DeliveryPoint': makeObjectPropertySetter(readString),\n  'City': makeObjectPropertySetter(readString),\n  'AdministrativeArea': makeObjectPropertySetter(readString),\n  'PostalCode': makeObjectPropertySetter(readString),\n  'Country': makeObjectPropertySetter(readString),\n  'ElectronicMailAddress': makeObjectPropertySetter(readString),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ALLOWED_VALUES_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Value': makeObjectPropertyPusher(readValue),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONSTRAINT_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'AllowedValues': makeObjectPropertySetter(readAllowedValues),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONTACT_INFO_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Phone': makeObjectPropertySetter(readPhone),\n  'Address': makeObjectPropertySetter(readAddress),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst DCP_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'HTTP': makeObjectPropertySetter(readHttp),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst HTTP_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Get': makeObjectPropertyPusher(readGet),\n  'Post': undefined, // TODO\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst OPERATION_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'DCP': makeObjectPropertySetter(readDcp),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst OPERATIONS_METADATA_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Operation': readOperation,\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PHONE_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Voice': makeObjectPropertySetter(readString),\n  'Facsimile': makeObjectPropertySetter(readString),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst REQUEST_METHOD_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Constraint': makeObjectPropertyPusher(readConstraint),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_CONTACT_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'IndividualName': makeObjectPropertySetter(readString),\n  'PositionName': makeObjectPropertySetter(readString),\n  'ContactInfo': makeObjectPropertySetter(readContactInfo),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_IDENTIFICATION_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Abstract': makeObjectPropertySetter(readString),\n  'AccessConstraints': makeObjectPropertySetter(readString),\n  'Fees': makeObjectPropertySetter(readString),\n  'Title': makeObjectPropertySetter(readString),\n  'ServiceTypeVersion': makeObjectPropertySetter(readString),\n  'ServiceType': makeObjectPropertySetter(readString),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_PROVIDER_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'ProviderName': makeObjectPropertySetter(readString),\n  'ProviderSite': makeObjectPropertySetter(readHref),\n  'ServiceContact': makeObjectPropertySetter(readServiceContact),\n});\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The address.\n */\nfunction readAddress(node, objectStack) {\n  return pushParseAndPop({}, ADDRESS_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The values.\n */\nfunction readAllowedValues(node, objectStack) {\n  return pushParseAndPop({}, ALLOWED_VALUES_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The constraint.\n */\nfunction readConstraint(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (!name) {\n    return undefined;\n  }\n  return pushParseAndPop({'name': name}, CONSTRAINT_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The contact info.\n */\nfunction readContactInfo(node, objectStack) {\n  return pushParseAndPop({}, CONTACT_INFO_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The DCP.\n */\nfunction readDcp(node, objectStack) {\n  return pushParseAndPop({}, DCP_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The GET object.\n */\nfunction readGet(node, objectStack) {\n  const href = readHref(node);\n  if (!href) {\n    return undefined;\n  }\n  return pushParseAndPop(\n    {'href': href},\n    REQUEST_METHOD_PARSERS,\n    node,\n    objectStack\n  );\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The HTTP object.\n */\nfunction readHttp(node, objectStack) {\n  return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operation.\n */\nfunction readOperation(node, objectStack) {\n  const name = node.getAttribute('name');\n  const value = pushParseAndPop({}, OPERATION_PARSERS, node, objectStack);\n  if (!value) {\n    return undefined;\n  }\n  const object = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  object[name] = value;\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operations metadata.\n */\nfunction readOperationsMetadata(node, objectStack) {\n  return pushParseAndPop({}, OPERATIONS_METADATA_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The phone.\n */\nfunction readPhone(node, objectStack) {\n  return pushParseAndPop({}, PHONE_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service identification.\n */\nfunction readServiceIdentification(node, objectStack) {\n  return pushParseAndPop({}, SERVICE_IDENTIFICATION_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service contact.\n */\nfunction readServiceContact(node, objectStack) {\n  return pushParseAndPop({}, SERVICE_CONTACT_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service provider.\n */\nfunction readServiceProvider(node, objectStack) {\n  return pushParseAndPop({}, SERVICE_PROVIDER_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {string|undefined} The value.\n */\nfunction readValue(node, objectStack) {\n  return readString(node);\n}\n\nexport default OWS;\n","/**\n * @module ol/format/WMTSCapabilities\n */\nimport OWS from './OWS.js';\nimport XML from './XML.js';\nimport {boundingExtent} from '../extent.js';\nimport {\n  makeArrayPusher,\n  makeObjectPropertyPusher,\n  makeObjectPropertySetter,\n  makeStructureNS,\n  pushParseAndPop,\n} from '../xml.js';\nimport {readDecimal, readPositiveInteger, readString} from './xsd.js';\nimport {readHref} from './xlink.js';\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [null, 'http://www.opengis.net/wmts/1.0'];\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst OWS_NAMESPACE_URIS = [null, 'http://www.opengis.net/ows/1.1'];\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Contents': makeObjectPropertySetter(readContents),\n});\n\n/**\n * @classdesc\n * Format for reading WMTS capabilities data.\n *\n * @api\n */\nclass WMTSCapabilities extends XML {\n  constructor() {\n    super();\n\n    /**\n     * @type {OWS}\n     * @private\n     */\n    this.owsParser_ = new OWS();\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Object} Object\n   */\n  readFromNode(node) {\n    let version = node.getAttribute('version');\n    if (version) {\n      version = version.trim();\n    }\n    let WMTSCapabilityObject = this.owsParser_.readFromNode(node);\n    if (!WMTSCapabilityObject) {\n      return null;\n    }\n    WMTSCapabilityObject['version'] = version;\n    WMTSCapabilityObject = pushParseAndPop(\n      WMTSCapabilityObject,\n      PARSERS,\n      node,\n      []\n    );\n    return WMTSCapabilityObject ? WMTSCapabilityObject : null;\n  }\n}\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONTENTS_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'Layer': makeObjectPropertyPusher(readLayer),\n  'TileMatrixSet': makeObjectPropertyPusher(readTileMatrixSet),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LAYER_PARSERS = makeStructureNS(\n  NAMESPACE_URIS,\n  {\n    'Style': makeObjectPropertyPusher(readStyle),\n    'Format': makeObjectPropertyPusher(readString),\n    'TileMatrixSetLink': makeObjectPropertyPusher(readTileMatrixSetLink),\n    'Dimension': makeObjectPropertyPusher(readDimensions),\n    'ResourceURL': makeObjectPropertyPusher(readResourceUrl),\n  },\n  makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'WGS84BoundingBox': makeObjectPropertySetter(readBoundingBox),\n    'Identifier': makeObjectPropertySetter(readString),\n  })\n);\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS,\n  {\n    'LegendURL': makeObjectPropertyPusher(readLegendUrl),\n  },\n  makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString),\n  })\n);\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LINKS_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'TileMatrixSet': makeObjectPropertySetter(readString),\n  'TileMatrixSetLimits': makeObjectPropertySetter(readTileMatrixLimitsList),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LIMITS_LIST_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'TileMatrixLimits': makeArrayPusher(readTileMatrixLimits),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LIMITS_PARSERS = makeStructureNS(NAMESPACE_URIS, {\n  'TileMatrix': makeObjectPropertySetter(readString),\n  'MinTileRow': makeObjectPropertySetter(readPositiveInteger),\n  'MaxTileRow': makeObjectPropertySetter(readPositiveInteger),\n  'MinTileCol': makeObjectPropertySetter(readPositiveInteger),\n  'MaxTileCol': makeObjectPropertySetter(readPositiveInteger),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst DIMENSION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS,\n  {\n    'Default': makeObjectPropertySetter(readString),\n    'Value': makeObjectPropertyPusher(readString),\n  },\n  makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString),\n  })\n);\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst WGS84_BBOX_READERS = makeStructureNS(OWS_NAMESPACE_URIS, {\n  'LowerCorner': makeArrayPusher(readCoordinates),\n  'UpperCorner': makeArrayPusher(readCoordinates),\n});\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS,\n  {\n    'WellKnownScaleSet': makeObjectPropertySetter(readString),\n    'TileMatrix': makeObjectPropertyPusher(readTileMatrix),\n  },\n  makeStructureNS(OWS_NAMESPACE_URIS, {\n    'SupportedCRS': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString),\n    'BoundingBox': makeObjectPropertySetter(readBoundingBox),\n  })\n);\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TM_PARSERS = makeStructureNS(\n  NAMESPACE_URIS,\n  {\n    'TopLeftCorner': makeObjectPropertySetter(readCoordinates),\n    'ScaleDenominator': makeObjectPropertySetter(readDecimal),\n    'TileWidth': makeObjectPropertySetter(readPositiveInteger),\n    'TileHeight': makeObjectPropertySetter(readPositiveInteger),\n    'MatrixWidth': makeObjectPropertySetter(readPositiveInteger),\n    'MatrixHeight': makeObjectPropertySetter(readPositiveInteger),\n  },\n  makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString),\n  })\n);\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Attribution object.\n */\nfunction readContents(node, objectStack) {\n  return pushParseAndPop({}, CONTENTS_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Layers object.\n */\nfunction readLayer(node, objectStack) {\n  return pushParseAndPop({}, LAYER_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set object.\n */\nfunction readTileMatrixSet(node, objectStack) {\n  return pushParseAndPop({}, TMS_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Style object.\n */\nfunction readStyle(node, objectStack) {\n  const style = pushParseAndPop({}, STYLE_PARSERS, node, objectStack);\n  if (!style) {\n    return undefined;\n  }\n  const isDefault = node.getAttribute('isDefault') === 'true';\n  style['isDefault'] = isDefault;\n  return style;\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set Link object.\n */\nfunction readTileMatrixSetLink(node, objectStack) {\n  return pushParseAndPop({}, TMS_LINKS_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Dimension object.\n */\nfunction readDimensions(node, objectStack) {\n  return pushParseAndPop({}, DIMENSION_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Resource URL object.\n */\nfunction readResourceUrl(node, objectStack) {\n  const format = node.getAttribute('format');\n  const template = node.getAttribute('template');\n  const resourceType = node.getAttribute('resourceType');\n  const resource = {};\n  if (format) {\n    resource['format'] = format;\n  }\n  if (template) {\n    resource['template'] = template;\n  }\n  if (resourceType) {\n    resource['resourceType'] = resourceType;\n  }\n  return resource;\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} BBox object.\n */\nfunction readBoundingBox(node, objectStack) {\n  const coordinates = pushParseAndPop(\n    [],\n    WGS84_BBOX_READERS,\n    node,\n    objectStack\n  );\n  if (coordinates.length != 2) {\n    return undefined;\n  }\n  return boundingExtent(coordinates);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Legend object.\n */\nfunction readLegendUrl(node, objectStack) {\n  const legend = {};\n  legend['format'] = node.getAttribute('format');\n  legend['href'] = readHref(node);\n  return legend;\n}\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Coordinates object.\n */\nfunction readCoordinates(node, objectStack) {\n  const coordinates = readString(node).split(/\\s+/);\n  if (!coordinates || coordinates.length != 2) {\n    return undefined;\n  }\n  const x = +coordinates[0];\n  const y = +coordinates[1];\n  if (isNaN(x) || isNaN(y)) {\n    return undefined;\n  }\n  return [x, y];\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrix object.\n */\nfunction readTileMatrix(node, objectStack) {\n  return pushParseAndPop({}, TM_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixSetLimits Object.\n */\nfunction readTileMatrixLimitsList(node, objectStack) {\n  return pushParseAndPop([], TMS_LIMITS_LIST_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixLimits Array.\n */\nfunction readTileMatrixLimits(node, objectStack) {\n  return pushParseAndPop({}, TMS_LIMITS_PARSERS, node, objectStack);\n}\n\nexport default WMTSCapabilities;\n","/**\n * @module ol/webgl/TileTexture\n */\n\nimport DataTile, {asArrayLike, asImageLike} from '../DataTile.js';\nimport EventTarget from '../events/Target.js';\nimport EventType from '../events/EventType.js';\nimport ImageTile from '../ImageTile.js';\nimport ReprojTile from '../reproj/Tile.js';\nimport TileState from '../TileState.js';\nimport WebGLArrayBuffer from './Buffer.js';\nimport {ARRAY_BUFFER, STATIC_DRAW} from '../webgl.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {toSize} from '../size.js';\n\n/**\n * @param {WebGLRenderingContext} gl The WebGL context.\n * @param {WebGLTexture} texture The texture.\n * @param {boolean} interpolate Interpolate when resampling.\n */\nfunction bindAndConfigure(gl, texture, interpolate) {\n  const resampleFilter = interpolate ? gl.LINEAR : gl.NEAREST;\n  gl.bindTexture(gl.TEXTURE_2D, texture);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, resampleFilter);\n  gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, resampleFilter);\n}\n\n/**\n * @param {WebGLRenderingContext} gl The WebGL context.\n * @param {WebGLTexture} texture The texture.\n * @param {import(\"../DataTile.js\").ImageLike} image The image.\n * @param {boolean} interpolate Interpolate when resampling.\n */\nfunction uploadImageTexture(gl, texture, image, interpolate) {\n  bindAndConfigure(gl, texture, interpolate);\n\n  gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n}\n\n/**\n * @param {import(\"./Helper.js\").default} helper The WebGL helper.\n * @param {WebGLTexture} texture The texture.\n * @param {import(\"../DataTile.js\").ArrayLike} data The pixel data.\n * @param {import(\"../size.js\").Size} size The pixel size.\n * @param {number} bandCount The band count.\n * @param {boolean} interpolate Interpolate when resampling.\n */\nfunction uploadDataTexture(\n  helper,\n  texture,\n  data,\n  size,\n  bandCount,\n  interpolate\n) {\n  const gl = helper.getGL();\n  let textureType;\n  let canInterpolate;\n  if (data instanceof Float32Array) {\n    textureType = gl.FLOAT;\n    helper.getExtension('OES_texture_float');\n    const extension = helper.getExtension('OES_texture_float_linear');\n    canInterpolate = extension !== null;\n  } else {\n    textureType = gl.UNSIGNED_BYTE;\n    canInterpolate = true;\n  }\n  bindAndConfigure(gl, texture, interpolate && canInterpolate);\n\n  const bytesPerRow = data.byteLength / size[1];\n  let unpackAlignment = 1;\n  if (bytesPerRow % 8 === 0) {\n    unpackAlignment = 8;\n  } else if (bytesPerRow % 4 === 0) {\n    unpackAlignment = 4;\n  } else if (bytesPerRow % 2 === 0) {\n    unpackAlignment = 2;\n  }\n\n  let format;\n  switch (bandCount) {\n    case 1: {\n      format = gl.LUMINANCE;\n      break;\n    }\n    case 2: {\n      format = gl.LUMINANCE_ALPHA;\n      break;\n    }\n    case 3: {\n      format = gl.RGB;\n      break;\n    }\n    case 4: {\n      format = gl.RGBA;\n      break;\n    }\n    default: {\n      throw new Error(`Unsupported number of bands: ${bandCount}`);\n    }\n  }\n\n  const oldUnpackAlignment = gl.getParameter(gl.UNPACK_ALIGNMENT);\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, unpackAlignment);\n  gl.texImage2D(\n    gl.TEXTURE_2D,\n    0,\n    format,\n    size[0],\n    size[1],\n    0,\n    format,\n    textureType,\n    data\n  );\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, oldUnpackAlignment);\n}\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nlet pixelContext = null;\n\nfunction createPixelContext() {\n  pixelContext = createCanvasContext2D(1, 1, undefined, {\n    willReadFrequently: true,\n  });\n}\n\n/**\n * @typedef {import(\"../DataTile.js\").default|ImageTile|ReprojTile} TileType\n */\n\n/**\n * @typedef {Object} Options\n * @property {TileType} tile The tile.\n * @property {import(\"../tilegrid/TileGrid.js\").default} grid Tile grid.\n * @property {import(\"../webgl/Helper.js\").default} helper WebGL helper.\n * @property {number} [gutter=0] The size in pixels of the gutter around image tiles to ignore.\n */\n\nclass TileTexture extends EventTarget {\n  /**\n   * @param {Options} options The tile texture options.\n   */\n  constructor(options) {\n    super();\n\n    /**\n     * @type {TileType}\n     */\n    this.tile;\n\n    /**\n     * @type {Array<WebGLTexture>}\n     */\n    this.textures = [];\n    this.handleTileChange_ = this.handleTileChange_.bind(this);\n\n    /**\n     * @type {import(\"../size.js\").Size}\n     * @private\n     */\n    this.renderSize_ = toSize(\n      options.grid.getTileSize(options.tile.tileCoord[0])\n    );\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.gutter_ = options.gutter || 0;\n\n    /**\n     * @type {number}\n     */\n    this.bandCount = NaN;\n\n    /**\n     * @type {import(\"../webgl/Helper.js\").default}\n     * @private\n     */\n    this.helper_ = options.helper;\n\n    const coords = new WebGLArrayBuffer(ARRAY_BUFFER, STATIC_DRAW);\n    coords.fromArray([\n      0, // P0\n      1,\n      1, // P1\n      1,\n      1, // P2\n      0,\n      0, // P3\n      0,\n    ]);\n    this.helper_.flushBufferData(coords);\n\n    /**\n     * @type {WebGLArrayBuffer}\n     */\n    this.coords = coords;\n\n    this.setTile(options.tile);\n  }\n\n  /**\n   * @param {TileType} tile Tile.\n   */\n  setTile(tile) {\n    if (tile !== this.tile) {\n      if (this.tile) {\n        this.tile.removeEventListener(EventType.CHANGE, this.handleTileChange_);\n      }\n      this.tile = tile;\n      this.textures.length = 0;\n      this.loaded = tile.getState() === TileState.LOADED;\n      if (this.loaded) {\n        this.uploadTile_();\n      } else {\n        if (tile instanceof ImageTile) {\n          const image = tile.getImage();\n          if (image instanceof Image && !image.crossOrigin) {\n            image.crossOrigin = 'anonymous';\n          }\n        }\n        tile.addEventListener(EventType.CHANGE, this.handleTileChange_);\n      }\n    }\n  }\n\n  uploadTile_() {\n    const helper = this.helper_;\n    const gl = helper.getGL();\n    const tile = this.tile;\n\n    /**\n     * @type {import(\"../DataTile.js\").Data}\n     */\n    let data;\n\n    if (tile instanceof ImageTile || tile instanceof ReprojTile) {\n      data = tile.getImage();\n    } else {\n      data = tile.getData();\n    }\n\n    const image = asImageLike(data);\n    if (image) {\n      const texture = gl.createTexture();\n      this.textures.push(texture);\n      this.bandCount = 4;\n      uploadImageTexture(gl, texture, image, tile.interpolate);\n      return;\n    }\n\n    data = asArrayLike(data);\n\n    const sourceTileSize = /** @type {DataTile} */ (tile).getSize();\n    const pixelSize = [\n      sourceTileSize[0] + 2 * this.gutter_,\n      sourceTileSize[1] + 2 * this.gutter_,\n    ];\n    const isFloat = data instanceof Float32Array;\n    const pixelCount = pixelSize[0] * pixelSize[1];\n    const DataType = isFloat ? Float32Array : Uint8Array;\n    const bytesPerElement = DataType.BYTES_PER_ELEMENT;\n    const bytesPerRow = data.byteLength / pixelSize[1];\n\n    this.bandCount = Math.floor(bytesPerRow / bytesPerElement / pixelSize[0]);\n    const textureCount = Math.ceil(this.bandCount / 4);\n\n    if (textureCount === 1) {\n      const texture = gl.createTexture();\n      this.textures.push(texture);\n      uploadDataTexture(\n        helper,\n        texture,\n        data,\n        pixelSize,\n        this.bandCount,\n        tile.interpolate\n      );\n      return;\n    }\n\n    const textureDataArrays = new Array(textureCount);\n    for (let textureIndex = 0; textureIndex < textureCount; ++textureIndex) {\n      const texture = gl.createTexture();\n      this.textures.push(texture);\n\n      const bandCount =\n        textureIndex < textureCount - 1 ? 4 : ((this.bandCount - 1) % 4) + 1;\n      textureDataArrays[textureIndex] = new DataType(pixelCount * bandCount);\n    }\n\n    let dataIndex = 0;\n    let rowOffset = 0;\n    const colCount = pixelSize[0] * this.bandCount;\n    for (let rowIndex = 0; rowIndex < pixelSize[1]; ++rowIndex) {\n      for (let colIndex = 0; colIndex < colCount; ++colIndex) {\n        const dataValue = data[rowOffset + colIndex];\n\n        const pixelIndex = Math.floor(dataIndex / this.bandCount);\n        const bandIndex = colIndex % this.bandCount;\n        const textureIndex = Math.floor(bandIndex / 4);\n        const textureData = textureDataArrays[textureIndex];\n        const bandCount = textureData.length / pixelCount;\n        const textureBandIndex = bandIndex % 4;\n        textureData[pixelIndex * bandCount + textureBandIndex] = dataValue;\n\n        ++dataIndex;\n      }\n      rowOffset += bytesPerRow / bytesPerElement;\n    }\n\n    for (let textureIndex = 0; textureIndex < textureCount; ++textureIndex) {\n      const texture = this.textures[textureIndex];\n      const textureData = textureDataArrays[textureIndex];\n      const bandCount = textureData.length / pixelCount;\n      uploadDataTexture(\n        helper,\n        texture,\n        textureData,\n        pixelSize,\n        bandCount,\n        tile.interpolate\n      );\n    }\n  }\n\n  handleTileChange_() {\n    if (this.tile.getState() === TileState.LOADED) {\n      this.loaded = true;\n      this.uploadTile_();\n      this.dispatchEvent(EventType.CHANGE);\n    }\n  }\n\n  disposeInternal() {\n    const gl = this.helper_.getGL();\n    this.helper_.deleteBuffer(this.coords);\n    for (let i = 0; i < this.textures.length; ++i) {\n      gl.deleteTexture(this.textures[i]);\n    }\n    this.tile.removeEventListener(EventType.CHANGE, this.handleTileChange_);\n  }\n\n  /**\n   * @param {import(\"../DataTile.js\").ImageLike} image The image.\n   * @param {number} renderCol The column index (in rendered tile space).\n   * @param {number} renderRow The row index (in rendered tile space).\n   * @return {Uint8ClampedArray|null} The data.\n   * @private\n   */\n  getImagePixelData_(image, renderCol, renderRow) {\n    const gutter = this.gutter_;\n    const renderWidth = this.renderSize_[0];\n    const renderHeight = this.renderSize_[1];\n\n    if (!pixelContext) {\n      createPixelContext();\n    }\n    pixelContext.clearRect(0, 0, 1, 1);\n\n    const sourceWidth = image.width;\n    const sourceHeight = image.height;\n\n    const sourceWidthWithoutGutter = sourceWidth - 2 * gutter;\n    const sourceHeightWithoutGutter = sourceHeight - 2 * gutter;\n\n    const sourceCol =\n      gutter + Math.floor(sourceWidthWithoutGutter * (renderCol / renderWidth));\n\n    const sourceRow =\n      gutter +\n      Math.floor(sourceHeightWithoutGutter * (renderRow / renderHeight));\n\n    let data;\n    try {\n      pixelContext.drawImage(image, sourceCol, sourceRow, 1, 1, 0, 0, 1, 1);\n      data = pixelContext.getImageData(0, 0, 1, 1).data;\n    } catch (err) {\n      pixelContext = null;\n      return null;\n    }\n    return data;\n  }\n\n  /**\n   * @param {import(\"../DataTile.js\").ArrayLike} data The data.\n   * @param {import(\"../size.js\").Size} sourceSize The size.\n   * @param {number} renderCol The column index (in rendered tile space).\n   * @param {number} renderRow The row index (in rendered tile space).\n   * @return {import(\"../DataTile.js\").ArrayLike|null} The data.\n   * @private\n   */\n  getArrayPixelData_(data, sourceSize, renderCol, renderRow) {\n    const gutter = this.gutter_;\n    const renderWidth = this.renderSize_[0];\n    const renderHeight = this.renderSize_[1];\n\n    const sourceWidthWithoutGutter = sourceSize[0];\n    const sourceHeightWithoutGutter = sourceSize[1];\n    const sourceWidth = sourceWidthWithoutGutter + 2 * gutter;\n    const sourceHeight = sourceHeightWithoutGutter + 2 * gutter;\n\n    const sourceCol =\n      gutter + Math.floor(sourceWidthWithoutGutter * (renderCol / renderWidth));\n\n    const sourceRow =\n      gutter +\n      Math.floor(sourceHeightWithoutGutter * (renderRow / renderHeight));\n\n    if (data instanceof DataView) {\n      const bytesPerPixel = data.byteLength / (sourceWidth * sourceHeight);\n      const offset = bytesPerPixel * (sourceRow * sourceWidth + sourceCol);\n      const buffer = data.buffer.slice(offset, offset + bytesPerPixel);\n      return new DataView(buffer);\n    }\n\n    const offset = this.bandCount * (sourceRow * sourceWidth + sourceCol);\n    return data.slice(offset, offset + this.bandCount);\n  }\n\n  /**\n   * Get data for a pixel.  If the tile is not loaded, null is returned.\n   * @param {number} renderCol The column index (in rendered tile space).\n   * @param {number} renderRow The row index (in rendered tile space).\n   * @return {import(\"../DataTile.js\").ArrayLike|null} The data.\n   */\n  getPixelData(renderCol, renderRow) {\n    if (!this.loaded) {\n      return null;\n    }\n\n    if (this.tile instanceof DataTile) {\n      const data = this.tile.getData();\n      const arrayData = asArrayLike(data);\n      if (arrayData) {\n        const sourceSize = this.tile.getSize();\n        return this.getArrayPixelData_(\n          arrayData,\n          sourceSize,\n          renderCol,\n          renderRow\n        );\n      }\n      return this.getImagePixelData_(asImageLike(data), renderCol, renderRow);\n    }\n\n    return this.getImagePixelData_(this.tile.getImage(), renderCol, renderRow);\n  }\n}\n\nexport default TileTexture;\n","/**\n * @module ol/renderer/webgl/TileLayer\n */\nimport LRUCache from '../../structs/LRUCache.js';\nimport ReprojDataTile from '../../reproj/DataTile.js';\nimport ReprojTile from '../../reproj/Tile.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport TileTexture from '../../webgl/TileTexture.js';\nimport WebGLArrayBuffer from '../../webgl/Buffer.js';\nimport WebGLLayerRenderer from './Layer.js';\nimport {AttributeType} from '../../webgl/Helper.js';\nimport {ELEMENT_ARRAY_BUFFER, STATIC_DRAW} from '../../webgl.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform,\n  translate as translateTransform,\n} from '../../transform.js';\nimport {ascending} from '../../array.js';\nimport {\n  boundingExtent,\n  containsCoordinate,\n  getIntersection,\n  isEmpty,\n} from '../../extent.js';\nimport {\n  create as createMat4,\n  fromTransform as mat4FromTransform,\n} from '../../vec/mat4.js';\nimport {\n  createOrUpdate as createTileCoord,\n  getKey as getTileCoordKey,\n} from '../../tilecoord.js';\nimport {fromUserExtent} from '../../proj.js';\nimport {getUid} from '../../util.js';\nimport {toSize} from '../../size.js';\n\nexport const Uniforms = {\n  TILE_TEXTURE_ARRAY: 'u_tileTextures',\n  TILE_TRANSFORM: 'u_tileTransform',\n  TRANSITION_ALPHA: 'u_transitionAlpha',\n  DEPTH: 'u_depth',\n  TEXTURE_PIXEL_WIDTH: 'u_texturePixelWidth',\n  TEXTURE_PIXEL_HEIGHT: 'u_texturePixelHeight',\n  TEXTURE_RESOLUTION: 'u_textureResolution', // map units per texture pixel\n  TEXTURE_ORIGIN_X: 'u_textureOriginX', // map x coordinate of left edge of texture\n  TEXTURE_ORIGIN_Y: 'u_textureOriginY', // map y coordinate of top edge of texture\n  RENDER_EXTENT: 'u_renderExtent', // intersection of layer, source, and view extent\n  RESOLUTION: 'u_resolution',\n  ZOOM: 'u_zoom',\n};\n\nexport const Attributes = {\n  TEXTURE_COORD: 'a_textureCoord',\n};\n\n/**\n * @type {Array<import('../../webgl/Helper.js').AttributeDescription>}\n */\nconst attributeDescriptions = [\n  {\n    name: Attributes.TEXTURE_COORD,\n    size: 2,\n    type: AttributeType.FLOAT,\n  },\n];\n\n/**\n * @type {Object<string, boolean>}\n */\nconst empty = {};\n\n/**\n * Transform a zoom level into a depth value ranging from -1 to 1.\n * @param {number} z A zoom level.\n * @return {number} A depth value.\n */\nfunction depthForZ(z) {\n  return 2 * (1 - 1 / (z + 1)) - 1;\n}\n\n/**\n * Add a tile texture to the lookup.\n * @param {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>} tileTexturesByZ Lookup of\n * tile textures by zoom level.\n * @param {import(\"../../webgl/TileTexture.js\").default} tileTexture A tile texture.\n * @param {number} z The zoom level.\n */\nfunction addTileTextureToLookup(tileTexturesByZ, tileTexture, z) {\n  if (!(z in tileTexturesByZ)) {\n    tileTexturesByZ[z] = [];\n  }\n  tileTexturesByZ[z].push(tileTexture);\n}\n\n/**\n * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n * @param {import(\"../../extent.js\").Extent} extent The frame extent.\n * @return {import(\"../../extent.js\").Extent} Frame extent intersected with layer extents.\n */\nfunction getRenderExtent(frameState, extent) {\n  const layerState = frameState.layerStatesArray[frameState.layerIndex];\n  if (layerState.extent) {\n    extent = getIntersection(\n      extent,\n      fromUserExtent(layerState.extent, frameState.viewState.projection)\n    );\n  }\n  const source = /** @type {import(\"../../source/Tile.js\").default} */ (\n    layerState.layer.getRenderSource()\n  );\n  if (!source.getWrapX()) {\n    const gridExtent = source\n      .getTileGridForProjection(frameState.viewState.projection)\n      .getExtent();\n    if (gridExtent) {\n      extent = getIntersection(extent, gridExtent);\n    }\n  }\n  return extent;\n}\n\nfunction getCacheKey(source, tileCoord) {\n  return `${source.getKey()},${getTileCoordKey(tileCoord)}`;\n}\n\n/**\n * @typedef {Object} Options\n * @property {string} vertexShader Vertex shader source.\n * @property {string} fragmentShader Fragment shader source.\n * @property {Object<string, import(\"../../webgl/Helper\").UniformValue>} [uniforms] Additional uniforms\n * made available to shaders.\n * @property {Array<import(\"../../webgl/PaletteTexture.js\").default>} [paletteTextures] Palette textures.\n * @property {number} [cacheSize=512] The texture cache size.\n */\n\n/**\n * @typedef {import(\"../../layer/WebGLTile.js\").default} LayerType\n */\n\n/**\n * @classdesc\n * WebGL renderer for tile layers.\n * @extends {WebGLLayerRenderer<LayerType>}\n * @api\n */\nclass WebGLTileLayerRenderer extends WebGLLayerRenderer {\n  /**\n   * @param {LayerType} tileLayer Tile layer.\n   * @param {Options} options Options.\n   */\n  constructor(tileLayer, options) {\n    super(tileLayer, {\n      uniforms: options.uniforms,\n    });\n\n    /**\n     * The last call to `renderFrame` was completed with all tiles loaded\n     * @type {boolean}\n     */\n    this.renderComplete = false;\n\n    /**\n     * This transform converts texture coordinates to screen coordinates.\n     * @type {import(\"../../transform.js\").Transform}\n     * @private\n     */\n    this.tileTransform_ = createTransform();\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.tempMat4_ = createMat4();\n\n    /**\n     * @type {import(\"../../TileRange.js\").default}\n     * @private\n     */\n    this.tempTileRange_ = new TileRange(0, 0, 0, 0);\n\n    /**\n     * @type {import(\"../../tilecoord.js\").TileCoord}\n     * @private\n     */\n    this.tempTileCoord_ = createTileCoord(0, 0, 0);\n\n    /**\n     * @type {import(\"../../size.js\").Size}\n     * @private\n     */\n    this.tempSize_ = [0, 0];\n\n    /**\n     * @type {WebGLProgram}\n     * @private\n     */\n    this.program_;\n\n    /**\n     * @private\n     */\n    this.vertexShader_ = options.vertexShader;\n\n    /**\n     * @private\n     */\n    this.fragmentShader_ = options.fragmentShader;\n\n    /**\n     * Tiles are rendered as a quad with the following structure:\n     *\n     *  [P3]---------[P2]\n     *   |`           |\n     *   |  `     B   |\n     *   |    `       |\n     *   |      `     |\n     *   |   A    `   |\n     *   |          ` |\n     *  [P0]---------[P1]\n     *\n     * Triangle A: P0, P1, P3\n     * Triangle B: P1, P2, P3\n     *\n     * @private\n     */\n    this.indices_ = new WebGLArrayBuffer(ELEMENT_ARRAY_BUFFER, STATIC_DRAW);\n    this.indices_.fromArray([0, 1, 3, 1, 2, 3]);\n\n    const cacheSize = options.cacheSize !== undefined ? options.cacheSize : 512;\n\n    /**\n     * @type {import(\"../../structs/LRUCache.js\").default<import(\"../../webgl/TileTexture.js\").default>}\n     * @private\n     */\n    this.tileTextureCache_ = new LRUCache(cacheSize);\n\n    /**\n     * @type {Array<import(\"../../webgl/PaletteTexture.js\").default>}\n     * @private\n     */\n    this.paletteTextures_ = options.paletteTextures || [];\n\n    /**\n     * @private\n     * @type {import(\"../../Map.js\").FrameState|null}\n     */\n    this.frameState_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../proj/Projection.js\").default}\n     */\n    this.projection_ = undefined;\n  }\n\n  /**\n   * @param {Options} options Options.\n   */\n  reset(options) {\n    super.reset({\n      uniforms: options.uniforms,\n    });\n    this.vertexShader_ = options.vertexShader;\n    this.fragmentShader_ = options.fragmentShader;\n    this.paletteTextures_ = options.paletteTextures || [];\n\n    if (this.helper) {\n      this.program_ = this.helper.getProgram(\n        this.fragmentShader_,\n        this.vertexShader_\n      );\n    }\n  }\n\n  afterHelperCreated() {\n    this.program_ = this.helper.getProgram(\n      this.fragmentShader_,\n      this.vertexShader_\n    );\n\n    this.helper.flushBufferData(this.indices_);\n  }\n\n  /**\n   * @param {import(\"../../webgl/TileTexture\").TileType} tile Tile.\n   * @return {boolean} Tile is drawable.\n   * @private\n   */\n  isDrawableTile_(tile) {\n    const tileLayer = this.getLayer();\n    const tileState = tile.getState();\n    const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    return (\n      tileState == TileState.LOADED ||\n      tileState == TileState.EMPTY ||\n      (tileState == TileState.ERROR && !useInterimTilesOnError)\n    );\n  }\n\n  /**\n   * Determine whether renderFrame should be called.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @return {boolean} Layer is ready to be rendered.\n   */\n  prepareFrameInternal(frameState) {\n    if (!this.projection_) {\n      this.projection_ = frameState.viewState.projection;\n    } else if (frameState.viewState.projection !== this.projection_) {\n      this.clearCache();\n      this.projection_ = frameState.viewState.projection;\n    }\n\n    const layer = this.getLayer();\n    const source = layer.getRenderSource();\n    if (!source) {\n      return false;\n    }\n\n    if (isEmpty(getRenderExtent(frameState, frameState.extent))) {\n      return false;\n    }\n    return source.getState() === 'ready';\n  }\n\n  /**\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../extent.js\").Extent} extent The extent to be rendered.\n   * @param {number} initialZ The zoom level.\n   * @param {Object<number, Array<TileTexture>>} tileTexturesByZ The zoom level.\n   * @param {number} preload Number of additional levels to load.\n   */\n  enqueueTiles(frameState, extent, initialZ, tileTexturesByZ, preload) {\n    const viewState = frameState.viewState;\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getRenderSource();\n    const tileGrid = tileSource.getTileGridForProjection(viewState.projection);\n    const gutter = tileSource.getGutterForProjection(viewState.projection);\n\n    const tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in frameState.wantedTiles)) {\n      frameState.wantedTiles[tileSourceKey] = {};\n    }\n\n    const wantedTiles = frameState.wantedTiles[tileSourceKey];\n    const tileTextureCache = this.tileTextureCache_;\n\n    const map = tileLayer.getMapInternal();\n    const minZ = Math.max(\n      initialZ - preload,\n      tileGrid.getMinZoom(),\n      tileGrid.getZForResolution(\n        Math.min(\n          tileLayer.getMaxResolution(),\n          map\n            ? map\n                .getView()\n                .getResolutionForZoom(Math.max(tileLayer.getMinZoom(), 0))\n            : tileGrid.getResolution(0)\n        ),\n        tileSource.zDirection\n      )\n    );\n    for (let z = initialZ; z >= minZ; --z) {\n      const tileRange = tileGrid.getTileRangeForExtentAndZ(\n        extent,\n        z,\n        this.tempTileRange_\n      );\n\n      const tileResolution = tileGrid.getResolution(z);\n\n      for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n        for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n          const tileCoord = createTileCoord(z, x, y, this.tempTileCoord_);\n          const cacheKey = getCacheKey(tileSource, tileCoord);\n\n          /** @type {TileTexture} */\n          let tileTexture;\n\n          /** @type {import(\"../../webgl/TileTexture\").TileType} */\n          let tile;\n\n          if (tileTextureCache.containsKey(cacheKey)) {\n            tileTexture = tileTextureCache.get(cacheKey);\n            tile = tileTexture.tile;\n          }\n          if (!tileTexture || tileTexture.tile.key !== tileSource.getKey()) {\n            tile = tileSource.getTile(\n              z,\n              x,\n              y,\n              frameState.pixelRatio,\n              viewState.projection\n            );\n            if (!tileTexture) {\n              tileTexture = new TileTexture({\n                tile: tile,\n                grid: tileGrid,\n                helper: this.helper,\n                gutter: gutter,\n              });\n              tileTextureCache.set(cacheKey, tileTexture);\n            } else {\n              if (this.isDrawableTile_(tile)) {\n                tileTexture.setTile(tile);\n              } else {\n                const interimTile =\n                  /** @type {import(\"../../webgl/TileTexture\").TileType} */ (\n                    tile.getInterimTile()\n                  );\n                tileTexture.setTile(interimTile);\n              }\n            }\n          }\n\n          addTileTextureToLookup(tileTexturesByZ, tileTexture, z);\n\n          const tileQueueKey = tile.getKey();\n          wantedTiles[tileQueueKey] = true;\n\n          if (tile.getState() === TileState.IDLE) {\n            if (!frameState.tileQueue.isKeyQueued(tileQueueKey)) {\n              frameState.tileQueue.enqueue([\n                tile,\n                tileSourceKey,\n                tileGrid.getTileCoordCenter(tileCoord),\n                tileResolution,\n              ]);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Render the layer.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @return {HTMLElement} The rendered element.\n   */\n  renderFrame(frameState) {\n    this.frameState_ = frameState;\n    this.renderComplete = true;\n    const gl = this.helper.getGL();\n    this.preRender(gl, frameState);\n\n    const viewState = frameState.viewState;\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getRenderSource();\n    const tileGrid = tileSource.getTileGridForProjection(viewState.projection);\n    const gutter = tileSource.getGutterForProjection(viewState.projection);\n    const extent = getRenderExtent(frameState, frameState.extent);\n    const z = tileGrid.getZForResolution(\n      viewState.resolution,\n      tileSource.zDirection\n    );\n\n    /**\n     * @type {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>}\n     */\n    const tileTexturesByZ = {};\n\n    const preload = tileLayer.getPreload();\n    if (frameState.nextExtent) {\n      const targetZ = tileGrid.getZForResolution(\n        viewState.nextResolution,\n        tileSource.zDirection\n      );\n      const nextExtent = getRenderExtent(frameState, frameState.nextExtent);\n      this.enqueueTiles(\n        frameState,\n        nextExtent,\n        targetZ,\n        tileTexturesByZ,\n        preload\n      );\n    }\n\n    this.enqueueTiles(frameState, extent, z, tileTexturesByZ, 0);\n    if (preload > 0) {\n      setTimeout(() => {\n        this.enqueueTiles(\n          frameState,\n          extent,\n          z - 1,\n          tileTexturesByZ,\n          preload - 1\n        );\n      }, 0);\n    }\n\n    /**\n     * A lookup of alpha values for tiles at the target rendering resolution\n     * for tiles that are in transition.  If a tile coord key is absent from\n     * this lookup, the tile should be rendered at alpha 1.\n     * @type {Object<string, number>}\n     */\n    const alphaLookup = {};\n\n    const uid = getUid(this);\n    const time = frameState.time;\n    let blend = false;\n\n    // look for cached tiles to use if a target tile is not ready\n    const tileTextures = tileTexturesByZ[z];\n    for (let i = 0, ii = tileTextures.length; i < ii; ++i) {\n      const tileTexture = tileTextures[i];\n      const tile = tileTexture.tile;\n      if (\n        (tile instanceof ReprojTile || tile instanceof ReprojDataTile) &&\n        tile.getState() === TileState.EMPTY\n      ) {\n        continue;\n      }\n      const tileCoord = tile.tileCoord;\n\n      if (tileTexture.loaded) {\n        const alpha = tile.getAlpha(uid, time);\n        if (alpha === 1) {\n          // no need to look for alt tiles\n          tile.endTransition(uid);\n          continue;\n        }\n        blend = true;\n        const tileCoordKey = getTileCoordKey(tileCoord);\n        alphaLookup[tileCoordKey] = alpha;\n      }\n      this.renderComplete = false;\n\n      // first look for child tiles (at z + 1)\n      const coveredByChildren = this.findAltTiles_(\n        tileGrid,\n        tileCoord,\n        z + 1,\n        tileTexturesByZ\n      );\n\n      if (coveredByChildren) {\n        continue;\n      }\n\n      // next look for parent tiles\n      const minZoom = tileGrid.getMinZoom();\n      for (let parentZ = z - 1; parentZ >= minZoom; --parentZ) {\n        const coveredByParent = this.findAltTiles_(\n          tileGrid,\n          tileCoord,\n          parentZ,\n          tileTexturesByZ\n        );\n\n        if (coveredByParent) {\n          break;\n        }\n      }\n    }\n\n    this.helper.useProgram(this.program_, frameState);\n    this.helper.prepareDraw(frameState, !blend);\n\n    const zs = Object.keys(tileTexturesByZ).map(Number).sort(ascending);\n\n    const centerX = viewState.center[0];\n    const centerY = viewState.center[1];\n\n    for (let j = 0, jj = zs.length; j < jj; ++j) {\n      const tileZ = zs[j];\n      const tileResolution = tileGrid.getResolution(tileZ);\n      const tileSize = toSize(tileGrid.getTileSize(tileZ), this.tempSize_);\n      const tileOrigin = tileGrid.getOrigin(tileZ);\n\n      const tileWidthWithGutter = tileSize[0] + 2 * gutter;\n      const tileHeightWithGutter = tileSize[1] + 2 * gutter;\n      const aspectRatio = tileWidthWithGutter / tileHeightWithGutter;\n\n      const centerI =\n        (centerX - tileOrigin[0]) / (tileSize[0] * tileResolution);\n      const centerJ =\n        (tileOrigin[1] - centerY) / (tileSize[1] * tileResolution);\n\n      const tileScale = viewState.resolution / tileResolution;\n\n      const depth = depthForZ(tileZ);\n      const tileTextures = tileTexturesByZ[tileZ];\n      for (let i = 0, ii = tileTextures.length; i < ii; ++i) {\n        const tileTexture = tileTextures[i];\n        if (!tileTexture.loaded) {\n          continue;\n        }\n        const tile = tileTexture.tile;\n        const tileCoord = tile.tileCoord;\n        const tileCoordKey = getTileCoordKey(tileCoord);\n\n        const tileCenterI = tileCoord[1];\n        const tileCenterJ = tileCoord[2];\n\n        resetTransform(this.tileTransform_);\n        scaleTransform(\n          this.tileTransform_,\n          2 / ((frameState.size[0] * tileScale) / tileWidthWithGutter),\n          -2 / ((frameState.size[1] * tileScale) / tileWidthWithGutter)\n        );\n        rotateTransform(this.tileTransform_, viewState.rotation);\n        scaleTransform(this.tileTransform_, 1, 1 / aspectRatio);\n        translateTransform(\n          this.tileTransform_,\n          (tileSize[0] * (tileCenterI - centerI) - gutter) /\n            tileWidthWithGutter,\n          (tileSize[1] * (tileCenterJ - centerJ) - gutter) /\n            tileHeightWithGutter\n        );\n\n        this.helper.setUniformMatrixValue(\n          Uniforms.TILE_TRANSFORM,\n          mat4FromTransform(this.tempMat4_, this.tileTransform_)\n        );\n\n        this.helper.bindBuffer(tileTexture.coords);\n        this.helper.bindBuffer(this.indices_);\n        this.helper.enableAttributes(attributeDescriptions);\n\n        let textureSlot = 0;\n        while (textureSlot < tileTexture.textures.length) {\n          const textureProperty = 'TEXTURE' + textureSlot;\n          const uniformName = `${Uniforms.TILE_TEXTURE_ARRAY}[${textureSlot}]`;\n          gl.activeTexture(gl[textureProperty]);\n          gl.bindTexture(gl.TEXTURE_2D, tileTexture.textures[textureSlot]);\n          gl.uniform1i(\n            this.helper.getUniformLocation(uniformName),\n            textureSlot\n          );\n          ++textureSlot;\n        }\n\n        for (\n          let paletteIndex = 0;\n          paletteIndex < this.paletteTextures_.length;\n          ++paletteIndex\n        ) {\n          const paletteTexture = this.paletteTextures_[paletteIndex];\n          gl.activeTexture(gl['TEXTURE' + textureSlot]);\n          const texture = paletteTexture.getTexture(gl);\n          gl.bindTexture(gl.TEXTURE_2D, texture);\n          gl.uniform1i(\n            this.helper.getUniformLocation(paletteTexture.name),\n            textureSlot\n          );\n          ++textureSlot;\n        }\n\n        const alpha =\n          tileCoordKey in alphaLookup ? alphaLookup[tileCoordKey] : 1;\n\n        if (alpha < 1) {\n          frameState.animate = true;\n        }\n\n        this.helper.setUniformFloatValue(Uniforms.TRANSITION_ALPHA, alpha);\n        this.helper.setUniformFloatValue(Uniforms.DEPTH, depth);\n        this.helper.setUniformFloatValue(\n          Uniforms.TEXTURE_PIXEL_WIDTH,\n          tileWidthWithGutter\n        );\n        this.helper.setUniformFloatValue(\n          Uniforms.TEXTURE_PIXEL_HEIGHT,\n          tileHeightWithGutter\n        );\n        this.helper.setUniformFloatValue(\n          Uniforms.TEXTURE_RESOLUTION,\n          tileResolution\n        );\n        this.helper.setUniformFloatValue(\n          Uniforms.TEXTURE_ORIGIN_X,\n          tileOrigin[0] +\n            tileCenterI * tileSize[0] * tileResolution -\n            gutter * tileResolution\n        );\n        this.helper.setUniformFloatValue(\n          Uniforms.TEXTURE_ORIGIN_Y,\n          tileOrigin[1] -\n            tileCenterJ * tileSize[1] * tileResolution +\n            gutter * tileResolution\n        );\n        let gutterExtent = extent;\n        if (gutter > 0) {\n          gutterExtent = tileGrid.getTileCoordExtent(tileCoord);\n          getIntersection(gutterExtent, extent, gutterExtent);\n        }\n        this.helper.setUniformFloatVec4(Uniforms.RENDER_EXTENT, gutterExtent);\n        this.helper.setUniformFloatValue(\n          Uniforms.RESOLUTION,\n          viewState.resolution\n        );\n        this.helper.setUniformFloatValue(Uniforms.ZOOM, viewState.zoom);\n\n        this.helper.drawElements(0, this.indices_.getSize());\n      }\n    }\n\n    this.helper.finalizeDraw(\n      frameState,\n      this.dispatchPreComposeEvent,\n      this.dispatchPostComposeEvent\n    );\n\n    const canvas = this.helper.getCanvas();\n\n    const tileTextureCache = this.tileTextureCache_;\n    while (tileTextureCache.canExpireCache()) {\n      const tileTexture = tileTextureCache.pop();\n      tileTexture.dispose();\n    }\n\n    // TODO: let the renderers manage their own cache instead of managing the source cache\n    /**\n     * Here we unconditionally expire the source cache since the renderer maintains\n     * its own cache.\n     * @param {import(\"../../Map.js\").default} map Map.\n     * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n     */\n    const postRenderFunction = function (map, frameState) {\n      tileSource.updateCacheSize(0.1, frameState.viewState.projection);\n      tileSource.expireCache(frameState.viewState.projection, empty);\n    };\n\n    frameState.postRenderFunctions.push(postRenderFunction);\n\n    this.postRender(gl, frameState);\n    return canvas;\n  }\n\n  /**\n   * @param {import(\"../../pixel.js\").Pixel} pixel Pixel.\n   * @return {Uint8ClampedArray|Uint8Array|Float32Array|DataView} Data at the pixel location.\n   */\n  getData(pixel) {\n    const gl = this.helper.getGL();\n    if (!gl) {\n      return null;\n    }\n\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    }\n\n    const layer = this.getLayer();\n    const coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform,\n      pixel.slice()\n    );\n\n    const viewState = frameState.viewState;\n    const layerExtent = layer.getExtent();\n    if (layerExtent) {\n      if (\n        !containsCoordinate(\n          fromUserExtent(layerExtent, viewState.projection),\n          coordinate\n        )\n      ) {\n        return null;\n      }\n    }\n\n    // determine last source suitable for rendering at coordinate\n    const sources = layer.getSources(\n      boundingExtent([coordinate]),\n      viewState.resolution\n    );\n    let i, source, tileGrid;\n    for (i = sources.length - 1; i >= 0; --i) {\n      source = sources[i];\n      if (source.getState() === 'ready') {\n        tileGrid = source.getTileGridForProjection(viewState.projection);\n        if (source.getWrapX()) {\n          break;\n        }\n        const gridExtent = tileGrid.getExtent();\n        if (!gridExtent || containsCoordinate(gridExtent, coordinate)) {\n          break;\n        }\n      }\n    }\n    if (i < 0) {\n      return null;\n    }\n\n    const tileTextureCache = this.tileTextureCache_;\n    for (\n      let z = tileGrid.getZForResolution(viewState.resolution);\n      z >= tileGrid.getMinZoom();\n      --z\n    ) {\n      const tileCoord = tileGrid.getTileCoordForCoordAndZ(coordinate, z);\n      const cacheKey = getCacheKey(source, tileCoord);\n      if (!tileTextureCache.containsKey(cacheKey)) {\n        continue;\n      }\n      const tileTexture = tileTextureCache.get(cacheKey);\n      const tile = tileTexture.tile;\n      if (\n        (tile instanceof ReprojTile || tile instanceof ReprojDataTile) &&\n        tile.getState() === TileState.EMPTY\n      ) {\n        return null;\n      }\n      if (!tileTexture.loaded) {\n        continue;\n      }\n      const tileOrigin = tileGrid.getOrigin(z);\n      const tileSize = toSize(tileGrid.getTileSize(z));\n      const tileResolution = tileGrid.getResolution(z);\n\n      const col =\n        (coordinate[0] - tileOrigin[0]) / tileResolution -\n        tileCoord[1] * tileSize[0];\n\n      const row =\n        (tileOrigin[1] - coordinate[1]) / tileResolution -\n        tileCoord[2] * tileSize[1];\n\n      return tileTexture.getPixelData(col, row);\n    }\n    return null;\n  }\n\n  /**\n   * Look for tiles covering the provided tile coordinate at an alternate\n   * zoom level.  Loaded tiles will be added to the provided tile texture lookup.\n   * @param {import(\"../../tilegrid/TileGrid.js\").default} tileGrid The tile grid.\n   * @param {import(\"../../tilecoord.js\").TileCoord} tileCoord The target tile coordinate.\n   * @param {number} altZ The alternate zoom level.\n   * @param {Object<number, Array<import(\"../../webgl/TileTexture.js\").default>>} tileTexturesByZ Lookup of\n   * tile textures by zoom level.\n   * @return {boolean} The tile coordinate is covered by loaded tiles at the alternate zoom level.\n   * @private\n   */\n  findAltTiles_(tileGrid, tileCoord, altZ, tileTexturesByZ) {\n    const tileRange = tileGrid.getTileRangeForTileCoordAndZ(\n      tileCoord,\n      altZ,\n      this.tempTileRange_\n    );\n\n    if (!tileRange) {\n      return false;\n    }\n\n    let covered = true;\n    const tileTextureCache = this.tileTextureCache_;\n    const source = this.getLayer().getRenderSource();\n    for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        const cacheKey = getCacheKey(source, [altZ, x, y]);\n        let loaded = false;\n        if (tileTextureCache.containsKey(cacheKey)) {\n          const tileTexture = tileTextureCache.get(cacheKey);\n          if (tileTexture.loaded) {\n            addTileTextureToLookup(tileTexturesByZ, tileTexture, altZ);\n            loaded = true;\n          }\n        }\n        if (!loaded) {\n          covered = false;\n        }\n      }\n    }\n    return covered;\n  }\n\n  clearCache() {\n    const tileTextureCache = this.tileTextureCache_;\n    tileTextureCache.forEach((tileTexture) => tileTexture.dispose());\n    tileTextureCache.clear();\n  }\n\n  removeHelper() {\n    if (this.helper) {\n      this.clearCache();\n    }\n\n    super.removeHelper();\n  }\n\n  /**\n   * Clean up.\n   */\n  disposeInternal() {\n    const helper = this.helper;\n    if (helper) {\n      const gl = helper.getGL();\n      gl.deleteProgram(this.program_);\n      delete this.program_;\n\n      helper.deleteBuffer(this.indices_);\n    }\n\n    super.disposeInternal();\n\n    delete this.indices_;\n    delete this.tileTextureCache_;\n    delete this.frameState_;\n  }\n}\n\nexport default WebGLTileLayerRenderer;\n","/**\n * @module ol/webgl/PaletteTexture\n */\n\nclass PaletteTexture {\n  /**\n   * @param {string} name The name of the texture.\n   * @param {Uint8Array} data The texture data.\n   */\n  constructor(name, data) {\n    this.name = name;\n    this.data = data;\n\n    /**\n     * @type {WebGLTexture}\n     * @private\n     */\n    this.texture_ = null;\n  }\n\n  /**\n   * @param {WebGLRenderingContext} gl Rendering context.\n   * @return {WebGLTexture} The texture.\n   */\n  getTexture(gl) {\n    if (!this.texture_) {\n      const texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n      gl.texImage2D(\n        gl.TEXTURE_2D,\n        0,\n        gl.RGBA,\n        this.data.length / 4,\n        1,\n        0,\n        gl.RGBA,\n        gl.UNSIGNED_BYTE,\n        this.data\n      );\n      this.texture_ = texture;\n    }\n    return this.texture_;\n  }\n}\n\nexport default PaletteTexture;\n","/**\n * Operators and utilities used for style expressions\n * @module ol/style/expressions\n */\n\nimport PaletteTexture from '../webgl/PaletteTexture.js';\nimport {Uniforms} from '../renderer/webgl/TileLayer.js';\nimport {asArray, fromString, isStringColor} from '../color.js';\n\n/**\n * Base type used for literal style parameters; can be a number literal or the output of an operator,\n * which in turns takes {@link import(\"./expressions.js\").ExpressionValue} arguments.\n *\n * The following operators can be used:\n *\n * * Reading operators:\n *   * `['band', bandIndex, xOffset, yOffset]` For tile layers only. Fetches pixel values from band\n *     `bandIndex` of the source's data. The first `bandIndex` of the source data is `1`. Fetched values\n *     are in the 0..1 range. {@link import(\"../source/TileImage.js\").default} sources have 4 bands: red,\n *     green, blue and alpha. {@link import(\"../source/DataTile.js\").default} sources can have any number\n *     of bands, depending on the underlying data source and\n *     {@link import(\"../source/GeoTIFF.js\").Options configuration}. `xOffset` and `yOffset` are optional\n *     and allow specifying pixel offsets for x and y. This is used for sampling data from neighboring pixels.\n *   * `['get', 'attributeName']` fetches a feature attribute (it will be prefixed by `a_` in the shader)\n *     Note: those will be taken from the attributes provided to the renderer\n *   * `['resolution']` returns the current resolution\n *   * `['time']` returns the time in seconds since the creation of the layer\n *   * `['var', 'varName']` fetches a value from the style variables, or 0 if undefined\n *   * `['zoom']` returns the current zoom level\n *\n * * Math operators:\n *   * `['*', value1, value2]` multiplies `value1` by `value2`\n *   * `['/', value1, value2]` divides `value1` by `value2`\n *   * `['+', value1, value2]` adds `value1` and `value2`\n *   * `['-', value1, value2]` subtracts `value2` from `value1`\n *   * `['clamp', value, low, high]` clamps `value` between `low` and `high`\n *   * `['%', value1, value2]` returns the result of `value1 % value2` (modulo)\n *   * `['^', value1, value2]` returns the value of `value1` raised to the `value2` power\n *   * `['abs', value1]` returns the absolute value of `value1`\n *   * `['floor', value1]` returns the nearest integer less than or equal to `value1`\n *   * `['round', value1]` returns the nearest integer to `value1`\n *   * `['ceil', value1]` returns the nearest integer greater than or equal to `value1`\n *   * `['sin', value1]` returns the sine of `value1`\n *   * `['cos', value1]` returns the cosine of `value1`\n *   * `['atan', value1, value2]` returns `atan2(value1, value2)`. If `value2` is not provided, returns `atan(value1)`\n *\n * * Transform operators:\n *   * `['case', condition1, output1, ...conditionN, outputN, fallback]` selects the first output whose corresponding\n *     condition evaluates to `true`. If no match is found, returns the `fallback` value.\n *     All conditions should be `boolean`, output and fallback can be any kind.\n *   * `['match', input, match1, output1, ...matchN, outputN, fallback]` compares the `input` value against all\n *     provided `matchX` values, returning the output associated with the first valid match. If no match is found,\n *     returns the `fallback` value.\n *     `input` and `matchX` values must all be of the same type, and can be `number` or `string`. `outputX` and\n *     `fallback` values must be of the same type, and can be of any kind.\n *   * `['interpolate', interpolation, input, stop1, output1, ...stopN, outputN]` returns a value by interpolating between\n *     pairs of inputs and outputs; `interpolation` can either be `['linear']` or `['exponential', base]` where `base` is\n *     the rate of increase from stop A to stop B (i.e. power to which the interpolation ratio is raised); a value\n *     of 1 is equivalent to `['linear']`.\n *     `input` and `stopX` values must all be of type `number`. `outputX` values can be `number` or `color` values.\n *     Note: `input` will be clamped between `stop1` and `stopN`, meaning that all output values will be comprised\n *     between `output1` and `outputN`.\n *\n * * Logical operators:\n *   * `['<', value1, value2]` returns `true` if `value1` is strictly lower than `value2`, or `false` otherwise.\n *   * `['<=', value1, value2]` returns `true` if `value1` is lower than or equals `value2`, or `false` otherwise.\n *   * `['>', value1, value2]` returns `true` if `value1` is strictly greater than `value2`, or `false` otherwise.\n *   * `['>=', value1, value2]` returns `true` if `value1` is greater than or equals `value2`, or `false` otherwise.\n *   * `['==', value1, value2]` returns `true` if `value1` equals `value2`, or `false` otherwise.\n *   * `['!=', value1, value2]` returns `true` if `value1` does not equal `value2`, or `false` otherwise.\n *   * `['!', value1]` returns `false` if `value1` is `true` or greater than `0`, or `true` otherwise.\n *   * `['all', value1, value2, ...]` returns `true` if all the inputs are `true`, `false` otherwise.\n *   * `['any', value1, value2, ...]` returns `true` if any of the inputs are `true`, `false` otherwise.\n *   * `['between', value1, value2, value3]` returns `true` if `value1` is contained between `value2` and `value3`\n *     (inclusively), or `false` otherwise.\n *\n * * Conversion operators:\n *   * `['array', value1, ...valueN]` creates a numerical array from `number` values; please note that the amount of\n *     values can currently only be 2, 3 or 4.\n *   * `['color', red, green, blue, alpha]` creates a `color` value from `number` values; the `alpha` parameter is\n *     optional; if not specified, it will be set to 1.\n *     Note: `red`, `green` and `blue` components must be values between 0 and 255; `alpha` between 0 and 1.\n *   * `['palette', index, colors]` picks a `color` value from an array of colors using the given index; the `index`\n *     expression must evaluate to a number; the items in the `colors` array must be strings with hex colors\n *     (e.g. `'#86A136'`), colors using the rgba[a] functional notation (e.g. `'rgb(134, 161, 54)'` or `'rgba(134, 161, 54, 1)'`),\n *     named colors (e.g. `'red'`), or array literals with 3 ([r, g, b]) or 4 ([r, g, b, a]) values (with r, g, and b\n *     in the 0-255 range and a in the 0-1 range).\n *\n * Values can either be literals or another operator, as they will be evaluated recursively.\n * Literal values can be of the following types:\n * * `boolean`\n * * `number`\n * * `string`\n * * {@link module:ol/color~Color}\n *\n * @typedef {Array<*>|import(\"../color.js\").Color|string|number|boolean} ExpressionValue\n * @api\n */\n\n/**\n * Possible inferred types from a given value or expression.\n * Note: these are binary flags.\n * @enum {number}\n */\nexport const ValueTypes = {\n  NUMBER: 0b00001,\n  STRING: 0b00010,\n  COLOR: 0b00100,\n  BOOLEAN: 0b01000,\n  NUMBER_ARRAY: 0b10000,\n  ANY: 0b11111,\n  NONE: 0,\n};\n\n/**\n * An operator declaration must contain two methods: `getReturnType` which returns a type based on\n * the operator arguments, and `toGlsl` which returns a GLSL-compatible string.\n * Note: both methods can process arguments recursively.\n * @typedef {Object} Operator\n * @property {function(Array<ExpressionValue>): ValueTypes|number} getReturnType Returns one or several types\n * @property {function(ParsingContext, Array<ExpressionValue>, ValueTypes=): string} toGlsl Returns a GLSL-compatible string\n * Note: takes in an optional type hint as 3rd parameter\n */\n\n/**\n * Operator declarations\n * @type {Object<string, Operator>}\n */\nexport const Operators = {};\n\n/**\n * Returns the possible types for a given value (each type being a binary flag)\n * To test a value use e.g. `getValueType(v) & ValueTypes.BOOLEAN`\n * @param {ExpressionValue} value Value\n * @return {ValueTypes|number} Type or types inferred from the value\n */\nexport function getValueType(value) {\n  if (typeof value === 'number') {\n    return ValueTypes.NUMBER;\n  }\n  if (typeof value === 'boolean') {\n    return ValueTypes.BOOLEAN;\n  }\n  if (typeof value === 'string') {\n    if (isStringColor(value)) {\n      return ValueTypes.COLOR | ValueTypes.STRING;\n    }\n    return ValueTypes.STRING;\n  }\n  if (!Array.isArray(value)) {\n    throw new Error(`Unhandled value type: ${JSON.stringify(value)}`);\n  }\n  const valueArr = /** @type {Array<*>} */ (value);\n  const onlyNumbers = valueArr.every(function (v) {\n    return typeof v === 'number';\n  });\n  if (onlyNumbers) {\n    if (valueArr.length === 3 || valueArr.length === 4) {\n      return ValueTypes.COLOR | ValueTypes.NUMBER_ARRAY;\n    }\n    return ValueTypes.NUMBER_ARRAY;\n  }\n  if (typeof valueArr[0] !== 'string') {\n    throw new Error(\n      `Expected an expression operator but received: ${JSON.stringify(\n        valueArr\n      )}`\n    );\n  }\n  const operator = Operators[valueArr[0]];\n  if (operator === undefined) {\n    throw new Error(\n      `Unrecognized expression operator: ${JSON.stringify(valueArr)}`\n    );\n  }\n  return operator.getReturnType(valueArr.slice(1));\n}\n\n/**\n * Checks if only one value type is enabled in the input number.\n * @param {ValueTypes|number} valueType Number containing value type binary flags\n * @return {boolean} True if only one type flag is enabled, false if zero or multiple\n */\nexport function isTypeUnique(valueType) {\n  return Math.log2(valueType) % 1 === 0;\n}\n\n/**\n * Context available during the parsing of an expression.\n * @typedef {Object} ParsingContext\n * @property {boolean} [inFragmentShader] If false, means the expression output should be made for a vertex shader\n * @property {Array<string>} variables List of variables used in the expression; contains **unprefixed names**\n * @property {Array<string>} attributes List of attributes used in the expression; contains **unprefixed names**\n * @property {Object<string, number>} stringLiteralsMap This object maps all encountered string values to a number\n * @property {Object<string, string>} functions Lookup of functions used by the style.\n * @property {number} [bandCount] Number of bands per pixel.\n * @property {Array<PaletteTexture>} [paletteTextures] List of palettes used by the style.\n */\n\n/**\n * Will return the number as a float with a dot separator, which is required by GLSL.\n * @param {number} v Numerical value.\n * @return {string} The value as string.\n */\nexport function numberToGlsl(v) {\n  const s = v.toString();\n  return s.includes('.') ? s : s + '.0';\n}\n\n/**\n * Will return the number array as a float with a dot separator, concatenated with ', '.\n * @param {Array<number>} array Numerical values array.\n * @return {string} The array as a vector, e. g.: `vec3(1.0, 2.0, 3.0)`.\n */\nexport function arrayToGlsl(array) {\n  if (array.length < 2 || array.length > 4) {\n    throw new Error(\n      '`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.'\n    );\n  }\n  return `vec${array.length}(${array.map(numberToGlsl).join(', ')})`;\n}\n\n/**\n * Will normalize and converts to string a `vec4` color array compatible with GLSL.\n * @param {string|import(\"../color.js\").Color} color Color either in string format or [r, g, b, a] array format,\n * with RGB components in the 0..255 range and the alpha component in the 0..1 range.\n * Note that the final array will always have 4 components.\n * @return {string} The color expressed in the `vec4(1.0, 1.0, 1.0, 1.0)` form.\n */\nexport function colorToGlsl(color) {\n  const array = asArray(color).slice();\n  if (array.length < 4) {\n    array.push(1);\n  }\n  return arrayToGlsl(\n    array.map(function (c, i) {\n      return i < 3 ? c / 255 : c;\n    })\n  );\n}\n\n/**\n * Returns a stable equivalent number for the string literal.\n * @param {ParsingContext} context Parsing context\n * @param {string} string String literal value\n * @return {number} Number equivalent\n */\nexport function getStringNumberEquivalent(context, string) {\n  if (context.stringLiteralsMap[string] === undefined) {\n    context.stringLiteralsMap[string] = Object.keys(\n      context.stringLiteralsMap\n    ).length;\n  }\n  return context.stringLiteralsMap[string];\n}\n\n/**\n * Returns a stable equivalent number for the string literal, for use in shaders. This number is then\n * converted to be a GLSL-compatible string.\n * @param {ParsingContext} context Parsing context\n * @param {string} string String literal value\n * @return {string} GLSL-compatible string containing a number\n */\nexport function stringToGlsl(context, string) {\n  return numberToGlsl(getStringNumberEquivalent(context, string));\n}\n\n/**\n * Recursively parses a style expression and outputs a GLSL-compatible string. Takes in a parsing context that\n * will be read and modified during the parsing operation.\n * @param {ParsingContext} context Parsing context\n * @param {ExpressionValue} value Value\n * @param {ValueTypes|number} [typeHint] Hint for the expected final type (can be several types combined)\n * @return {string} GLSL-compatible output\n */\nexport function expressionToGlsl(context, value, typeHint) {\n  // operator\n  if (Array.isArray(value) && typeof value[0] === 'string') {\n    const operator = Operators[value[0]];\n    if (operator === undefined) {\n      throw new Error(\n        `Unrecognized expression operator: ${JSON.stringify(value)}`\n      );\n    }\n    return operator.toGlsl(context, value.slice(1), typeHint);\n  }\n\n  const valueType = getValueType(value);\n  if ((valueType & ValueTypes.NUMBER) > 0) {\n    return numberToGlsl(/** @type {number} */ (value));\n  }\n\n  if ((valueType & ValueTypes.BOOLEAN) > 0) {\n    return value.toString();\n  }\n\n  if (\n    (valueType & ValueTypes.STRING) > 0 &&\n    (typeHint === undefined || typeHint == ValueTypes.STRING)\n  ) {\n    return stringToGlsl(context, value.toString());\n  }\n\n  if (\n    (valueType & ValueTypes.COLOR) > 0 &&\n    (typeHint === undefined || typeHint == ValueTypes.COLOR)\n  ) {\n    return colorToGlsl(/** @type {Array<number> | string} */ (value));\n  }\n\n  if ((valueType & ValueTypes.NUMBER_ARRAY) > 0) {\n    return arrayToGlsl(/** @type {Array<number>} */ (value));\n  }\n\n  throw new Error(`Unexpected expression ${value} (expected type ${typeHint})`);\n}\n\nfunction assertNumber(value) {\n  if (!(getValueType(value) & ValueTypes.NUMBER)) {\n    throw new Error(\n      `A numeric value was expected, got ${JSON.stringify(value)} instead`\n    );\n  }\n}\nfunction assertNumbers(values) {\n  for (let i = 0; i < values.length; i++) {\n    assertNumber(values[i]);\n  }\n}\nfunction assertString(value) {\n  if (!(getValueType(value) & ValueTypes.STRING)) {\n    throw new Error(\n      `A string value was expected, got ${JSON.stringify(value)} instead`\n    );\n  }\n}\nfunction assertBoolean(value) {\n  if (!(getValueType(value) & ValueTypes.BOOLEAN)) {\n    throw new Error(\n      `A boolean value was expected, got ${JSON.stringify(value)} instead`\n    );\n  }\n}\nfunction assertArgsCount(args, count) {\n  if (args.length !== count) {\n    throw new Error(\n      `Exactly ${count} arguments were expected, got ${args.length} instead`\n    );\n  }\n}\nfunction assertArgsMinCount(args, count) {\n  if (args.length < count) {\n    throw new Error(\n      `At least ${count} arguments were expected, got ${args.length} instead`\n    );\n  }\n}\nfunction assertArgsMaxCount(args, count) {\n  if (args.length > count) {\n    throw new Error(\n      `At most ${count} arguments were expected, got ${args.length} instead`\n    );\n  }\n}\nfunction assertArgsEven(args) {\n  if (args.length % 2 !== 0) {\n    throw new Error(\n      `An even amount of arguments was expected, got ${args} instead`\n    );\n  }\n}\nfunction assertArgsOdd(args) {\n  if (args.length % 2 === 0) {\n    throw new Error(\n      `An odd amount of arguments was expected, got ${args} instead`\n    );\n  }\n}\nfunction assertUniqueInferredType(args, types) {\n  if (!isTypeUnique(types)) {\n    throw new Error(\n      `Could not infer only one type from the following expression: ${JSON.stringify(\n        args\n      )}`\n    );\n  }\n}\n\nOperators['get'] = {\n  getReturnType: function (args) {\n    return ValueTypes.ANY;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertString(args[0]);\n    const value = args[0].toString();\n    if (!context.attributes.includes(value)) {\n      context.attributes.push(value);\n    }\n    const prefix = context.inFragmentShader ? 'v_' : 'a_';\n    return prefix + value;\n  },\n};\n\n/**\n * Get the uniform name given a variable name.\n * @param {string} variableName The variable name.\n * @return {string} The uniform name.\n */\nexport function uniformNameForVariable(variableName) {\n  return 'u_var_' + variableName;\n}\n\nOperators['var'] = {\n  getReturnType: function (args) {\n    return ValueTypes.ANY;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertString(args[0]);\n    const value = args[0].toString();\n    if (!context.variables.includes(value)) {\n      context.variables.push(value);\n    }\n    return uniformNameForVariable(value);\n  },\n};\n\nexport const PALETTE_TEXTURE_ARRAY = 'u_paletteTextures';\n\n// ['palette', index, colors]\nOperators['palette'] = {\n  getReturnType: function (args) {\n    return ValueTypes.COLOR;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumber(args[0]);\n    const index = expressionToGlsl(context, args[0]);\n    const colors = args[1];\n    if (!Array.isArray(colors)) {\n      throw new Error('The second argument of palette must be an array');\n    }\n    const numColors = colors.length;\n    const palette = new Uint8Array(numColors * 4);\n    for (let i = 0; i < numColors; i++) {\n      const candidate = colors[i];\n      /**\n       * @type {import('../color.js').Color}\n       */\n      let color;\n      if (typeof candidate === 'string') {\n        color = fromString(candidate);\n      } else {\n        if (!Array.isArray(candidate)) {\n          throw new Error(\n            'The second argument of palette must be an array of strings or colors'\n          );\n        }\n        const length = candidate.length;\n        if (length === 4) {\n          color = candidate;\n        } else {\n          if (length !== 3) {\n            throw new Error(\n              `Expected palette color to have 3 or 4 values, got ${length}`\n            );\n          }\n          color = [candidate[0], candidate[1], candidate[2], 1];\n        }\n      }\n      const offset = i * 4;\n      palette[offset] = color[0];\n      palette[offset + 1] = color[1];\n      palette[offset + 2] = color[2];\n      palette[offset + 3] = color[3] * 255;\n    }\n    if (!context.paletteTextures) {\n      context.paletteTextures = [];\n    }\n    const paletteName = `${PALETTE_TEXTURE_ARRAY}[${context.paletteTextures.length}]`;\n    const paletteTexture = new PaletteTexture(paletteName, palette);\n    context.paletteTextures.push(paletteTexture);\n    return `texture2D(${paletteName}, vec2((${index} + 0.5) / ${numColors}.0, 0.5))`;\n  },\n};\n\nconst GET_BAND_VALUE_FUNC = 'getBandValue';\n\nOperators['band'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 1);\n    assertArgsMaxCount(args, 3);\n    const band = args[0];\n\n    if (!(GET_BAND_VALUE_FUNC in context.functions)) {\n      let ifBlocks = '';\n      const bandCount = context.bandCount || 1;\n      for (let i = 0; i < bandCount; i++) {\n        const colorIndex = Math.floor(i / 4);\n        let bandIndex = i % 4;\n        if (i === bandCount - 1 && bandIndex === 1) {\n          // LUMINANCE_ALPHA - band 1 assigned to rgb and band 2 assigned to alpha\n          bandIndex = 3;\n        }\n        const textureName = `${Uniforms.TILE_TEXTURE_ARRAY}[${colorIndex}]`;\n        ifBlocks += `\n          if (band == ${i + 1}.0) {\n            return texture2D(${textureName}, v_textureCoord + vec2(dx, dy))[${bandIndex}];\n          }\n        `;\n      }\n\n      context.functions[GET_BAND_VALUE_FUNC] = `\n        float getBandValue(float band, float xOffset, float yOffset) {\n          float dx = xOffset / ${Uniforms.TEXTURE_PIXEL_WIDTH};\n          float dy = yOffset / ${Uniforms.TEXTURE_PIXEL_HEIGHT};\n          ${ifBlocks}\n        }\n      `;\n    }\n\n    const bandExpression = expressionToGlsl(context, band);\n    const xOffsetExpression = expressionToGlsl(context, args[1] || 0);\n    const yOffsetExpression = expressionToGlsl(context, args[2] || 0);\n    return `${GET_BAND_VALUE_FUNC}(${bandExpression}, ${xOffsetExpression}, ${yOffsetExpression})`;\n  },\n};\n\nOperators['time'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 0);\n    return 'u_time';\n  },\n};\n\nOperators['zoom'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 0);\n    return 'u_zoom';\n  },\n};\n\nOperators['resolution'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 0);\n    return 'u_resolution';\n  },\n};\n\nOperators['*'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 2);\n    assertNumbers(args);\n    return `(${args.map((arg) => expressionToGlsl(context, arg)).join(' * ')})`;\n  },\n};\n\nOperators['/'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} / ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['+'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 2);\n    assertNumbers(args);\n\n    return `(${args.map((arg) => expressionToGlsl(context, arg)).join(' + ')})`;\n  },\n};\n\nOperators['-'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} - ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['clamp'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 3);\n    assertNumbers(args);\n    const min = expressionToGlsl(context, args[1]);\n    const max = expressionToGlsl(context, args[2]);\n    return `clamp(${expressionToGlsl(context, args[0])}, ${min}, ${max})`;\n  },\n};\n\nOperators['%'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `mod(${expressionToGlsl(context, args[0])}, ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['^'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `pow(${expressionToGlsl(context, args[0])}, ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['abs'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `abs(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['floor'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `floor(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['round'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `floor(${expressionToGlsl(context, args[0])} + 0.5)`;\n  },\n};\n\nOperators['ceil'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `ceil(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['sin'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `sin(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['cos'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertNumbers(args);\n    return `cos(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['atan'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 1);\n    assertArgsMaxCount(args, 2);\n    assertNumbers(args);\n    return args.length === 2\n      ? `atan(${expressionToGlsl(context, args[0])}, ${expressionToGlsl(\n          context,\n          args[1]\n        )})`\n      : `atan(${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nOperators['>'] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} > ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['>='] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} >= ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['<'] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} < ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nOperators['<='] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 2);\n    assertNumbers(args);\n    return `(${expressionToGlsl(context, args[0])} <= ${expressionToGlsl(\n      context,\n      args[1]\n    )})`;\n  },\n};\n\nfunction getEqualOperator(operator) {\n  return {\n    getReturnType: function (args) {\n      return ValueTypes.BOOLEAN;\n    },\n    toGlsl: function (context, args) {\n      assertArgsCount(args, 2);\n\n      // find common type\n      let type = ValueTypes.ANY;\n      for (let i = 0; i < args.length; i++) {\n        type &= getValueType(args[i]);\n      }\n      if (type === ValueTypes.NONE) {\n        throw new Error(\n          `All arguments should be of compatible type, got ${JSON.stringify(\n            args\n          )} instead`\n        );\n      }\n\n      // Since it's not possible to have color types here, we can leave it out\n      // This fixes issues in case the value type is ambiguously detected as a color (e.g. the string 'red')\n      type &= ~ValueTypes.COLOR;\n\n      return `(${expressionToGlsl(\n        context,\n        args[0],\n        type\n      )} ${operator} ${expressionToGlsl(context, args[1], type)})`;\n    },\n  };\n}\n\nOperators['=='] = getEqualOperator('==');\n\nOperators['!='] = getEqualOperator('!=');\n\nOperators['!'] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 1);\n    assertBoolean(args[0]);\n    return `(!${expressionToGlsl(context, args[0])})`;\n  },\n};\n\nfunction getDecisionOperator(operator) {\n  return {\n    getReturnType: function (args) {\n      return ValueTypes.BOOLEAN;\n    },\n    toGlsl: function (context, args) {\n      assertArgsMinCount(args, 2);\n      for (let i = 0; i < args.length; i++) {\n        assertBoolean(args[i]);\n      }\n      let result = '';\n      result = args\n        .map((arg) => expressionToGlsl(context, arg))\n        .join(` ${operator} `);\n      result = `(${result})`;\n      return result;\n    },\n  };\n}\n\nOperators['all'] = getDecisionOperator('&&');\n\nOperators['any'] = getDecisionOperator('||');\n\nOperators['between'] = {\n  getReturnType: function (args) {\n    return ValueTypes.BOOLEAN;\n  },\n  toGlsl: function (context, args) {\n    assertArgsCount(args, 3);\n    assertNumbers(args);\n    const min = expressionToGlsl(context, args[1]);\n    const max = expressionToGlsl(context, args[2]);\n    const value = expressionToGlsl(context, args[0]);\n    return `(${value} >= ${min} && ${value} <= ${max})`;\n  },\n};\n\nOperators['array'] = {\n  getReturnType: function (args) {\n    return ValueTypes.NUMBER_ARRAY;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 2);\n    assertArgsMaxCount(args, 4);\n    assertNumbers(args);\n    const parsedArgs = args.map(function (val) {\n      return expressionToGlsl(context, val, ValueTypes.NUMBER);\n    });\n    return `vec${args.length}(${parsedArgs.join(', ')})`;\n  },\n};\n\nOperators['color'] = {\n  getReturnType: function (args) {\n    return ValueTypes.COLOR;\n  },\n  toGlsl: function (context, args) {\n    assertArgsMinCount(args, 3);\n    assertArgsMaxCount(args, 4);\n    assertNumbers(args);\n    const array = /** @type {Array<number>} */ (args);\n    if (args.length === 3) {\n      array.push(1);\n    }\n    const parsedArgs = args.map(function (val, i) {\n      return (\n        expressionToGlsl(context, val, ValueTypes.NUMBER) +\n        (i < 3 ? ' / 255.0' : '')\n      );\n    });\n    return `vec${args.length}(${parsedArgs.join(', ')})`;\n  },\n};\n\nOperators['interpolate'] = {\n  getReturnType: function (args) {\n    let type = ValueTypes.COLOR | ValueTypes.NUMBER;\n    for (let i = 3; i < args.length; i += 2) {\n      type = type & getValueType(args[i]);\n    }\n    return type;\n  },\n  toGlsl: function (context, args, typeHint) {\n    assertArgsEven(args);\n    assertArgsMinCount(args, 6);\n\n    // validate interpolation type\n    const type = args[0];\n    let interpolation;\n    switch (type[0]) {\n      case 'linear':\n        interpolation = 1;\n        break;\n      case 'exponential':\n        interpolation = type[1];\n        break;\n      default:\n        interpolation = null;\n    }\n    if (!interpolation) {\n      throw new Error(\n        `Invalid interpolation type for \"interpolate\" operator, received: ${JSON.stringify(\n          type\n        )}`\n      );\n    }\n\n    // compute input/output types\n    typeHint = typeHint !== undefined ? typeHint : ValueTypes.ANY;\n    const outputType = Operators['interpolate'].getReturnType(args) & typeHint;\n    assertUniqueInferredType(args, outputType);\n\n    const input = expressionToGlsl(context, args[1]);\n    const exponent = numberToGlsl(interpolation);\n\n    let result = '';\n    for (let i = 2; i < args.length - 2; i += 2) {\n      const stop1 = expressionToGlsl(context, args[i]);\n      const output1 =\n        result || expressionToGlsl(context, args[i + 1], outputType);\n      const stop2 = expressionToGlsl(context, args[i + 2]);\n      const output2 = expressionToGlsl(context, args[i + 3], outputType);\n      result = `mix(${output1}, ${output2}, pow(clamp((${input} - ${stop1}) / (${stop2} - ${stop1}), 0.0, 1.0), ${exponent}))`;\n    }\n    return result;\n  },\n};\n\nOperators['match'] = {\n  getReturnType: function (args) {\n    let type = ValueTypes.ANY;\n    for (let i = 2; i < args.length; i += 2) {\n      type = type & getValueType(args[i]);\n    }\n    type = type & getValueType(args[args.length - 1]);\n    return type;\n  },\n  toGlsl: function (context, args, typeHint) {\n    assertArgsEven(args);\n    assertArgsMinCount(args, 4);\n\n    typeHint = typeHint !== undefined ? typeHint : ValueTypes.ANY;\n    const outputType = Operators['match'].getReturnType(args) & typeHint;\n    assertUniqueInferredType(args, outputType);\n\n    const input = expressionToGlsl(context, args[0]);\n    const fallback = expressionToGlsl(\n      context,\n      args[args.length - 1],\n      outputType\n    );\n    let result = null;\n    for (let i = args.length - 3; i >= 1; i -= 2) {\n      const match = expressionToGlsl(context, args[i]);\n      const output = expressionToGlsl(context, args[i + 1], outputType);\n      result = `(${input} == ${match} ? ${output} : ${result || fallback})`;\n    }\n    return result;\n  },\n};\n\nOperators['case'] = {\n  getReturnType: function (args) {\n    let type = ValueTypes.ANY;\n    for (let i = 1; i < args.length; i += 2) {\n      type = type & getValueType(args[i]);\n    }\n    type = type & getValueType(args[args.length - 1]);\n    return type;\n  },\n  toGlsl: function (context, args, typeHint) {\n    assertArgsOdd(args);\n    assertArgsMinCount(args, 3);\n\n    typeHint = typeHint !== undefined ? typeHint : ValueTypes.ANY;\n    const outputType = Operators['case'].getReturnType(args) & typeHint;\n    assertUniqueInferredType(args, outputType);\n    for (let i = 0; i < args.length - 1; i += 2) {\n      assertBoolean(args[i]);\n    }\n\n    const fallback = expressionToGlsl(\n      context,\n      args[args.length - 1],\n      outputType\n    );\n    let result = null;\n    for (let i = args.length - 3; i >= 0; i -= 2) {\n      const condition = expressionToGlsl(context, args[i]);\n      const output = expressionToGlsl(context, args[i + 1], outputType);\n      result = `(${condition} ? ${output} : ${result || fallback})`;\n    }\n    return result;\n  },\n};\n","/**\n * @module ol/layer/WebGLTile\n */\nimport BaseTileLayer from './BaseTile.js';\nimport LayerProperty from '../layer/Property.js';\nimport WebGLTileLayerRenderer, {\n  Attributes,\n  Uniforms,\n} from '../renderer/webgl/TileLayer.js';\nimport {\n  PALETTE_TEXTURE_ARRAY,\n  ValueTypes,\n  expressionToGlsl,\n  getStringNumberEquivalent,\n  uniformNameForVariable,\n} from '../style/expressions.js';\n\n/**\n * @typedef {import(\"../source/DataTile.js\").default|import(\"../source/TileImage.js\").default} SourceType\n */\n\n/**\n * @typedef {Object} Style\n * Translates tile data to rendered pixels.\n *\n * @property {Object<string, (string|number)>} [variables] Style variables.  Each variable must hold a number or string.  These\n * variables can be used in the `color`, `brightness`, `contrast`, `exposure`, `saturation` and `gamma`\n * {@link import(\"../style/expressions.js\").ExpressionValue expressions}, using the `['var', 'varName']` operator.\n * To update style variables, use the {@link import(\"./WebGLTile.js\").default#updateStyleVariables} method.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [color] An expression applied to color values.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [brightness=0] Value used to decrease or increase\n * the layer brightness.  Values range from -1 to 1.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [contrast=0] Value used to decrease or increase\n * the layer contrast.  Values range from -1 to 1.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [exposure=0] Value used to decrease or increase\n * the layer exposure.  Values range from -1 to 1.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [saturation=0] Value used to decrease or increase\n * the layer saturation.  Values range from -1 to 1.\n * @property {import(\"../style/expressions.js\").ExpressionValue} [gamma=1] Apply a gamma correction to the layer.\n * Values range from 0 to infinity.\n */\n\n/**\n * @typedef {Object} Options\n * @property {Style} [style] Style to apply to the layer.\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [minZoom] The minimum view zoom level (exclusive) above which this layer will be\n * visible.\n * @property {number} [maxZoom] The maximum view zoom level (inclusive) at which this layer will\n * be visible.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {SourceType} [source] Source for this layer.\n * @property {Array<SourceType>|function(import(\"../extent.js\").Extent, number):Array<SourceType>} [sources] Array\n * of sources for this layer. Takes precedence over `source`. Can either be an array of sources, or a function that\n * expects an extent and a resolution (in view projection units per pixel) and returns an array of sources. See\n * {@link module:ol/source.sourcesFromTileGrid} for a helper function to generate sources that are organized in a\n * pyramid following the same pattern as a tile grid. **Note:** All sources must have the same band count and content.\n * @property {import(\"../Map.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map~Map#addLayer}.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n * @property {number} [cacheSize=512] The internal texture cache size.  This needs to be large enough to render\n * two zoom levels worth of tiles.\n */\n\n/**\n * @typedef {Object} ParsedStyle\n * @property {string} vertexShader The vertex shader.\n * @property {string} fragmentShader The fragment shader.\n * @property {Object<string,import(\"../webgl/Helper.js\").UniformValue>} uniforms Uniform definitions.\n * @property {Array<import(\"../webgl/PaletteTexture.js\").default>} paletteTextures Palette textures.\n */\n\n/**\n * @param {Style} style The layer style.\n * @param {number} [bandCount] The number of bands.\n * @return {ParsedStyle} Shaders and uniforms generated from the style.\n */\nfunction parseStyle(style, bandCount) {\n  const vertexShader = `\n    attribute vec2 ${Attributes.TEXTURE_COORD};\n    uniform mat4 ${Uniforms.TILE_TRANSFORM};\n    uniform float ${Uniforms.TEXTURE_PIXEL_WIDTH};\n    uniform float ${Uniforms.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${Uniforms.TEXTURE_RESOLUTION};\n    uniform float ${Uniforms.TEXTURE_ORIGIN_X};\n    uniform float ${Uniforms.TEXTURE_ORIGIN_Y};\n    uniform float ${Uniforms.DEPTH};\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ${Attributes.TEXTURE_COORD};\n      v_mapCoord = vec2(\n        ${Uniforms.TEXTURE_ORIGIN_X} + ${Uniforms.TEXTURE_RESOLUTION} * ${Uniforms.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],\n        ${Uniforms.TEXTURE_ORIGIN_Y} - ${Uniforms.TEXTURE_RESOLUTION} * ${Uniforms.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]\n      );\n      gl_Position = ${Uniforms.TILE_TRANSFORM} * vec4(${Attributes.TEXTURE_COORD}, ${Uniforms.DEPTH}, 1.0);\n    }\n  `;\n\n  /**\n   * @type {import(\"../style/expressions.js\").ParsingContext}\n   */\n  const context = {\n    inFragmentShader: true,\n    variables: [],\n    attributes: [],\n    stringLiteralsMap: {},\n    functions: {},\n    bandCount: bandCount,\n  };\n\n  const pipeline = [];\n\n  if (style.color !== undefined) {\n    const color = expressionToGlsl(context, style.color, ValueTypes.COLOR);\n    pipeline.push(`color = ${color};`);\n  }\n\n  if (style.contrast !== undefined) {\n    const contrast = expressionToGlsl(\n      context,\n      style.contrast,\n      ValueTypes.NUMBER\n    );\n    pipeline.push(\n      `color.rgb = clamp((${contrast} + 1.0) * color.rgb - (${contrast} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`\n    );\n  }\n\n  if (style.exposure !== undefined) {\n    const exposure = expressionToGlsl(\n      context,\n      style.exposure,\n      ValueTypes.NUMBER\n    );\n    pipeline.push(\n      `color.rgb = clamp((${exposure} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`\n    );\n  }\n\n  if (style.saturation !== undefined) {\n    const saturation = expressionToGlsl(\n      context,\n      style.saturation,\n      ValueTypes.NUMBER\n    );\n    pipeline.push(`\n      float saturation = ${saturation} + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    `);\n  }\n\n  if (style.gamma !== undefined) {\n    const gamma = expressionToGlsl(context, style.gamma, ValueTypes.NUMBER);\n    pipeline.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${gamma}));`);\n  }\n\n  if (style.brightness !== undefined) {\n    const brightness = expressionToGlsl(\n      context,\n      style.brightness,\n      ValueTypes.NUMBER\n    );\n    pipeline.push(\n      `color.rgb = clamp(color.rgb + ${brightness}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`\n    );\n  }\n\n  /** @type {Object<string,import(\"../webgl/Helper\").UniformValue>} */\n  const uniforms = {};\n\n  const numVariables = context.variables.length;\n  if (numVariables > 1 && !style.variables) {\n    throw new Error(\n      `Missing variables in style (expected ${context.variables})`\n    );\n  }\n\n  for (let i = 0; i < numVariables; ++i) {\n    const variableName = context.variables[i];\n    if (!(variableName in style.variables)) {\n      throw new Error(`Missing '${variableName}' in style variables`);\n    }\n    const uniformName = uniformNameForVariable(variableName);\n    uniforms[uniformName] = function () {\n      let value = style.variables[variableName];\n      if (typeof value === 'string') {\n        value = getStringNumberEquivalent(context, value);\n      }\n      return value !== undefined ? value : -9999999; // to avoid matching with the first string literal\n    };\n  }\n\n  const uniformDeclarations = Object.keys(uniforms).map(function (name) {\n    return `uniform float ${name};`;\n  });\n\n  const textureCount = Math.ceil(bandCount / 4);\n  uniformDeclarations.push(\n    `uniform sampler2D ${Uniforms.TILE_TEXTURE_ARRAY}[${textureCount}];`\n  );\n\n  if (context.paletteTextures) {\n    uniformDeclarations.push(\n      `uniform sampler2D ${PALETTE_TEXTURE_ARRAY}[${context.paletteTextures.length}];`\n    );\n  }\n\n  const functionDefintions = Object.keys(context.functions).map(function (\n    name\n  ) {\n    return context.functions[name];\n  });\n\n  const fragmentShader = `\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ${Uniforms.RENDER_EXTENT};\n    uniform float ${Uniforms.TRANSITION_ALPHA};\n    uniform float ${Uniforms.TEXTURE_PIXEL_WIDTH};\n    uniform float ${Uniforms.TEXTURE_PIXEL_HEIGHT};\n    uniform float ${Uniforms.RESOLUTION};\n    uniform float ${Uniforms.ZOOM};\n\n    ${uniformDeclarations.join('\\n')}\n\n    ${functionDefintions.join('\\n')}\n\n    void main() {\n      if (\n        v_mapCoord[0] < ${Uniforms.RENDER_EXTENT}[0] ||\n        v_mapCoord[1] < ${Uniforms.RENDER_EXTENT}[1] ||\n        v_mapCoord[0] > ${Uniforms.RENDER_EXTENT}[2] ||\n        v_mapCoord[1] > ${Uniforms.RENDER_EXTENT}[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(${\n        Uniforms.TILE_TEXTURE_ARRAY\n      }[0],  v_textureCoord);\n\n      ${pipeline.join('\\n')}\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ${Uniforms.TRANSITION_ALPHA};\n    }`;\n\n  return {\n    vertexShader: vertexShader,\n    fragmentShader: fragmentShader,\n    uniforms: uniforms,\n    paletteTextures: context.paletteTextures,\n  };\n}\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @extends BaseTileLayer<SourceType, WebGLTileLayerRenderer>\n * @fires import(\"../render/Event.js\").RenderEvent\n * @api\n */\nclass WebGLTileLayer extends BaseTileLayer {\n  /**\n   * @param {Options} options Tile layer options.\n   */\n  constructor(options) {\n    options = options ? Object.assign({}, options) : {};\n\n    const style = options.style || {};\n    delete options.style;\n\n    const cacheSize = options.cacheSize;\n    delete options.cacheSize;\n\n    super(options);\n\n    /**\n     * @type {Array<SourceType>|function(import(\"../extent.js\").Extent, number):Array<SourceType>}\n     * @private\n     */\n    this.sources_ = options.sources;\n\n    /**\n     * @type {SourceType|null}\n     * @private\n     */\n    this.renderedSource_ = null;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.renderedResolution_ = NaN;\n\n    /**\n     * @type {Style}\n     * @private\n     */\n    this.style_ = style;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.cacheSize_ = cacheSize;\n\n    /**\n     * @type {Object<string, (string|number)>}\n     * @private\n     */\n    this.styleVariables_ = this.style_.variables || {};\n\n    this.addChangeListener(LayerProperty.SOURCE, this.handleSourceUpdate_);\n  }\n\n  /**\n   * Gets the sources for this layer, for a given extent and resolution.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @return {Array<SourceType>} Sources.\n   */\n  getSources(extent, resolution) {\n    const source = this.getSource();\n    return this.sources_\n      ? typeof this.sources_ === 'function'\n        ? this.sources_(extent, resolution)\n        : this.sources_\n      : source\n      ? [source]\n      : [];\n  }\n\n  /**\n   * @return {SourceType} The source being rendered.\n   */\n  getRenderSource() {\n    return this.renderedSource_ || this.getSource();\n  }\n\n  /**\n   * @return {import(\"../source/Source.js\").State} Source state.\n   */\n  getSourceState() {\n    const source = this.getRenderSource();\n    return source ? source.getState() : 'undefined';\n  }\n\n  /**\n   * @private\n   */\n  handleSourceUpdate_() {\n    if (this.hasRenderer()) {\n      this.getRenderer().clearCache();\n    }\n    if (this.getSource()) {\n      this.setStyle(this.style_);\n    }\n  }\n\n  /**\n   * @private\n   * @return {number} The number of source bands.\n   */\n  getSourceBandCount_() {\n    const max = Number.MAX_SAFE_INTEGER;\n    const sources = this.getSources([-max, -max, max, max], max);\n    return sources && sources.length && 'bandCount' in sources[0]\n      ? sources[0].bandCount\n      : 4;\n  }\n\n  createRenderer() {\n    const parsedStyle = parseStyle(this.style_, this.getSourceBandCount_());\n\n    return new WebGLTileLayerRenderer(this, {\n      vertexShader: parsedStyle.vertexShader,\n      fragmentShader: parsedStyle.fragmentShader,\n      uniforms: parsedStyle.uniforms,\n      cacheSize: this.cacheSize_,\n      paletteTextures: parsedStyle.paletteTextures,\n    });\n  }\n\n  /**\n   * @param {import(\"../Map\").FrameState} frameState Frame state.\n   * @param {Array<SourceType>} sources Sources.\n   * @return {HTMLElement} Canvas.\n   */\n  renderSources(frameState, sources) {\n    const layerRenderer = this.getRenderer();\n    let canvas;\n    for (let i = 0, ii = sources.length; i < ii; ++i) {\n      this.renderedSource_ = sources[i];\n      if (layerRenderer.prepareFrame(frameState)) {\n        canvas = layerRenderer.renderFrame(frameState);\n      }\n    }\n    return canvas;\n  }\n\n  /**\n   * @param {?import(\"../Map.js\").FrameState} frameState Frame state.\n   * @param {HTMLElement} target Target which the renderer may (but need not) use\n   * for rendering its content.\n   * @return {HTMLElement} The rendered element.\n   */\n  render(frameState, target) {\n    this.rendered = true;\n    const viewState = frameState.viewState;\n    const sources = this.getSources(frameState.extent, viewState.resolution);\n    let ready = true;\n    for (let i = 0, ii = sources.length; i < ii; ++i) {\n      const source = sources[i];\n      const sourceState = source.getState();\n      if (sourceState == 'loading') {\n        const onChange = () => {\n          if (source.getState() == 'ready') {\n            source.removeEventListener('change', onChange);\n            this.changed();\n          }\n        };\n        source.addEventListener('change', onChange);\n      }\n      ready = ready && sourceState == 'ready';\n    }\n    const canvas = this.renderSources(frameState, sources);\n    if (this.getRenderer().renderComplete && ready) {\n      // Fully rendered, done.\n      this.renderedResolution_ = viewState.resolution;\n      return canvas;\n    }\n    // Render sources from previously fully rendered frames\n    if (this.renderedResolution_ > 0.5 * viewState.resolution) {\n      const altSources = this.getSources(\n        frameState.extent,\n        this.renderedResolution_\n      ).filter((source) => !sources.includes(source));\n      if (altSources.length > 0) {\n        return this.renderSources(frameState, altSources);\n      }\n    }\n    return canvas;\n  }\n\n  /**\n   * Update the layer style.  The `updateStyleVariables` function is a more efficient\n   * way to update layer rendering.  In cases where the whole style needs to be updated,\n   * this method may be called instead.  Note that calling this method will also replace\n   * any previously set variables, so the new style also needs to include new variables,\n   * if needed.\n   * @param {Style} style The new style.\n   */\n  setStyle(style) {\n    this.styleVariables_ = style.variables || {};\n    this.style_ = style;\n    const parsedStyle = parseStyle(this.style_, this.getSourceBandCount_());\n    const renderer = this.getRenderer();\n    renderer.reset({\n      vertexShader: parsedStyle.vertexShader,\n      fragmentShader: parsedStyle.fragmentShader,\n      uniforms: parsedStyle.uniforms,\n      paletteTextures: parsedStyle.paletteTextures,\n    });\n    this.changed();\n  }\n\n  /**\n   * Update any variables used by the layer style and trigger a re-render.\n   * @param {Object<string, number>} variables Variables to update.\n   * @api\n   */\n  updateStyleVariables(variables) {\n    Object.assign(this.styleVariables_, variables);\n    this.changed();\n  }\n}\n\n/**\n * Clean up underlying WebGL resources.\n * @function\n * @api\n */\nWebGLTileLayer.prototype.dispose;\n\nexport default WebGLTileLayer;\n","/**\n * @module ol/reproj/DataTile\n */\nimport {ERROR_THRESHOLD} from './common.js';\n\nimport DataTile, {asArrayLike, asImageLike, toArray} from '../DataTile.js';\nimport EventType from '../events/EventType.js';\nimport TileState from '../TileState.js';\nimport Triangulation from './Triangulation.js';\nimport {\n  calculateSourceExtentResolution,\n  canvasPool,\n  render as renderReprojected,\n} from '../reproj.js';\nimport {clamp} from '../math.js';\nimport {createCanvasContext2D, releaseCanvas} from '../dom.js';\nimport {getArea, getIntersection} from '../extent.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n/**\n * @typedef {function(number, number, number, number) : import(\"../DataTile.js\").default} TileGetter\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../proj/Projection.js\").default} sourceProj Source projection.\n * @property {import(\"../tilegrid/TileGrid.js\").default} sourceTileGrid Source tile grid.\n * @property {import(\"../proj/Projection.js\").default} targetProj Target projection.\n * @property {import(\"../tilegrid/TileGrid.js\").default} targetTileGrid Target tile grid.\n * @property {import(\"../tilecoord.js\").TileCoord} tileCoord Coordinate of the tile.\n * @property {import(\"../tilecoord.js\").TileCoord} [wrappedTileCoord] Coordinate of the tile wrapped in X.\n * @property {number} pixelRatio Pixel ratio.\n * @property {number} gutter Gutter of the source tiles.\n * @property {TileGetter} getTileFunction Function returning source tiles (z, x, y, pixelRatio).\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @property {number} [errorThreshold] Acceptable reprojection error (in px).\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n */\n\n/**\n * @classdesc\n * Class encapsulating single reprojected data tile.\n * See {@link module:ol/source/DataTile~DataTileSource}.\n *\n */\nclass ReprojDataTile extends DataTile {\n  /**\n   * @param {Options} options Tile options.\n   */\n  constructor(options) {\n    super({\n      tileCoord: options.tileCoord,\n      loader: () => Promise.resolve(new Uint8Array(4)),\n      interpolate: options.interpolate,\n      transition: options.transition,\n    });\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = options.pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.gutter_ = options.gutter;\n\n    /**\n     * @type {import(\"../DataTile.js\").Data}\n     * @private\n     */\n    this.reprojData_ = null;\n\n    /**\n     * @type {Error}\n     * @private\n     */\n    this.reprojError_ = null;\n\n    /**\n     * @type {import('../size.js').Size}\n     * @private\n     */\n    this.reprojSize_ = undefined;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.sourceTileGrid_ = options.sourceTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.targetTileGrid_ = options.targetTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilecoord.js\").TileCoord}\n     */\n    this.wrappedTileCoord_ = options.wrappedTileCoord || options.tileCoord;\n\n    /**\n     * @private\n     * @type {!Array<DataTile>}\n     */\n    this.sourceTiles_ = [];\n\n    /**\n     * @private\n     * @type {?Array<import(\"../events.js\").EventsKey>}\n     */\n    this.sourcesListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.sourceZ_ = 0;\n\n    const targetExtent = this.targetTileGrid_.getTileCoordExtent(\n      this.wrappedTileCoord_\n    );\n    const maxTargetExtent = this.targetTileGrid_.getExtent();\n    let maxSourceExtent = this.sourceTileGrid_.getExtent();\n\n    const limitedTargetExtent = maxTargetExtent\n      ? getIntersection(targetExtent, maxTargetExtent)\n      : targetExtent;\n\n    if (getArea(limitedTargetExtent) === 0) {\n      // Tile is completely outside range -> EMPTY\n      // TODO: is it actually correct that the source even creates the tile ?\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    const sourceProj = options.sourceProj;\n    const sourceProjExtent = sourceProj.getExtent();\n    if (sourceProjExtent) {\n      if (!maxSourceExtent) {\n        maxSourceExtent = sourceProjExtent;\n      } else {\n        maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);\n      }\n    }\n\n    const targetResolution = this.targetTileGrid_.getResolution(\n      this.wrappedTileCoord_[0]\n    );\n\n    const targetProj = options.targetProj;\n    const sourceResolution = calculateSourceExtentResolution(\n      sourceProj,\n      targetProj,\n      limitedTargetExtent,\n      targetResolution\n    );\n\n    if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n      // invalid sourceResolution -> EMPTY\n      // probably edges of the projections when no extent is defined\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    const errorThresholdInPixels =\n      options.errorThreshold !== undefined\n        ? options.errorThreshold\n        : ERROR_THRESHOLD;\n\n    /**\n     * @private\n     * @type {!import(\"./Triangulation.js\").default}\n     */\n    this.triangulation_ = new Triangulation(\n      sourceProj,\n      targetProj,\n      limitedTargetExtent,\n      maxSourceExtent,\n      sourceResolution * errorThresholdInPixels,\n      targetResolution\n    );\n\n    if (this.triangulation_.getTriangles().length === 0) {\n      // no valid triangles -> EMPTY\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    this.sourceZ_ = this.sourceTileGrid_.getZForResolution(sourceResolution);\n    let sourceExtent = this.triangulation_.calculateSourceExtent();\n\n    if (maxSourceExtent) {\n      if (sourceProj.canWrapX()) {\n        sourceExtent[1] = clamp(\n          sourceExtent[1],\n          maxSourceExtent[1],\n          maxSourceExtent[3]\n        );\n        sourceExtent[3] = clamp(\n          sourceExtent[3],\n          maxSourceExtent[1],\n          maxSourceExtent[3]\n        );\n      } else {\n        sourceExtent = getIntersection(sourceExtent, maxSourceExtent);\n      }\n    }\n\n    if (!getArea(sourceExtent)) {\n      this.state = TileState.EMPTY;\n    } else {\n      const sourceRange = this.sourceTileGrid_.getTileRangeForExtentAndZ(\n        sourceExtent,\n        this.sourceZ_\n      );\n      const getTile = options.getTileFunction;\n      for (let srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {\n        for (let srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {\n          const tile = getTile(this.sourceZ_, srcX, srcY, this.pixelRatio_);\n          if (tile) {\n            this.sourceTiles_.push(tile);\n          }\n        }\n      }\n\n      if (this.sourceTiles_.length === 0) {\n        this.state = TileState.EMPTY;\n      }\n    }\n  }\n\n  /**\n   * Get the tile size.\n   * @return {import('../size.js').Size} Tile size.\n   */\n  getSize() {\n    return this.reprojSize_;\n  }\n\n  /**\n   * Get the data for the tile.\n   * @return {import(\"../DataTile.js\").Data} Tile data.\n   */\n  getData() {\n    return this.reprojData_;\n  }\n\n  /**\n   * Get any loading error.\n   * @return {Error} Loading error.\n   */\n  getError() {\n    return this.reprojError_;\n  }\n\n  /**\n   * @private\n   */\n  reproject_() {\n    const dataSources = [];\n    this.sourceTiles_.forEach((tile) => {\n      if (!tile || tile.getState() !== TileState.LOADED) {\n        return;\n      }\n      const size = tile.getSize();\n      const gutter = this.gutter_;\n      /**\n       * @type {import(\"../DataTile.js\").ArrayLike}\n       */\n      let tileData;\n      const arrayData = asArrayLike(tile.getData());\n      if (arrayData) {\n        tileData = arrayData;\n      } else {\n        tileData = toArray(asImageLike(tile.getData()));\n      }\n      const pixelSize = [size[0] + 2 * gutter, size[1] + 2 * gutter];\n      const isFloat = tileData instanceof Float32Array;\n      const pixelCount = pixelSize[0] * pixelSize[1];\n      const DataType = isFloat ? Float32Array : Uint8Array;\n      const tileDataR = new DataType(tileData.buffer);\n      const bytesPerElement = DataType.BYTES_PER_ELEMENT;\n      const bytesPerPixel = (bytesPerElement * tileDataR.length) / pixelCount;\n      const bytesPerRow = tileDataR.byteLength / pixelSize[1];\n      const bandCount = Math.floor(\n        bytesPerRow / bytesPerElement / pixelSize[0]\n      );\n      const packedLength = pixelCount * bandCount;\n      let packedData = tileDataR;\n      if (tileDataR.length !== packedLength) {\n        packedData = new DataType(packedLength);\n        let dataIndex = 0;\n        let rowOffset = 0;\n        const colCount = pixelSize[0] * bandCount;\n        for (let rowIndex = 0; rowIndex < pixelSize[1]; ++rowIndex) {\n          for (let colIndex = 0; colIndex < colCount; ++colIndex) {\n            packedData[dataIndex++] = tileDataR[rowOffset + colIndex];\n          }\n          rowOffset += bytesPerRow / bytesPerElement;\n        }\n      }\n      dataSources.push({\n        extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),\n        data: new Uint8Array(packedData.buffer),\n        dataType: DataType,\n        bytesPerPixel: bytesPerPixel,\n        pixelSize: pixelSize,\n      });\n    });\n    this.sourceTiles_.length = 0;\n\n    if (dataSources.length === 0) {\n      this.state = TileState.ERROR;\n    } else {\n      const z = this.wrappedTileCoord_[0];\n      const size = this.targetTileGrid_.getTileSize(z);\n      const targetWidth = typeof size === 'number' ? size : size[0];\n      const targetHeight = typeof size === 'number' ? size : size[1];\n      const targetResolution = this.targetTileGrid_.getResolution(z);\n      const sourceResolution = this.sourceTileGrid_.getResolution(\n        this.sourceZ_\n      );\n\n      const targetExtent = this.targetTileGrid_.getTileCoordExtent(\n        this.wrappedTileCoord_\n      );\n\n      let dataR, dataU;\n\n      const bytesPerPixel = dataSources[0].bytesPerPixel;\n\n      const reprojs = Math.ceil(bytesPerPixel / 3);\n      for (let reproj = reprojs - 1; reproj >= 0; --reproj) {\n        const sources = [];\n        for (let i = 0, len = dataSources.length; i < len; ++i) {\n          const dataSource = dataSources[i];\n          const buffer = dataSource.data;\n          const pixelSize = dataSource.pixelSize;\n          const width = pixelSize[0];\n          const height = pixelSize[1];\n          const context = createCanvasContext2D(width, height, canvasPool);\n          const imageData = context.createImageData(width, height);\n          const data = imageData.data;\n          let offset = reproj * 3;\n          for (let j = 0, len = data.length; j < len; j += 4) {\n            data[j] = buffer[offset];\n            data[j + 1] = buffer[offset + 1];\n            data[j + 2] = buffer[offset + 2];\n            data[j + 3] = 255;\n            offset += bytesPerPixel;\n          }\n          context.putImageData(imageData, 0, 0);\n          sources.push({\n            extent: dataSource.extent,\n            image: context.canvas,\n          });\n        }\n\n        const canvas = renderReprojected(\n          targetWidth,\n          targetHeight,\n          this.pixelRatio_,\n          sourceResolution,\n          this.sourceTileGrid_.getExtent(),\n          targetResolution,\n          targetExtent,\n          this.triangulation_,\n          sources,\n          this.gutter_,\n          false,\n          false\n        );\n\n        for (let i = 0, len = sources.length; i < len; ++i) {\n          const canvas = sources[i].image;\n          const context = canvas.getContext('2d');\n          releaseCanvas(context);\n          canvasPool.push(context.canvas);\n        }\n\n        const context = canvas.getContext('2d');\n        const imageData = context.getImageData(\n          0,\n          0,\n          canvas.width,\n          canvas.height\n        );\n\n        releaseCanvas(context);\n        canvasPool.push(canvas);\n\n        if (!dataR) {\n          dataU = new Uint8Array(\n            bytesPerPixel * imageData.width * imageData.height\n          );\n          dataR = new dataSources[0].dataType(dataU.buffer);\n        }\n\n        const data = imageData.data;\n        let offset = reproj * 3;\n        for (let i = 0, len = data.length; i < len; i += 4) {\n          if (data[i + 3] === 255) {\n            dataU[offset] = data[i];\n            dataU[offset + 1] = data[i + 1];\n            dataU[offset + 2] = data[i + 2];\n          } else {\n            dataU[offset] = 0;\n            dataU[offset + 1] = 0;\n            dataU[offset + 2] = 0;\n          }\n          offset += bytesPerPixel;\n        }\n      }\n\n      this.reprojData_ = dataR;\n      this.reprojSize_ = [\n        Math.round(targetWidth * this.pixelRatio_),\n        Math.round(targetHeight * this.pixelRatio_),\n      ];\n      this.state = TileState.LOADED;\n    }\n    this.changed();\n  }\n\n  /**\n   * Load not yet loaded URI.\n   */\n  load() {\n    if (this.state !== TileState.IDLE && this.state !== TileState.ERROR) {\n      return;\n    }\n    this.state = TileState.LOADING;\n    this.changed();\n\n    let leftToLoad = 0;\n\n    this.sourcesListenerKeys_ = [];\n    this.sourceTiles_.forEach((tile) => {\n      const state = tile.getState();\n      if (state !== TileState.IDLE && state !== TileState.LOADING) {\n        return;\n      }\n      leftToLoad++;\n\n      const sourceListenKey = listen(\n        tile,\n        EventType.CHANGE,\n        function () {\n          const state = tile.getState();\n          if (\n            state == TileState.LOADED ||\n            state == TileState.ERROR ||\n            state == TileState.EMPTY\n          ) {\n            unlistenByKey(sourceListenKey);\n            leftToLoad--;\n            if (leftToLoad === 0) {\n              this.unlistenSources_();\n              this.reproject_();\n            }\n          }\n        },\n        this\n      );\n      this.sourcesListenerKeys_.push(sourceListenKey);\n    });\n\n    if (leftToLoad === 0) {\n      setTimeout(this.reproject_.bind(this), 0);\n    } else {\n      this.sourceTiles_.forEach(function (tile) {\n        const state = tile.getState();\n        if (state == TileState.IDLE) {\n          tile.load();\n        }\n      });\n    }\n  }\n\n  /**\n   * @private\n   */\n  unlistenSources_() {\n    this.sourcesListenerKeys_.forEach(unlistenByKey);\n    this.sourcesListenerKeys_ = null;\n  }\n}\n\nexport default ReprojDataTile;\n","/**\n * @module ol/source/DataTile\n */\nimport DataTile from '../DataTile.js';\nimport EventType from '../events/EventType.js';\nimport ReprojDataTile from '../reproj/DataTile.js';\nimport TileCache from '../TileCache.js';\nimport TileEventType from './TileEventType.js';\nimport TileSource, {TileSourceEvent} from './Tile.js';\nimport TileState from '../TileState.js';\nimport {\n  createXYZ,\n  extentFromProjection,\n  getForProjection as getTileGridForProjection,\n} from '../tilegrid.js';\nimport {equivalent, get as getProjection} from '../proj.js';\nimport {getKeyZXY} from '../tilecoord.js';\nimport {getUid} from '../util.js';\nimport {toPromise} from '../functions.js';\nimport {toSize} from '../size.js';\n\n/**\n * Data tile loading function.  The function is called with z, x, and y tile coordinates and\n * returns {@link import(\"../DataTile.js\").Data data} for a tile or a promise for the same.\n * @typedef {function(number, number, number) : (import(\"../DataTile.js\").Data|Promise<import(\"../DataTile.js\").Data>)} Loader\n */\n\n/**\n * @typedef {Object} Options\n * @property {Loader} [loader] Data loader.  Called with z, x, and y tile coordinates.\n * Returns {@link import(\"../DataTile.js\").Data data} for a tile or a promise for the same.\n * For loaders that generate images, the promise should not resolve until the image is loaded.\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [maxZoom=42] Optional max zoom level. Not used if `tileGrid` is provided.\n * @property {number} [minZoom=0] Optional min zoom level. Not used if `tileGrid` is provided.\n * @property {number|import(\"../size.js\").Size} [tileSize=[256, 256]] The pixel width and height of the source tiles.\n * This may be different than the rendered pixel size if a `tileGrid` is provided.\n * @property {number} [gutter=0] The size in pixels of the gutter around data tiles to ignore.\n * This allows artifacts of rendering at tile edges to be ignored.\n * Supported data should be wider and taller than the tile size by a value of `2 x gutter`.\n * @property {number} [maxResolution] Optional tile grid resolution at level zero. Not used if `tileGrid` is provided.\n * @property {import(\"../proj.js\").ProjectionLike} [projection='EPSG:3857'] Tile projection.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid.\n * @property {boolean} [opaque=false] Whether the layer is opaque.\n * @property {import(\"./Source.js\").State} [state] The source state.\n * @property {boolean} [wrapX=false] Render tiles beyond the antimeridian.\n * @property {number} [transition] Transition time when fading in new tiles (in miliseconds).\n * @property {number} [bandCount=4] Number of bands represented in the data.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n */\n\n/**\n * @classdesc\n * A source for typed array data tiles.\n *\n * @fires import(\"./Tile.js\").TileSourceEvent\n * @api\n */\nclass DataTileSource extends TileSource {\n  /**\n   * @param {Options} options DataTile source options.\n   */\n  constructor(options) {\n    const projection =\n      options.projection === undefined ? 'EPSG:3857' : options.projection;\n\n    let tileGrid = options.tileGrid;\n    if (tileGrid === undefined && projection) {\n      tileGrid = createXYZ({\n        extent: extentFromProjection(projection),\n        maxResolution: options.maxResolution,\n        maxZoom: options.maxZoom,\n        minZoom: options.minZoom,\n        tileSize: options.tileSize,\n      });\n    }\n\n    super({\n      cacheSize: 0.1, // don't cache on the source\n      attributions: options.attributions,\n      attributionsCollapsible: options.attributionsCollapsible,\n      projection: projection,\n      tileGrid: tileGrid,\n      opaque: options.opaque,\n      state: options.state,\n      wrapX: options.wrapX,\n      transition: options.transition,\n      interpolate: options.interpolate,\n    });\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.gutter_ = options.gutter !== undefined ? options.gutter : 0;\n\n    /**\n     * @private\n     * @type {import('../size.js').Size|null}\n     */\n    this.tileSize_ = options.tileSize ? toSize(options.tileSize) : null;\n\n    /**\n     * @private\n     * @type {Array<import('../size.js').Size>|null}\n     */\n    this.tileSizes_ = null;\n\n    /**\n     * @private\n     * @type {!Object<string, boolean>}\n     */\n    this.tileLoadingKeys_ = {};\n\n    /**\n     * @private\n     */\n    this.loader_ = options.loader;\n\n    this.handleTileChange_ = this.handleTileChange_.bind(this);\n\n    /**\n     * @type {number}\n     */\n    this.bandCount = options.bandCount === undefined ? 4 : options.bandCount; // assume RGBA if undefined\n\n    /**\n     * @private\n     * @type {!Object<string, import(\"../tilegrid/TileGrid.js\").default>}\n     */\n    this.tileGridForProjection_ = {};\n\n    /**\n     * @private\n     * @type {!Object<string, import(\"../TileCache.js\").default>}\n     */\n    this.tileCacheForProjection_ = {};\n  }\n\n  /**\n   * Set the source tile sizes.  The length of the array is expected to match the number of\n   * levels in the tile grid.\n   * @protected\n   * @param {Array<import('../size.js').Size>} tileSizes An array of tile sizes.\n   */\n  setTileSizes(tileSizes) {\n    this.tileSizes_ = tileSizes;\n  }\n\n  /**\n   * Get the source tile size at the given zoom level.  This may be different than the rendered tile\n   * size.\n   * @protected\n   * @param {number} z Tile zoom level.\n   * @return {import('../size.js').Size} The source tile size.\n   */\n  getTileSize(z) {\n    if (this.tileSizes_) {\n      return this.tileSizes_[z];\n    }\n    if (this.tileSize_) {\n      return this.tileSize_;\n    }\n    const tileGrid = this.getTileGrid();\n    return tileGrid ? toSize(tileGrid.getTileSize(z)) : [256, 256];\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {number} Gutter.\n   */\n  getGutterForProjection(projection) {\n    const thisProj = this.getProjection();\n    if (!thisProj || equivalent(thisProj, projection)) {\n      return this.gutter_;\n    }\n\n    return 0;\n  }\n\n  /**\n   * @param {Loader} loader The data loader.\n   * @protected\n   */\n  setLoader(loader) {\n    this.loader_ = loader;\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {import(\"../proj/Projection.js\").default} targetProj The output projection.\n   * @param {import(\"../proj/Projection.js\").default} sourceProj The input projection.\n   * @return {!DataTile} Tile.\n   */\n  getReprojTile_(z, x, y, targetProj, sourceProj) {\n    const cache = this.getTileCacheForProjection(targetProj);\n    const tileCoordKey = getKeyZXY(z, x, y);\n    if (cache.containsKey(tileCoordKey)) {\n      const tile = cache.get(tileCoordKey);\n      if (tile && tile.key == this.getKey()) {\n        return tile;\n      }\n    }\n\n    const tileGrid = this.getTileGrid();\n    const reprojTilePixelRatio = Math.max.apply(\n      null,\n      tileGrid.getResolutions().map((r, z) => {\n        const tileSize = toSize(tileGrid.getTileSize(z));\n        const textureSize = this.getTileSize(z);\n        return Math.max(\n          textureSize[0] / tileSize[0],\n          textureSize[1] / tileSize[1]\n        );\n      })\n    );\n\n    const sourceTileGrid = this.getTileGridForProjection(sourceProj);\n    const targetTileGrid = this.getTileGridForProjection(targetProj);\n    const tileCoord = [z, x, y];\n    const wrappedTileCoord = this.getTileCoordForTileUrlFunction(\n      tileCoord,\n      targetProj\n    );\n\n    const options = Object.assign(\n      {\n        sourceProj,\n        sourceTileGrid,\n        targetProj,\n        targetTileGrid,\n        tileCoord,\n        wrappedTileCoord,\n        pixelRatio: reprojTilePixelRatio,\n        gutter: this.getGutterForProjection(sourceProj),\n        getTileFunction: (z, x, y, pixelRatio) =>\n          this.getTile(z, x, y, pixelRatio, sourceProj),\n      },\n      this.tileOptions\n    );\n    const newTile = new ReprojDataTile(options);\n    newTile.key = this.getKey();\n    return newTile;\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!DataTile} Tile.\n   */\n  getTile(z, x, y, pixelRatio, projection) {\n    const sourceProjection = this.getProjection();\n    if (\n      sourceProjection &&\n      projection &&\n      !equivalent(sourceProjection, projection)\n    ) {\n      return this.getReprojTile_(z, x, y, projection, sourceProjection);\n    }\n\n    const size = this.getTileSize(z);\n    const tileCoordKey = getKeyZXY(z, x, y);\n    if (this.tileCache.containsKey(tileCoordKey)) {\n      return this.tileCache.get(tileCoordKey);\n    }\n\n    const sourceLoader = this.loader_;\n\n    function loader() {\n      return toPromise(function () {\n        return sourceLoader(z, x, y);\n      });\n    }\n\n    const options = Object.assign(\n      {\n        tileCoord: [z, x, y],\n        loader: loader,\n        size: size,\n      },\n      this.tileOptions\n    );\n\n    const tile = new DataTile(options);\n    tile.key = this.getKey();\n    tile.addEventListener(EventType.CHANGE, this.handleTileChange_);\n\n    this.tileCache.set(tileCoordKey, tile);\n    return tile;\n  }\n\n  /**\n   * Handle tile change events.\n   * @param {import(\"../events/Event.js\").default} event Event.\n   */\n  handleTileChange_(event) {\n    const tile = /** @type {import(\"../Tile.js\").default} */ (event.target);\n    const uid = getUid(tile);\n    const tileState = tile.getState();\n    let type;\n    if (tileState == TileState.LOADING) {\n      this.tileLoadingKeys_[uid] = true;\n      type = TileEventType.TILELOADSTART;\n    } else if (uid in this.tileLoadingKeys_) {\n      delete this.tileLoadingKeys_[uid];\n      type =\n        tileState == TileState.ERROR\n          ? TileEventType.TILELOADERROR\n          : tileState == TileState.LOADED\n          ? TileEventType.TILELOADEND\n          : undefined;\n    }\n    if (type) {\n      this.dispatchEvent(new TileSourceEvent(type, tile));\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../tilegrid/TileGrid.js\").default} Tile grid.\n   */\n  getTileGridForProjection(projection) {\n    const thisProj = this.getProjection();\n    if (this.tileGrid && (!thisProj || equivalent(thisProj, projection))) {\n      return this.tileGrid;\n    }\n\n    const projKey = getUid(projection);\n    if (!(projKey in this.tileGridForProjection_)) {\n      this.tileGridForProjection_[projKey] =\n        getTileGridForProjection(projection);\n    }\n    return this.tileGridForProjection_[projKey];\n  }\n\n  /**\n   * Sets the tile grid to use when reprojecting the tiles to the given\n   * projection instead of the default tile grid for the projection.\n   *\n   * This can be useful when the default tile grid cannot be created\n   * (e.g. projection has no extent defined) or\n   * for optimization reasons (custom tile size, resolutions, ...).\n   *\n   * @param {import(\"../proj.js\").ProjectionLike} projection Projection.\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tilegrid Tile grid to use for the projection.\n   * @api\n   */\n  setTileGridForProjection(projection, tilegrid) {\n    const proj = getProjection(projection);\n    if (proj) {\n      const projKey = getUid(proj);\n      if (!(projKey in this.tileGridForProjection_)) {\n        this.tileGridForProjection_[projKey] = tilegrid;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../TileCache.js\").default} Tile cache.\n   */\n  getTileCacheForProjection(projection) {\n    const thisProj = this.getProjection();\n    if (!thisProj || equivalent(thisProj, projection)) {\n      return this.tileCache;\n    }\n\n    const projKey = getUid(projection);\n    if (!(projKey in this.tileCacheForProjection_)) {\n      this.tileCacheForProjection_[projKey] = new TileCache(0.1); // don't cache\n    }\n    return this.tileCacheForProjection_[projKey];\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {!Object<string, boolean>} usedTiles Used tiles.\n   */\n  expireCache(projection, usedTiles) {\n    const usedTileCache = this.getTileCacheForProjection(projection);\n\n    this.tileCache.expireCache(\n      this.tileCache == usedTileCache ? usedTiles : {}\n    );\n    for (const id in this.tileCacheForProjection_) {\n      const tileCache = this.tileCacheForProjection_[id];\n      tileCache.expireCache(tileCache == usedTileCache ? usedTiles : {});\n    }\n  }\n\n  clear() {\n    super.clear();\n    for (const id in this.tileCacheForProjection_) {\n      this.tileCacheForProjection_[id].clear();\n    }\n  }\n}\n\nexport default DataTileSource;\n","import { getDecoder } from './compression/index.js';\n\nconst defaultPoolSize = typeof navigator !== 'undefined' ? (navigator.hardwareConcurrency || 2) : 2;\n\n/**\n * @module pool\n */\n\n/**\n * Pool for workers to decode chunks of the images.\n */\nclass Pool {\n  /**\n   * @constructor\n   * @param {Number} [size] The size of the pool. Defaults to the number of CPUs\n   *                      available. When this parameter is `null` or 0, then the\n   *                      decoding will be done in the main thread.\n   * @param {function(): Worker} [createWorker] A function that creates the decoder worker.\n   * Defaults to a worker with all decoders that ship with geotiff.js. The `createWorker()`\n   * function is expected to return a `Worker` compatible with Web Workers. For code that\n   * runs in Node, [web-worker](https://www.npmjs.com/package/web-worker) is a good choice.\n   *\n   * A worker that uses a custom lzw decoder would look like this `my-custom-worker.js` file:\n   * ```js\n   * import { addDecoder, getDecoder } from 'geotiff';\n   * addDecoder(5, () => import ('./my-custom-lzw').then((m) => m.default));\n   * self.addEventListener('message', async (e) => {\n   *   const { id, fileDirectory, buffer } = e.data;\n   *   const decoder = await getDecoder(fileDirectory);\n   *   const decoded = await decoder.decode(fileDirectory, buffer);\n   *   self.postMessage({ decoded, id }, [decoded]);\n   * });\n   * ```\n   * The way the above code is built into a worker by the `createWorker()` function\n   * depends on the used bundler. For most bundlers, something like this will work:\n   * ```js\n   * function createWorker() {\n   *   return new Worker(new URL('./my-custom-worker.js', import.meta.url));\n   * }\n   * ```\n   */\n  constructor(size = defaultPoolSize, createWorker) {\n    this.workers = null;\n    this._awaitingDecoder = null;\n    this.size = size;\n    this.messageId = 0;\n    if (size) {\n      this._awaitingDecoder = createWorker ? Promise.resolve(createWorker) : new Promise((resolve) => {\n        import('./worker/decoder.js').then((module) => {\n          resolve(module.create);\n        });\n      });\n      this._awaitingDecoder.then((create) => {\n        this._awaitingDecoder = null;\n        this.workers = [];\n        for (let i = 0; i < size; i++) {\n          this.workers.push({ worker: create(), idle: true });\n        }\n      });\n    }\n  }\n\n  /**\n   * Decode the given block of bytes with the set compression method.\n   * @param {ArrayBuffer} buffer the array buffer of bytes to decode.\n   * @returns {Promise<ArrayBuffer>} the decoded result as a `Promise`\n   */\n  async decode(fileDirectory, buffer) {\n    if (this._awaitingDecoder) {\n      await this._awaitingDecoder;\n    }\n    return this.size === 0\n      ? getDecoder(fileDirectory).then((decoder) => decoder.decode(fileDirectory, buffer))\n      : new Promise((resolve) => {\n        const worker = this.workers.find((candidate) => candidate.idle)\n          || this.workers[Math.floor(Math.random() * this.size)];\n        worker.idle = false;\n        const id = this.messageId++;\n        const onMessage = (e) => {\n          if (e.data.id === id) {\n            worker.idle = true;\n            resolve(e.data.decoded);\n            worker.worker.removeEventListener('message', onMessage);\n          }\n        };\n        worker.worker.addEventListener('message', onMessage);\n        worker.worker.postMessage({ fileDirectory, buffer, id }, [buffer]);\n      });\n  }\n\n  destroy() {\n    if (this.workers) {\n      this.workers.forEach((worker) => {\n        worker.worker.terminate();\n      });\n      this.workers = null;\n    }\n  }\n}\n\nexport default Pool;\n","/**\n * @module ol/source/GeoTIFF\n */\nimport DataTile from './DataTile.js';\nimport TileGrid from '../tilegrid/TileGrid.js';\nimport {\n  Pool,\n  globals as geotiffGlobals,\n  fromBlob as tiffFromBlob,\n  fromUrl as tiffFromUrl,\n  fromUrls as tiffFromUrls,\n} from 'geotiff';\nimport {\n  Projection,\n  get as getCachedProjection,\n  toUserCoordinate,\n  toUserExtent,\n} from '../proj.js';\nimport {clamp} from '../math.js';\nimport {getCenter, getIntersection} from '../extent.js';\nimport {error as logError} from '../console.js';\nimport {fromCode as unitsFromCode} from '../proj/Units.js';\n\n/**\n * Determine if an image type is a mask.\n * See https://www.awaresystems.be/imaging/tiff/tifftags/newsubfiletype.html\n * @param {GeoTIFFImage} image The image.\n * @return {boolean} The image is a mask.\n */\nfunction isMask(image) {\n  const fileDirectory = image.fileDirectory;\n  const type = fileDirectory.NewSubfileType || 0;\n  return (type & 4) === 4;\n}\n\n/**\n * @param {true|false|'auto'} preference The convertToRGB option.\n * @param {GeoTIFFImage} image The image.\n * @return {boolean} Use the `image.readRGB()` method.\n */\nfunction readRGB(preference, image) {\n  if (!preference) {\n    return false;\n  }\n  if (preference === true) {\n    return true;\n  }\n  if (image.getSamplesPerPixel() !== 3) {\n    return false;\n  }\n  const interpretation = image.fileDirectory.PhotometricInterpretation;\n  const interpretations = geotiffGlobals.photometricInterpretations;\n  return (\n    interpretation === interpretations.CMYK ||\n    interpretation === interpretations.YCbCr ||\n    interpretation === interpretations.CIELab ||\n    interpretation === interpretations.ICCLab\n  );\n}\n\n/**\n * @typedef {Object} SourceInfo\n * @property {string} [url] URL for the source GeoTIFF.\n * @property {Array<string>} [overviews] List of any overview URLs, only applies if the url parameter is given.\n * @property {Blob} [blob] Blob containing the source GeoTIFF. `blob` and `url` are mutually exclusive.\n * @property {number} [min=0] The minimum source data value.  Rendered values are scaled from 0 to 1 based on\n * the configured min and max.  If not provided and raster statistics are available, those will be used instead.\n * If neither are available, the minimum for the data type will be used.  To disable this behavior, set\n * the `normalize` option to `false` in the constructor.\n * @property {number} [max] The maximum source data value.  Rendered values are scaled from 0 to 1 based on\n * the configured min and max.  If not provided and raster statistics are available, those will be used instead.\n * If neither are available, the maximum for the data type will be used.  To disable this behavior, set\n * the `normalize` option to `false` in the constructor.\n * @property {number} [nodata] Values to discard (overriding any nodata values in the metadata).\n * When provided, an additional alpha band will be added to the data.  Often the GeoTIFF metadata\n * will include information about nodata values, so you should only need to set this property if\n * you find that it is not already extracted from the metadata.\n * @property {Array<number>} [bands] Band numbers to be read from (where the first band is `1`). If not provided, all bands will\n * be read. For example, if a GeoTIFF has blue (1), green (2), red (3), and near-infrared (4) bands, and you only need the\n * near-infrared band, configure `bands: [4]`.\n */\n\n/**\n * @typedef {Object} GeoKeys\n * @property {number} GTModelTypeGeoKey Model type.\n * @property {number} GTRasterTypeGeoKey Raster type.\n * @property {number} GeogAngularUnitsGeoKey Angular units.\n * @property {number} GeogInvFlatteningGeoKey Inverse flattening.\n * @property {number} GeogSemiMajorAxisGeoKey Semi-major axis.\n * @property {number} GeographicTypeGeoKey Geographic coordinate system code.\n * @property {number} ProjLinearUnitsGeoKey Projected linear unit code.\n * @property {number} ProjectedCSTypeGeoKey Projected coordinate system code.\n */\n\n/**\n * @typedef {import(\"geotiff\").GeoTIFF} GeoTIFF\n */\n\n/**\n * @typedef {import(\"geotiff\").MultiGeoTIFF} MultiGeoTIFF\n */\n\n/**\n * @typedef {Object} GDALMetadata\n * @property {string} STATISTICS_MINIMUM The minimum value (as a string).\n * @property {string} STATISTICS_MAXIMUM The maximum value (as a string).\n */\n\nconst STATISTICS_MAXIMUM = 'STATISTICS_MAXIMUM';\nconst STATISTICS_MINIMUM = 'STATISTICS_MINIMUM';\n\nconst defaultTileSize = 256;\n\n/**\n * @typedef {import(\"geotiff\").GeoTIFFImage} GeoTIFFImage\n */\n\nlet workerPool;\nfunction getWorkerPool() {\n  if (!workerPool) {\n    workerPool = new Pool();\n  }\n  return workerPool;\n}\n\n/**\n * Get the bounding box of an image.  If the image does not have an affine transform,\n * the pixel bounds are returned.\n * @param {GeoTIFFImage} image The image.\n * @return {Array<number>} The image bounding box.\n */\nfunction getBoundingBox(image) {\n  try {\n    return image.getBoundingBox();\n  } catch (_) {\n    const fileDirectory = image.fileDirectory;\n    return [0, 0, fileDirectory.ImageWidth, fileDirectory.ImageLength];\n  }\n}\n\n/**\n * Get the origin of an image.  If the image does not have an affine transform,\n * the top-left corner of the pixel bounds is returned.\n * @param {GeoTIFFImage} image The image.\n * @return {Array<number>} The image origin.\n */\nfunction getOrigin(image) {\n  try {\n    return image.getOrigin().slice(0, 2);\n  } catch (_) {\n    return [0, image.fileDirectory.ImageLength];\n  }\n}\n\n/**\n * Get the resolution of an image.  If the image does not have an affine transform,\n * the width of the image is compared with the reference image.\n * @param {GeoTIFFImage} image The image.\n * @param {GeoTIFFImage} referenceImage The reference image.\n * @return {Array<number>} The map x and y units per pixel.\n */\nfunction getResolutions(image, referenceImage) {\n  try {\n    return image.getResolution(referenceImage);\n  } catch (_) {\n    return [\n      referenceImage.fileDirectory.ImageWidth / image.fileDirectory.ImageWidth,\n      referenceImage.fileDirectory.ImageHeight /\n        image.fileDirectory.ImageHeight,\n    ];\n  }\n}\n\n/**\n * @param {GeoTIFFImage} image A GeoTIFF.\n * @return {import(\"../proj/Projection.js\").default} The image projection.\n */\nfunction getProjection(image) {\n  const geoKeys = image.geoKeys;\n  if (!geoKeys) {\n    return null;\n  }\n\n  if (\n    geoKeys.ProjectedCSTypeGeoKey &&\n    geoKeys.ProjectedCSTypeGeoKey !== 32767\n  ) {\n    const code = 'EPSG:' + geoKeys.ProjectedCSTypeGeoKey;\n    let projection = getCachedProjection(code);\n    if (!projection) {\n      const units = unitsFromCode(geoKeys.ProjLinearUnitsGeoKey);\n      if (units) {\n        projection = new Projection({\n          code: code,\n          units: units,\n        });\n      }\n    }\n    return projection;\n  }\n\n  if (geoKeys.GeographicTypeGeoKey && geoKeys.GeographicTypeGeoKey !== 32767) {\n    const code = 'EPSG:' + geoKeys.GeographicTypeGeoKey;\n    let projection = getCachedProjection(code);\n    if (!projection) {\n      const units = unitsFromCode(geoKeys.GeogAngularUnitsGeoKey);\n      if (units) {\n        projection = new Projection({\n          code: code,\n          units: units,\n        });\n      }\n    }\n    return projection;\n  }\n\n  return null;\n}\n\n/**\n * @param {GeoTIFF|MultiGeoTIFF} tiff A GeoTIFF.\n * @return {Promise<Array<GeoTIFFImage>>} Resolves to a list of images.\n */\nfunction getImagesForTIFF(tiff) {\n  return tiff.getImageCount().then(function (count) {\n    const requests = new Array(count);\n    for (let i = 0; i < count; ++i) {\n      requests[i] = tiff.getImage(i);\n    }\n    return Promise.all(requests);\n  });\n}\n\n/**\n * @param {SourceInfo} source The GeoTIFF source.\n * @param {Object} options Options for the GeoTIFF source.\n * @return {Promise<Array<GeoTIFFImage>>} Resolves to a list of images.\n */\nfunction getImagesForSource(source, options) {\n  let request;\n  if (source.blob) {\n    request = tiffFromBlob(source.blob);\n  } else if (source.overviews) {\n    request = tiffFromUrls(source.url, source.overviews, options);\n  } else {\n    request = tiffFromUrl(source.url, options);\n  }\n  return request.then(getImagesForTIFF);\n}\n\n/**\n * @param {number|Array<number>|Array<Array<number>>} expected Expected value.\n * @param {number|Array<number>|Array<Array<number>>} got Actual value.\n * @param {number} tolerance Accepted tolerance in fraction of expected between expected and got.\n * @param {string} message The error message.\n * @param {function(Error):void} rejector A function to be called with any error.\n */\nfunction assertEqual(expected, got, tolerance, message, rejector) {\n  if (Array.isArray(expected)) {\n    const length = expected.length;\n    if (!Array.isArray(got) || length != got.length) {\n      const error = new Error(message);\n      rejector(error);\n      throw error;\n    }\n    for (let i = 0; i < length; ++i) {\n      assertEqual(expected[i], got[i], tolerance, message, rejector);\n    }\n    return;\n  }\n\n  got = /** @type {number} */ (got);\n  if (Math.abs(expected - got) > tolerance * expected) {\n    throw new Error(message);\n  }\n}\n\n/**\n * @param {Array} array The data array.\n * @return {number} The minimum value.\n */\nfunction getMinForDataType(array) {\n  if (array instanceof Int8Array) {\n    return -128;\n  }\n  if (array instanceof Int16Array) {\n    return -32768;\n  }\n  if (array instanceof Int32Array) {\n    return -2147483648;\n  }\n  if (array instanceof Float32Array) {\n    return 1.2e-38;\n  }\n  return 0;\n}\n\n/**\n * @param {Array} array The data array.\n * @return {number} The maximum value.\n */\nfunction getMaxForDataType(array) {\n  if (array instanceof Int8Array) {\n    return 127;\n  }\n  if (array instanceof Uint8Array) {\n    return 255;\n  }\n  if (array instanceof Uint8ClampedArray) {\n    return 255;\n  }\n  if (array instanceof Int16Array) {\n    return 32767;\n  }\n  if (array instanceof Uint16Array) {\n    return 65535;\n  }\n  if (array instanceof Int32Array) {\n    return 2147483647;\n  }\n  if (array instanceof Uint32Array) {\n    return 4294967295;\n  }\n  if (array instanceof Float32Array) {\n    return 3.4e38;\n  }\n  return 255;\n}\n\n/**\n * @typedef {Object} GeoTIFFSourceOptions\n * @property {boolean} [forceXHR=false] Whether to force the usage of the browsers XMLHttpRequest API.\n * @property {Object<string, string>} [headers] additional key-value pairs of headers to be passed with each request. Key is the header name, value the header value.\n * @property {string} [credentials] How credentials shall be handled. See\n * https://developer.mozilla.org/en-US/docs/Web/API/fetch for reference and possible values\n * @property {number} [maxRanges] The maximum amount of ranges to request in a single multi-range request.\n * By default only a single range is used.\n * @property {boolean} [allowFullFile=false] Whether or not a full file is accepted when only a portion is\n * requested. Only use this when you know the source image to be small enough to fit in memory.\n * @property {number} [blockSize=65536] The block size to use.\n * @property {number} [cacheSize=100] The number of blocks that shall be held in a LRU cache.\n */\n\n/**\n * @typedef {Object} Options\n * @property {Array<SourceInfo>} sources List of information about GeoTIFF sources.\n * Multiple sources can be combined when their resolution sets are equal after applying a scale.\n * The list of sources defines a mapping between input bands as they are read from each GeoTIFF and\n * the output bands that are provided by data tiles. To control which bands to read from each GeoTIFF,\n * use the {@link import(\"./GeoTIFF.js\").SourceInfo bands} property. If, for example, you specify two\n * sources, one with 3 bands and {@link import(\"./GeoTIFF.js\").SourceInfo nodata} configured, and\n * another with 1 band, the resulting data tiles will have 5 bands: 3 from the first source, 1 alpha\n * band from the first source, and 1 band from the second source.\n * @property {GeoTIFFSourceOptions} [sourceOptions] Additional options to be passed to [geotiff.js](https://geotiffjs.github.io/geotiff.js/module-geotiff.html)'s `fromUrl` or `fromUrls` methods.\n * @property {true|false|'auto'} [convertToRGB=false] By default, bands from the sources are read as-is. When\n * reading GeoTIFFs with the purpose of displaying them as RGB images, setting this to `true` will\n * convert other color spaces (YCbCr, CMYK) to RGB.  Setting the option to `'auto'` will make it so CMYK, YCbCr,\n * CIELab, and ICCLab images will automatically be converted to RGB.\n * @property {boolean} [normalize=true] By default, the source data is normalized to values between\n * 0 and 1 with scaling factors based on the raster statistics or `min` and `max` properties of each source.\n * If instead you want to work with the raw values in a style expression, set this to `false`.  Setting this option\n * to `false` will make it so any `min` and `max` properties on sources are ignored.\n * @property {boolean} [opaque=false] Whether the layer is opaque.\n * @property {number} [transition=250] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {boolean} [wrapX=false] Render tiles beyond the tile grid extent.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * the linear interpolation is used to resample the data.  If false, nearest neighbor is used.\n */\n\n/**\n * @classdesc\n * A source for working with GeoTIFF data.\n * **Note for users of the full build**: The `GeoTIFF` source requires the\n * [geotiff.js](https://github.com/geotiffjs/geotiff.js) library to be loaded as well.\n *\n * @api\n */\nclass GeoTIFFSource extends DataTile {\n  /**\n   * @param {Options} options Data tile options.\n   */\n  constructor(options) {\n    super({\n      state: 'loading',\n      tileGrid: null,\n      projection: null,\n      opaque: options.opaque,\n      transition: options.transition,\n      interpolate: options.interpolate !== false,\n      wrapX: options.wrapX,\n    });\n\n    /**\n     * @type {Array<SourceInfo>}\n     * @private\n     */\n    this.sourceInfo_ = options.sources;\n\n    const numSources = this.sourceInfo_.length;\n\n    /**\n     * @type {Object}\n     * @private\n     */\n    this.sourceOptions_ = options.sourceOptions;\n\n    /**\n     * @type {Array<Array<GeoTIFFImage>>}\n     * @private\n     */\n    this.sourceImagery_ = new Array(numSources);\n\n    /**\n     * @type {Array<Array<GeoTIFFImage>>}\n     * @private\n     */\n    this.sourceMasks_ = new Array(numSources);\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.resolutionFactors_ = new Array(numSources);\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.samplesPerPixel_;\n\n    /**\n     * @type {Array<Array<number>>}\n     * @private\n     */\n    this.nodataValues_;\n\n    /**\n     * @type {Array<Array<GDALMetadata>>}\n     * @private\n     */\n    this.metadata_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.normalize_ = options.normalize !== false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.addAlpha_ = false;\n\n    /**\n     * @type {Error}\n     * @private\n     */\n    this.error_ = null;\n\n    /**\n     * @type {true|false|'auto'}\n     */\n    this.convertToRGB_ = options.convertToRGB || false;\n\n    this.setKey(this.sourceInfo_.map((source) => source.url).join(','));\n\n    const self = this;\n    const requests = new Array(numSources);\n    for (let i = 0; i < numSources; ++i) {\n      requests[i] = getImagesForSource(\n        this.sourceInfo_[i],\n        this.sourceOptions_\n      );\n    }\n    Promise.all(requests)\n      .then(function (sources) {\n        self.configure_(sources);\n      })\n      .catch(function (error) {\n        logError(error);\n        self.error_ = error;\n        self.setState('error');\n      });\n  }\n\n  /**\n   * @return {Error} A source loading error. When the source state is `error`, use this function\n   * to get more information about the error. To debug a faulty configuration, you may want to use\n   * a listener like\n   * ```js\n   * geotiffSource.on('change', () => {\n   *   if (geotiffSource.getState() === 'error') {\n   *     console.error(geotiffSource.getError());\n   *   }\n   * });\n   * ```\n   */\n  getError() {\n    return this.error_;\n  }\n\n  /**\n   * Determine the projection of the images in this GeoTIFF.\n   * The default implementation looks at the ProjectedCSTypeGeoKey and the GeographicTypeGeoKey\n   * of each image in turn.\n   * You can override this method in a subclass to support more projections.\n   *\n   * @param {Array<Array<GeoTIFFImage>>} sources Each source is a list of images\n   * from a single GeoTIFF.\n   */\n  determineProjection(sources) {\n    const firstSource = sources[0];\n    for (let i = firstSource.length - 1; i >= 0; --i) {\n      const image = firstSource[i];\n      const projection = getProjection(image);\n      if (projection) {\n        this.projection = projection;\n        break;\n      }\n    }\n  }\n\n  /**\n   * Configure the tile grid based on images within the source GeoTIFFs.  Each GeoTIFF\n   * must have the same internal tiled structure.\n   * @param {Array<Array<GeoTIFFImage>>} sources Each source is a list of images\n   * from a single GeoTIFF.\n   * @private\n   */\n  configure_(sources) {\n    let extent;\n    let origin;\n    let commonRenderTileSizes;\n    let commonSourceTileSizes;\n    let resolutions;\n    const samplesPerPixel = new Array(sources.length);\n    const nodataValues = new Array(sources.length);\n    const metadata = new Array(sources.length);\n    let minZoom = 0;\n\n    const sourceCount = sources.length;\n    for (let sourceIndex = 0; sourceIndex < sourceCount; ++sourceIndex) {\n      const images = [];\n      const masks = [];\n      sources[sourceIndex].forEach((item) => {\n        if (isMask(item)) {\n          masks.push(item);\n        } else {\n          images.push(item);\n        }\n      });\n\n      const imageCount = images.length;\n      if (masks.length > 0 && masks.length !== imageCount) {\n        throw new Error(\n          `Expected one mask per image found ${masks.length} masks and ${imageCount} images`\n        );\n      }\n\n      let sourceExtent;\n      let sourceOrigin;\n      const sourceTileSizes = new Array(imageCount);\n      const renderTileSizes = new Array(imageCount);\n      const sourceResolutions = new Array(imageCount);\n\n      nodataValues[sourceIndex] = new Array(imageCount);\n      metadata[sourceIndex] = new Array(imageCount);\n\n      for (let imageIndex = 0; imageIndex < imageCount; ++imageIndex) {\n        const image = images[imageIndex];\n        const nodataValue = image.getGDALNoData();\n        metadata[sourceIndex][imageIndex] = image.getGDALMetadata(0);\n        nodataValues[sourceIndex][imageIndex] = nodataValue;\n\n        const wantedSamples = this.sourceInfo_[sourceIndex].bands;\n        samplesPerPixel[sourceIndex] = wantedSamples\n          ? wantedSamples.length\n          : image.getSamplesPerPixel();\n        const level = imageCount - (imageIndex + 1);\n\n        if (!sourceExtent) {\n          sourceExtent = getBoundingBox(image);\n        }\n\n        if (!sourceOrigin) {\n          sourceOrigin = getOrigin(image);\n        }\n\n        const imageResolutions = getResolutions(image, images[0]);\n        sourceResolutions[level] = imageResolutions[0];\n\n        const sourceTileSize = [image.getTileWidth(), image.getTileHeight()];\n\n        // request larger blocks for untiled layouts\n        if (\n          sourceTileSize[0] !== sourceTileSize[1] &&\n          sourceTileSize[1] < defaultTileSize\n        ) {\n          sourceTileSize[0] = defaultTileSize;\n          sourceTileSize[1] = defaultTileSize;\n        }\n\n        sourceTileSizes[level] = sourceTileSize;\n\n        const aspectRatio = imageResolutions[0] / Math.abs(imageResolutions[1]);\n        renderTileSizes[level] = [\n          sourceTileSize[0],\n          sourceTileSize[1] / aspectRatio,\n        ];\n      }\n\n      if (!extent) {\n        extent = sourceExtent;\n      } else {\n        getIntersection(extent, sourceExtent, extent);\n      }\n\n      if (!origin) {\n        origin = sourceOrigin;\n      } else {\n        const message = `Origin mismatch for source ${sourceIndex}, got [${sourceOrigin}] but expected [${origin}]`;\n        assertEqual(origin, sourceOrigin, 0, message, this.viewRejector);\n      }\n\n      if (!resolutions) {\n        resolutions = sourceResolutions;\n        this.resolutionFactors_[sourceIndex] = 1;\n      } else {\n        if (resolutions.length - minZoom > sourceResolutions.length) {\n          minZoom = resolutions.length - sourceResolutions.length;\n        }\n        const resolutionFactor =\n          resolutions[resolutions.length - 1] /\n          sourceResolutions[sourceResolutions.length - 1];\n        this.resolutionFactors_[sourceIndex] = resolutionFactor;\n        const scaledSourceResolutions = sourceResolutions.map(\n          (resolution) => (resolution *= resolutionFactor)\n        );\n        const message = `Resolution mismatch for source ${sourceIndex}, got [${scaledSourceResolutions}] but expected [${resolutions}]`;\n        assertEqual(\n          resolutions.slice(minZoom, resolutions.length),\n          scaledSourceResolutions,\n          0.02,\n          message,\n          this.viewRejector\n        );\n      }\n\n      if (!commonRenderTileSizes) {\n        commonRenderTileSizes = renderTileSizes;\n      } else {\n        assertEqual(\n          commonRenderTileSizes.slice(minZoom, commonRenderTileSizes.length),\n          renderTileSizes,\n          0.01,\n          `Tile size mismatch for source ${sourceIndex}`,\n          this.viewRejector\n        );\n      }\n\n      if (!commonSourceTileSizes) {\n        commonSourceTileSizes = sourceTileSizes;\n      } else {\n        assertEqual(\n          commonSourceTileSizes.slice(minZoom, commonSourceTileSizes.length),\n          sourceTileSizes,\n          0,\n          `Tile size mismatch for source ${sourceIndex}`,\n          this.viewRejector\n        );\n      }\n\n      this.sourceImagery_[sourceIndex] = images.reverse();\n      this.sourceMasks_[sourceIndex] = masks.reverse();\n    }\n\n    for (let i = 0, ii = this.sourceImagery_.length; i < ii; ++i) {\n      const sourceImagery = this.sourceImagery_[i];\n      while (sourceImagery.length < resolutions.length) {\n        sourceImagery.unshift(undefined);\n      }\n    }\n\n    if (!this.getProjection()) {\n      this.determineProjection(sources);\n    }\n\n    this.samplesPerPixel_ = samplesPerPixel;\n    this.nodataValues_ = nodataValues;\n    this.metadata_ = metadata;\n\n    // decide if we need to add an alpha band to handle nodata\n    outer: for (let sourceIndex = 0; sourceIndex < sourceCount; ++sourceIndex) {\n      // option 1: source is configured with a nodata value\n      if (this.sourceInfo_[sourceIndex].nodata !== undefined) {\n        this.addAlpha_ = true;\n        break;\n      }\n      if (this.sourceMasks_[sourceIndex].length) {\n        this.addAlpha_ = true;\n        break;\n      }\n\n      const values = nodataValues[sourceIndex];\n\n      // option 2: check image metadata for limited bands\n      const bands = this.sourceInfo_[sourceIndex].bands;\n      if (bands) {\n        for (let i = 0; i < bands.length; ++i) {\n          if (values[bands[i] - 1] !== null) {\n            this.addAlpha_ = true;\n            break outer;\n          }\n        }\n        continue;\n      }\n\n      // option 3: check image metadata for all bands\n      for (let imageIndex = 0; imageIndex < values.length; ++imageIndex) {\n        if (values[imageIndex] !== null) {\n          this.addAlpha_ = true;\n          break outer;\n        }\n      }\n    }\n\n    let bandCount = this.addAlpha_ ? 1 : 0;\n    for (let sourceIndex = 0; sourceIndex < sourceCount; ++sourceIndex) {\n      bandCount += samplesPerPixel[sourceIndex];\n    }\n    this.bandCount = bandCount;\n\n    const tileGrid = new TileGrid({\n      extent: extent,\n      minZoom: minZoom,\n      origin: origin,\n      resolutions: resolutions,\n      tileSizes: commonRenderTileSizes,\n    });\n\n    this.tileGrid = tileGrid;\n    this.setTileSizes(commonSourceTileSizes);\n\n    this.setLoader(this.loadTile_.bind(this));\n    this.setState('ready');\n\n    const zoom = 1;\n    if (resolutions.length === 2) {\n      resolutions = [resolutions[0], resolutions[1], resolutions[1] / 2];\n    } else if (resolutions.length === 1) {\n      resolutions = [resolutions[0] * 2, resolutions[0], resolutions[0] / 2];\n    }\n\n    this.viewResolver({\n      showFullExtent: true,\n      projection: this.projection,\n      resolutions: resolutions,\n      center: toUserCoordinate(getCenter(extent), this.projection),\n      extent: toUserExtent(extent, this.projection),\n      zoom: zoom,\n    });\n  }\n\n  /**\n   * @param {number} z The z tile index.\n   * @param {number} x The x tile index.\n   * @param {number} y The y tile index.\n   * @return {Promise} The composed tile data.\n   * @private\n   */\n  loadTile_(z, x, y) {\n    const sourceTileSize = this.getTileSize(z);\n    const sourceCount = this.sourceImagery_.length;\n    const requests = new Array(sourceCount * 2);\n    const nodataValues = this.nodataValues_;\n    const sourceInfo = this.sourceInfo_;\n    const pool = getWorkerPool();\n    for (let sourceIndex = 0; sourceIndex < sourceCount; ++sourceIndex) {\n      const source = sourceInfo[sourceIndex];\n      const resolutionFactor = this.resolutionFactors_[sourceIndex];\n      const pixelBounds = [\n        Math.round(x * (sourceTileSize[0] * resolutionFactor)),\n        Math.round(y * (sourceTileSize[1] * resolutionFactor)),\n        Math.round((x + 1) * (sourceTileSize[0] * resolutionFactor)),\n        Math.round((y + 1) * (sourceTileSize[1] * resolutionFactor)),\n      ];\n      const image = this.sourceImagery_[sourceIndex][z];\n      let samples;\n      if (source.bands) {\n        samples = source.bands.map(function (bandNumber) {\n          return bandNumber - 1;\n        });\n      }\n\n      /** @type {number|Array<number>} */\n      let fillValue;\n      if ('nodata' in source && source.nodata !== null) {\n        fillValue = source.nodata;\n      } else {\n        if (!samples) {\n          fillValue = nodataValues[sourceIndex];\n        } else {\n          fillValue = samples.map(function (sampleIndex) {\n            return nodataValues[sourceIndex][sampleIndex];\n          });\n        }\n      }\n\n      const readOptions = {\n        window: pixelBounds,\n        width: sourceTileSize[0],\n        height: sourceTileSize[1],\n        samples: samples,\n        fillValue: fillValue,\n        pool: pool,\n        interleave: false,\n      };\n      if (readRGB(this.convertToRGB_, image)) {\n        requests[sourceIndex] = image.readRGB(readOptions);\n      } else {\n        requests[sourceIndex] = image.readRasters(readOptions);\n      }\n\n      // requests after `sourceCount` are for mask data (if any)\n      const maskIndex = sourceCount + sourceIndex;\n      const mask = this.sourceMasks_[sourceIndex][z];\n      if (!mask) {\n        requests[maskIndex] = Promise.resolve(null);\n        continue;\n      }\n\n      requests[maskIndex] = mask.readRasters({\n        window: pixelBounds,\n        width: sourceTileSize[0],\n        height: sourceTileSize[1],\n        samples: [0],\n        pool: pool,\n        interleave: false,\n      });\n    }\n\n    return Promise.all(requests)\n      .then(this.composeTile_.bind(this, sourceTileSize))\n      .catch(function (error) {\n        logError(error);\n        throw error;\n      });\n  }\n\n  /**\n   * @param {import(\"../size.js\").Size} sourceTileSize The source tile size.\n   * @param {Array} sourceSamples The source samples.\n   * @return {import(\"../DataTile.js\").Data} The composed tile data.\n   * @private\n   */\n  composeTile_(sourceTileSize, sourceSamples) {\n    const metadata = this.metadata_;\n    const sourceInfo = this.sourceInfo_;\n    const sourceCount = this.sourceImagery_.length;\n    const bandCount = this.bandCount;\n    const samplesPerPixel = this.samplesPerPixel_;\n    const nodataValues = this.nodataValues_;\n    const normalize = this.normalize_;\n    const addAlpha = this.addAlpha_;\n\n    const pixelCount = sourceTileSize[0] * sourceTileSize[1];\n    const dataLength = pixelCount * bandCount;\n\n    /** @type {Uint8Array|Float32Array} */\n    let data;\n    if (normalize) {\n      data = new Uint8Array(dataLength);\n    } else {\n      data = new Float32Array(dataLength);\n    }\n\n    let dataIndex = 0;\n    for (let pixelIndex = 0; pixelIndex < pixelCount; ++pixelIndex) {\n      let transparent = addAlpha;\n      for (let sourceIndex = 0; sourceIndex < sourceCount; ++sourceIndex) {\n        const source = sourceInfo[sourceIndex];\n\n        let min = source.min;\n        let max = source.max;\n        let gain, bias;\n        if (normalize) {\n          const stats = metadata[sourceIndex][0];\n          if (min === undefined) {\n            if (stats && STATISTICS_MINIMUM in stats) {\n              min = parseFloat(stats[STATISTICS_MINIMUM]);\n            } else {\n              min = getMinForDataType(sourceSamples[sourceIndex][0]);\n            }\n          }\n          if (max === undefined) {\n            if (stats && STATISTICS_MAXIMUM in stats) {\n              max = parseFloat(stats[STATISTICS_MAXIMUM]);\n            } else {\n              max = getMaxForDataType(sourceSamples[sourceIndex][0]);\n            }\n          }\n\n          gain = 255 / (max - min);\n          bias = -min * gain;\n        }\n\n        for (\n          let sampleIndex = 0;\n          sampleIndex < samplesPerPixel[sourceIndex];\n          ++sampleIndex\n        ) {\n          const sourceValue =\n            sourceSamples[sourceIndex][sampleIndex][pixelIndex];\n\n          let value;\n          if (normalize) {\n            value = clamp(gain * sourceValue + bias, 0, 255);\n          } else {\n            value = sourceValue;\n          }\n\n          if (!addAlpha) {\n            data[dataIndex] = value;\n          } else {\n            let nodata = source.nodata;\n            if (nodata === undefined) {\n              let bandIndex;\n              if (source.bands) {\n                bandIndex = source.bands[sampleIndex] - 1;\n              } else {\n                bandIndex = sampleIndex;\n              }\n              nodata = nodataValues[sourceIndex][bandIndex];\n            }\n\n            const nodataIsNaN = isNaN(nodata);\n            if (\n              (!nodataIsNaN && sourceValue !== nodata) ||\n              (nodataIsNaN && !isNaN(sourceValue))\n            ) {\n              transparent = false;\n              data[dataIndex] = value;\n            }\n          }\n          dataIndex++;\n        }\n        if (!transparent) {\n          const maskIndex = sourceCount + sourceIndex;\n          const mask = sourceSamples[maskIndex];\n          if (mask && !mask[0][pixelIndex]) {\n            transparent = true;\n          }\n        }\n      }\n      if (addAlpha) {\n        if (!transparent) {\n          data[dataIndex] = 255;\n        }\n        dataIndex++;\n      }\n    }\n\n    return data;\n  }\n}\n\n/**\n * Get a promise for view properties based on the source.  Use the result of this function\n * as the `view` option in a map constructor.\n *\n *     const source = new GeoTIFF(options);\n *\n *     const map = new Map({\n *       target: 'map',\n *       layers: [\n *         new TileLayer({\n *           source: source,\n *         }),\n *       ],\n *       view: source.getView(),\n *     });\n *\n * @function\n * @return {Promise<import(\"../View.js\").ViewOptions>} A promise for view-related properties.\n * @api\n *\n */\nGeoTIFFSource.prototype.getView;\n\nexport default GeoTIFFSource;\n","/**\n * @module ol/uri\n */\n\n/**\n * Appends query parameters to a URI.\n *\n * @param {string} uri The original URI, which may already have query data.\n * @param {!Object} params An object where keys are URI-encoded parameter keys,\n *     and the values are arbitrary types or arrays.\n * @return {string} The new URI.\n */\nexport function appendParams(uri, params) {\n  const keyParams = [];\n  // Skip any null or undefined parameter values\n  Object.keys(params).forEach(function (k) {\n    if (params[k] !== null && params[k] !== undefined) {\n      keyParams.push(k + '=' + encodeURIComponent(params[k]));\n    }\n  });\n  const qs = keyParams.join('&');\n  // remove any trailing ? or &\n  uri = uri.replace(/[?&]$/, '');\n  // append ? or & depending on whether uri has existing parameters\n  uri += uri.includes('?') ? '&' : '?';\n  return uri + qs;\n}\n","/**\n * @module ol/tilegrid/WMTS\n */\n\nimport TileGrid from './TileGrid.js';\nimport {get as getProjection} from '../proj.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../extent.js\").Extent} [extent] Extent for the tile grid. No tiles\n * outside this extent will be requested by {@link module:ol/source/Tile~TileSource} sources.\n * When no `origin` or `origins` are configured, the `origin` will be set to the\n * top-left corner of the extent.\n * @property {import(\"../coordinate.js\").Coordinate} [origin] The tile grid origin, i.e.\n * where the `x` and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left\n * to right and downwards. If not specified, `extent` or `origins` must be provided.\n * @property {Array<import(\"../coordinate.js\").Coordinate>} [origins] Tile grid origins,\n * i.e. where the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If\n * given, the array length should match the length of the `resolutions` array, i.e.\n * each resolution can have a different origin. Tile coordinates increase left to\n * right and downwards. If not specified, `extent` or `origin` must be provided.\n * @property {!Array<number>} resolutions Resolutions. The array index of each\n * resolution needs to match the zoom level. This means that even if a `minZoom`\n * is configured, the resolutions array will have a length of `maxZoom + 1`\n * @property {!Array<string>} matrixIds matrix IDs. The length of this array needs\n * to match the length of the `resolutions` array.\n * @property {Array<import(\"../size.js\").Size>} [sizes] Number of tile rows and columns\n * of the grid for each zoom level. The values here are the `TileMatrixWidth` and\n * `TileMatrixHeight` advertised in the GetCapabilities response of the WMTS, and\n * define each zoom level's extent together with the `origin` or `origins`.\n * A grid `extent` can be configured in addition, and will further limit the extent for\n * which tile requests are made by sources. If the bottom-left corner of\n * an extent is used as `origin` or `origins`, then the `y` value must be\n * negative because OpenLayers tile coordinates use the top left as the origin.\n * @property {number|import(\"../size.js\").Size} [tileSize] Tile size.\n * @property {Array<number|import(\"../size.js\").Size>} [tileSizes] Tile sizes. The length of\n * this array needs to match the length of the `resolutions` array.\n */\n\n/**\n * @classdesc\n * Set the grid pattern for sources accessing WMTS tiled-image servers.\n * @api\n */\nclass WMTSTileGrid extends TileGrid {\n  /**\n   * @param {Options} options WMTS options.\n   */\n  constructor(options) {\n    super({\n      extent: options.extent,\n      origin: options.origin,\n      origins: options.origins,\n      resolutions: options.resolutions,\n      tileSize: options.tileSize,\n      tileSizes: options.tileSizes,\n      sizes: options.sizes,\n    });\n\n    /**\n     * @private\n     * @type {!Array<string>}\n     */\n    this.matrixIds_ = options.matrixIds;\n  }\n\n  /**\n   * @param {number} z Z.\n   * @return {string} MatrixId..\n   */\n  getMatrixId(z) {\n    return this.matrixIds_[z];\n  }\n\n  /**\n   * Get the list of matrix identifiers.\n   * @return {Array<string>} MatrixIds.\n   * @api\n   */\n  getMatrixIds() {\n    return this.matrixIds_;\n  }\n}\n\nexport default WMTSTileGrid;\n\n/**\n * Create a tile grid from a WMTS capabilities matrix set and an\n * optional TileMatrixSetLimits.\n * @param {Object} matrixSet An object representing a matrixSet in the\n *     capabilities document.\n * @param {import(\"../extent.js\").Extent} [extent] An optional extent to restrict the tile\n *     ranges the server provides.\n * @param {Array<Object>} [matrixLimits] An optional object representing\n *     the available matrices for tileGrid.\n * @return {WMTSTileGrid} WMTS tileGrid instance.\n * @api\n */\nexport function createFromCapabilitiesMatrixSet(\n  matrixSet,\n  extent,\n  matrixLimits\n) {\n  /** @type {!Array<number>} */\n  const resolutions = [];\n  /** @type {!Array<string>} */\n  const matrixIds = [];\n  /** @type {!Array<import(\"../coordinate.js\").Coordinate>} */\n  const origins = [];\n  /** @type {!Array<number|import(\"../size.js\").Size>} */\n  const tileSizes = [];\n  /** @type {!Array<import(\"../size.js\").Size>} */\n  const sizes = [];\n\n  matrixLimits = matrixLimits !== undefined ? matrixLimits : [];\n\n  const supportedCRSPropName = 'SupportedCRS';\n  const matrixIdsPropName = 'TileMatrix';\n  const identifierPropName = 'Identifier';\n  const scaleDenominatorPropName = 'ScaleDenominator';\n  const topLeftCornerPropName = 'TopLeftCorner';\n  const tileWidthPropName = 'TileWidth';\n  const tileHeightPropName = 'TileHeight';\n\n  const code = matrixSet[supportedCRSPropName];\n  const projection = getProjection(code);\n  const metersPerUnit = projection.getMetersPerUnit();\n  // swap origin x and y coordinates if axis orientation is lat/long\n  const switchOriginXY = projection.getAxisOrientation().substr(0, 2) == 'ne';\n\n  matrixSet[matrixIdsPropName].sort(function (a, b) {\n    return b[scaleDenominatorPropName] - a[scaleDenominatorPropName];\n  });\n\n  matrixSet[matrixIdsPropName].forEach(function (elt) {\n    let matrixAvailable;\n    // use of matrixLimits to filter TileMatrices from GetCapabilities\n    // TileMatrixSet from unavailable matrix levels.\n    if (matrixLimits.length > 0) {\n      matrixAvailable = matrixLimits.find(function (elt_ml) {\n        if (elt[identifierPropName] == elt_ml[matrixIdsPropName]) {\n          return true;\n        }\n        // Fallback for tileMatrix identifiers that don't get prefixed\n        // by their tileMatrixSet identifiers.\n        if (!elt[identifierPropName].includes(':')) {\n          return (\n            matrixSet[identifierPropName] + ':' + elt[identifierPropName] ===\n            elt_ml[matrixIdsPropName]\n          );\n        }\n        return false;\n      });\n    } else {\n      matrixAvailable = true;\n    }\n\n    if (matrixAvailable) {\n      matrixIds.push(elt[identifierPropName]);\n      const resolution =\n        (elt[scaleDenominatorPropName] * 0.28e-3) / metersPerUnit;\n      const tileWidth = elt[tileWidthPropName];\n      const tileHeight = elt[tileHeightPropName];\n      if (switchOriginXY) {\n        origins.push([\n          elt[topLeftCornerPropName][1],\n          elt[topLeftCornerPropName][0],\n        ]);\n      } else {\n        origins.push(elt[topLeftCornerPropName]);\n      }\n      resolutions.push(resolution);\n      tileSizes.push(\n        tileWidth == tileHeight ? tileWidth : [tileWidth, tileHeight]\n      );\n      sizes.push([elt['MatrixWidth'], elt['MatrixHeight']]);\n    }\n  });\n\n  return new WMTSTileGrid({\n    extent: extent,\n    origins: origins,\n    resolutions: resolutions,\n    matrixIds: matrixIds,\n    tileSizes: tileSizes,\n    sizes: sizes,\n  });\n}\n","/**\n * @module ol/source/WMTS\n */\n\nimport TileImage from './TileImage.js';\nimport {appendParams} from '../uri.js';\nimport {containsExtent} from '../extent.js';\nimport {createFromCapabilitiesMatrixSet} from '../tilegrid/WMTS.js';\nimport {createFromTileUrlFunctions, expandUrl} from '../tileurlfunction.js';\nimport {equivalent, get as getProjection, transformExtent} from '../proj.js';\n\n/**\n * Request encoding. One of 'KVP', 'REST'.\n * @typedef {'KVP' | 'REST'} RequestEncoding\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize] Initial tile cache size. Will auto-grow to hold at least the number of tiles in the viewport.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {import(\"../tilegrid/WMTS.js\").default} tileGrid Tile grid.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {RequestEncoding} [requestEncoding='KVP'] Request encoding.\n * @property {string} layer Layer name as advertised in the WMTS capabilities.\n * @property {string} style Style name as advertised in the WMTS capabilities.\n * @property {typeof import(\"../ImageTile.js\").default} [tileClass]  Class used to instantiate image tiles. Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {string} [format='image/jpeg'] Image format. Only used when `requestEncoding` is `'KVP'`.\n * @property {string} [version='1.0.0'] WMTS version.\n * @property {string} matrixSet Matrix set.\n * @property {!Object} [dimensions] Additional \"dimensions\" for tile requests.\n * This is an object with properties named like the advertised WMTS dimensions.\n * @property {string} [url]  A URL for the service.\n * For the RESTful request encoding, this is a URL\n * template.  For KVP encoding, it is normal URL. A `{?-?}` template pattern,\n * for example `subdomain{a-f}.domain.com`, may be used instead of defining\n * each one separately in the `urls` option.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {Array<string>} [urls] An array of URLs.\n * Requests will be distributed among the URLs in this array.\n * @property {boolean} [wrapX=false] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n */\n\n/**\n * @classdesc\n * Layer source for tile data from WMTS servers.\n * @api\n */\nclass WMTS extends TileImage {\n  /**\n   * @param {Options} options WMTS options.\n   */\n  constructor(options) {\n    // TODO: add support for TileMatrixLimits\n\n    const requestEncoding =\n      options.requestEncoding !== undefined ? options.requestEncoding : 'KVP';\n\n    // FIXME: should we create a default tileGrid?\n    // we could issue a getCapabilities xhr to retrieve missing configuration\n    const tileGrid = options.tileGrid;\n\n    let urls = options.urls;\n    if (urls === undefined && options.url !== undefined) {\n      urls = expandUrl(options.url);\n    }\n\n    super({\n      attributions: options.attributions,\n      attributionsCollapsible: options.attributionsCollapsible,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      interpolate: options.interpolate,\n      projection: options.projection,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileClass: options.tileClass,\n      tileGrid: tileGrid,\n      tileLoadFunction: options.tileLoadFunction,\n      tilePixelRatio: options.tilePixelRatio,\n      urls: urls,\n      wrapX: options.wrapX !== undefined ? options.wrapX : false,\n      transition: options.transition,\n      zDirection: options.zDirection,\n    });\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.version_ = options.version !== undefined ? options.version : '1.0.0';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.format_ = options.format !== undefined ? options.format : 'image/jpeg';\n\n    /**\n     * @private\n     * @type {!Object}\n     */\n    this.dimensions_ =\n      options.dimensions !== undefined ? options.dimensions : {};\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.layer_ = options.layer;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.matrixSet_ = options.matrixSet;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.style_ = options.style;\n\n    // FIXME: should we guess this requestEncoding from options.url(s)\n    //        structure? that would mean KVP only if a template is not provided.\n\n    /**\n     * @private\n     * @type {RequestEncoding}\n     */\n    this.requestEncoding_ = requestEncoding;\n\n    this.setKey(this.getKeyForDimensions_());\n\n    if (urls && urls.length > 0) {\n      this.tileUrlFunction = createFromTileUrlFunctions(\n        urls.map(this.createFromWMTSTemplate.bind(this))\n      );\n    }\n  }\n\n  /**\n   * Set the URLs to use for requests.\n   * URLs may contain OGC conform URL Template Variables: {TileMatrix}, {TileRow}, {TileCol}.\n   * @param {Array<string>} urls URLs.\n   */\n  setUrls(urls) {\n    this.urls = urls;\n    const key = urls.join('\\n');\n    this.setTileUrlFunction(\n      createFromTileUrlFunctions(\n        urls.map(this.createFromWMTSTemplate.bind(this))\n      ),\n      key\n    );\n  }\n\n  /**\n   * Get the dimensions, i.e. those passed to the constructor through the\n   * \"dimensions\" option, and possibly updated using the updateDimensions\n   * method.\n   * @return {!Object} Dimensions.\n   * @api\n   */\n  getDimensions() {\n    return this.dimensions_;\n  }\n\n  /**\n   * Return the image format of the WMTS source.\n   * @return {string} Format.\n   * @api\n   */\n  getFormat() {\n    return this.format_;\n  }\n\n  /**\n   * Return the layer of the WMTS source.\n   * @return {string} Layer.\n   * @api\n   */\n  getLayer() {\n    return this.layer_;\n  }\n\n  /**\n   * Return the matrix set of the WMTS source.\n   * @return {string} MatrixSet.\n   * @api\n   */\n  getMatrixSet() {\n    return this.matrixSet_;\n  }\n\n  /**\n   * Return the request encoding, either \"KVP\" or \"REST\".\n   * @return {RequestEncoding} Request encoding.\n   * @api\n   */\n  getRequestEncoding() {\n    return this.requestEncoding_;\n  }\n\n  /**\n   * Return the style of the WMTS source.\n   * @return {string} Style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * Return the version of the WMTS source.\n   * @return {string} Version.\n   * @api\n   */\n  getVersion() {\n    return this.version_;\n  }\n\n  /**\n   * @private\n   * @return {string} The key for the current dimensions.\n   */\n  getKeyForDimensions_() {\n    const res = this.urls ? this.urls.slice(0) : [];\n    for (const key in this.dimensions_) {\n      res.push(key + '-' + this.dimensions_[key]);\n    }\n    return res.join('/');\n  }\n\n  /**\n   * Update the dimensions.\n   * @param {Object} dimensions Dimensions.\n   * @api\n   */\n  updateDimensions(dimensions) {\n    Object.assign(this.dimensions_, dimensions);\n    this.setKey(this.getKeyForDimensions_());\n  }\n\n  /**\n   * @param {string} template Template.\n   * @return {import(\"../Tile.js\").UrlFunction} Tile URL function.\n   */\n  createFromWMTSTemplate(template) {\n    const requestEncoding = this.requestEncoding_;\n\n    // context property names are lower case to allow for a case insensitive\n    // replacement as some services use different naming conventions\n    const context = {\n      'layer': this.layer_,\n      'style': this.style_,\n      'tilematrixset': this.matrixSet_,\n    };\n\n    if (requestEncoding == 'KVP') {\n      Object.assign(context, {\n        'Service': 'WMTS',\n        'Request': 'GetTile',\n        'Version': this.version_,\n        'Format': this.format_,\n      });\n    }\n\n    // TODO: we may want to create our own appendParams function so that params\n    // order conforms to wmts spec guidance, and so that we can avoid to escape\n    // special template params\n\n    template =\n      requestEncoding == 'KVP'\n        ? appendParams(template, context)\n        : template.replace(/\\{(\\w+?)\\}/g, function (m, p) {\n            return p.toLowerCase() in context ? context[p.toLowerCase()] : m;\n          });\n\n    const tileGrid = /** @type {import(\"../tilegrid/WMTS.js\").default} */ (\n      this.tileGrid\n    );\n    const dimensions = this.dimensions_;\n\n    return (\n      /**\n       * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n       * @param {number} pixelRatio Pixel ratio.\n       * @param {import(\"../proj/Projection.js\").default} projection Projection.\n       * @return {string|undefined} Tile URL.\n       */\n      function (tileCoord, pixelRatio, projection) {\n        if (!tileCoord) {\n          return undefined;\n        }\n        const localContext = {\n          'TileMatrix': tileGrid.getMatrixId(tileCoord[0]),\n          'TileCol': tileCoord[1],\n          'TileRow': tileCoord[2],\n        };\n        Object.assign(localContext, dimensions);\n        let url = template;\n        if (requestEncoding == 'KVP') {\n          url = appendParams(url, localContext);\n        } else {\n          url = url.replace(/\\{(\\w+?)\\}/g, function (m, p) {\n            return localContext[p];\n          });\n        }\n        return url;\n      }\n    );\n  }\n}\n\nexport default WMTS;\n\n/**\n * Generate source options from a capabilities object.\n * @param {Object} wmtsCap An object representing the capabilities document.\n * @param {!Object} config Configuration properties for the layer.  Defaults for\n *                  the layer will apply if not provided.\n *\n * Required config properties:\n *  - layer - {string} The layer identifier.\n *\n * Optional config properties:\n *  - matrixSet - {string} The matrix set identifier, required if there is\n *       more than one matrix set in the layer capabilities.\n *  - projection - {string} The desired CRS when no matrixSet is specified.\n *       eg: \"EPSG:3857\". If the desired projection is not available,\n *       an error is thrown.\n *  - requestEncoding - {string} url encoding format for the layer. Default is\n *       the first tile url format found in the GetCapabilities response.\n *  - style - {string} The name of the style\n *  - format - {string} Image format for the layer. Default is the first\n *       format returned in the GetCapabilities response.\n *  - crossOrigin - {string|null|undefined} Cross origin. Default is `undefined`.\n * @return {Options|null} WMTS source options object or `null` if the layer was not found.\n * @api\n */\nexport function optionsFromCapabilities(wmtsCap, config) {\n  const layers = wmtsCap['Contents']['Layer'];\n  const l = layers.find(function (elt) {\n    return elt['Identifier'] == config['layer'];\n  });\n  if (!l) {\n    return null;\n  }\n  const tileMatrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  let idx;\n  if (l['TileMatrixSetLink'].length > 1) {\n    if ('projection' in config) {\n      idx = l['TileMatrixSetLink'].findIndex(function (elt) {\n        const tileMatrixSet = tileMatrixSets.find(function (el) {\n          return el['Identifier'] == elt['TileMatrixSet'];\n        });\n        const supportedCRS = tileMatrixSet['SupportedCRS'];\n        const proj1 = getProjection(supportedCRS);\n        const proj2 = getProjection(config['projection']);\n        if (proj1 && proj2) {\n          return equivalent(proj1, proj2);\n        }\n        return supportedCRS == config['projection'];\n      });\n    } else {\n      idx = l['TileMatrixSetLink'].findIndex(function (elt) {\n        return elt['TileMatrixSet'] == config['matrixSet'];\n      });\n    }\n  } else {\n    idx = 0;\n  }\n  if (idx < 0) {\n    idx = 0;\n  }\n  const matrixSet =\n    /** @type {string} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSet']);\n  const matrixLimits =\n    /** @type {Array<Object>} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSetLimits']);\n\n  let format = /** @type {string} */ (l['Format'][0]);\n  if ('format' in config) {\n    format = config['format'];\n  }\n  idx = l['Style'].findIndex(function (elt) {\n    if ('style' in config) {\n      return elt['Title'] == config['style'];\n    }\n    return elt['isDefault'];\n  });\n  if (idx < 0) {\n    idx = 0;\n  }\n  const style = /** @type {string} */ (l['Style'][idx]['Identifier']);\n\n  const dimensions = {};\n  if ('Dimension' in l) {\n    l['Dimension'].forEach(function (elt, index, array) {\n      const key = elt['Identifier'];\n      let value = elt['Default'];\n      if (value === undefined) {\n        value = elt['Value'][0];\n      }\n      dimensions[key] = value;\n    });\n  }\n\n  const matrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  const matrixSetObj = matrixSets.find(function (elt) {\n    return elt['Identifier'] == matrixSet;\n  });\n\n  let projection;\n  const code = matrixSetObj['SupportedCRS'];\n  if (code) {\n    projection = getProjection(code);\n  }\n  if ('projection' in config) {\n    const projConfig = getProjection(config['projection']);\n    if (projConfig) {\n      if (!projection || equivalent(projConfig, projection)) {\n        projection = projConfig;\n      }\n    }\n  }\n\n  let wrapX = false;\n  const switchXY = projection.getAxisOrientation().substr(0, 2) == 'ne';\n\n  let matrix = matrixSetObj.TileMatrix[0];\n\n  // create default matrixLimit\n  let selectedMatrixLimit = {\n    MinTileCol: 0,\n    MinTileRow: 0,\n    // subtract one to end up at tile top left\n    MaxTileCol: matrix.MatrixWidth - 1,\n    MaxTileRow: matrix.MatrixHeight - 1,\n  };\n\n  //in case of matrix limits, use matrix limits to calculate extent\n  if (matrixLimits) {\n    selectedMatrixLimit = matrixLimits[matrixLimits.length - 1];\n    const m = matrixSetObj.TileMatrix.find(\n      (tileMatrixValue) =>\n        tileMatrixValue.Identifier === selectedMatrixLimit.TileMatrix ||\n        matrixSetObj.Identifier + ':' + tileMatrixValue.Identifier ===\n          selectedMatrixLimit.TileMatrix\n    );\n    if (m) {\n      matrix = m;\n    }\n  }\n\n  const resolution =\n    (matrix.ScaleDenominator * 0.00028) / projection.getMetersPerUnit(); // WMTS 1.0.0: standardized rendering pixel size\n  const origin = switchXY\n    ? [matrix.TopLeftCorner[1], matrix.TopLeftCorner[0]]\n    : matrix.TopLeftCorner;\n  const tileSpanX = matrix.TileWidth * resolution;\n  const tileSpanY = matrix.TileHeight * resolution;\n  let matrixSetExtent = matrixSetObj['BoundingBox'];\n  if (matrixSetExtent && switchXY) {\n    matrixSetExtent = [\n      matrixSetExtent[1],\n      matrixSetExtent[0],\n      matrixSetExtent[3],\n      matrixSetExtent[2],\n    ];\n  }\n  let extent = [\n    origin[0] + tileSpanX * selectedMatrixLimit.MinTileCol,\n    // add one to get proper bottom/right coordinate\n    origin[1] - tileSpanY * (1 + selectedMatrixLimit.MaxTileRow),\n    origin[0] + tileSpanX * (1 + selectedMatrixLimit.MaxTileCol),\n    origin[1] - tileSpanY * selectedMatrixLimit.MinTileRow,\n  ];\n\n  if (\n    matrixSetExtent !== undefined &&\n    !containsExtent(matrixSetExtent, extent)\n  ) {\n    const wgs84BoundingBox = l['WGS84BoundingBox'];\n    const wgs84ProjectionExtent = getProjection('EPSG:4326').getExtent();\n    extent = matrixSetExtent;\n    if (wgs84BoundingBox) {\n      wrapX =\n        wgs84BoundingBox[0] === wgs84ProjectionExtent[0] &&\n        wgs84BoundingBox[2] === wgs84ProjectionExtent[2];\n    } else {\n      const wgs84MatrixSetExtent = transformExtent(\n        matrixSetExtent,\n        matrixSetObj['SupportedCRS'],\n        'EPSG:4326'\n      );\n      // Ignore slight deviation from the correct x limits\n      wrapX =\n        wgs84MatrixSetExtent[0] - 1e-10 <= wgs84ProjectionExtent[0] &&\n        wgs84MatrixSetExtent[2] + 1e-10 >= wgs84ProjectionExtent[2];\n    }\n  }\n\n  const tileGrid = createFromCapabilitiesMatrixSet(\n    matrixSetObj,\n    extent,\n    matrixLimits\n  );\n\n  /** @type {!Array<string>} */\n  const urls = [];\n  let requestEncoding = config['requestEncoding'];\n  requestEncoding = requestEncoding !== undefined ? requestEncoding : '';\n\n  if (\n    'OperationsMetadata' in wmtsCap &&\n    'GetTile' in wmtsCap['OperationsMetadata']\n  ) {\n    const gets = wmtsCap['OperationsMetadata']['GetTile']['DCP']['HTTP']['Get'];\n\n    for (let i = 0, ii = gets.length; i < ii; ++i) {\n      if (gets[i]['Constraint']) {\n        const constraint = gets[i]['Constraint'].find(function (element) {\n          return element['name'] == 'GetEncoding';\n        });\n        const encodings = constraint['AllowedValues']['Value'];\n\n        if (requestEncoding === '') {\n          // requestEncoding not provided, use the first encoding from the list\n          requestEncoding = encodings[0];\n        }\n        if (requestEncoding === 'KVP') {\n          if (encodings.includes('KVP')) {\n            urls.push(/** @type {string} */ (gets[i]['href']));\n          }\n        } else {\n          break;\n        }\n      } else if (gets[i]['href']) {\n        requestEncoding = 'KVP';\n        urls.push(/** @type {string} */ (gets[i]['href']));\n      }\n    }\n  }\n  if (urls.length === 0) {\n    requestEncoding = 'REST';\n    l['ResourceURL'].forEach(function (element) {\n      if (element['resourceType'] === 'tile') {\n        format = element['format'];\n        urls.push(/** @type {string} */ (element['template']));\n      }\n    });\n  }\n\n  return {\n    urls: urls,\n    layer: config['layer'],\n    matrixSet: matrixSet,\n    format: format,\n    projection: projection,\n    requestEncoding: requestEncoding,\n    tileGrid: tileGrid,\n    style: style,\n    dimensions: dimensions,\n    wrapX: wrapX,\n    crossOrigin: config['crossOrigin'],\n  };\n}\n"],"names":["e","t","module","exports","this","s","r","n","o","a","i","l","default","c","d","u","p","h","m","g","y","f","b","w","v","$","namespace","spin","hidden","address","country","city","road","olControl","glass","container","control","button","input","expanded","reset","result","inputText","icon","k","containerId","buttonControlId","inputQueryId","inputResetId","cssClasses","x","Object","freeze","__proto__","q","C","S","L","j","E","T","N","R","A","P","provider","placeholder","featureStyle","targetType","lang","limit","keepOpen","preventDefault","autoComplete","autoCompleteMinLength","autoCompleteTimeout","debug","I","Error","_","window","performance","Date","now","timing","navigationStart","toString","M","test","O","Array","isArray","forEach","split","length","V","U","F","G","classList","contains","B","className","D","replace","String","replaceAll","Q","document","createElement","id","classname","attr","setAttribute","name","value","innerHTML","createDocumentFragment","childNodes","append","RegExp","add","trim","setTimeout","remove","z","H","constructor","options","els","createControl","querySelector","K","settings","url","params","langs","getParameters","toLowerCase","query","includes","handleResponse","features","map","lon","geometry","coordinates","lat","properties","postcode","state","original","formatted","details","J","format","addressdetails","countrycodes","bbox","boundingbox","display_name","houseNumber","house_number","town","W","key","neighbourhood","X","callbackName","includeNeighborhood","maxResults","resources","resourceSets","point","formattedAddress","Y","countrycode","pretty","no_annotations","results","lng","components","Z","Promise","ee","data","method","mode","credentials","jsonp","head","Math","round","random","indexOf","removeChild","fetch","then","json","catch","keys","reduce","push","encodeURIComponent","join","te","se","Base","layerName","layer","source","newProvider","lastQuery","registeredListeners","mapClick","setListeners","stopPropagation","collapse","expand","addEventListener","target","which","keyCode","clearTimeout","focus","clearResults","firstChild","console","info","createList","listenMapClick","addressTemplate","chosen","getMap","Number","parseFloat","getView","getProjection","transform","transformExtent","dispatchEvent","type","coordinate","place","fit","duration","animate","resolution","center","createFeature","feature","addLayer","setStyle","setId","getSource","addFeature","building","village","blur","getTargetElement","handleEvent","removeEventListener","getLayers","re","image","scale","src","super","element","prototype","hasOwnProperty","call","getLayer","setProvider","setProviderKey","ol_control_Timeline","zoomButton","_scrollDiv","parent","_buttons","addButton","handleClick","zoom","get","min","refresh","bind","_intervalDiv","_select","elt","scrollListener","_setScrollLeft","date","getDate","dateStart","dateEnd","scrollTimeout","onmove","_moving","_tline","_scrollLeft","set","maxWidth","minDate","Infinity","maxDate","graduation","minZoom","maxZoom","setInterval","interval","getHTML","_getHTML","getFeatureDate","_getFeatureDate","endFeatureDate","_endFeatureDate","setFeatures","setMap","undefined","title","html","click","isCollapsed","collapsed","toggle","_features","_source","getFeatures","first","max","d2","tline","isNaN","end","sort","div","_minDate","_maxDate","isFinite","delta","_scale","width","_drawTime","line","lineHeight","fdiv","style","left","img","querySelectorAll","ondragstart","minWidth","pos","top","_nbline","setDate","anim","position","_getOffsetFromDate","_getDateFromOffset","offset","scrollLeft","_getScrollLeft","dt","month","dmonth","tdiv","dx","heigth","year","getFullYear","setFullYear","dyear","setMonth","toLocaleDateString","dday","day","offdate","getMonth","roundDate","stick","_roundTo","getStartDate","getEndDate","asImageLike","Image","HTMLCanvasElement","HTMLVideoElement","asArrayLike","Uint8Array","Uint8ClampedArray","Float32Array","DataView","sharedContext","toArray","height","willReadFrequently","canvas","drawImage","getImageData","defaultSize","DataTile","tileCoord","transition","interpolate","loader_","loader","data_","error_","size_","size","getSize","imageData","getData","getError","load","changed","self","error","createElementNS","namespaceURI","qualifiedName","node","normalizeWhitespace","getAllTextContent_","accumulator","nodeType","Node","CDATA_SECTION_NODE","TEXT_NODE","nodeValue","nextSibling","isDocument","object","parse","xml","DOMParser","parseFromString","makeArrayPusher","valueReader","thisArg","objectStack","array","makeObjectPropertyPusher","property","localName","makeObjectPropertySetter","makeSimpleNodeFactory","fixedNodeName","fixedNamespaceURI","newNodeName","context","nodeName","makeStructureNS","namespaceURIs","structure","structureNS","ii","parseNode","parsersNS","firstElementChild","nextElementSibling","parsers","parser","pushParseAndPop","pop","document_","implementation","createDocument","XML","read","doc","readFromDocument","readFromNode","ELEMENT_NODE","NAMESPACE_URI","readHref","getAttributeNS","readDecimal","readDecimalString","string","exec","readPositiveInteger","readNonNegativeIntegerString","parseInt","readString","NAMESPACE_URIS","PARSERS","readServiceIdentification","readServiceProvider","readOperationsMetadata","OWS","owsObject","ADDRESS_PARSERS","ALLOWED_VALUES_PARSERS","readValue","CONSTRAINT_PARSERS","readAllowedValues","CONTACT_INFO_PARSERS","readPhone","readAddress","DCP_PARSERS","readHttp","HTTP_PARSERS","readGet","OPERATION_PARSERS","readDcp","OPERATIONS_METADATA_PARSERS","readOperation","PHONE_PARSERS","REQUEST_METHOD_PARSERS","readConstraint","SERVICE_CONTACT_PARSERS","readContactInfo","SERVICE_IDENTIFICATION_PARSERS","SERVICE_PROVIDER_PARSERS","readServiceContact","getAttribute","href","OWS_NAMESPACE_URIS","readContents","WMTSCapabilities","owsParser_","version","WMTSCapabilityObject","CONTENTS_PARSERS","readLayer","readTileMatrixSet","LAYER_PARSERS","readStyle","readTileMatrixSetLink","readDimensions","readResourceUrl","readBoundingBox","STYLE_PARSERS","readLegendUrl","TMS_LINKS_PARSERS","readTileMatrixLimitsList","TMS_LIMITS_LIST_PARSERS","readTileMatrixLimits","TMS_LIMITS_PARSERS","DIMENSION_PARSERS","WGS84_BBOX_READERS","readCoordinates","TMS_PARSERS","readTileMatrix","TM_PARSERS","isDefault","template","resourceType","resource","legend","bindAndConfigure","gl","texture","resampleFilter","LINEAR","NEAREST","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","uploadImageTexture","texImage2D","RGBA","UNSIGNED_BYTE","uploadDataTexture","helper","bandCount","getGL","textureType","canInterpolate","FLOAT","getExtension","extension","bytesPerRow","byteLength","unpackAlignment","LUMINANCE","LUMINANCE_ALPHA","RGB","oldUnpackAlignment","getParameter","UNPACK_ALIGNMENT","pixelStorei","pixelContext","createPixelContext","TileTexture","tile","textures","handleTileChange_","renderSize_","grid","getTileSize","gutter_","gutter","NaN","helper_","coords","fromArray","flushBufferData","setTile","EventType","loaded","getState","TileState","uploadTile_","ImageTile","getImage","crossOrigin","createTexture","sourceTileSize","pixelSize","isFloat","pixelCount","DataType","bytesPerElement","BYTES_PER_ELEMENT","floor","textureCount","ceil","textureDataArrays","textureIndex","dataIndex","rowOffset","colCount","rowIndex","colIndex","dataValue","pixelIndex","bandIndex","textureData","textureBandIndex","disposeInternal","deleteBuffer","deleteTexture","getImagePixelData_","renderCol","renderRow","renderWidth","renderHeight","clearRect","sourceWidth","sourceHeight","sourceWidthWithoutGutter","sourceHeightWithoutGutter","sourceCol","sourceRow","err","getArrayPixelData_","sourceSize","bytesPerPixel","buffer","slice","getPixelData","arrayData","Uniforms","TILE_TEXTURE_ARRAY","TILE_TRANSFORM","TRANSITION_ALPHA","DEPTH","TEXTURE_PIXEL_WIDTH","TEXTURE_PIXEL_HEIGHT","TEXTURE_RESOLUTION","TEXTURE_ORIGIN_X","TEXTURE_ORIGIN_Y","RENDER_EXTENT","RESOLUTION","ZOOM","Attributes","TEXTURE_COORD","attributeDescriptions","empty","depthForZ","addTileTextureToLookup","tileTexturesByZ","tileTexture","getRenderExtent","frameState","extent","layerState","layerStatesArray","layerIndex","fromUserExtent","viewState","projection","getRenderSource","getWrapX","gridExtent","getTileGridForProjection","getExtent","getCacheKey","getKey","WebGLTileLayerRenderer","tileLayer","uniforms","renderComplete","tileTransform_","tempMat4_","tempTileRange_","TileRange","tempTileCoord_","tempSize_","program_","vertexShader_","vertexShader","fragmentShader_","fragmentShader","indices_","cacheSize","tileTextureCache_","LRUCache","paletteTextures_","paletteTextures","frameState_","projection_","getProgram","afterHelperCreated","isDrawableTile_","tileState","useInterimTilesOnError","getUseInterimTilesOnError","prepareFrameInternal","clearCache","enqueueTiles","initialZ","preload","tileSource","tileGrid","getGutterForProjection","tileSourceKey","wantedTiles","tileTextureCache","getMapInternal","minZ","getMinZoom","getZForResolution","getMaxResolution","getResolutionForZoom","getResolution","zDirection","tileRange","getTileRangeForExtentAndZ","tileResolution","minX","maxX","minY","maxY","cacheKey","containsKey","getTile","pixelRatio","interimTile","getInterimTile","tileQueueKey","tileQueue","isKeyQueued","enqueue","getTileCoordCenter","renderFrame","preRender","getPreload","nextExtent","targetZ","nextResolution","alphaLookup","uid","time","blend","tileTextures","alpha","getAlpha","endTransition","tileCoordKey","coveredByChildren","findAltTiles_","parentZ","coveredByParent","useProgram","prepareDraw","zs","centerX","centerY","jj","tileZ","tileSize","tileOrigin","getOrigin","tileWidthWithGutter","tileHeightWithGutter","aspectRatio","centerI","centerJ","tileScale","depth","tileCenterI","tileCenterJ","rotation","setUniformMatrixValue","mat4","bindBuffer","enableAttributes","textureSlot","textureProperty","uniformName","activeTexture","uniform1i","getUniformLocation","paletteIndex","paletteTexture","getTexture","setUniformFloatValue","gutterExtent","getTileCoordExtent","setUniformFloatVec4","drawElements","finalizeDraw","dispatchPreComposeEvent","dispatchPostComposeEvent","getCanvas","canExpireCache","dispose","postRenderFunction","updateCacheSize","expireCache","postRenderFunctions","postRender","pixel","pixelToCoordinateTransform","layerExtent","sources","getSources","getTileCoordForCoordAndZ","col","row","altZ","getTileRangeForTileCoordAndZ","covered","clear","removeHelper","deleteProgram","PaletteTexture","texture_","ValueTypes","NUMBER","STRING","COLOR","BOOLEAN","NUMBER_ARRAY","ANY","NONE","Operators","getValueType","JSON","stringify","valueArr","onlyNumbers","every","operator","getReturnType","isTypeUnique","valueType","log2","numberToGlsl","arrayToGlsl","colorToGlsl","color","getStringNumberEquivalent","stringLiteralsMap","stringToGlsl","expressionToGlsl","typeHint","toGlsl","assertNumber","assertNumbers","values","assertString","assertBoolean","assertArgsCount","args","count","assertArgsMinCount","assertArgsMaxCount","assertArgsEven","assertArgsOdd","assertUniqueInferredType","types","uniformNameForVariable","variableName","attributes","prefix","inFragmentShader","variables","PALETTE_TEXTURE_ARRAY","index","colors","numColors","palette","candidate","paletteName","GET_BAND_VALUE_FUNC","getEqualOperator","getDecisionOperator","arg","parseStyle","functions","pipeline","contrast","exposure","saturation","gamma","brightness","numVariables","uniformDeclarations","functionDefintions","band","ifBlocks","colorIndex","textureName","bandExpression","xOffsetExpression","yOffsetExpression","parsedArgs","val","interpolation","outputType","exponent","stop1","output1","stop2","output2","fallback","match","output","condition","WebGLTileLayer","BaseTile","assign","sources_","renderedSource_","renderedResolution_","style_","cacheSize_","styleVariables_","addChangeListener","handleSourceUpdate_","getSourceState","hasRenderer","getRenderer","getSourceBandCount_","MAX_SAFE_INTEGER","createRenderer","parsedStyle","renderSources","layerRenderer","prepareFrame","render","rendered","ready","sourceState","onChange","altSources","filter","renderer","updateStyleVariables","ReprojDataTile","resolve","pixelRatio_","reprojData_","reprojError_","reprojSize_","sourceTileGrid_","sourceTileGrid","targetTileGrid_","targetTileGrid","wrappedTileCoord_","wrappedTileCoord","sourceTiles_","sourcesListenerKeys_","sourceZ_","targetExtent","maxTargetExtent","maxSourceExtent","limitedTargetExtent","sourceProj","sourceProjExtent","targetResolution","targetProj","sourceResolution","errorThresholdInPixels","errorThreshold","triangulation_","getTriangles","sourceExtent","calculateSourceExtent","canWrapX","sourceRange","getTileFunction","srcX","srcY","reproject_","dataSources","tileData","tileDataR","packedLength","packedData","dataType","targetWidth","targetHeight","dataR","dataU","reprojs","reproj","len","dataSource","createImageData","putImageData","getContext","leftToLoad","sourceListenKey","unlistenSources_","DataTileSource","Tile","maxResolution","attributions","attributionsCollapsible","opaque","wrapX","tileSize_","tileSizes_","tileLoadingKeys_","tileGridForProjection_","tileCacheForProjection_","setTileSizes","tileSizes","getTileGrid","thisProj","equivalent","setLoader","getReprojTile_","cache","getTileCacheForProjection","reprojTilePixelRatio","apply","getResolutions","textureSize","getTileCoordForTileUrlFunction","tileOptions","newTile","sourceProjection","tileCache","sourceLoader","event","TileEventType","projKey","setTileGridForProjection","tilegrid","proj","TileCache","usedTiles","usedTileCache","defaultPoolSize","navigator","hardwareConcurrency","Pool","createWorker","workers","_awaitingDecoder","messageId","create","worker","idle","async","fileDirectory","decoder","decode","find","onMessage","decoded","postMessage","destroy","terminate","isMask","NewSubfileType","readRGB","preference","getSamplesPerPixel","interpretation","PhotometricInterpretation","interpretations","CMYK","YCbCr","CIELab","ICCLab","STATISTICS_MAXIMUM","STATISTICS_MINIMUM","defaultTileSize","workerPool","getWorkerPool","getBoundingBox","ImageWidth","ImageLength","referenceImage","ImageHeight","geoKeys","ProjectedCSTypeGeoKey","code","units","ProjLinearUnitsGeoKey","Projection","GeographicTypeGeoKey","GeogAngularUnitsGeoKey","getImagesForTIFF","tiff","getImageCount","requests","all","getImagesForSource","request","blob","overviews","assertEqual","expected","got","tolerance","message","rejector","abs","getMinForDataType","Int8Array","Int16Array","Int32Array","getMaxForDataType","Uint16Array","Uint32Array","GeoTIFFSource","sourceInfo_","numSources","sourceOptions_","sourceOptions","sourceImagery_","sourceMasks_","resolutionFactors_","samplesPerPixel_","nodataValues_","metadata_","normalize_","normalize","addAlpha_","convertToRGB_","convertToRGB","setKey","configure_","setState","determineProjection","firstSource","origin","commonRenderTileSizes","commonSourceTileSizes","resolutions","samplesPerPixel","nodataValues","metadata","sourceCount","sourceIndex","images","masks","item","imageCount","sourceOrigin","sourceTileSizes","renderTileSizes","sourceResolutions","imageIndex","nodataValue","getGDALNoData","getGDALMetadata","wantedSamples","bands","level","imageResolutions","getTileWidth","getTileHeight","viewRejector","resolutionFactor","scaledSourceResolutions","reverse","sourceImagery","unshift","outer","nodata","TileGrid","loadTile_","viewResolver","showFullExtent","toUserCoordinate","toUserExtent","sourceInfo","pool","pixelBounds","samples","fillValue","bandNumber","sampleIndex","readOptions","interleave","readRasters","maskIndex","mask","composeTile_","sourceSamples","addAlpha","dataLength","transparent","gain","bias","stats","sourceValue","nodataIsNaN","appendParams","uri","keyParams","qs","WMTSTileGrid","origins","sizes","matrixIds_","matrixIds","getMatrixId","getMatrixIds","createFromCapabilitiesMatrixSet","matrixSet","matrixLimits","supportedCRSPropName","matrixIdsPropName","identifierPropName","scaleDenominatorPropName","topLeftCornerPropName","tileWidthPropName","tileHeightPropName","metersPerUnit","getMetersPerUnit","switchOriginXY","getAxisOrientation","substr","matrixAvailable","elt_ml","tileWidth","tileHeight","TileImage","requestEncoding","urls","reprojectionErrorThreshold","tileClass","tileLoadFunction","tilePixelRatio","version_","format_","dimensions_","dimensions","layer_","matrixSet_","requestEncoding_","getKeyForDimensions_","tileUrlFunction","createFromWMTSTemplate","setUrls","setTileUrlFunction","getDimensions","getFormat","getMatrixSet","getRequestEncoding","getStyle","getVersion","res","updateDimensions","localContext","optionsFromCapabilities","wmtsCap","config","layers","tileMatrixSets","idx","findIndex","tileMatrixSet","el","supportedCRS","proj1","proj2","matrixSets","matrixSetObj","projConfig","switchXY","matrix","TileMatrix","selectedMatrixLimit","MinTileCol","MinTileRow","MaxTileCol","MatrixWidth","MaxTileRow","MatrixHeight","tileMatrixValue","Identifier","ScaleDenominator","TopLeftCorner","tileSpanX","TileWidth","tileSpanY","TileHeight","matrixSetExtent","wgs84BoundingBox","wgs84ProjectionExtent","wgs84MatrixSetExtent","gets","constraint","encodings"],"sourceRoot":""}