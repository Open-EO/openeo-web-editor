"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[8022],{29186:(e,t,r)=>{r.d(t,{Z:()=>f});var n=r(57581),i=r(70553),o=r(37755),a=r(4773),s=r(11481),l=r(6101),u=r(69374),h=r(28641),d=r(63432),c=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=function(e){function t(t){var r=e.call(this,t)||this;return r.image_=null,r}return c(t,e),t.prototype.getImage=function(){return this.image_?this.image_.getImage():null},t.prototype.prepareFrame=function(e){var t=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,n=e.viewState,s=n.resolution,l=this.getLayer().getSource(),u=e.viewHints,c=e.extent;if(void 0!==t.extent&&(c=(0,h.Ed)(c,(0,d.dY)(t.extent,n.projection))),!u[o.Z.ANIMATING]&&!u[o.Z.INTERACTING]&&!(0,h.xb)(c))if(l){var p=n.projection;if(!a.j){var f=l.getProjection();f&&(p=f)}var g=l.getImage(c,s,r,p);g&&(this.loadImage(g)?this.image_=g:g.getState()===i.Z.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_},t.prototype.getData=function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,l.nn)(t.pixelToCoordinateTransform,e.slice()),i=r.getExtent();if(i&&!(0,h.b8)(i,n))return null;var o=this.image_.getExtent(),a=this.image_.getImage(),s=(0,h.dz)(o),u=Math.floor(a.width*((n[0]-o[0])/s));if(u<0||u>=a.width)return null;var d=(0,h.Cr)(o),c=Math.floor(a.height*((o[3]-n[1])/d));return c<0||c>=a.height?null:this.getImageData(a,u,c)},t.prototype.renderFrame=function(e,t){var r=this.image_,n=r.getExtent(),i=r.getResolution(),o=r.getPixelRatio(),a=e.layerStatesArray[e.layerIndex],c=e.pixelRatio,p=e.viewState,f=p.center,g=p.resolution,v=e.size,y=c*i/(g*o),T=Math.round(v[0]*c),m=Math.round(v[1]*c),_=p.rotation;if(_){var x=Math.round(Math.sqrt(T*T+m*m));T=x,m=x}(0,l.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/c,1/c,_,-T/2,-m/2),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);var R=(0,l.BB)(this.pixelTransform);this.useContainer(t,R,a.opacity,this.getBackground(e));var E=this.context,C=E.canvas;C.width!=T||C.height!=m?(C.width=T,C.height=m):this.containerReused||E.clearRect(0,0,T,m);var S=!1,I=!0;if(a.extent){var w=(0,d.dY)(a.extent,p.projection);I=(0,h.kK)(w,e.extent),S=I&&!(0,h.r4)(w,e.extent),S&&this.clipUnrotated(E,e,w)}var Z=r.getImage(),b=(0,l.qC)(this.tempTransform,T/2,m/2,y,y,0,o*(n[0]-f[0])/i,o*(f[1]-n[3])/i);this.renderedResolution=i*c/o;var P=Z.width*b[0],A=Z.height*b[3];if(this.getLayer().getSource().getInterpolate()||(0,u.f0)(E,s.$),this.preRender(E,e),I&&P>=.5&&A>=.5){var O=b[4],F=b[5],L=a.opacity,D=void 0;1!==L&&(D=E.globalAlpha,E.globalAlpha=L),E.drawImage(Z,0,0,+Z.width,+Z.height,Math.round(O),Math.round(F),Math.round(P),Math.round(A)),1!==L&&(E.globalAlpha=D)}return this.postRender(E,e),S&&E.restore(),(0,u.f0)(E,s.s),R!==C.style.transform&&(C.style.transform=R),this.container},t}(n.Z);const f=p},57581:(e,t,r)=>{r.d(t,{Z:()=>g});var n=r(10115),i=r(57380),o=r(98771),a=r(6101),s=r(79706),l=r(28641),u=r(68326),h=r(65537),d=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=null;function p(){var e=document.createElement("canvas");e.width=1,e.height=1,c=e.getContext("2d")}var f=function(e){function t(t){var r=e.call(this,t)||this;return r.container=null,r.renderedResolution,r.tempTransform=(0,a.Ue)(),r.pixelTransform=(0,a.Ue)(),r.inversePixelTransform=(0,a.Ue)(),r.context=null,r.containerReused=!1,r.pixelContext_=null,r.frameState=null,r}return d(t,e),t.prototype.getImageData=function(e,t,r){var n;c||p(),c.clearRect(0,0,1,1);try{c.drawImage(e,t,r,1,1,0,0,1,1),n=c.getImageData(0,0,1,1).data}catch(i){return null}return n},t.prototype.getBackground=function(e){var t=this.getLayer(),r=t.getBackground();return"function"===typeof r&&(r=r(e.viewState.resolution)),r||void 0},t.prototype.useContainer=function(e,t,r,n){var i,o,a=this.getLayer().getClassName();if(e&&e.className===a&&""===e.style.opacity&&1===r&&(!n||e.style.backgroundColor&&(0,h.fS)((0,s._2)(e.style.backgroundColor),(0,s._2)(n)))){var l=e.firstElementChild;l instanceof HTMLCanvasElement&&(o=l.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){i=document.createElement("div"),i.className=a;var d=i.style;d.position="absolute",d.width="100%",d.height="100%",n&&(d.backgroundColor=n),o=(0,u.E4)();l=o.canvas;i.appendChild(l),d=l.style,d.position="absolute",d.left="0",d.transformOrigin="top left",this.container=i,this.context=o}},t.prototype.clipUnrotated=function(e,t,r){var n=(0,l.rL)(r),i=(0,l.Xv)(r),o=(0,l.w$)(r),s=(0,l.hC)(r);(0,a.nn)(t.coordinateToPixelTransform,n),(0,a.nn)(t.coordinateToPixelTransform,i),(0,a.nn)(t.coordinateToPixelTransform,o),(0,a.nn)(t.coordinateToPixelTransform,s);var u=this.inversePixelTransform;(0,a.nn)(u,n),(0,a.nn)(u,i),(0,a.nn)(u,o),(0,a.nn)(u,s),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.clip()},t.prototype.dispatchRenderEvent_=function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){var o=new i.Z(e,this.inversePixelTransform,r,t);n.dispatchEvent(o)}},t.prototype.preRender=function(e,t){this.frameState=t,this.dispatchRenderEvent_(o.Z.PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(o.Z.POSTRENDER,e,t)},t.prototype.getRenderTransform=function(e,t,r,n,i,o,s){var l=i/2,u=o/2,h=n/t,d=-h,c=-e[0]+s,p=-e[1];return(0,a.qC)(this.tempTransform,l,u,h,d,-r,c,p)},t.prototype.getDataAtPixel=function(e,t,r){var n=(0,a.nn)(this.inversePixelTransform,e.slice()),i=this.context,o=this.getLayer(),s=o.getExtent();if(s){var u=(0,a.nn)(t.pixelToCoordinateTransform,e.slice());if(!(0,l.b8)(s,u))return null}var h,d=Math.round(n[0]),c=Math.round(n[1]),p=this.pixelContext_;if(!p){var f=document.createElement("canvas");f.width=1,f.height=1,p=f.getContext("2d"),this.pixelContext_=p}p.clearRect(0,0,1,1);try{p.drawImage(i.canvas,d,c,1,1,0,0,1,1),h=p.getImageData(0,0,1,1).data}catch(g){return"SecurityError"===g.name?(this.pixelContext_=null,new Uint8Array):h}return 0===h[3]?null:h},t.prototype.disposeInternal=function(){delete this.frameState,e.prototype.disposeInternal.call(this)},t}(n.Z);const g=f},8845:(e,t,r)=>{r.d(t,{Z:()=>m});var n=r(57581),i=r(20825),o=r(96113),a=r(2519),s=r(37195),l=r(11481),u=r(6101),h=r(69374),d=r(28641),c=r(10245),p=r(63432),f=r(74187),g=r(65537),v=r(4307),y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),T=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=(0,d.lJ)(),r.tmpTileRange_=new a.Z(0,0,0,0),r}return y(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),n=t.getUseInterimTilesOnError();return r==s.Z.LOADED||r==s.Z.EMPTY||r==s.Z.ERROR&&!n},t.prototype.getTile=function(e,t,r,n){var i=n.pixelRatio,o=n.viewState.projection,a=this.getLayer(),l=a.getSource(),u=l.getTile(e,t,r,i,o);return u.getState()==s.Z.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):u.setState(s.Z.LOADED)),this.isDrawableTile(u)||(u=u.getInterimTile()),u},t.prototype.getData=function(e){var t=this.frameState;if(!t)return null;var r=this.getLayer(),n=(0,u.nn)(t.pixelToCoordinateTransform,e.slice()),a=r.getExtent();if(a&&!(0,d.b8)(a,n))return null;for(var l=t.pixelRatio,h=t.viewState.projection,c=t.viewState,p=r.getRenderSource(),f=p.getTileGridForProjection(c.projection),g=p.getTilePixelRatio(t.pixelRatio),y=f.getZForResolution(c.resolution);y>=f.getMinZoom();--y){var T=f.getTileCoordForCoordAndZ(n,y),m=p.getTile(y,T[1],T[2],l,h);if(!(m instanceof i.Z||m instanceof o.Z))return null;if(m.getState()===s.Z.LOADED){var _=f.getOrigin(y),x=(0,v.Pq)(f.getTileSize(y)),R=f.getResolution(y),E=Math.floor(g*((n[0]-_[0])/R-T[1]*x[0])),C=Math.floor(g*((_[1]-n[1])/R-T[2]*x[1]));return this.getImageData(m.getImage(),E,C)}}return null},t.prototype.loadedTileCallback=function(t,r,n){return!!this.isDrawableTile(n)&&e.prototype.loadedTileCallback.call(this,t,r,n)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],n=e.viewState,i=n.projection,o=n.resolution,a=n.center,v=n.rotation,y=e.pixelRatio,T=this.getLayer(),m=T.getSource(),_=m.getRevision(),x=m.getTileGridForProjection(i),R=x.getZForResolution(o,m.zDirection),E=x.getResolution(R),C=e.extent,S=r.extent&&(0,p.dY)(r.extent,i);S&&(C=(0,d.Ed)(C,(0,p.dY)(r.extent,i)));var I=m.getTilePixelRatio(y),w=Math.round(e.size[0]*I),Z=Math.round(e.size[1]*I);if(v){var b=Math.round(Math.sqrt(w*w+Z*Z));w=b,Z=b}var P=E*w/2/I,A=E*Z/2/I,O=[a[0]-P,a[1]-A,a[0]+P,a[1]+A],F=x.getTileRangeForExtentAndZ(C,R),L={};L[R]={};var D=this.createLoadedTileFinder(m,i,L),G=this.tmpExtent,M=this.tmpTileRange_;this.newTiles_=!1;for(var B=F.minX;B<=F.maxX;++B)for(var N=F.minY;N<=F.maxY;++N){var j=this.getTile(R,B,N,e);if(this.isDrawableTile(j)){var k=(0,f.sq)(this);if(j.getState()==s.Z.LOADED){L[R][j.tileCoord.toString()]=j;var U=j.inTransition(k);this.newTiles_||!U&&-1!==this.renderedTiles.indexOf(j)||(this.newTiles_=!0)}if(1===j.getAlpha(k,e.time))continue}var z=x.getTileCoordChildTileRange(j.tileCoord,M,G),q=!1;z&&(q=D(R+1,z)),q||x.forEachTileCoordParentTileRange(j.tileCoord,D,M,G)}var H=E/o;(0,u.qC)(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/I,1/I,v,-w/2,-Z/2);var X=(0,u.BB)(this.pixelTransform);this.useContainer(t,X,r.opacity,this.getBackground(e));var V=this.context,Y=V.canvas;(0,u.nb)(this.inversePixelTransform,this.pixelTransform),(0,u.qC)(this.tempTransform,w/2,Z/2,H,H,0,-w/2,-Z/2),Y.width!=w||Y.height!=Z?(Y.width=w,Y.height=Z):this.containerReused||V.clearRect(0,0,w,Z),S&&this.clipUnrotated(V,e,S),m.getInterpolate()||(0,h.f0)(V,l.$),this.preRender(V,e),this.renderedTiles.length=0;var K,W,$,J=Object.keys(L).map(Number);J.sort(g.kK),1!==r.opacity||this.containerReused&&!m.getOpaque(e.viewState.projection)?(K=[],W=[]):J=J.reverse();for(var Q=J.length-1;Q>=0;--Q){var ee=J[Q],te=m.getTilePixelSize(ee,y,i),re=x.getResolution(ee),ne=re/E,ie=te[0]*ne*H,oe=te[1]*ne*H,ae=x.getTileCoordForCoordAndZ((0,d.rL)(O),ee),se=x.getTileCoordExtent(ae),le=(0,u.nn)(this.tempTransform,[I*(se[0]-O[0])/E,I*(O[3]-se[3])/E]),ue=I*m.getGutterForProjection(i),he=L[ee];for(var de in he){j=he[de];var ce=j.tileCoord,pe=ae[1]-ce[1],fe=Math.round(le[0]-(pe-1)*ie),ge=ae[2]-ce[2],ve=Math.round(le[1]-(ge-1)*oe),ye=(B=Math.round(le[0]-pe*ie),N=Math.round(le[1]-ge*oe),fe-B),Te=ve-N,me=R===ee,_e=(U=me&&1!==j.getAlpha((0,f.sq)(this),e.time),!1);if(!U)if(K){$=[B,N,B+ye,N,B+ye,N+Te,B,N+Te];for(var xe=0,Re=K.length;xe<Re;++xe)if(R!==ee&&ee<W[xe]){var Ee=K[xe];(0,d.kK)([B,N,B+ye,N+Te],[Ee[0],Ee[3],Ee[4],Ee[7]])&&(_e||(V.save(),_e=!0),V.beginPath(),V.moveTo($[0],$[1]),V.lineTo($[2],$[3]),V.lineTo($[4],$[5]),V.lineTo($[6],$[7]),V.moveTo(Ee[6],Ee[7]),V.lineTo(Ee[4],Ee[5]),V.lineTo(Ee[2],Ee[3]),V.lineTo(Ee[0],Ee[1]),V.clip())}K.push($),W.push(ee)}else V.clearRect(B,N,ye,Te);this.drawTileImage(j,e,B,N,ye,Te,ue,me),K&&!U?(_e&&V.restore(),this.renderedTiles.unshift(j)):this.renderedTiles.push(j),this.updateUsedTiles(e.usedTiles,m,j)}}this.renderedRevision=_,this.renderedResolution=E,this.extentChanged=!this.renderedExtent_||!(0,d.fS)(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=y,this.renderedProjection=i,this.manageTilePyramid(e,m,x,y,i,C,R,T.getPreload()),this.scheduleExpireCache(e,m),this.postRender(V,e),r.extent&&V.restore(),(0,h.f0)(V,l.s),X!==Y.style.transform&&(Y.style.transform=X);var Ce=(0,c.Xy)(r.opacity),Se=this.container;return Ce!==Se.style.opacity&&(Se.style.opacity=Ce),this.container},t.prototype.drawTileImage=function(e,t,r,n,i,o,a,s){var l=this.getTileImage(e);if(l){var u=(0,f.sq)(this),h=s?e.getAlpha(u,t.time):1,d=h!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(l,a,a,l.width-2*a,l.height-2*a,r,n,i,o),d&&this.context.restore(),1!==h?t.animate=!0:s&&e.endTransition(u)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var n=(0,f.sq)(e);n in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[n])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var n=(0,f.sq)(t);n in e||(e[n]={}),e[n][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,n,i,o,a,l,u){var h=(0,f.sq)(t);h in e.wantedTiles||(e.wantedTiles[h]={});var d,c,p,g,v,y,T=e.wantedTiles[h],m=e.tileQueue,_=r.getMinZoom(),x=0;for(y=_;y<=a;++y)for(c=r.getTileRangeForExtentAndZ(o,y,c),p=r.getResolution(y),g=c.minX;g<=c.maxX;++g)for(v=c.minY;v<=c.maxY;++v)a-y<=l?(++x,d=t.getTile(y,g,v,n,i),d.getState()==s.Z.IDLE&&(T[d.getKey()]=!0,m.isKeyQueued(d.getKey())||m.enqueue([d,h,r.getTileCoordCenter(d.tileCoord),p])),void 0!==u&&u(d)):t.useTile(y,g,v,i);t.updateCacheSize(x,i)},t}(n.Z);const m=T},25682:(e,t,r)=>{r.d(t,{Z:()=>T});var n=r(35570),i=r(57581),o=r(15240),a=r(37755),s=r(12382),l=r(6101),u=r(28641),h=r(10245),d=r(76234),c=r(65537),p=r(63432),f=r(74187),g=r(91900),v=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.dirty_=!1,r.hitDetectionImageData_=null,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=(0,u.lJ)(),r.wrappedRenderedExtent_=(0,u.lJ)(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r.declutterExecutorGroup=null,r.clipping=!0,r}return v(t,e),t.prototype.renderWorlds=function(e,t,r){var n=t.extent,i=t.viewState,o=i.center,s=i.resolution,l=i.projection,h=i.rotation,d=l.getExtent(),c=this.getLayer().getSource(),p=t.pixelRatio,f=t.viewHints,g=!(f[a.Z.ANIMATING]||f[a.Z.INTERACTING]),v=this.context,y=Math.round(t.size[0]*p),T=Math.round(t.size[1]*p),m=c.getWrapX()&&l.canWrapX(),_=m?(0,u.dz)(d):null,x=m?Math.ceil((n[2]-d[2])/_)+1:1,R=m?Math.floor((n[0]-d[0])/_):0;do{var E=this.getRenderTransform(o,s,h,p,y,T,R*_);e.execute(v,1,E,h,g,void 0,r)}while(++R<x)},t.prototype.renderDeclutter=function(e){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,e,e.declutterTree)},t.prototype.renderFrame=function(e,t){var r=e.pixelRatio,n=e.layerStatesArray[e.layerIndex];(0,l.n3)(this.pixelTransform,1/r,1/r),(0,l.nb)(this.inversePixelTransform,this.pixelTransform);var i=(0,l.BB)(this.pixelTransform);this.useContainer(t,i,n.opacity,this.getBackground(e));var o=this.context,a=o.canvas,s=this.replayGroup_,d=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!d||d.isEmpty()))return null;var c=Math.round(e.size[0]*r),f=Math.round(e.size[1]*r);a.width!=c||a.height!=f?(a.width=c,a.height=f,a.style.transform!==i&&(a.style.transform=i)):this.containerReused||o.clearRect(0,0,c,f),this.preRender(o,e);var g=e.viewState,v=g.projection,y=!1,T=!0;if(n.extent&&this.clipping){var m=(0,p.dY)(n.extent,v);T=(0,u.kK)(m,e.extent),y=T&&!(0,u.r4)(m,e.extent),y&&this.clipUnrotated(o,e,m)}T&&this.renderWorlds(s,e),y&&o.restore(),this.postRender(o,e);var _=(0,h.Xy)(n.opacity),x=this.container;return _!==x.style.opacity&&(x.style.opacity=_),this.renderedRotation_!==g.rotation&&(this.renderedRotation_=g.rotation,this.hitDetectionImageData_=null),this.container},t.prototype.getFeatures=function(e){return new Promise(function(t){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var r=[this.context.canvas.width,this.context.canvas.height];(0,l.nn)(this.pixelTransform,r);var n=this.renderedCenter_,i=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,h=this.wrappedRenderedExtent_,d=this.getLayer(),c=[],p=r[0]*s.UN,f=r[1]*s.UN;c.push(this.getRenderTransform(n,i,o,s.UN,p,f,0).slice());var g=d.getSource(),v=a.getExtent();if(g.getWrapX()&&a.canWrapX()&&!(0,u.r4)(v,h)){var y=h[0],T=(0,u.dz)(v),m=0,_=void 0;while(y<v[0])--m,_=T*m,c.push(this.getRenderTransform(n,i,o,s.UN,p,f,_).slice()),y+=T;m=0,y=h[2];while(y>v[2])++m,_=T*m,c.push(this.getRenderTransform(n,i,o,s.UN,p,f,_).slice()),y-=T}this.hitDetectionImageData_=(0,s.TU)(r,c,this.renderedFeatures_,d.getStyleFunction(),h,i,o)}t((0,s.ix)(e,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){var o=this;if(this.replayGroup_){var a,s=t.viewState.resolution,l=t.viewState.rotation,u=this.getLayer(),h={},d=function(e,t,r){var o=(0,f.sq)(e),a=h[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return h[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,u,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return h[o]=!0,n(e,u,t);i.push(h[o]={feature:e,layer:u,geometry:t,distanceSq:r,callback:n})}},c=[this.replayGroup_];return this.declutterExecutorGroup&&c.push(this.declutterExecutorGroup),c.some((function(n){return a=n.forEachFeatureAtCoordinate(e,s,l,r,d,n===o.declutterExecutorGroup&&t.declutterTree?t.declutterTree.all().map((function(e){return e.value})):null)})),a}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource();if(!r)return!1;var i=e.viewHints[a.Z.ANIMATING],s=e.viewHints[a.Z.INTERACTING],l=t.getUpdateWhileAnimating(),h=t.getUpdateWhileInteracting();if(!this.dirty_&&!l&&i||!h&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var f=e.extent,v=e.viewState,y=v.projection,T=v.resolution,m=e.pixelRatio,_=t.getRevision(),x=t.getRenderBuffer(),R=t.getRenderOrder();void 0===R&&(R=d.eR);var E=v.center.slice(),C=(0,u.f3)(f,x*T),S=C.slice(),I=[C.slice()],w=y.getExtent();if(r.getWrapX()&&y.canWrapX()&&!(0,u.r4)(w,e.extent)){var Z=(0,u.dz)(w),b=Math.max((0,u.dz)(C)/2,Z);C[0]=w[0]-b,C[2]=w[2]+b,(0,g.Cf)(E,y);var P=(0,u.Cf)(I[0],y);P[0]<w[0]&&P[2]<w[2]?I.push([P[0]+Z,P[1],P[2]+Z,P[3]]):P[0]>w[0]&&P[2]>w[2]&&I.push([P[0]-Z,P[1],P[2]-Z,P[3]])}if(!this.dirty_&&this.renderedResolution_==T&&this.renderedRevision_==_&&this.renderedRenderOrder_==R&&(0,u.r4)(this.wrappedRenderedExtent_,C))return(0,c.fS)(this.renderedExtent_,S)||(this.hitDetectionImageData_=null,this.renderedExtent_=S),this.renderedCenter_=E,this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var A,O=new n.Z((0,d.Qz)(T,m),C,T,m);this.getLayer().getDeclutter()&&(A=new n.Z((0,d.Qz)(T,m),C,T,m));var F,L=(0,p.Cs)();if(L){for(var D=0,G=I.length;D<G;++D){var M=I[D],B=(0,p.Fj)(M,y);r.loadFeatures(B,(0,p.on)(T,y),L)}F=(0,p.WO)(L,y)}else for(D=0,G=I.length;D<G;++D)r.loadFeatures(I[D],T,y);var N=(0,d.se)(T,m),j=function(e){var r,n=e.getStyleFunction()||t.getStyleFunction();if(n&&(r=n(e,T)),r){var i=this.renderFeature(e,N,r,O,F,A);this.dirty_=this.dirty_||i}}.bind(this),k=(0,p.Fj)(C,y),U=r.getFeaturesInExtent(k);R&&U.sort(R);for(D=0,G=U.length;D<G;++D)j(U[D]);this.renderedFeatures_=U;var z=O.finish(),q=new o.Z(C,T,m,r.getOverlaps(),z,t.getRenderBuffer());return A&&(this.declutterExecutorGroup=new o.Z(C,T,m,r.getOverlaps(),A.finish(),t.getRenderBuffer())),this.renderedResolution_=T,this.renderedRevision_=_,this.renderedRenderOrder_=R,this.renderedExtent_=S,this.wrappedRenderedExtent_=C,this.renderedCenter_=E,this.renderedProjection_=y,this.replayGroup_=q,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(e,t,r,n,i,o){if(!r)return!1;var a=!1;if(Array.isArray(r))for(var s=0,l=r.length;s<l;++s)a=(0,d.Pn)(n,e,r[s],t,this.boundHandleStyleImageChange_,i,o)||a;else a=(0,d.Pn)(n,e,r,t,this.boundHandleStyleImageChange_,i,o);return a},t}(i.Z);const T=y},85980:(e,t,r)=>{r.d(t,{Z:()=>x});var n=r(35570),i=r(15240),o=r(8845),a=r(72286),s=r(37195),l=r(74225),u=r(37755),h=r(12382),d=r(6101),c=r(28641),p=r(76234),f=r(74187),g=r(4307),v=r(91900),y=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),T={image:[a.Z.POLYGON,a.Z.CIRCLE,a.Z.LINE_STRING,a.Z.IMAGE,a.Z.TEXT],hybrid:[a.Z.POLYGON,a.Z.LINE_STRING],vector:[]},m={hybrid:[a.Z.IMAGE,a.Z.TEXT,a.Z.DEFAULT],vector:[a.Z.POLYGON,a.Z.CIRCLE,a.Z.LINE_STRING,a.Z.IMAGE,a.Z.TEXT,a.Z.DEFAULT]},_=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.dirty_=!1,r.renderedLayerRevision_,r.renderedPixelToCoordinateTransform_=null,r.renderedRotation_,r.tmpTransform_=(0,d.Ue)(),r}return y(t,e),t.prototype.prepareTile=function(e,t,r){var n,i=e.getState();return i!==s.Z.LOADED&&i!==s.Z.ERROR||(this.updateExecutorGroup_(e,t,r),this.tileImageNeedsRender_(e)&&(n=!0)),n},t.prototype.getTile=function(t,r,n,i){var o=i.pixelRatio,a=i.viewState,s=a.resolution,h=a.projection,d=this.getLayer(),c=d.getSource().getTile(t,r,n,o,h),p=i.viewHints,f=!(p[u.Z.ANIMATING]||p[u.Z.INTERACTING]);!f&&c.wantedResolution||(c.wantedResolution=s);var g=this.prepareTile(c,o,h);return g&&(f||Date.now()-i.time<8)&&d.getRenderMode()!==l.Z.VECTOR&&this.renderTileImage_(c,i),e.prototype.getTile.call(this,t,r,n,i)},t.prototype.isDrawableTile=function(t){var r=this.getLayer();return e.prototype.isDrawableTile.call(this,t)&&(r.getRenderMode()===l.Z.VECTOR?(0,f.sq)(r)in t.executorGroups:t.hasContext(r))},t.prototype.getTileImage=function(e){return e.getImage(this.getLayer())},t.prototype.prepareFrame=function(t){var r=this.getLayer().getRevision();return this.renderedLayerRevision_!=r&&(this.renderedTiles.length=0),this.renderedLayerRevision_=r,e.prototype.prepareFrame.call(this,t)},t.prototype.updateExecutorGroup_=function(e,t,r){var o=this.getLayer(),a=o.getRevision(),u=o.getRenderOrder()||null,h=e.wantedResolution,d=e.getReplayState(o);if(d.dirty||d.renderedResolution!==h||d.renderedRevision!=a||d.renderedRenderOrder!=u){var g=o.getSource(),v=o.getDeclutter(),y=g.getTileGrid(),T=g.getTileGridForProjection(r),m=T.getTileCoordExtent(e.wrappedTileCoord),_=g.getSourceTiles(t,r,e),x=(0,f.sq)(o);delete e.hitDetectionImageData[x],e.executorGroups[x]=[],v&&(e.declutterExecutorGroups[x]=[]);for(var R=function(r,a){var f=_[r];if(f.getState()!=s.Z.LOADED)return"continue";var T=f.tileCoord,R=y.getTileCoordExtent(T),C=(0,c.Ed)(m,R),S=(0,c.f3)(C,o.getRenderBuffer()*h,E.tmpExtent),I=(0,c.fS)(R,C)?null:S;d.dirty=!1;var w=new n.Z(0,S,h,t),Z=v?new n.Z(0,C,h,t):void 0,b=(0,p.se)(h,t),P=function(e){var t,r=e.getStyleFunction()||o.getStyleFunction();if(r&&(t=r(e,h)),t){var n=this.renderFeature(e,b,t,w,Z);this.dirty_=this.dirty_||n,d.dirty=d.dirty||n}},A=f.getFeatures();u&&u!==d.renderedRenderOrder&&A.sort(u);for(var O=0,F=A.length;O<F;++O){var L=A[O];I&&!(0,c.kK)(I,L.getGeometry().getExtent())||P.call(E,L)}var D=w.finish(),G=o.getRenderMode()!==l.Z.VECTOR&&v&&1===_.length?null:C,M=new i.Z(G,h,t,g.getOverlaps(),D,o.getRenderBuffer());if(e.executorGroups[x].push(M),Z){var B=new i.Z(null,h,t,g.getOverlaps(),Z.finish(),o.getRenderBuffer());e.declutterExecutorGroups[x].push(B)}},E=this,C=0,S=_.length;C<S;++C)R(C,S);d.renderedRevision=a,d.renderedRenderOrder=u,d.renderedResolution=h}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){var o=t.viewState.resolution,a=t.viewState.rotation;r=void 0==r?0:r;var s=this.getLayer(),l=s.getSource(),u=l.getTileGridForProjection(t.viewState.projection),h=(0,c.hI)([e]);(0,c.f3)(h,o*r,h);for(var d,p={},g=function(e,t,r){var o=e.getId();void 0===o&&(o=(0,f.sq)(e));var a=p[o];if(a){if(!0!==a&&r<a.distanceSq){if(0===r)return p[o]=!0,i.splice(i.lastIndexOf(a),1),n(e,s,t);a.geometry=t,a.distanceSq=r}}else{if(0===r)return p[o]=!0,n(e,s,t);i.push(p[o]={feature:e,layer:s,geometry:t,distanceSq:r,callback:n})}},v=this.renderedTiles,y=function(n,i){var l=v[n],p=u.getTileCoordExtent(l.wrappedTileCoord);if(!(0,c.kK)(p,h))return"continue";var y=(0,f.sq)(s),T=[l.executorGroups[y]],m=l.declutterExecutorGroups[y];m&&T.push(m),T.some((function(n){for(var i=n===m?t.declutterTree.all().map((function(e){return e.value})):null,s=0,l=n.length;s<l;++s){var u=n[s];if(d=u.forEachFeatureAtCoordinate(e,o,a,r,g,i),d)return!0}}))},T=0,m=v.length;!d&&T<m;++T)y(T,m);return d},t.prototype.getFeatures=function(e){return new Promise(function(t,r){for(var n,i=this.getLayer(),o=(0,f.sq)(i),a=i.getSource(),l=this.renderedProjection,u=l.getExtent(),p=this.renderedResolution,y=a.getTileGridForProjection(l),T=(0,d.nn)(this.renderedPixelToCoordinateTransform_,e.slice()),m=y.getTileCoordForCoordAndResolution(T,p),_=0,x=this.renderedTiles.length;_<x;++_)if(m.toString()===this.renderedTiles[_].tileCoord.toString()){if(n=this.renderedTiles[_],n.getState()===s.Z.LOADED){var R=y.getTileCoordExtent(n.tileCoord);a.getWrapX()&&l.canWrapX()&&!(0,c.r4)(u,R)&&(0,v.Cf)(T,l);break}n=void 0}if(!n||n.loadingSourceTiles>0)t([]);else{var E=y.getTileCoordExtent(n.wrappedTileCoord),C=(0,c.rL)(E),S=[(T[0]-C[0])/p,(C[1]-T[1])/p],I=n.getSourceTiles().reduce((function(e,t){return e.concat(t.getFeatures())}),[]),w=n.hitDetectionImageData[o];if(!w&&!this.animatingOrInteracting_){var Z=(0,g.Pq)(y.getTileSize(y.getZForResolution(p))),b=this.renderedRotation_,P=[this.getRenderTransform(y.getTileCoordCenter(n.wrappedTileCoord),p,0,h.UN,Z[0]*h.UN,Z[1]*h.UN,0)];w=(0,h.TU)(Z,P,I,i.getStyleFunction(),y.getTileCoordExtent(n.wrappedTileCoord),n.getReplayState(i).renderedResolution,b),n.hitDetectionImageData[o]=w}t((0,h.ix)(S,I,w))}}.bind(this))},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.renderDeclutter=function(e){var t=this.context,r=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();for(var n=e.viewHints,i=!(n[u.Z.ANIMATING]||n[u.Z.INTERACTING]),o=this.renderedTiles,a=0,s=o.length;a<s;++a){var l=o[a],h=l.declutterExecutorGroups[(0,f.sq)(this.getLayer())];if(h)for(var d=h.length-1;d>=0;--d)h[d].execute(this.context,1,this.getTileRenderTransform(l,e),e.viewState.rotation,i,void 0,e.declutterTree)}t.globalAlpha=r},t.prototype.getTileRenderTransform=function(e,t){var r=t.pixelRatio,n=t.viewState,i=n.center,o=n.resolution,a=n.rotation,s=t.size,l=Math.round(s[0]*r),u=Math.round(s[1]*r),h=this.getLayer().getSource(),c=h.getTileGridForProjection(t.viewState.projection),p=e.tileCoord,f=c.getTileCoordExtent(e.wrappedTileCoord),g=c.getTileCoordExtent(p,this.tmpExtent)[0]-f[0],v=(0,d.Jp)((0,d.bA)(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(i,o,a,r,l,u,g));return v},t.prototype.renderFrame=function(t,r){var n=t.viewHints,i=!(n[u.Z.ANIMATING]||n[u.Z.INTERACTING]);e.prototype.renderFrame.call(this,t,r),this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;var o=this.getLayer(),a=o.getRenderMode(),s=this.context,l=s.globalAlpha;s.globalAlpha=o.getOpacity();for(var h=m[a],d=t.viewState,p=d.rotation,g=o.getSource(),v=g.getTileGridForProjection(d.projection),y=v.getZForResolution(d.resolution,g.zDirection),T=this.renderedTiles,_=[],x=[],R=T.length-1;R>=0;--R){var E=T[R],C=E.executorGroups[(0,f.sq)(o)].filter((function(e){return e.hasExecutors(h)}));if(0!==C.length){for(var S=this.getTileRenderTransform(E,t),I=E.tileCoord[0],w=!1,Z=C[0].getClipCoords(S),b=0,P=_.length;b<P;++b)if(y!==I&&I<x[b]){var A=_[b];(0,c.kK)([Z[0],Z[3],Z[4],Z[7]],[A[0],A[3],A[4],A[7]])&&(w||(s.save(),w=!0),s.beginPath(),s.moveTo(Z[0],Z[1]),s.lineTo(Z[2],Z[3]),s.lineTo(Z[4],Z[5]),s.lineTo(Z[6],Z[7]),s.moveTo(A[6],A[7]),s.lineTo(A[4],A[5]),s.lineTo(A[2],A[3]),s.lineTo(A[0],A[1]),s.clip())}_.push(Z),x.push(I);for(var O=0,F=C.length;O<F;++O){var L=C[O];L.execute(s,1,S,p,i,h)}w&&s.restore()}}return s.globalAlpha=l,this.container},t.prototype.renderFeature=function(e,t,r,n,i){if(!r)return!1;var o=!1;if(Array.isArray(r))for(var a=0,s=r.length;a<s;++a)o=(0,p.Pn)(n,e,r[a],t,this.boundHandleStyleImageChange_,void 0,i)||o;else o=(0,p.Pn)(n,e,r,t,this.boundHandleStyleImageChange_,void 0,i);return o},t.prototype.tileImageNeedsRender_=function(e){var t=this.getLayer();if(t.getRenderMode()===l.Z.VECTOR)return!1;var r=e.getReplayState(t),n=t.getRevision(),i=e.wantedResolution;return r.renderedTileResolution!==i||r.renderedTileRevision!==n},t.prototype.renderTileImage_=function(e,t){var r=this.getLayer(),n=e.getReplayState(r),i=r.getRevision(),o=e.executorGroups[(0,f.sq)(r)];n.renderedTileRevision=i;var a=e.wrappedTileCoord,s=a[0],l=r.getSource(),u=t.pixelRatio,h=t.viewState,c=h.projection,p=l.getTileGridForProjection(c),g=p.getResolution(e.tileCoord[0]),v=t.pixelRatio/e.wantedResolution*g,y=p.getResolution(s),m=e.getContext(r);u=Math.round(Math.max(u,v/u));var _=l.getTilePixelSize(s,u,c);m.canvas.width=_[0],m.canvas.height=_[1];var x=u/v;if(1!==x){var R=(0,d.mc)(this.tmpTransform_);(0,d.bA)(R,x,x),m.setTransform.apply(m,R)}var E=p.getTileCoordExtent(a,this.tmpExtent),C=v/y,S=(0,d.mc)(this.tmpTransform_);(0,d.bA)(S,C,-C),(0,d.Iu)(S,-E[0],-E[3]);for(var I=0,w=o.length;I<w;++I){var Z=o[I];Z.execute(m,x,S,0,!0,T[r.getRenderMode()])}n.renderedTileResolution=e.wantedResolution},t}(o.Z);const x=_},11481:(e,t,r)=>{r.d(t,{$:()=>n,s:()=>i});var n={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},i={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0}},76234:(e,t,r)=>{r.d(t,{Pn:()=>p,Qz:()=>d,eR:()=>u,se:()=>h});var n=r(72286),i=r(74754),o=r(70553),a=r(74187),s=.5,l={Point:_,LineString:y,Polygon:R,MultiPoint:x,MultiLineString:T,MultiPolygon:m,GeometryCollection:v,Circle:c};function u(e,t){return parseInt((0,a.sq)(e),10)-parseInt((0,a.sq)(t),10)}function h(e,t){var r=d(e,t);return r*r}function d(e,t){return s*e/t}function c(e,t,r,i,o){var a=r.getFill(),s=r.getStroke();if(a||s){var l=e.getBuilder(r.getZIndex(),n.Z.CIRCLE);l.setFillStrokeStyle(a,s),l.drawCircle(t,i)}var u=r.getText();if(u&&u.getText()){var h=(o||e).getBuilder(r.getZIndex(),n.Z.TEXT);h.setTextStyle(u),h.drawText(t,i)}}function p(e,t,r,n,i,a,s){var l=!1,u=r.getImage();if(u){var h=u.getImageState();h==o.Z.LOADED||h==o.Z.ERROR?u.unlistenImageChange(i):(h==o.Z.IDLE&&u.load(),h=u.getImageState(),u.listenImageChange(i),l=!0)}return f(e,t,r,n,a,s),l}function f(e,t,r,n,i,o){var a=r.getGeometryFunction()(t);if(a){var s=a.simplifyTransformed(n,i),u=r.getRenderer();if(u)g(e,s,r,t);else{var h=l[s.getType()];h(e,s,r,t,o)}}}function g(e,t,r,o){if(t.getType()!=i.Z.GEOMETRY_COLLECTION){var a=e.getBuilder(r.getZIndex(),n.Z.DEFAULT);a.drawCustom(t,o,r.getRenderer(),r.getHitDetectionRenderer())}else for(var s=t.getGeometries(),l=0,u=s.length;l<u;++l)g(e,s[l],r,o)}function v(e,t,r,n,i){var o,a,s=t.getGeometriesArray();for(o=0,a=s.length;o<a;++o){var u=l[s[o].getType()];u(e,s[o],r,n,i)}}function y(e,t,r,i,o){var a=r.getStroke();if(a){var s=e.getBuilder(r.getZIndex(),n.Z.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawLineString(t,i)}var l=r.getText();if(l&&l.getText()){var u=(o||e).getBuilder(r.getZIndex(),n.Z.TEXT);u.setTextStyle(l),u.drawText(t,i)}}function T(e,t,r,i,o){var a=r.getStroke();if(a){var s=e.getBuilder(r.getZIndex(),n.Z.LINE_STRING);s.setFillStrokeStyle(null,a),s.drawMultiLineString(t,i)}var l=r.getText();if(l&&l.getText()){var u=(o||e).getBuilder(r.getZIndex(),n.Z.TEXT);u.setTextStyle(l),u.drawText(t,i)}}function m(e,t,r,i,o){var a=r.getFill(),s=r.getStroke();if(s||a){var l=e.getBuilder(r.getZIndex(),n.Z.POLYGON);l.setFillStrokeStyle(a,s),l.drawMultiPolygon(t,i)}var u=r.getText();if(u&&u.getText()){var h=(o||e).getBuilder(r.getZIndex(),n.Z.TEXT);h.setTextStyle(u),h.drawText(t,i)}}function _(e,t,r,i,a){var s,l=r.getImage(),u=r.getText();if(a&&(e=a,s=l&&u&&u.getText()?{}:void 0),l){if(l.getImageState()!=o.Z.LOADED)return;var h=e.getBuilder(r.getZIndex(),n.Z.IMAGE);h.setImageStyle(l,s),h.drawPoint(t,i)}if(u&&u.getText()){var d=e.getBuilder(r.getZIndex(),n.Z.TEXT);d.setTextStyle(u,s),d.drawText(t,i)}}function x(e,t,r,i,a){var s,l=r.getImage(),u=r.getText();if(a&&(e=a,s=l&&u&&u.getText()?{}:void 0),l){if(l.getImageState()!=o.Z.LOADED)return;var h=e.getBuilder(r.getZIndex(),n.Z.IMAGE);h.setImageStyle(l,s),h.drawMultiPoint(t,i)}if(u&&u.getText()){var d=(a||e).getBuilder(r.getZIndex(),n.Z.TEXT);d.setTextStyle(u,s),d.drawText(t,i)}}function R(e,t,r,i,o){var a=r.getFill(),s=r.getStroke();if(a||s){var l=e.getBuilder(r.getZIndex(),n.Z.POLYGON);l.setFillStrokeStyle(a,s),l.drawPolygon(t,i)}var u=r.getText();if(u&&u.getText()){var h=(o||e).getBuilder(r.getZIndex(),n.Z.TEXT);h.setTextStyle(u),h.drawText(t,i)}}},35455:(e,t,r)=>{r.d(t,{O$:()=>p,S$:()=>d,ZP:()=>g,il:()=>f});var n=r(71912),i=r(10115),o=r(57380),a=r(98771),s=r(37751),l=r(6101),u=r(28641),h=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d={GENERATE_BUFFERS:"GENERATE_BUFFERS"},c=function(e){function t(t,r){var i=e.call(this,t)||this,o=r||{};return i.inversePixelTransform_=(0,l.Ue)(),i.pixelContext_=null,i.postProcesses_=o.postProcesses,i.uniforms_=o.uniforms,i.helper,t.addChangeListener(n.Z.MAP,i.removeHelper.bind(i)),i.dispatchPreComposeEvent=i.dispatchPreComposeEvent.bind(i),i.dispatchPostComposeEvent=i.dispatchPostComposeEvent.bind(i),i}return h(t,e),t.prototype.dispatchPreComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(a.Z.PRECOMPOSE)){var n=new o.Z(a.Z.PRECOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.dispatchPostComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(a.Z.POSTCOMPOSE)){var n=new o.Z(a.Z.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.reset=function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},t.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},t.prototype.prepareFrame=function(e){if(this.getLayer().getRenderSource()){for(var r=!0,n=-1,i=void 0,o=0,a=e.layerStatesArray.length;o<a;o++){var l=e.layerStatesArray[o].layer,u=l.getRenderer();if(u instanceof t){var h=l.getClassName();if((r||h!==i)&&(n+=1,r=!1),i=h,u===this)break}else r=!0}var d="map/"+e.mapId+"/group/"+n;this.helper&&this.helper.canvasCacheKeyMatches(d)||(this.removeHelper(),this.helper=new s.ZP({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:d}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)},t.prototype.afterHelperCreated=function(){},t.prototype.prepareFrameInternal=function(e){return!0},t.prototype.disposeInternal=function(){this.removeHelper(),e.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){(0,l.qC)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);var i=new o.Z(e,this.inversePixelTransform_,r,t);n.dispatchEvent(i)}},t.prototype.preRender=function(e,t){this.dispatchRenderEvent_(a.Z.PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(a.Z.POSTRENDER,e,t)},t.prototype.getDataAtPixel=function(e,t,r){var n=(0,l.nn)([t.pixelRatio,0,0,t.pixelRatio,0,0],e.slice()),i=this.helper.getGL();if(!i)return null;var o=this.getLayer(),a=o.getExtent();if(a){var s=(0,l.nn)(t.pixelToCoordinateTransform,e.slice());if(!(0,u.b8)(a,s))return null}var h=i.getContextAttributes();if(!h||!h.preserveDrawingBuffer)return new Uint8Array;var d,c=Math.round(n[0]),p=Math.round(n[1]),f=this.pixelContext_;if(!f){var g=document.createElement("canvas");g.width=1,g.height=1,f=g.getContext("2d"),this.pixelContext_=f}f.clearRect(0,0,1,1);try{f.drawImage(i.canvas,c,p,1,1,0,0,1,1),d=f.getImageData(0,0,1,1).data}catch(v){return d}return 0===d[3]?null:d},t}(i.Z);function p(e,t){var r=t||[],n=256,i=n-1;return r[0]=Math.floor(e/n/n/n)/i,r[1]=Math.floor(e/n/n)%n/i,r[2]=Math.floor(e/n)%n/i,r[3]=e%n/i,r}function f(e){var t=0,r=256,n=r-1;return t+=Math.round(e[0]*r*r*r*n),t+=Math.round(e[1]*r*r*n),t+=Math.round(e[2]*r*n),t+=Math.round(e[3]*n),t}const g=c},79567:(e,t,r)=>{r.d(t,{Z:()=>_});var n=r(12582),i=r(74754),o=r(22796),a=r(37755),s=r(22988),l=r(35455),u=r(60931),h=r(41536),d=r(37751),c=r(6101),p=r(99515),f=r(28641),g=r(21025),v=r(74187),y=r(65818),T=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),m=function(e){function t(t,r){var n=this,i=r.uniforms||{},a=(0,c.Ue)();i[d.ZC.PROJECTION_MATRIX]=a,n=e.call(this,t,{uniforms:i,postProcesses:r.postProcesses})||this,n.ready=!1,n.sourceRevision_=-1,n.verticesBuffer_=new s.ZP(h.qO,h.kd),n.hitVerticesBuffer_=new s.ZP(h.qO,h.kd),n.indicesBuffer_=new s.ZP(h.cX,h.kd),n.vertexShader_=r.vertexShader,n.fragmentShader_=r.fragmentShader,n.program_,n.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),n.hitVertexShader_=r.hitVertexShader,n.hitFragmentShader_=r.hitFragmentShader,n.hitProgram_;var u=r.attributes?r.attributes.map((function(e){return{name:"a_"+e.name,size:1,type:d.GC.FLOAT}})):[];n.attributes=[{name:"a_position",size:2,type:d.GC.FLOAT},{name:"a_index",size:1,type:d.GC.FLOAT}].concat(u),n.hitDetectionAttributes=[{name:"a_position",size:2,type:d.GC.FLOAT},{name:"a_index",size:1,type:d.GC.FLOAT},{name:"a_hitColor",size:4,type:d.GC.FLOAT},{name:"a_featureUid",size:1,type:d.GC.FLOAT}].concat(u),n.customAttributes=r.attributes?r.attributes:[],n.previousExtent_=(0,f.lJ)(),n.currentTransform_=a,n.renderTransform_=(0,c.Ue)(),n.invertRenderTransform_=(0,c.Ue)(),n.renderInstructions_=new Float32Array(0),n.hitRenderInstructions_=new Float32Array(0),n.hitRenderTarget_,n.generateBuffersRun_=0,n.worker_=(0,g.U)(),n.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===l.S$.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,(0,c.nb)(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):(this.renderInstructions_=new Float32Array(e.data.renderInstructions),t.generateBuffersRun===this.generateBuffersRun_&&(this.ready=!0)),this.getLayer().changed()}}.bind(n)),n.featureCache_={},n.featureCount_=0;var p=n.getLayer().getSource();return n.sourceListenKeys_=[(0,y.oL)(p,o.Z.ADDFEATURE,n.handleSourceFeatureAdded_,n),(0,y.oL)(p,o.Z.CHANGEFEATURE,n.handleSourceFeatureChanged_,n),(0,y.oL)(p,o.Z.REMOVEFEATURE,n.handleSourceFeatureDelete_,n),(0,y.oL)(p,o.Z.CLEAR,n.handleSourceFeatureClear_,n)],p.forEachFeature(function(e){this.featureCache_[(0,v.sq)(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(n)),n}return T(t,e),t.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.hitDetectionEnabled_&&(this.hitProgram_=this.helper.getProgram(this.hitFragmentShader_,this.hitVertexShader_),this.hitRenderTarget_=new u.Z(this.helper))},t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[(0,v.sq)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[(0,v.sq)(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[(0,v.sq)(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.helper.getGL();this.preRender(t,e);var r=this.indicesBuffer_.getSize();this.helper.drawElements(0,r),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var n=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderHitDetection(e),this.hitRenderTarget_.clearCachedData()),this.postRender(t,e),n},t.prototype.prepareFrameInternal=function(e){var t=this.getLayer(),r=t.getSource(),i=e.viewState,o=!e.viewHints[a.Z.ANIMATING]&&!e.viewHints[a.Z.INTERACTING],s=!(0,f.fS)(this.previousExtent_,e.extent),l=this.sourceRevision_<r.getRevision();if(l&&(this.sourceRevision_=r.getRevision()),o&&(s||l)){var u=i.projection,h=i.resolution,d=t instanceof n.Z?t.getRenderBuffer():0,p=(0,f.f3)(e.extent,d*h);r.loadFeatures(p,h,u),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.makeProjectionTransform(e,this.currentTransform_),(0,c.Jp)(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=(0,c.Ue)();this.helper.makeProjectionTransform(e,t);var r,n,o=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===o||(this.renderInstructions_=new Float32Array(o)),this.hitDetectionEnabled_){var a=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===a||(this.hitRenderInstructions_=new Float32Array(a))}var s,u=[],h=[],d=0,p=0;for(var f in this.featureCache_)if(r=this.featureCache_[f],n=r.geometry,n&&n.getType()===i.Z.POINT){u[0]=n.getFlatCoordinates()[0],u[1]=n.getFlatCoordinates()[1],(0,c.nn)(t,u),s=(0,l.O$)(p+6,h),this.renderInstructions_[d++]=u[0],this.renderInstructions_[d++]=u[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[p++]=u[0],this.hitRenderInstructions_[p++]=u[1],this.hitRenderInstructions_[p++]=s[0],this.hitRenderInstructions_[p++]=s[1],this.hitRenderInstructions_[p++]=s[2],this.hitRenderInstructions_[p++]=s[3],this.hitRenderInstructions_[p++]=Number(f));for(var g=void 0,v=0;v<this.customAttributes.length;v++)g=this.customAttributes[v].callback(r.feature,r.properties),this.renderInstructions_[d++]=g,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[p++]=g)}var y={type:l.S$.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(y["projectionTransform"]=t,y["generateBuffersRun"]=++this.generateBuffersRun_,this.ready=!1,this.worker_.postMessage(y,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var T={type:l.S$.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};T["projectionTransform"]=t,T["hitDetection"]=!0,this.worker_.postMessage(T,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,n,i){if((0,p.h)(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var o=(0,c.nn)(t.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),s=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],u=(0,l.il)(s),h=this.hitRenderInstructions_[u],d=Math.floor(h).toString(),f=this.getLayer().getSource(),g=f.getFeatureByUid(d);return g?n(g,this.getLayer(),null):void 0}},t.prototype.renderHitDetection=function(e){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach((function(e){(0,y.bN)(e)})),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(l.ZP);const _=m}}]);
//# sourceMappingURL=8022.371a219b.js.map