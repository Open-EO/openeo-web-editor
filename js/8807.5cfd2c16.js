"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[2722,7828,8807,9409],{35254:(e,t,s)=>{s.d(t,{A:()=>a});const a={components:{FederationNotice:()=>s.e(2604).then(s.bind(s,52604)),FederationMissingNotice:()=>s.e(5363).then(s.bind(s,35363))},props:{federation:{type:Object,default:()=>({})}}}},17834:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(86975);const r={cpu:"CPU usage",memory:"Memory usage",duration:"Wall time",network:"Network Transfer IO",disk:"Storage IO",storage:"Storage space"},i={computed:{hasUsageMetrics(){return a.A.size(this.usage)>0}},filters:{usageLabel(e){return r[e]?r[e]:a.A.prettifyString(e)},usageValue(e){return"number"===typeof e?e.toLocaleString():e}}}},69748:(e,t,s)=>{s.d(t,{A:()=>u});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component collections"},[t("SearchableList",{attrs:{data:e.collections,identifierKey:"id",summaryKey:"title",keywordsKey:"keywords",showKeywords:e.showKeywords,showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed,loadAdditionalData:e.loadAdditionalData,allowCopy:""},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(t){return[e._t("summary",null,null,t)]}},{key:"details",fn:function(s){return[t("Collection",{attrs:{data:s.item,mapOptions:e.mapOptions,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("collection-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("collection-end",null,null,t)]}},{key:"spatial-extents",fn:function(t){return[e._t("collection-spatial-extents",null,null,t)]}},{key:"temporal-extents",fn:function(t){return[e._t("collection-temporal-extents",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},r=[],i=s(86975),o=s(35254);const n={name:"Collections",components:{Collection:()=>i.A.loadAsyncComponent(Promise.all([s.e(5585),s.e(2919),s.e(4432),s.e(7487),s.e(1358),s.e(3249)]).then(s.bind(s,3249))),SearchableList:()=>i.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152)))},mixins:[o.A],props:{collections:{type:Array,default:()=>[]},mapOptions:{type:Object,default:()=>({})},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"Collections"},collapsed:{type:Boolean,default:null},loadAdditionalData:{type:Function,default:null},showKeywords:{type:Boolean,default:!1},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},missing:{type:Array,default:null},...o.A.props},beforeCreate(){i.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,a,r,!1,null,null,null);const u=d.exports},90334:(e,t,s)=>{s.d(t,{A:()=>u});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component file-formats"},[t("SearchableList",{attrs:{data:e.fileFormats,summaryKey:"title",keywordsKey:"gis_data_types",showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(s){return[e._t("summary",(function(){return[t("strong",{staticClass:"inline"},[e._v(e._s(s.item.name))]),t("ul",{staticClass:"badges small inline"},[e.showAll&&"input"===s.item.type?t("li",{staticClass:"badge option1"},[e._v("Import")]):e._e(),e.showAll&&"output"===s.item.type?t("li",{staticClass:"badge option2"},[e._v("Export")]):e._e(),Array.isArray(s.item.gis_data_types)?e._l(s.item.gis_data_types,(function(s){return t("li",{key:s,staticClass:"badge gis"},[e._v(e._s(s))])})):e._e()],2),t("br"),t("small",[e._v(e._s(s.summary.summary))])]}),null,s)]}},{key:"details",fn:function(s){return[t("FileFormat",{attrs:{id:s.summary.identifier,format:s.item,type:s.item.type,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"badges",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("file-format-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("file-format-end",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},r=[],i=s(86975),o=s(35254);const n={name:"FileFormats",components:{SearchableList:()=>i.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152))),FileFormat:()=>i.A.loadAsyncComponent(s.e(3504).then(s.bind(s,13504)))},mixins:[o.A],props:{formats:{type:Object,default:()=>({})},showInput:{type:Boolean,default:!0},showOutput:{type:Boolean,default:!0},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"File Formats"},collapsed:{type:Boolean,default:null},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},missing:{type:Array,default:null},...o.A.props},computed:{showAll(){return this.showInput&&this.showOutput},typesToShow(){let e=[];return this.showInput&&e.push("input"),this.showOutput&&e.push("output"),e},fileFormats(){let e=[];for(let s of this.typesToShow)for(var t in this.formats[s]){let a=Object.assign({id:`${t}-${s}`,name:t,type:s},this.formats[s][t]);e.push(a)}return e}},beforeCreate(){i.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,a,r,!1,null,null,null);const u=d.exports},48312:(e,t,s)=>{s.d(t,{A:()=>u});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component processes"},[t("SearchableList",{attrs:{data:e.processes,keywordsKey:"categories",showKeywords:e.showCategories,showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed,loadAdditionalData:e.loadAdditionalData,allowCopy:""},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(t){return[e._t("summary",null,null,t)]}},{key:"details",fn:function(s){return[t("Process",{attrs:{process:s.item,provideDownload:e.provideDownload,processUrl:e.processUrl,showGraph:e.showGraph,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("process-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("process-end",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},r=[],i=s(86975),o=s(35254);const n={name:"Processes",components:{Process:()=>i.A.loadAsyncComponent(s.e(6660).then(s.bind(s,34279))),SearchableList:()=>i.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152)))},mixins:[o.A],props:{processes:{type:Array,default:()=>[]},provideDownload:{type:Boolean,default:!0},processUrl:String,searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"Processes"},collapsed:{type:Boolean,default:null},showCategories:{type:Boolean,default:!1},showGraph:{type:Boolean,default:!1},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},loadAdditionalData:{type:Function,default:null},missing:{type:Array,default:null},...o.A.props},beforeCreate(){i.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,a,r,!1,null,null,null);const u=d.exports},9409:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component search-box",class:{compact:e.compact}},[t("span",{staticClass:"icon"},[e._v("🔎")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{type:"search",placeholder:e.placeholder,minlength:e.minLength,title:e.searchHint},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}})])},r=[];const i={name:"SearchBox",props:{value:{type:String,default:""},placeholder:{type:String,default:"Search"},minLength:{type:Number,default:1},compact:{type:Boolean,default:!1}},data(){return{searchTerm:this.value}},watch:{searchTerm(e,t){e.length<this.minLength&&(e=""),this.$emit("input",e)}},computed:{searchHint(){return this.minLength>1?`Searching requires at least ${this.minLength} characters.`:null}}},o=i;var n=s(81656),l=(0,n.A)(o,a,r,!1,null,null,null);const c=l.exports},91065:(e,t,s)=>{s.d(t,{A:()=>u});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component udf-runtimes"},[t("SearchableList",{attrs:{data:e.runtimes,summaryKey:"title",showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},{key:"summary",fn:function(s){return[e._t("summary",(function(){return[t("strong",{staticClass:"inline"},[e._v(e._s(s.summary.identifier))]),t("ul",{staticClass:"badges small inline"},["docker"===s.item.type||s.item.docker&&s.item.tags?[t("li",{staticClass:"badge docker"},[e._v("Docker")]),e._l(s.item.tags,(function(a){return t("li",{key:a,staticClass:"badge version",class:{default:a===s.item.default}},[e._v(e._s(a))])}))]:e._l(s.item.versions,(function(a,r){return t("li",{key:r,staticClass:"badge version",class:{default:r===s.item.default}},[e._v(e._s(r))])}))],2),t("br"),t("small",[e._v(e._s(s.summary.summary))])]}),null,s)]}},{key:"details",fn:function(s){return[t("UdfRuntime",{attrs:{id:s.summary.identifier,runtime:s.item,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"badges",fn:function(t){return[e._t("udf-runtime-badges",null,null,t)]}},{key:"before-description",fn:function(t){return[e._t("udf-runtime-before-description",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},r=[],i=s(86975),o=s(35254);const n={name:"UdfRuntimes",components:{SearchableList:()=>i.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152))),UdfRuntime:()=>i.A.loadAsyncComponent(s.e(3271).then(s.bind(s,33271)))},mixins:[o.A],props:{runtimes:{type:Object,default:()=>({})},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"UDF Runtimes"},collapsed:{type:Boolean,default:null},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},...o.A.props},beforeCreate(){i.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,a,r,!1,null,null,null);const u=d.exports},36107:(e,t,s)=>{s.d(t,{A:()=>y});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"discovery-toolbar"},[t("SearchBox",{model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),t("div",{staticClass:"filters"},[t("span",{staticClass:"label"},[e._v(" Show ")]),t("label",{staticClass:"show-deprecated",attrs:{title:"Show deprecated elements?"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.showDeprecated,expression:"showDeprecated"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showDeprecated)?e._i(e.showDeprecated,null)>-1:e.showDeprecated},on:{change:function(t){var s=e.showDeprecated,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=null,o=e._i(s,i);a.checked?o<0&&(e.showDeprecated=s.concat([i])):o>-1&&(e.showDeprecated=s.slice(0,o).concat(s.slice(o+1)))}else e.showDeprecated=r}}}),e._v(" deprecated ")]),t("label",{staticClass:"show-experimental",attrs:{title:"Show experimental elements?"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.showExperimental,expression:"showExperimental"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showExperimental)?e._i(e.showExperimental,null)>-1:e.showExperimental},on:{change:function(t){var s=e.showExperimental,a=t.target,r=!!a.checked;if(Array.isArray(s)){var i=null,o=e._i(s,i);a.checked?o<0&&(e.showExperimental=s.concat([i])):o>-1&&(e.showExperimental=s.slice(0,o).concat(s.slice(o+1)))}else e.showExperimental=r}}}),e._v(" experimental ")])]),t("div",{staticClass:"search-results"},[t("Collections",{staticClass:"category",attrs:{collections:e.collections,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsLoadCollection},on:{dragstart:function(t){return e.onDrag(t,"collection",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showCollectionInfo(s.id)}}},[t("strong",{attrs:{title:s.id}},[e._v(e._s(s.id))]),s.title?t("small",{attrs:{title:s.title}},[e._v(e._s(s.title))]):e._e()]),e.hasCollectionPreview(s)?t("button",{staticClass:"discovery-button",attrs:{type:"button",title:"View on map"},on:{click:function(t){return e.showCollectionPreview(s)}}},[t("i",{staticClass:"fas fa-map"})]):e._e()])]}}])}),t("Processes",{staticClass:"category",attrs:{processes:e.allProcesses,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:"true"},on:{dragstart:function(t){return e.onDrag(t,"process",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showProcess(s)}}},["user"===s.namespace?t("i",{staticClass:"custom-process fas fa-xs fa-sitemap",attrs:{title:"Custom Process"}}):"backend"!==s.namespace?t("i",{staticClass:"custom-process fas fa-xs fa-tag",attrs:{title:`Process from namespace '${s.namespace}'`}}):e._e(),t("strong",{attrs:{title:s.id}},[e._v(e._s(s.id))]),s.summary?t("small",{attrs:{title:s.summary}},[e._v(e._s(s.summary))]):e._e()])])]}}])}),e.hasUdfRuntimes?t("UdfRuntimes",{staticClass:"category",attrs:{runtimes:e.udfRuntimes,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({summary:s,item:a}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsRunUdf},on:{dragstart:function(t){return e.onDrag(t,"udf",{runtime:s.identifier,version:a.default})}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showUdfInfo(s.identifier,a)}}},[t("strong",{attrs:{title:s.identifier}},[e._v(e._s(s.identifier)+" ("+e._s(a.default)+")")]),s.summary?t("small",{attrs:{title:s.summary}},[e._v(e._s(s.summary))]):e._e()])])]}}],null,!1,92063951)}):e._e(),t("FileFormats",{staticClass:"category",attrs:{formats:e.fileFormats,showInput:!1,heading:"Export File Formats",searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsSaveResult},on:{dragstart:function(t){return e.onDrag(t,"fileformat",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showFileFormatInfo(s)}}},[t("strong",{attrs:{title:s.name}},[e._v(e._s(s.name))]),s.title?t("small",{attrs:{title:s.title}},[e._v(e._s(s.title))]):e._e()])])]}}])})],1)],1)},r=[],i=s(61663),o=s(2566),n=s(69748),l=s(90334),c=s(48312),d=s(9409),u=s(91065);const p={name:"DiscoveryToolbar",mixins:[i.A],components:{Collections:n.A,FileFormats:l.A,Processes:c.A,SearchBox:d["default"],UdfRuntimes:u.A},props:{onAddProcess:{type:Function,required:!0},collectionPreview:{type:Boolean,default:!1},persist:{type:Boolean,default:!1}},data(){return{internalSearchTerm:"",collapsed:!0,showDeprecated:this.$config.showDeprecatedByDefault||!1,showExperimental:this.$config.showExperimentalByDefault||!1}},computed:{...o.A.mapState(["collections","udfRuntimes"]),...o.A.mapState("editor",["discoverySearchTerm"]),...o.A.mapGetters(["supports","fileFormats","processes"]),supportsLoadCollection(){return this.processes.has("load_collection")},supportsRunUdf(){return this.processes.has("run_udf")},supportsSaveResult(){return this.processes.has("save_result")},hasUdfRuntimes(){return o.A.size(this.udfRuntimes)},allProcesses(){return this.processes.all()},searchTerm:{get(){return this.persist?this.discoverySearchTerm:this.internalSearchTerm},set(e){this.persist?this.setDiscoverySearchTerm(e):this.internalSearchTerm=e}}},watch:{searchTerm:{immediate:!0,handler(e,t){!e&&t?this.collapsed=!0:e&&!t&&(this.collapsed=!1)}}},methods:{...o.A.mapMutations("editor",["setDiscoverySearchTerm","setModelDnD"]),...o.A.mapActions(["loadProcess"]),onDrag(e,t,s){let a=e=>this.setModelDnD({type:t,data:s,loading:e});"process"===t?(a(!0),this.loadProcess(s).then((()=>a(!1)))):a(!1)},showCollectionInfo(e){this.broadcast("showCollection",e)},hasCollectionPreview(e){return Boolean(this.collectionPreview&&o.A.getPreviewLinkFromSTAC(e))},showCollectionPreview(e){this.broadcast("showCollectionPreview",e)},showProcess(e){this.broadcast("showProcess",e)},showUdfInfo(e,t){this.broadcast("showModal","UdfRuntimeModal",{id:e,data:t,version:t.default})},showFileFormatInfo(e){let t={id:e.name,format:this.fileFormats.output[e.name],type:"output"};this.broadcast("showModal","FileFormatModal",t)}}},h=p;var m=s(81656),f=(0,m.A)(h,a,r,!1,null,"aacdf426",null);const y=f.exports},98087:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=function(){var e=this,t=e._self._c;return t("Tabs",{ref:"tabs",staticClass:"editor",attrs:{id:"customProcessContent",position:"bottom"}},[t("Tab",{attrs:{id:"visual",name:"Visual Model",icon:"fa-project-diagram",selected:!0,allowShow:e.canSwitchView},on:{show:e.showModel}},[t("VisualEditor",{ref:"graphBuilder",staticClass:"visualEditorTab",attrs:{editable:e.editable,parent:e.parent,parentSchema:e.parentSchema,value:e.modelValue,title:e.title,id:e.id+"_visual",showDiscoveryToolbar:e.showDiscoveryToolbar,showIntro:e.showIntro,defaultValue:e.defaultValue},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1),t("Tab",{attrs:{id:"source",name:"Code",icon:"fa-code",allowShow:e.canSwitchView},on:{show:e.showCode}},[t("TextEditor",{ref:"sourceEditor",staticClass:"textEditorTab",attrs:{editable:e.editable,value:e.codeValue,title:e.title,id:e.id+"_text",language:"processgraph"},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1)],1)},r=[],i=s(2566),o=s(4615),n=s(58379),l=function(){var e=this,t=e._self._c;return t("div",{ref:"visualEditor",staticClass:"visualEditor"},[t("div",{staticClass:"sourceHeader"},[e.title?t("strong",[e._v(e._s(e.title))]):e._e(),t("div",{staticClass:"sourceToolbar"},[e.editable?t("span",{staticClass:"sepr"},[t("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:e.confirmClear}},[t("i",{staticClass:"fas fa-file"})]),e._t("file-toolbar")],2):e._e(),e.editable?t("span",{staticClass:"sepr"},[t("button",{attrs:{type:"button",disabled:!e.canUndo,title:"Revert last change"},on:{click:function(t){return e.$refs.blocks.undo()}}},[t("i",{staticClass:"fas fa-undo-alt"})]),t("button",{attrs:{type:"button",disabled:!e.canRedo,title:"Redo last reverted change"},on:{click:function(t){return e.$refs.blocks.redo()}}},[t("i",{staticClass:"fas fa-redo-alt"})]),t("button",{attrs:{type:"button",disabled:!e.hasSelection,title:"Delete selected elements"},on:{click:function(t){return e.$refs.blocks.deleteSelected()}}},[t("i",{staticClass:"fas fa-trash"})])]):e._e(),e.editable?t("span",{staticClass:"sepr"},[e.parent?e._e():t("button",{attrs:{type:"button",title:"Edit Process Metadata"},on:{click:()=>e.editProcess(e.value)}},[t("i",{staticClass:"fas fa-edit"})]),t("button",{attrs:{type:"button",title:"Add Parameter"},on:{click:e.addParameter}},[t("i",{staticClass:"fas fa-parking"})]),e.supportsMath?t("button",{class:{highlightFormula:e.isMath},attrs:{type:"button",title:"Insert/Edit formula"},on:{click:e.showExpressionModal}},[t("i",{staticClass:"fas fa-square-root-alt"})]):e._e()]):e._e(),t("button",{class:{compactMode:e.compactMode},attrs:{type:"button",title:"Compact Mode"},on:{click:function(t){return e.$refs.blocks.toggleCompact()}}},[t("i",{staticClass:"fas fa-compress-arrows-alt"})]),t("button",{attrs:{type:"button",title:"Scale to perfect size"},on:{click:function(t){return e.$refs.blocks.perfectScale()}}},[t("i",{staticClass:"fas fa-arrows-alt"})]),t("FullscreenButton",{attrs:{element:()=>this.$refs.visualEditor},on:{changed:t=>{this.$refs.blocks.perfectScale(),e.isFullScreen=t}}}),e._t("toolbar")],2)]),t("div",{staticClass:"editorSplitter"},[(e.showDiscoveryToolbar||e.isFullScreen)&&e.editable?t("DiscoveryToolbar",{staticClass:"discoveryToolbar",attrs:{onAddProcess:e.insertProcess}}):e._e(),t("div",{staticClass:"graphBuilder",on:{drop:e.onDrop,dragover:e.allowDrop}},[e.showHelpOverlay?t("div",{staticClass:"model-overlay"},[t("h2",[e._v("Welcome!")]),t("p",[e._v(" What you are seeing in this area is the visual model builder. You can start building your model by dragging collections, processes etc. from the left area and dropping them here. ")]),t("p",[e._v(" Alternatively, you can also import existing processes into the model builder: "),t("ul",[e.canPaste?t("li",[e._v("Paste the JSON from your clipboard by clicking "),t("button",{attrs:{type:"button",title:"Paste from clipboard"},on:{click:e.paste}},[t("i",{staticClass:"fas fa-paste"})]),e._v(" or use "),t("kbd",[e._v("CTRL")]),e._v(" + "),t("kbd",[e._v("V")]),e._v(" (Windows, Linux) or "),t("kbd",[e._v("⌘")]),e._v(" + "),t("kbd",[e._v("V")]),e._v(" (MacOS) when the model builder is in focus.")]):e._e(),t("li",[e._v("Drag and drop a JSON file from your computer")]),t("li",[e._v("Import a JSON file from your computer or another source such as the internet by clicking "),t("button",{attrs:{type:"button",title:"Import process from external source"},on:{click:e.importProcess}},[t("i",{staticClass:"fas fa-cloud-download-alt"})])])])]),e._m(0),t("p",[e._v("Once you start interacting with this area, this message will disappear.")])]):e._e(),t("ModelBuilder",{ref:"blocks",attrs:{editable:e.editable,id:e.id,processes:e.processes,collections:e.collections,parent:e.parent,parentSchema:e.parentSchema,value:e.value},on:{input:e.commit,error:e.errorHandler,showProcess:(t,s)=>e.broadcast("showProcess",{id:t,namespace:s}),showCollection:t=>e.broadcast("showCollection",t),showParameter:(t,s)=>e.broadcast("showProcessParameter",t,s),editParameter:e.editParameter,editArguments:e.openArgumentEditor,compactMode:e=>this.compactMode=e,selectionChanged:e.selectionChanged,historyChanged:e.historyChanged}})],1)],1)])},c=[function(){var e=this,t=e._self._c;return t("p",[e._v(" You can also import the processes from the Python and R client. You need to export your process to JSON first: "),t("ul",[t("li",[e._v("In Python use "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-python-client/cookbook/tricks.html#process-graph-export",target:"_blank"}},[t("code",[e._v("print(result.to_json())")])])]),t("li",[e._v("In R use "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-r-client/reference/index.html",target:"_blank"}},[t("code",[e._v('toJSON(as(result, "Process"))')])])])]),e._v(" In both cases, "),t("code",[e._v("result")]),e._v(" is your last return value from a data cube process such as "),t("code",[e._v("save_result")]),e._v(". For more details, please read the corresponding chapter in the "),t("a",{attrs:{href:"https://openeo.org/documentation/1.0/cookbook/#output-process-as-json",target:"_blank"}},[e._v("openEO cookbook")]),e._v(". ")])}],d=(s(98992),s(54520),s(81454),s(4638)),u=s(36107),p=s(61663),h=s(82574),m=s(31572),f=s(47067);const y={name:"VisualEditor",mixins:[p.A],components:{ModelBuilder:d["default"],DiscoveryToolbar:u.A,FullscreenButton:h.A},props:{id:String,editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},parent:{type:Object,default:null},parentSchema:{type:Object,default:null},showDiscoveryToolbar:{type:Boolean,default:!1},showIntro:{type:Boolean,default:!1},title:{type:String},defaultValue:{}},computed:{...i.A.mapState(["connection","collections"]),...i.A.mapGetters(["processes","supportsMath"]),...i.A.mapState("editor",["initialNode"]),...i.A.mapGetters("editor",["getModelNodeFromDnD"]),isMath(){return this.supportsMath&&this.processes.isMath(this.value)}},data(){return{showHelpOverlay:this.showIntro,canUndo:!1,canRedo:!1,canPaste:!1,compactMode:!1,hasSelection:!1,formula:null,isFullScreen:!1}},watch:{value:{immediate:!0,handler(e){if(e&&(this.showHelpOverlay=!1),this.initialNode&&i.A.isObject(e)&&i.A.isObject(e.process_graph))try{let t=this.initialNode;"1"==t&&i.A.size(e.process_graph)&&(t=Object.keys(e.process_graph)[0]),this.openArgumentEditorForNode(t)}catch(t){i.A.exception(this,t)}finally{this.setInitialNode(null)}}}},mounted(){this.canPaste=navigator&&navigator.clipboard&&"function"===typeof navigator.clipboard.readText},methods:{...i.A.mapMutations("editor",["setInitialNode","setModelDnD"]),commit(e){"undefined"!==typeof this.defaultValue&&i.A.isObject(e)&&0===i.A.size(e.process_graph)&&(e=this.defaultValue),this.$emit("input",e)},async paste(){this.canPaste||i.A.error(this,"error","Pasting is not supported by your browser.");try{const e=await navigator.clipboard.readText();let t=JSON.parse(e);await this.$refs.blocks.import(t)}catch(e){i.A.exception(this,e,"Paste Error")}},importProcess(){this.broadcast("importProcess")},errorHandler(e,t=null){i.A.exception(this,e,t)},selectionChanged(e,t){this.hasSelection=Boolean(e.filter((e=>e.$el.allowsDelete)).length||t.length)},historyChanged(e,t){this.canUndo=!!e[t-1],this.canRedo=!!e[t+1]},allowDrop(e){this.showHelpOverlay=!1,e.preventDefault()},async onDrop(e){const t=await this.getModelNodeFromDnD();if(t)return this.insertProcess(t,e.pageX,e.pageY),this.setModelDnD(),e.preventDefault();let s=e.dataTransfer.files;if(1===s.length){let t=e.dataTransfer.files[0];if("application/json"===t.type){var a=new FileReader;return a.onload=async e=>{try{let t=JSON.parse(e.target.result);await this.$refs.blocks.import(t)}catch(t){i.A.exception(this,t,"Parsing JSON file failed")}},a.onerror=e=>i.A.exception(this,e,"Reading JSON file failed"),a.readAsText(t,"UTF-8"),e.preventDefault()}}},getNameField(e=void 0,t="name"){return{value:e,name:t,description:"A unique identifier. Must contain only letters (`a`-`z`), digits (`0`-`9`) and underscores (`_`). `snake_case` is recommended.",label:"Name",schema:{type:"string",pattern:"^\\w+$"},default:null}},getDescriptionField(e=void 0,t=!1,s="description",a="Description"){return{value:e,name:s,description:"Provides a detailed description. CommonMark (Markdown) syntax can be used for rich text formatting.",label:a,optional:t,schema:{type:"string",subtype:"commonmark"}}},getOptionalField(e=void 0){return{value:e,name:"optional",label:"Optional",description:"Parameters by default are required. CHeck this option to make the parameter optional. For optional parameters a default value should be specified.",optional:!0,schema:{type:"boolean"},default:!1}},getDefaultField(e=void 0){return{value:e,name:"default",label:"Default Value",description:"This value is used whenever the user of this process did not specify a value for this parameter.",toggledBy:"optional",optional:!0,schema:{}}},getExperimentalField(e=void 0){return{value:e,name:"experimental",label:"Experimental",description:"Declares that this is experimental, which means that it is unstable and likely to change.",optional:!0,schema:{type:"boolean"},default:!1}},getDeprecatedField(e=void 0){return{value:e,name:"deprecated",label:"Deprecated",description:"Declares that this is deprecated with the potential to be removed in any of the next versions. It should be transitioned out of usage.",optional:!0,schema:{type:"boolean"},default:!1}},getSchemaField(e=void 0,t="schema",s="Data Types"){let a=e?"json-schema":"openeo-datatype";return{value:e,name:t,label:s,description:"Allowed data type(s) as JSON Schema.",schema:[{title:"Single data type",type:"object",subtype:a},{title:"Multiple data types",type:"array",minItems:2,items:{type:"object",subtype:a}}]}},editProcess(e){e=i.A.isObject(e)?e:{};let t=i.A.isObject(e.returns)?e.returns:{};var s=[this.getNameField(e.id,"id"),{value:e.summary,name:"summary",description:"A very short description of the process with usually less than 60 characters.",label:"Summary",optional:!0,schema:{type:"string"}},this.getDescriptionField(e.description,!0),{value:e.categories,name:"categories",label:"Categories",optional:!0,schema:{type:"array",items:{type:"string"}}},this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),{label:"Parameters",description:'The parameters can be edited directly in the "Visual Model" interface.',info:!0},this.getDescriptionField(t.description,!0,"returns_description","Return Value > Description"),this.getSchemaField(t.schema,"returns_schema","Return Value > Data Type"),{value:e.exceptions,name:"exceptions",description:"Declares exceptions (errors) that might occur during execution of this process. This list is just for informative purposes.\n\nThe keys of the object are the error codes, which should only consist of alphanumerical characters. `PascalCase` is recommended.",label:"Errors",optional:!0,schema:{type:"object",additionalProperties:{type:"object",required:["message"],properties:{message:{title:"Error Message",type:"string"},description:{title:"Description",type:"string",subtype:"commonmark"},http:{title:"HTTP Status Code",type:"integer",enum:[400,500,501]}}}}},{value:e.examples,name:"examples",label:"Examples",description:"Example calls for this process with specific values for the parameters (arguments) and the result (return value).",optional:!0,schema:{type:"array",items:{type:"object",required:["arguments"],properties:{title:{title:"Title",type:"string"},title:{title:"Description",type:"string",subtype:"commonmark"},arguments:{title:"Arguments",type:"object",default:{}},returns:{title:"Return Value"}}}}},{value:e.links,name:"links",label:"Links",description:"Links related to this process, e.g. additional documentation.",optional:!0,schema:{type:"array",items:{type:"object",required:["href","rel"],properties:{href:{title:"URL",type:"string"},rel:{title:"Relation",description:"For examples see [IANA relation types](https://www.iana.org/assignments/link-relations/link-relations.xhtml)",type:"string",default:"about"},title:{title:"Title",type:"string"},type:{title:"Media Type",description:"For examples see [IANA media types](https://www.iana.org/assignments/media-types/media-types.xhtml)",type:"string"}}}}}];this.broadcast("showDataForm","Edit Process",s,(async e=>{let t=i.A.pickFromObject(e,["id","summary","description","categories","experimental","deprecated","exception","examples","links"]);("string"===typeof t.description||i.A.isObject(t.schema))&&(t.returns={description:e.returns_description,schema:e.returns_schema});let s=this.$refs.blocks.export(!0),a=Object.assign({},s,t);const r={id:"",summary:"",description:"",categories:[],experimental:!1,deprecated:!1,examples:[],links:[],process_graph:{}};for(let o in r)i.A.equals(r[o],a[o])&&delete a[o];this.commit(a)}))},addParameter(){var e=[this.getNameField(),this.getDescriptionField(),this.getOptionalField(),this.getDefaultField(),this.getExperimentalField(),this.getDeprecatedField(),this.getSchemaField()];this.broadcast("showDataForm","Add Parameter",e,(async e=>{"string"===typeof e.name&&e.name.length>0&&await this.$refs.blocks.addPgParameter(e)}))},editParameter(e,t="Edit Parameter",s=null){var a=[this.getNameField(e.name),this.getDescriptionField(e.description),this.getOptionalField(e.optional),this.getDefaultField(e.default),this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),this.getSchemaField(e.schema)];this.broadcast("showDataForm",t,a,s)},showExpressionModal(){let e=new f.A(this.value,this.processes,this.connection,!0);e.setCallbackParameters(this.$refs.blocks.getPgParameters().map((e=>e.spec)));try{e.parse();let t={process:e},s={save:this.insertNodes};this.broadcast("showModal","ExpressionModal",t,s)}catch(t){i.A.exception(this,t)}},openArgumentEditorForNode(e){let t=i.A.deepClone(this.value),s=t.process_graph[e],a=this.processes.get(s.process_id,s.namespace);Array.isArray(a.parameters)&&a.parameters.length>0&&this.openArgumentEditor(a.parameters.map((e=>new m.ProcessParameter(e))).filter((e=>e.isEditable())),s.arguments,a.id,!0,null,(e=>{Object.assign(s,{arguments:e}),this.commit(t)}))},openArgumentEditor(e,t,s="Edit",a=!0,r=null,i=null,o=null){let n={title:s,parameters:e,data:t,editable:a,selectParameterName:r,parent:o},l={};"function"===typeof i&&(l.save=i),this.broadcast("showModal","ParameterModal",n,l)},confirmClear(){var e=confirm("Do you really want to clear the existing model?");e&&this.clear()},clear(){this.$refs.blocks&&this.$refs.blocks.clear(),this.commit(null)},insertProcess(e,t=null,s=null){try{var a=this.$refs.blocks.getPositionForPageXY(t,s);let r=e.namespace;"backend"!==r&&"user"!==r||(r=null),this.$refs.blocks.addProcess(e.process_id,e.arguments,a,r)}catch(r){i.A.exception(this,r)}},async insertNodes(e,t=!1){return await this.$refs.blocks.import({process_graph:e},{clear:t})}}},g=y;var v=s(81656),b=(0,v.A)(g,l,c,!1,null,null,null);const _=b.exports;var w=s(57497);const C={name:"Editor",components:{VisualEditor:_,TextEditor:w.A,Tabs:o["default"],Tab:n["default"]},props:{id:{type:String,default:()=>`editor_${Date.now()}`},editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},title:{type:String},parent:{type:Object,default:null},parentSchema:{type:Object,default:null},showDiscoveryToolbar:{type:Boolean,default:!1},showIntro:{type:Boolean,default:!1},defaultValue:{}},watch:{value(){this.updateTab()}},data(){return{modelValue:null,codeValue:null,error:null}},mounted(){this.updateTab()},methods:{...i.A.mapActions(["loadProcess"]),showModel(){this.error=null,this.modelValue=this.value},showCode(){this.error=null,this.codeValue=this.value,this.$refs.sourceEditor.updateState()},updateTab(){"source"===this.$refs.tabs.getActiveTabId()?this.showCode():this.showModel()},commit(e){this.error=null,this.$emit("input",e)},onError(e){this.error=e},activeEditor(){return"source"===this.$refs.tabs.getActiveTabId()?this.$refs.sourceEditor:this.$refs.graphBuilder},async insertProcess(e){try{await this.loadProcess({id:e.process_id,namespace:e.namespace}),this.activeEditor().insertProcess(e)}catch(t){i.A.exception(this,t)}},canSwitchView(){return!this.editable||null===this.error||(i.A.exception(this,this.error,"Process Invalid Error"),!1)}}},A=C;var x=(0,v.A)(A,a,r,!1,null,null,null);const k=x.exports},1777:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var a=function(){var e=this,t=e._self._c;return t("Modal",{attrs:{width:"80%",title:e.title},on:{closed:function(t){return e.$emit("closed")}}},[t("Service",{attrs:{service:e.service,currency:e.currency},scopedSlots:e._u([{key:"process-graph",fn:function(){return[t("Editor",{staticClass:"infoViewer",attrs:{value:e.service.process,editable:!1,id:"servicePgViewer"}})]},proxy:!0}])})],1)},r=[],i=s(2566),o=s(94679),n=s(98087),l=function(){var e=this,t=e._self._c;return t("article",{staticClass:"vue-component service"},[e._t("title",(function(){return[t("a",{staticClass:"anchor",attrs:{name:e.service.id}}),t("h2",[e._v(e._s(e.service.title||e.service.id))])]}),null,e.$props),t("section",{staticClass:"basedata"},[t("div",{staticClass:"tabular"},[t("label",[e._v("ID:")]),t("code",{staticClass:"value"},[e._v(e._s(e.service.id))])]),t("div",{staticClass:"tabular"},[t("label",[e._v("Type:")]),t("span",{staticClass:"value"},[e._v(e._s(e.type))])]),e.service.url?t("div",{staticClass:"tabular"},[t("label",[e._v("URL:")]),t("code",{staticClass:"value"},[t("a",{attrs:{href:e.service.url,target:"_blank"}},[e._v(e._s(e.service.url))])])]):e._e(),t("div",{staticClass:"tabular"},[t("label",[e._v("Enabled:")]),t("span",{staticClass:"value boolean"},[!0===e.service.enabled?t("span",[e._v("✔️")]):!1===e.service.enabled?t("span",[e._v("❌")]):t("span",[e._v("❓")])])]),e.service.created?t("div",{staticClass:"tabular"},[t("label",[e._v("Created:")]),t("span",{staticClass:"value"},[e._v(e._s(e.created))])]):e._e()]),e._t("before-description",null,null,e.$props),e.service.description?t("summary",{staticClass:"description"},[t("h3",[e._v("Description")]),t("Description",{attrs:{description:e.service.description}})],1):e._e(),e.hasAttributes?t("section",{staticClass:"attributes"},[t("h3",[e._v("Exposed Capabilities from "+e._s(e.type))]),e._l(e.service.attributes,(function(s,a){return t("div",{key:a,staticClass:"tabular"},[t("label",[e._v(e._s(e._f("prettifyKey")(a))+":")]),t("ObjectTree",{staticClass:"value",attrs:{data:s}})],1)}))],2):e._e(),e.hasConfig?t("section",{staticClass:"parameters"},[t("h3",[e._v("Custom Settings for "+e._s(e.type))]),e._l(e.service.configuration,(function(s,a){return t("div",{key:a,staticClass:"tabular"},[t("label",[e._v(e._s(e._f("prettifyKey")(a))+":")]),t("ObjectTree",{staticClass:"value",attrs:{data:s}})],1)}))],2):e._e(),e.service.plan||e.costs||e.budget?t("section",{staticClass:"billing"},[t("h3",[e._v("Billing")]),e.service.plan?t("div",{staticClass:"tabular"},[t("label",[e._v("Billing plan:")]),t("span",{staticClass:"value"},[e._v(e._s(e.service.plan))])]):e._e(),e.costs?t("div",{staticClass:"tabular"},[t("label",[e._v("Incurred Costs:")]),t("span",{staticClass:"value"},[e._v(e._s(e.costs))])]):e._e(),e.budget?t("div",{staticClass:"tabular"},[t("label",{attrs:{title:"The allowed maximum costs, specified by the user."}},[e._v("Budget limit:")]),t("span",{staticClass:"value"},[e._v(e._s(e.budget))])]):e._e()]):e._e(),e.hasUsageMetrics?t("section",{staticClass:"usage"},[t("h3",[e._v("Usage Metrics")]),e._l(e.usage,(function(s,a){return t("div",{key:a,staticClass:"tabular"},[t("label",{staticClass:"metric"},[e._v(e._s(e._f("usageLabel")(a)))]),t("span",{staticClass:"value"},[e._v(e._s(e._f("usageValue")(s.value))+" "),t("span",{staticClass:"unit"},[e._v(e._s(s.unit))])])])}))],2):e._e(),t("section",{staticClass:"process"},[t("h3",[e._v("Process")]),t("Process",{staticClass:"inline",attrs:{process:e.service.process,provideDownload:!1,showGraph:!0},scopedSlots:e._u([{key:"process-graph",fn:function(t){return[e._t("process-graph",null,{vBind:t})]}}],null,!0)})],1),e._t("end",null,null,e.$props)],2)},c=[],d=s(86975),u=s(17834);const p={name:"Service",mixins:[u.A],components:{Description:()=>Promise.all([s.e(7261),s.e(1194)]).then(s.bind(s,27261)),ObjectTree:()=>s.e(2327).then(s.bind(s,2327)),Process:()=>s.e(6660).then(s.bind(s,34279))},props:{service:{type:Object,default:()=>({})},currency:{type:String,default:null}},computed:{budget(){return d.A.formatBudget(this.service.budget,this.currency,"No limit specified")},costs(){return d.A.formatCurrency(this.service.costs,this.currency)},created(){return d.A.formatTimestamp(this.service.created)},hasAttributes(){return d.A.size(this.service.attributes)>0},hasConfig(){return d.A.size(this.service.configuration)>0},type(){return"string"===typeof this.service.type?this.service.type.toUpperCase():"Unknown"},usage(){return this.service.usage}},beforeCreate(){d.A.enableHtmlProps(this)},filters:{prettifyKey(e){return d.A.prettifyString(e)}}},h=p;var m=s(81656),f=(0,m.A)(h,l,c,!1,null,null,null);const y=f.exports,g={name:"ServiceInfoModal",components:{Editor:n["default"],Modal:o.A,Service:y},props:{service:{type:Object}},computed:{...i.A.mapGetters(["currency"]),title(){return"Web Service: "+(this.service.title||"#"+this.service.id)}}},v=g;var b=(0,m.A)(v,a,r,!1,null,null,null);const _=b.exports},16125:(e,t,s)=>{s.d(t,{A:()=>o});s(81454);var a=s(14894),r=s(2566);class i extends a.BaseProcess{constructor(e,t){super(e),this.exporter=t}async execute(e){await this.exporter.generateFunction(e)}}class o extends a.ProcessGraph{constructor(e,t,s){super(r.A.isObject(e)?e:{},t),this.connection=s,this.code=[],this.fnCounter=1,this.allowEmpty(),this.fillUndefinedParameters()}createProcessGraphInstance(e){let t=new o(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(t)}copyProcessGraphInstanceProperties(e){return e=super.copyProcessGraphInstanceProperties(e),e.connection=this.connection,e}createProcessInstance(e){return new i(e,this)}isKeyword(e){return this.getKeywords().includes(e.toLowerCase())}getKeywords(){return[]}comment(){}generateImports(){}generateConnection(){}generateAuthentication(){}generateBuilder(){}generateMetadata(){}generateMissingParameter(){}async generateFunction(){}generateFunctionParams(e){return e.map((e=>"undefined"!==typeof e.default?`${e.name} = ${this.e(e.default)}`:e.name))}async generateCallback(){}generateResult(){}makeNull(){return"null"}makeBoolean(e){return e?"true":"false"}makeArray(e){return`[${e.join(", ")}]`}makeObject(e){let t=r.A.mapObject(e,((e,t)=>`${this.makeString(t)}: ${e}`));return`{${t.join(", ")}}`}makeString(e){return JSON.stringify(e)}makeNumber(e){return e}e(e){return null===e?this.makeNull():"boolean"===typeof e?this.makeBoolean(e):"number"===typeof e?this.makeNumber(e):"string"===typeof e?this.makeString(e):Array.isArray(e)?this.makeArray(e.map((e=>this.e(e)))):r.A.isObject(e)?this.makeObject(r.A.mapObjectValues(e,(e=>this.e(e)))):"function"===typeof e?e():this.makeNull()}generateMetadata(){let e=!1;for(let t in this.process){if("process_graph"===t)continue;let s=this.process[t];Array.isArray(s)&&0===s.length||("string"===typeof s&&0===s.length||("boolean"!==typeof s||s)&&(e||(this.newLine(),this.comment("Set the metadata for the process"),e=!0),this.generateMetadataEntry(t,s)))}}async resolveArguments(e,t,s){let a=Array.isArray(e)?[]:{};for(let i in e){let n=e[i];if(!s||!s(i,n))if(r.A.isObject(n)){if(n.from_node){a[i]=()=>this.var(n.from_node,this.varPrefix());continue}if(n.from_parameter){a[i]=()=>this.var(n.from_parameter);continue}if(n instanceof o){let e=await t(i);a[i]=()=>e;continue}a[i]=await this.resolveArguments(n,t,s)}else Array.isArray(n)?a[i]=await this.resolveArguments(n,t,s):a[i]=n}return a}async resolveCallback(e,t){let s;if("load_collection"===e.process_id){let a=e.getArgument("properties");s=a[t]}else s=e.getArgument(t);let a=s.getCallbackParameters();await s.execute(a);let r=this.var(`${t}${this.fnCounter++}`,"fn_"),i=await this.generateCallback(s,a,r);return i||r}async generateArguments(e,t=!1,s=null){let a=await this.resolveArguments(e.arguments,(async t=>await this.resolveCallback(e,t)),s);return t&&(a=this.orderArguments(e,a)),a}orderArguments(e,t){let s=e.getProcessGraph().getProcess(e);if(s&&Array.isArray(s.parameters)){let e=s.parameters.map((e=>"undefined"!==typeof t[e.name]?t[e.name]:e.optional?void 0:null)),a=!1;for(let t=e.length-1;t>=0;t--)"undefined"===typeof e[t]?a?e[t]=null:e.pop():a=!0;return e}}varPrefix(){return this.getParent()?"data":"datacube"}var(e,t="var"){return e=String(e),this.isKeyword(e)?`${e}_`:e.match(/^[a-z_]\w*$/)?e:t+e.replace(/[^\w]+/g,"_")}getTab(){return"\t"}addCode(e,t="",s=0){if("string"!==typeof e)return;let a=this.getTab().repeat(s),r=e.trim().split(/\r\n|\r|\n/g);for(let i of r)this.code.push(`${a}${t}${i}\n`)}newLine(e=1){for(let t=0;t<e;t++)this.addCode("")}getServerUrl(){return this.connection.getUrl()}async toCode(e=!1){this.code=[],e||(this.comment("Import required packages"),this.generateImports(),this.newLine(),this.comment("Connect to the back-end"),this.generateConnection(),this.generateAuthentication(),this.newLine(),this.generateBuilder(),this.generateMetadata(),this.newLine());let t=this.getProcessParameters();if(t.length>0){this.comment("ToDo: Here you need to set values for the parameters");for(let e of t)this.generateMissingParameter(e);this.newLine()}return await this.execute(),e||(this.newLine(),this.comment("The process can be executed synchronously (see below), as batch job or as web service now")),this.generateResult(this.getResultNode(),e),this.code.join("").trim()}async execute(){return await this.validate(),this.reset(),await this.executeNodes(this.getStartNodes()),this.getResultNode()}isMath(){return"undefined"===typeof this._isMath&&(this._isMath=this.processRegistry.isMath(this)),this._isMath}}},47067:(e,t,s)=>{s.d(t,{A:()=>n});s(98992),s(54520),s(81454);var a=s(2566),r=s(16125),i=s(73902);const o=["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield","builder","connection","formula","openeo","result"];class n extends r.A{constructor(e,t,s,a=!1){super(e,t,s),this.generateFormula=a}createProcessGraphInstance(e){let t=new n(e,this.processRegistry,this.getJsonSchemaValidator(),this.generateFormula);return this.copyProcessGraphInstanceProperties(t)}parse(){this.parsed||super.parse()}getKeywords(){return o}comment(e){this.addCode(e,"// ")}generateImports(){this.addCode("import { OpenEO, Formula } from '@openeo/js-client';")}generateConnection(){this.addCode(`let connection = await OpenEO.connect('${this.getServerUrl()}');`)}generateAuthentication(){this.comment("ToDo: Here you need to add your authentication steps")}generateBuilder(){this.addCode("let builder = await connection.buildProcess();")}generateMetadataEntry(e,t){this.addCode(`builder.${e} = ${this.e(t)};`)}async generateFunction(e){let t=e.getParent()?"this":"builder",s=this.var(e.id,this.varPrefix()),r=await this.generateArguments(e,!e.namespace);if(this.comment(e.description),a.A.isObject(r)){let a=e.namespace?`${e.process_id}@${e.namespace}`:e.process_id;this.addCode(`let ${s} = ${t}.process("${a}", ${this.e(r)});`)}else this.addCode(`let ${s} = ${t}.${e.process_id}(${r.map((e=>this.e(e))).join(", ")});`)}generateMissingParameter(e){this.comment(e.description);let t=this.var(e.name,"param"),s="undefined"!==typeof e.default?e.default:null;this.addCode(`let ${t} = ${this.e(s)};`)}async generateCallback(e,t,s){if(this.generateFormula&&e&&e.isMath()){let t=e.toFormulaString(),s=JSON.stringify(t);return`new Formula(${s})`}{let a=this.generateFunctionParams(t);this.newLine(),this.addCode(`let ${s} = function(${a.join(", ")}) {`),this.addCode(await e.toCode(!0),"",1),this.addCode("}")}}generateResult(e,t){if(!e)return;let s=this.var(e.id,this.varPrefix());t?this.addCode(`return ${s};`):this.addCode(`let result = await connection.computeResult(${s});`)}toFormulaString(){return this.isMath()?this.nodeToFormula(this.getResultNode()):""}getArrayElementPlaceholder(e){if("array_element"===e.process_id&&"parameter"===e.getArgumentType("data")){let t=e.getRawArgument("data").from_parameter,s=this.getCallbackParameters().findIndex((e=>e.name===t));if(s>=0)return"$".repeat(s+1)+(e.getArgument("label")||e.getArgument("index"))}return null}nodeToFormula(e,t=null){if("array_element"===e.process_id){let t=this.getArrayElementPlaceholder(e);if(t)return t}let s=i.Formula.reverseOperatorMapping[e.process_id],r=this.processRegistry.get(e.process_id),o="undefined"!==typeof i.Formula.arrayOperatorMapping[e.process_id],n=t=>{if(a.A.isObject(t))if(t.from_node){let a=e.getProcessGraph().getNode(t.from_node);t=a?this.nodeToFormula(a,s):"#"+t.from_node}else{if(!t.from_parameter)throw new Error("Objects not allowed");t=t.from_parameter}return t},l=[],c=Array.isArray(r.parameters)?r.parameters:[];for(let a of c){let t=n(e.getRawArgument(a.name));if(o&&Array.isArray(t)&&"data"===a.name){l=t.map((e=>n(e)));break}if("undefined"!==typeof t)l.push(t);else{if("undefined"===typeof a.default)throw new Error('Argument for parameter "'+a.name+'" missing');l.push(a.default)}}if(o&&(l=l.filter((e=>null!==e))),s){let e=["/","*"],a=["-","+"],r=l.map((e=>e<0?"("+e+")":e)).join(s);return!t||a.includes(t)&&a.includes(s)||"^"===s||a.includes(t)&&e.includes(s)?r:"("+r+")"}return e.process_id+"("+l.join(", ")+")"}}}}]);
//# sourceMappingURL=8807.5cfd2c16.js.map