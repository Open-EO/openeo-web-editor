{"version":3,"file":"js/7017.8022f0fe.js","mappings":"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","sources":["webpack://@openeo/web-editor/./node_modules/earcut/src/earcut.js","webpack://@openeo/web-editor/./node_modules/ol-ext/control/LayerSwitcher.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Base.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Checkbox.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Switch.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/input/Radio.js","webpack://@openeo/web-editor/./node_modules/ol-ext/util/element.js","webpack://@openeo/web-editor/./node_modules/ol/Collection.js","webpack://@openeo/web-editor/./node_modules/ol/CollectionEventType.js","webpack://@openeo/web-editor/./node_modules/ol/Disposable.js","webpack://@openeo/web-editor/./node_modules/ol/Feature.js","webpack://@openeo/web-editor/./node_modules/ol/Image.js","webpack://@openeo/web-editor/./node_modules/ol/ImageState.js","webpack://@openeo/web-editor/./node_modules/ol/ImageTile.js","webpack://@openeo/web-editor/./node_modules/ol/Kinetic.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEventHandler.js","webpack://@openeo/web-editor/./node_modules/ol/TileQueue.js","webpack://@openeo/web-editor/./node_modules/ol/Map.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEvent.js","webpack://@openeo/web-editor/./node_modules/ol/MapBrowserEventType.js","webpack://@openeo/web-editor/./node_modules/ol/MapEvent.js","webpack://@openeo/web-editor/./node_modules/ol/MapEventType.js","webpack://@openeo/web-editor/./node_modules/ol/MapProperty.js","webpack://@openeo/web-editor/./node_modules/ol/Object.js","webpack://@openeo/web-editor/./node_modules/ol/ObjectEventType.js","webpack://@openeo/web-editor/./node_modules/ol/Observable.js","webpack://@openeo/web-editor/./node_modules/ol/Tile.js","webpack://@openeo/web-editor/./node_modules/ol/TileCache.js","webpack://@openeo/web-editor/./node_modules/ol/TileRange.js","webpack://@openeo/web-editor/./node_modules/ol/TileState.js","webpack://@openeo/web-editor/./node_modules/ol/ViewProperty.js","webpack://@openeo/web-editor/./node_modules/ol/View.js","webpack://@openeo/web-editor/./node_modules/ol/ViewHint.js"],"sourcesContent":["'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 32767 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize, 0);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim | 0);\n            triangles.push(ear.i / dim | 0);\n            triangles.push(next.i / dim | 0);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    var p = c.next;\n    while (p !== a) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    var ax = a.x, bx = b.x, cx = c.x, ay = a.y, by = b.y, cy = c.y;\n\n    // triangle bbox; min & max are calculated like this for speed\n    var x0 = ax < bx ? (ax < cx ? ax : cx) : (bx < cx ? bx : cx),\n        y0 = ay < by ? (ay < cy ? ay : cy) : (by < cy ? by : cy),\n        x1 = ax > bx ? (ax > cx ? ax : cx) : (bx > cx ? bx : cx),\n        y1 = ay > by ? (ay > cy ? ay : cy) : (by > cy ? by : cy);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(x0, y0, minX, minY, invSize),\n        maxZ = zOrder(x1, y1, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p.x >= x0 && p.x <= x1 && p.y >= y0 && p.y <= y1 && p !== a && p !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, p.x, p.y) && area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n.x >= x0 && n.x <= x1 && n.y >= y0 && n.y <= y1 && n !== a && n !== c &&\n            pointInTriangle(ax, ay, bx, by, cx, cy, n.x, n.y) && area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim | 0);\n            triangles.push(p.i / dim | 0);\n            triangles.push(b.i / dim | 0);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize, 0);\n                earcutLinked(c, triangles, dim, minX, minY, invSize, 0);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        outerNode = eliminateHole(queue[i], outerNode);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    var bridge = findHoleBridge(hole, outerNode);\n    if (!bridge) {\n        return outerNode;\n    }\n\n    var bridgeReverse = splitPolygon(bridge, hole);\n\n    // filter collinear points around the cuts\n    filterPoints(bridgeReverse, bridgeReverse.next);\n    return filterPoints(bridge, bridge.next);\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                m = p.x < p.next.x ? p : p.next;\n                if (x === hx) return m; // hole touches outer segment; pick leftmost endpoint\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === 0) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = (x - minX) * invSize | 0;\n    y = (y - minY) * invSize | 0;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) >= (ax - px) * (cy - py) &&\n           (ax - px) * (by - py) >= (bx - px) * (ay - py) &&\n           (bx - px) * (cy - py) >= (cx - px) * (by - py);\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = 0;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable.js'\r\nimport ol_control_Control from 'ol/control/Control.js'\r\nimport ol_layer_Tile from 'ol/layer/Tile.js'\r\nimport ol_layer_Vector from 'ol/layer/Vector.js'\r\nimport ol_layer_VectorTile from 'ol/layer/VectorTile.js'\r\n// ol < 6 compatibility VectorImage is not defined\r\n// import ol_layer_VectorImage from 'ol/layer/VectorImage'\r\nimport ol_layer_Image from 'ol/layer/Image.js'\r\nimport ol_layer_Heatmap from 'ol/layer/Heatmap.js'\r\nimport {intersects as ol_extent_intersects} from 'ol/extent.js'\r\n\r\nimport ol_ext_element from '../util/element.js'\r\n\r\n/** Layer Switcher Control.\r\n * @fires select\r\n * @fires drawlist\r\n * @fires toggle\r\n * @fires reorder-start\r\n * @fires reorder-end\r\n * @fires layer:visible\r\n * @fires layer:opacity\r\n * \r\n * @constructor\r\n * @extends {ol_control_Control}\r\n * @param {Object=} options\r\n *  @param {boolean} options.selection enable layer selection when click on the title\r\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\r\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\r\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\r\n *  @param {boolean} options.reordering allow layer reordering, default true\r\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\r\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\r\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\r\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\r\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\r\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\r\n *  @param {ol.layer.Group} options.layerGroup a layer group to display in the switcher, default display all layers of the map\r\n *  @param {boolean} options.noScroll prevent handle scrolling, default false\r\n *  @param {function} options.onchangeCheck optional callback on click on checkbox, you can call this method for doing operations after check/uncheck a layer\r\n *\r\n * Layers attributes that control the switcher\r\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\r\n *\t- displayInLayerSwitcher {boolean} display the layer in switcher, default true\r\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\r\n */\r\nvar ol_control_LayerSwitcher = class olcontrolLayerSwitcher extends ol_control_Control {\r\n  constructor(options) {\r\n    options = options || {}\r\n    var element = ol_ext_element.create('DIV', {\r\n      className: options.switcherClass || 'ol-layerswitcher'\r\n    })\r\n    super({\r\n      element: element,\r\n      target: options.target\r\n    })\r\n    \r\n    var self = this\r\n    this.dcount = 0\r\n    this.show_progress = options.show_progress\r\n    this.oninfo = (typeof (options.oninfo) == 'function' ? options.oninfo : null)\r\n    this.onextent = (typeof (options.onextent) == 'function' ? options.onextent : null)\r\n    this.hasextent = options.extent || options.onextent\r\n    this.hastrash = options.trash\r\n    this.reordering = (options.reordering !== false)\r\n    this._layers = []\r\n    this._layerGroup = (options.layerGroup && options.layerGroup.getLayers) ? options.layerGroup : null\r\n    this.onchangeCheck = (typeof (options.onchangeCheck) == \"function\" ? options.onchangeCheck : null)\r\n\r\n    // displayInLayerSwitcher\r\n    if (typeof (options.displayInLayerSwitcher) === 'function') {\r\n      this.displayInLayerSwitcher = options.displayInLayerSwitcher\r\n    }\r\n\r\n    // Insert in the map\r\n    if (!options.target) {\r\n      element.classList.add('ol-unselectable')\r\n      element.classList.add('ol-control')\r\n      element.classList.add(options.collapsed !== false ? 'ol-collapsed' : 'ol-forceopen')\r\n\r\n      this.button = ol_ext_element.create('BUTTON', {\r\n        type: 'button',\r\n        parent: element\r\n      })\r\n      this.button.addEventListener('touchstart', function (e) {\r\n        element.classList.toggle('ol-forceopen')\r\n        element.classList.add('ol-collapsed')\r\n        self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') })\r\n        e.preventDefault()\r\n        self.overflow()\r\n      })\r\n      this.button.addEventListener('click', function () {\r\n        element.classList.toggle('ol-forceopen')\r\n        element.classList.add('ol-collapsed')\r\n        self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') })\r\n        self.overflow()\r\n      })\r\n\r\n      if (options.mouseover) {\r\n        element.addEventListener('mouseleave', function () {\r\n          element.classList.add(\"ol-collapsed\")\r\n          self.dispatchEvent({ type: 'toggle', collapsed: true })\r\n        })\r\n        element.addEventListener('mouseover', function () {\r\n          element.classList.remove(\"ol-collapsed\")\r\n          self.dispatchEvent({ type: 'toggle', collapsed: false })\r\n        })\r\n      }\r\n\r\n      if (options.minibar)\r\n        options.noScroll = true\r\n      if (!options.noScroll) {\r\n        this.topv = ol_ext_element.create('DIV', {\r\n          className: 'ol-switchertopdiv',\r\n          parent: element,\r\n          click: function () {\r\n            self.overflow(\"+50%\")\r\n          }\r\n        })\r\n\r\n        this.botv = ol_ext_element.create('DIV', {\r\n          className: 'ol-switcherbottomdiv',\r\n          parent: element,\r\n          click: function () {\r\n            self.overflow(\"-50%\")\r\n          }\r\n        })\r\n      }\r\n      this._noScroll = options.noScroll\r\n    }\r\n\r\n    this.panel_ = ol_ext_element.create('UL', {\r\n      className: 'panel',\r\n    })\r\n    this.panelContainer_ = ol_ext_element.create('DIV', {\r\n      className: 'panel-container',\r\n      html: this.panel_,\r\n      parent: element\r\n    })\r\n    // Handle mousewheel\r\n    if (!options.target && !options.noScroll) {\r\n      ol_ext_element.addListener(this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function (e) {\r\n        if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\r\n          e.stopPropagation()\r\n          e.preventDefault()\r\n        }\r\n      })\r\n    }\r\n\r\n    this.header_ = ol_ext_element.create('LI', {\r\n      className: 'ol-header',\r\n      parent: this.panel_\r\n    })\r\n\r\n    this.set('drawDelay', options.drawDelay || 0)\r\n    this.set('selection', options.selection)\r\n\r\n    if (options.minibar) {\r\n      // Wait init complete (for child classes)\r\n      setTimeout(function () {\r\n        var mbar = ol_ext_element.scrollDiv(this.panelContainer_, {\r\n          mousewheel: true,\r\n          vertical: true,\r\n          minibar: true\r\n        })\r\n        this.on(['drawlist', 'toggle'], function () {\r\n          mbar.refresh()\r\n        })\r\n      }.bind(this))\r\n    }\r\n  }\r\n  /** Test if a layer should be displayed in the switcher\r\n   * @param {ol.layer} layer\r\n   * @return {boolean} true if the layer is displayed\r\n   */\r\n  displayInLayerSwitcher(layer) {\r\n    return (layer.get('displayInLayerSwitcher') !== false)\r\n  }\r\n  /**\r\n   * Set the map instance the control is associated with.\r\n   * @param {_ol_Map_} map The map instance.\r\n   */\r\n  setMap(map) {\r\n    super.setMap(map)\r\n    this.drawPanel()\r\n\r\n    if (this._listener) {\r\n      for (var i in this._listener){\r\n        ol_Observable_unByKey(this._listener[i])\r\n      }\r\n    }\r\n    this._listener = null\r\n\r\n    // Get change (new layer added or removed)\r\n    if (map) {\r\n      this._listener = {\r\n        moveend: map.on('moveend', this.viewChange.bind(this)),\r\n        size: map.on('change:size', this.overflow.bind(this))\r\n      }\r\n      // Listen to a layer group\r\n      if (this._layerGroup) {\r\n        this._listener.change = this._layerGroup.getLayers().on('change:length', this.drawPanel.bind(this))\r\n      } else {\r\n        //Listen to all layers\r\n        this._listener.change = map.getLayerGroup().getLayers().on('change:length', this.drawPanel.bind(this))\r\n      }\r\n    }\r\n  }\r\n  /** Show control\r\n   */\r\n  show() {\r\n    this.element.classList.add('ol-forceopen')\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: false })\r\n  }\r\n  /** Hide control\r\n   */\r\n  hide() {\r\n    this.element.classList.remove('ol-forceopen')\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: true })\r\n  }\r\n  /** Toggle control\r\n   */\r\n  toggle() {\r\n    this.element.classList.toggle(\"ol-forceopen\")\r\n    this.overflow()\r\n    this.dispatchEvent({ type: 'toggle', collapsed: !this.isOpen() })\r\n  }\r\n  /** Is control open\r\n   * @return {boolean}\r\n   */\r\n  isOpen() {\r\n    return this.element.classList.contains(\"ol-forceopen\")\r\n  }\r\n  /** Add a custom header\r\n   * @param {Element|string} html content html\r\n   */\r\n  setHeader(html) {\r\n    ol_ext_element.setHTML(this.header_, html)\r\n  }\r\n  /** Calculate overflow and add scrolls\r\n   * @param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\r\n   * @private\r\n   */\r\n  overflow(dir) {\r\n    if (this.button && !this._noScroll) {\r\n      // Nothing to show\r\n      if (ol_ext_element.hidden(this.panel_)) {\r\n        ol_ext_element.setStyle(this.element, { height: 'auto' })\r\n        return\r\n      }\r\n      // Calculate offset\r\n      var h = ol_ext_element.outerHeight(this.element)\r\n      var hp = ol_ext_element.outerHeight(this.panel_)\r\n      var dh = this.button.offsetTop + ol_ext_element.outerHeight(this.button)\r\n      //var dh = this.button.position().top + this.button.outerHeight(true);\r\n      var top = this.panel_.offsetTop - dh\r\n      if (hp > h - dh) {\r\n        // Bug IE: need to have an height defined\r\n        ol_ext_element.setStyle(this.element, { height: '100%' })\r\n        var li = this.panel_.querySelectorAll('li.ol-visible .li-content')[0]\r\n        var lh = li ? 2 * ol_ext_element.getStyle(li, 'height') : 0\r\n        switch (dir) {\r\n          case 1: top += lh; break\r\n          case -1: top -= lh; break\r\n          case \"+50%\": top += Math.round(h / 2); break\r\n          case \"-50%\": top -= Math.round(h / 2); break\r\n          default: break\r\n        }\r\n        // Scroll div\r\n        if (top + hp <= h - 3 * dh / 2) {\r\n          top = h - 3 * dh / 2 - hp\r\n          ol_ext_element.hide(this.botv)\r\n        } else {\r\n          ol_ext_element.show(this.botv)\r\n        }\r\n        if (top >= 0) {\r\n          top = 0\r\n          ol_ext_element.hide(this.topv)\r\n        } else {\r\n          ol_ext_element.show(this.topv)\r\n        }\r\n        // Scroll ?\r\n        ol_ext_element.setStyle(this.panel_, { top: top + \"px\" })\r\n        return true\r\n      } else {\r\n        ol_ext_element.setStyle(this.element, { height: \"auto\" })\r\n        ol_ext_element.setStyle(this.panel_, { top: 0 })\r\n        ol_ext_element.hide(this.botv)\r\n        ol_ext_element.hide(this.topv)\r\n        return false\r\n      }\r\n    }\r\n    else\r\n      return false\r\n  }\r\n  /** Set the layer associated with a li\r\n   * @param {Element} li\r\n   * @param {ol.layer} layer\r\n   * @private\r\n   */\r\n  _setLayerForLI(li, layer) {\r\n    var listeners = []\r\n    if (layer.getLayers) {\r\n      listeners.push(layer.getLayers().on('change:length', this.drawPanel.bind(this)))\r\n    }\r\n    if (li) {\r\n      // Handle opacity change\r\n      listeners.push(layer.on('change:opacity', (function () {\r\n        this.setLayerOpacity(layer, li)\r\n      }).bind(this)))\r\n      // Handle visibility chage\r\n      listeners.push(layer.on('change:visible', (function () {\r\n        this.setLayerVisibility(layer, li)\r\n      }).bind(this)))\r\n    }\r\n    // Other properties\r\n    listeners.push(layer.on('propertychange', (function (e) {\r\n      if (e.key === 'displayInLayerSwitcher'\r\n        || e.key === 'openInLayerSwitcher'\r\n        || e.key === 'title'\r\n        || e.key === 'name') {\r\n        this.drawPanel(e)\r\n      }\r\n    }).bind(this)))\r\n    this._layers.push({ li: li, layer: layer, listeners: listeners })\r\n  }\r\n  /** Set opacity for a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @param {Element} li the list element\r\n   * @private\r\n   */\r\n  setLayerOpacity(layer, li) {\r\n    var i = li.querySelector('.layerswitcher-opacity-cursor')\r\n    if (i){\r\n      i.style.left = (layer.getOpacity() * 100) + \"%\"\r\n    }\r\n    this.dispatchEvent({ type: 'layer:opacity', layer: layer })\r\n  }\r\n  /** Set visibility for a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @param {Element} li the list element\r\n   * @api\r\n   */\r\n  setLayerVisibility(layer, li) {\r\n    var i = li.querySelector('.ol-visibility')\r\n    if (i) {\r\n      i.checked = layer.getVisible()\r\n    }\r\n    if (layer.getVisible()){\r\n      li.classList.add('ol-visible')\r\n    } else{\r\n      li.classList.remove('ol-visible')\r\n    }\r\n    this.dispatchEvent({ type: 'layer:visible', layer: layer })\r\n  }\r\n  /** Clear layers associated with li\r\n   * @private\r\n   */\r\n  _clearLayerForLI() {\r\n    this._layers.forEach(function (li) {\r\n      li.listeners.forEach(function (l) {\r\n        ol_Observable_unByKey(l)\r\n      })\r\n    })\r\n    this._layers = []\r\n  }\r\n  /** Get the layer associated with a li\r\n   * @param {Element} li\r\n   * @return {ol.layer}\r\n   * @private\r\n   */\r\n  _getLayerForLI(li) {\r\n    for (var i = 0, l; l = this._layers[i]; i++) {\r\n      if (l.li === li) {\r\n        return l.layer\r\n      }\r\n    }\r\n    return null\r\n  }\r\n  /**\r\n   * On view change hide layer depending on resolution / extent\r\n   * @private\r\n   */\r\n  viewChange() {\r\n    this.panel_.querySelectorAll('li').forEach(function (li) {\r\n      var l = this._getLayerForLI(li)\r\n      if (l) {\r\n        if (this.testLayerVisibility(l)) {\r\n          li.classList.remove('ol-layer-hidden')\r\n        } else {\r\n          li.classList.add('ol-layer-hidden')\r\n        }\r\n      }\r\n    }.bind(this))\r\n  }\r\n  /** Get control panel\r\n   * @api\r\n   */\r\n  getPanel() {\r\n    return this.panelContainer_\r\n  }\r\n  /** Draw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\r\n   * @api\r\n   */\r\n  drawPanel() {\r\n    if (!this.getMap())\r\n      return\r\n    var self = this\r\n    // Multiple event simultaneously / draw once => put drawing in the event queue\r\n    this.dcount++\r\n    setTimeout(function () { self.drawPanel_() }, this.get('drawDelay') || 0)\r\n  }\r\n  /** Delayed draw panel control\r\n   * @private\r\n   */\r\n  drawPanel_() {\r\n    if (--this.dcount || this.dragging_) {\r\n      return\r\n    }\r\n    var scrollTop = this.panelContainer_.scrollTop\r\n\r\n    // Remove existing layers\r\n    this._clearLayerForLI()\r\n    this.panel_.querySelectorAll('li').forEach(function (li) {\r\n      if (!li.classList.contains('ol-header'))\r\n        li.remove()\r\n    }.bind(this))\r\n    // Draw list\r\n    if (this._layerGroup) {\r\n      this.drawList(this.panel_, this._layerGroup.getLayers())\r\n    } else if (this.getMap()) {\r\n      this.drawList(this.panel_, this.getMap().getLayers())\r\n    }\r\n    // Reset scrolltop\r\n    this.panelContainer_.scrollTop = scrollTop\r\n  }\r\n  /** Change layer visibility according to the baselayer option\r\n   * @param {ol.layer}\r\n   * @param {Array<ol.layer>} related layers\r\n   * @private\r\n   */\r\n  switchLayerVisibility(l, layers) {\r\n    if (!l.get('baseLayer')) {\r\n      l.setVisible(!l.getVisible())\r\n    } else {\r\n      if (!l.getVisible()) {\r\n        l.setVisible(true)\r\n      }\r\n      layers.forEach(function (li) {\r\n        if (l !== li && li.get('baseLayer') && li.getVisible()) {\r\n          li.setVisible(false)\r\n        }\r\n      })\r\n    }\r\n  }\r\n  /** Check if layer is on the map (depending on resolution / zoom and extent)\r\n   * @param {ol.layer}\r\n   * @return {boolean}\r\n   * @private\r\n   */\r\n  testLayerVisibility(layer) {\r\n    if (!this.getMap())\r\n      return true\r\n    var res = this.getMap().getView().getResolution()\r\n    var zoom = this.getMap().getView().getZoom()\r\n    // Calculate visibility on resolution or zoom\r\n    if (layer.getMaxResolution() <= res || layer.getMinResolution() >= res) {\r\n      return false\r\n    } else if (layer.getMinZoom && (layer.getMinZoom() >= zoom || layer.getMaxZoom() < zoom)) {\r\n      return false\r\n    } else {\r\n      // Check extent\r\n      var ex0 = layer.getExtent()\r\n      if (ex0) {\r\n        var ex = this.getMap().getView().calculateExtent(this.getMap().getSize())\r\n        return ol_extent_intersects(ex, ex0)\r\n      }\r\n      return true\r\n    }\r\n  }\r\n  /** Start ordering the list\r\n  *\t@param {event} e drag event\r\n  *\t@private\r\n  */\r\n  dragOrdering_(e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    // Get params\r\n    var self = this\r\n    var elt = e.currentTarget.parentNode.parentNode\r\n    var start = true\r\n    var panel = this.panel_\r\n    var pageY\r\n    var pageY0 = e.pageY\r\n      || (e.touches && e.touches.length && e.touches[0].pageY)\r\n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY)\r\n    var target, dragElt\r\n    var layer, group\r\n    elt.parentNode.classList.add('drag')\r\n\r\n    // Stop ordering\r\n    function stop() {\r\n      if (target) {\r\n        // Get drag on parent\r\n        var drop = layer\r\n        var isSelected = self.getSelection() === drop\r\n        if (drop && target) {\r\n          var collection\r\n          if (group)\r\n            collection = group.getLayers()\r\n          else\r\n            collection = self._layerGroup ? self._layerGroup.getLayers() : self.getMap().getLayers()\r\n          var layers = collection.getArray()\r\n          // Switch layers\r\n          for (var i = 0; i < layers.length; i++) {\r\n            if (layers[i] == drop) {\r\n              collection.removeAt(i)\r\n              break\r\n            }\r\n          }\r\n          for (var j = 0; j < layers.length; j++) {\r\n            if (layers[j] === target) {\r\n              if (i > j)\r\n                collection.insertAt(j, drop)\r\n              else\r\n                collection.insertAt(j + 1, drop)\r\n              break\r\n            }\r\n          }\r\n        }\r\n        if (isSelected)\r\n          self.selectLayer(drop)\r\n\r\n        self.dispatchEvent({ type: \"reorder-end\", layer: drop, group: group })\r\n      }\r\n\r\n      elt.parentNode.querySelectorAll('li').forEach(function (li) {\r\n        li.classList.remove('dropover')\r\n        li.classList.remove('dropover-after')\r\n        li.classList.remove('dropover-before')\r\n      })\r\n      elt.classList.remove(\"drag\")\r\n      elt.parentNode.classList.remove(\"drag\")\r\n      self.element.classList.remove('drag')\r\n      if (dragElt)\r\n        dragElt.remove()\r\n\r\n      ol_ext_element.removeListener(document, 'mousemove touchmove', move)\r\n      ol_ext_element.removeListener(document, 'mouseup touchend touchcancel', stop)\r\n    }\r\n\r\n    // Ordering\r\n    function move(e) {\r\n      // First drag (more than 2 px) => show drag element (ghost)\r\n      pageY = e.pageY\r\n        || (e.touches && e.touches.length && e.touches[0].pageY)\r\n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY)\r\n      if (start && Math.abs(pageY0 - pageY) > 2) {\r\n        start = false\r\n        elt.classList.add(\"drag\")\r\n        layer = self._getLayerForLI(elt)\r\n        target = false\r\n        group = self._getLayerForLI(elt.parentNode.parentNode)\r\n        // Ghost div\r\n        dragElt = ol_ext_element.create('LI', {\r\n          className: 'ol-dragover',\r\n          html: elt.innerHTML,\r\n          style: {\r\n            position: \"absolute\",\r\n            \"z-index\": 10000,\r\n            left: elt.offsetLeft,\r\n            opacity: 0.5,\r\n            width: ol_ext_element.outerWidth(elt),\r\n            height: ol_ext_element.getStyle(elt, 'height'),\r\n          },\r\n          parent: panel\r\n        })\r\n        self.element.classList.add('drag')\r\n        self.dispatchEvent({ type: \"reorder-start\", layer: layer, group: group })\r\n      }\r\n      // Start a new drag sequence\r\n      if (!start) {\r\n        e.preventDefault()\r\n        e.stopPropagation()\r\n\r\n        // Ghost div\r\n        ol_ext_element.setStyle(dragElt, { top: pageY - ol_ext_element.offsetRect(panel).top + panel.scrollTop + 5 })\r\n\r\n        var li\r\n        if (!e.touches) {\r\n          li = e.target\r\n        } else {\r\n          li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY)\r\n        }\r\n        if (li.classList.contains(\"ol-switcherbottomdiv\")) {\r\n          self.overflow(-1)\r\n        } else if (li.classList.contains(\"ol-switchertopdiv\")) {\r\n          self.overflow(1)\r\n        }\r\n        // Get associated li\r\n        while (li && li.tagName !== 'LI') {\r\n          li = li.parentNode\r\n        }\r\n        if (!li || !li.classList.contains('dropover')) {\r\n          elt.parentNode.querySelectorAll('li').forEach(function (li) {\r\n            li.classList.remove('dropover')\r\n            li.classList.remove('dropover-after')\r\n            li.classList.remove('dropover-before')\r\n          })\r\n        }\r\n        if (li && li.parentNode.classList.contains('drag') && li !== elt) {\r\n          target = self._getLayerForLI(li)\r\n          // Don't mix layer level\r\n          if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\r\n            li.classList.add(\"dropover\")\r\n            li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before')\r\n          } else {\r\n            target = false\r\n          }\r\n          ol_ext_element.show(dragElt)\r\n        } else {\r\n          target = false\r\n          if (li === elt)\r\n            ol_ext_element.hide(dragElt)\r\n          else\r\n            ol_ext_element.show(dragElt)\r\n        }\r\n\r\n        if (!target)\r\n          dragElt.classList.add(\"forbidden\")\r\n        else\r\n          dragElt.classList.remove(\"forbidden\")\r\n      }\r\n    }\r\n\r\n    // Start ordering\r\n    ol_ext_element.addListener(document, 'mousemove touchmove', move)\r\n    ol_ext_element.addListener(document, 'mouseup touchend touchcancel', stop)\r\n  }\r\n  /** Change opacity on drag\r\n  *\t@param {event} e drag event\r\n  *\t@private\r\n  */\r\n  dragOpacity_(e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    var self = this\r\n    // Register start params\r\n    var elt = e.target\r\n    var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode)\r\n    if (!layer)\r\n      return\r\n    var x = e.pageX\r\n      || (e.touches && e.touches.length && e.touches[0].pageX)\r\n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX)\r\n    var start = ol_ext_element.getStyle(elt, 'left') - x\r\n    self.dragging_ = true\r\n\r\n    // stop dragging\r\n    function stop() {\r\n      ol_ext_element.removeListener(document, \"mouseup touchend touchcancel\", stop)\r\n      ol_ext_element.removeListener(document, \"mousemove touchmove\", move)\r\n      self.dragging_ = false\r\n    }\r\n    // On draggin\r\n    function move(e) {\r\n      var x = e.pageX\r\n        || (e.touches && e.touches.length && e.touches[0].pageX)\r\n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX)\r\n      var delta = (start + x) / ol_ext_element.getStyle(elt.parentNode, 'width')\r\n      var opacity = Math.max(0, Math.min(1, delta))\r\n      ol_ext_element.setStyle(elt, { left: (opacity * 100) + \"%\" })\r\n      elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity * 100)\r\n      layer.setOpacity(opacity)\r\n    }\r\n    // Register move\r\n    ol_ext_element.addListener(document, \"mouseup touchend touchcancel\", stop)\r\n    ol_ext_element.addListener(document, \"mousemove touchmove\", move)\r\n  }\r\n  /** Render a list of layer\r\n   * @param {Elemen} element to render\r\n   * @layers {Array{ol.layer}} list of layer to show\r\n   * @api stable\r\n   * @private\r\n   */\r\n  drawList(ul, collection) {\r\n    var self = this\r\n    var layers = collection.getArray()\r\n\r\n    // Change layer visibility\r\n    var setVisibility = function (e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      self.switchLayerVisibility(l, collection)\r\n      if (self.get('selection') && l.getVisible()) {\r\n        self.selectLayer(l)\r\n      }\r\n      if (self.onchangeCheck) {\r\n        self.onchangeCheck(l)\r\n      }\r\n    }\r\n    // Info button click\r\n    function onInfo(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      self.oninfo(l)\r\n      self.dispatchEvent({ type: \"info\", layer: l })\r\n    }\r\n    // Zoom to extent button\r\n    function zoomExtent(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var l = self._getLayerForLI(this.parentNode.parentNode)\r\n      if (self.onextent) {\r\n        self.onextent(l)\r\n      } else {\r\n        self.getMap().getView().fit(l.getExtent(), self.getMap().getSize())\r\n      }\r\n      self.dispatchEvent({ type: \"extent\", layer: l })\r\n    }\r\n    // Remove a layer on trash click\r\n    function removeLayer(e) {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      var li = this.parentNode.parentNode.parentNode.parentNode\r\n      var layer, group = self._getLayerForLI(li)\r\n      // Remove the layer from a group or from a map\r\n      if (group) {\r\n        layer = self._getLayerForLI(this.parentNode.parentNode)\r\n        group.getLayers().remove(layer)\r\n        if (group.getLayers().getLength() == 0 && !group.get('noSwitcherDelete')) {\r\n          removeLayer.call(li.querySelectorAll('.layerTrash')[0], e)\r\n        }\r\n      } else {\r\n        li = this.parentNode.parentNode\r\n        self.getMap().removeLayer(self._getLayerForLI(li))\r\n      }\r\n    }\r\n\r\n    // Create a list for a layer\r\n    function createLi(layer) {\r\n      if (!this.displayInLayerSwitcher(layer)) {\r\n        this._setLayerForLI(null, layer)\r\n        return\r\n      }\r\n\r\n      var li = ol_ext_element.create('LI', {\r\n        className: (layer.getVisible() ? \"ol-visible \" : \" \") + (layer.get('baseLayer') ? \"baselayer\" : \"\"),\r\n        parent: ul\r\n      })\r\n      this._setLayerForLI(li, layer)\r\n      if (this._selectedLayer === layer) {\r\n        li.classList.add('ol-layer-select')\r\n      }\r\n\r\n      var layer_buttons = ol_ext_element.create('DIV', {\r\n        className: 'ol-layerswitcher-buttons',\r\n        parent: li\r\n      })\r\n\r\n      // Content div\r\n      var d = ol_ext_element.create('DIV', {\r\n        className: 'li-content',\r\n        parent: li\r\n      })\r\n\r\n      // Visibility\r\n      ol_ext_element.create('INPUT', {\r\n        type: layer.get('baseLayer') ? 'radio' : 'checkbox',\r\n        className: 'ol-visibility',\r\n        checked: layer.getVisible(),\r\n        click: setVisibility,\r\n        parent: d\r\n      })\r\n      // Label\r\n      var label = ol_ext_element.create('LABEL', {\r\n        title: layer.get('title') || layer.get('name'),\r\n        click: setVisibility,\r\n        style: {\r\n          userSelect: 'none'\r\n        },\r\n        parent: d\r\n      })\r\n      label.addEventListener('selectstart', function () { return false })\r\n      ol_ext_element.create('SPAN', {\r\n        html: layer.get('title') || layer.get('name'),\r\n        click: function (e) {\r\n          if (this.get('selection')) {\r\n            e.stopPropagation()\r\n            this.selectLayer(layer)\r\n          }\r\n        }.bind(this),\r\n        parent: label\r\n      })\r\n\r\n      //  up/down\r\n      if (this.reordering) {\r\n        if ((i < layers.length - 1 && (layer.get(\"allwaysOnTop\") || !layers[i + 1].get(\"allwaysOnTop\")))\r\n          || (i > 0 && (!layer.get(\"allwaysOnTop\") || layers[i - 1].get(\"allwaysOnTop\")))) {\r\n          ol_ext_element.create('DIV', {\r\n            className: 'layerup ol-noscroll',\r\n            title: this.tip.up,\r\n            on: { 'mousedown touchstart': function (e) { self.dragOrdering_(e) } },\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Show/hide sub layers\r\n      if (layer.getLayers) {\r\n        var nb = 0\r\n        layer.getLayers().forEach(function (l) {\r\n          if (self.displayInLayerSwitcher(l))\r\n            nb++\r\n        })\r\n        if (nb) {\r\n          ol_ext_element.create('DIV', {\r\n            className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\r\n            title: this.tip.plus,\r\n            click: function () {\r\n              var l = self._getLayerForLI(this.parentNode.parentNode)\r\n              l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\"))\r\n            },\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Info button\r\n      if (this.oninfo) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerInfo',\r\n          title: this.tip.info,\r\n          click: onInfo,\r\n          parent: layer_buttons\r\n        })\r\n      }\r\n      // Layer remove\r\n      if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerTrash',\r\n          title: this.tip.trash,\r\n          click: removeLayer,\r\n          parent: layer_buttons\r\n        })\r\n      }\r\n      // Layer extent\r\n      if (this.hasextent && layers[i].getExtent()) {\r\n        var ex = layers[i].getExtent()\r\n        if (ex.length == 4 && ex[0] < ex[2] && ex[1] < ex[3]) {\r\n          ol_ext_element.create('DIV', {\r\n            className: 'layerExtent',\r\n            title: this.tip.extent,\r\n            click: zoomExtent,\r\n            parent: layer_buttons\r\n          })\r\n        }\r\n      }\r\n\r\n      // Progress\r\n      if (this.show_progress && layer instanceof ol_layer_Tile) {\r\n        var p = ol_ext_element.create('DIV', {\r\n          className: 'layerswitcher-progress',\r\n          parent: d\r\n        })\r\n        this.setprogress_(layer)\r\n        layer.layerswitcher_progress = ol_ext_element.create('DIV', { parent: p })\r\n      }\r\n\r\n      // Opacity\r\n      var opacity = ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity',\r\n        // Click on the opacity line\r\n        click: function (e) {\r\n          if (e.target !== this)\r\n            return\r\n          e.stopPropagation()\r\n          e.preventDefault()\r\n          var op = Math.max(0, Math.min(1, e.offsetX / ol_ext_element.getStyle(this, 'width')))\r\n          self._getLayerForLI(this.parentNode.parentNode).setOpacity(op)\r\n          this.parentNode.querySelectorAll('.layerswitcher-opacity-label')[0].innerHTML = Math.round(op * 100)\r\n        },\r\n        parent: d\r\n      })\r\n      // Start dragging\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity-cursor ol-noscroll',\r\n        style: { left: (layer.getOpacity() * 100) + \"%\" },\r\n        on: {\r\n          'mousedown touchstart': function (e) { self.dragOpacity_(e) }\r\n        },\r\n        parent: opacity\r\n      })\r\n      // Percent\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-opacity-label',\r\n        html: Math.round(layer.getOpacity() * 100),\r\n        parent: d\r\n      })\r\n\r\n      // Layer group\r\n      if (layer.getLayers) {\r\n        li.classList.add('ol-layer-group')\r\n        if (layer.get(\"openInLayerSwitcher\") === true) {\r\n          var ul2 = ol_ext_element.create('UL', {\r\n            parent: li\r\n          })\r\n          this.drawList(ul2, layer.getLayers())\r\n        }\r\n      }\r\n      li.classList.add(this.getLayerClass(layer))\r\n\r\n      // Dispatch a dralist event to allow customisation\r\n      this.dispatchEvent({ type: 'drawlist', layer: layer, li: li })\r\n    }\r\n\r\n    // Add the layer list\r\n    for (var i = layers.length - 1; i >= 0; i--) {\r\n      createLi.call(this, layers[i])\r\n    }\r\n\r\n    this.viewChange()\r\n\r\n    if (ul === this.panel_)\r\n      this.overflow()\r\n  }\r\n  /** Select a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @returns {string} the layer classname\r\n   * @api\r\n   */\r\n  getLayerClass(layer) {\r\n    if (!layer)\r\n      return 'none'\r\n    if (layer.getLayers)\r\n      return 'ol-layer-group'\r\n    if (layer instanceof ol_layer_Vector)\r\n      return 'ol-layer-vector'\r\n    if (layer instanceof ol_layer_VectorTile)\r\n      return 'ol-layer-vectortile'\r\n    if (layer instanceof ol_layer_Tile)\r\n      return 'ol-layer-tile'\r\n    if (layer instanceof ol_layer_Image)\r\n      return 'ol-layer-image'\r\n    if (layer instanceof ol_layer_Heatmap)\r\n      return 'ol-layer-heatmap'\r\n    /* ol < 6 compatibility VectorImage is not defined */\r\n    // if (layer instanceof ol_layer_VectorImage) return 'ol-layer-vectorimage';\r\n    if (layer.getFeatures)\r\n      return 'ol-layer-vectorimage'\r\n    /* */\r\n    return 'unknown'\r\n  }\r\n  /** Select a layer\r\n   * @param {ol.layer.Layer} layer\r\n   * @api\r\n   */\r\n  selectLayer(layer, silent) {\r\n    if (!layer) {\r\n      if (!this.getMap())\r\n        return\r\n      layer = this.getMap().getLayers().item(this.getMap().getLayers().getLength() - 1)\r\n    }\r\n    this._selectedLayer = layer\r\n    this.drawPanel()\r\n    if (!silent)\r\n      this.dispatchEvent({ type: 'select', layer: layer })\r\n  }\r\n  /** Get selected layer\r\n   * @returns {ol.layer.Layer}\r\n   */\r\n  getSelection() {\r\n    return this._selectedLayer\r\n  }\r\n  /** Handle progress bar for a layer\r\n  *\t@private\r\n  */\r\n  setprogress_(layer) {\r\n    if (!layer.layerswitcher_progress) {\r\n      var loaded = 0\r\n      var loading = 0\r\n      var draw = function () {\r\n        if (loading === loaded) {\r\n          loading = loaded = 0\r\n          ol_ext_element.setStyle(layer.layerswitcher_progress, { width: 0 }) // layer.layerswitcher_progress.width(0);\r\n        } else {\r\n          ol_ext_element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' }) // layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\r\n        }\r\n      }\r\n      layer.getSource().on('tileloadstart', function () {\r\n        loading++\r\n        draw()\r\n      })\r\n      layer.getSource().on('tileloadend', function () {\r\n        loaded++\r\n        draw()\r\n      })\r\n      layer.getSource().on('tileloaderror', function () {\r\n        loaded++\r\n        draw()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n/** List of tips for internationalization purposes\r\n*/\r\nol_control_LayerSwitcher.prototype.tip = {\r\n  up: \"up/down\",\r\n  down: \"down\",\r\n  info: \"informations...\",\r\n  extent: \"zoom to extent\",\r\n  trash: \"remove layer\",\r\n  plus: \"expand/shrink\"\r\n};\r\n\r\nexport default ol_control_LayerSwitcher\r\n","/** Vanilla JS geographic inputs\r\n * color, size, width, font, symboles, dash, arrow, pattern\r\n */\r\nimport ol_Object from 'ol/Object.js'\r\n\r\n/** @namespace  ol.ext.input\r\n */\r\n/*global ol*/\r\nif (window.ol && ol.ext && !ol.ext.input) {\r\n  ol.ext.input = {};\r\n}\r\n\r\n/** Abstract base class; normally only used for creating subclasses and not instantiated in apps.    \r\n * @constructor\r\n * @extends {ol_Object}\r\n * @param {*} options\r\n *  @param {Element} [options.input] input element, if none create one\r\n *  @param {string} [options.type] input type, if no input\r\n *  @param {number} [options.min] input min, if no input\r\n *  @param {number} [options.max] input max, if no input\r\n *  @param {number} [options.step] input step, if no input\r\n *  @param {string|number} [options.val] input value\r\n *  @param {boolean} [options.checked] check input\r\n *  @param {boolean} [options.hidden] the input is display:none\r\n *  @param {boolean} [options.disabled] disable input\r\n *  @param {Element} [options.parent] parent element, if no input\r\n */\r\nvar ol_ext_input_Base = class olextinputBase extends ol_Object {\r\n  constructor(options) {\r\n    options = options || {};\r\n    super();\r\n\r\n    var input = this.input = options.input;\r\n    if (!input) {\r\n      input = this.input = document.createElement('INPUT');\r\n      if (options.type)\r\n        input.setAttribute('type', options.type);\r\n      if (options.min !== undefined)\r\n        input.setAttribute('min', options.min);\r\n      if (options.max !== undefined)\r\n        input.setAttribute('max', options.max);\r\n      if (options.step !== undefined)\r\n        input.setAttribute('step', options.step);\r\n      if (options.parent)\r\n        options.parent.appendChild(input);\r\n    }\r\n    if (options.disabled)\r\n      input.disabled = true;\r\n    if (options.checked !== undefined)\r\n      input.checked = !!options.checked;\r\n    if (options.val !== undefined)\r\n      input.value = options.val;\r\n    if (options.hidden)\r\n      input.style.display = 'none';\r\n    input.addEventListener('focus', function () {\r\n      if (this.element)\r\n        this.element.classList.add('ol-focus');\r\n    }.bind(this));\r\n    var tout;\r\n    input.addEventListener('focusout', function () {\r\n      if (this.element) {\r\n        if (tout)\r\n          clearTimeout(tout);\r\n        tout = setTimeout(function () {\r\n          this.element.classList.remove('ol-focus');\r\n        }.bind(this), 0);\r\n      }\r\n    }.bind(this));\r\n  }\r\n  /** Listen to drag event\r\n   * @param {Element} elt\r\n   * @param {function} cback when draggin on the element\r\n   * @private\r\n   */\r\n  _listenDrag(elt, cback) {\r\n    var handle = function (e) {\r\n      this.moving = true;\r\n      this.element.classList.add('ol-moving');\r\n      var listen = function (e) {\r\n        if (e.type === 'pointerup') {\r\n          document.removeEventListener('pointermove', listen);\r\n          document.removeEventListener('pointerup', listen);\r\n          document.removeEventListener('pointercancel', listen);\r\n          setTimeout(function () {\r\n            this.moving = false;\r\n            this.element.classList.remove('ol-moving');\r\n          }.bind(this));\r\n        }\r\n        if (e.target === elt)\r\n          cback(e);\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n      }.bind(this);\r\n      document.addEventListener('pointermove', listen, false);\r\n      document.addEventListener('pointerup', listen, false);\r\n      document.addEventListener('pointercancel', listen, false);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }.bind(this);\r\n    elt.addEventListener('mousedown', handle, false);\r\n    elt.addEventListener('touchstart', handle, false);\r\n  }\r\n  /** Set the current value\r\n   */\r\n  setValue(v) {\r\n    if (v !== undefined)\r\n      this.input.value = v;\r\n    this.input.dispatchEvent(new Event('change'));\r\n  }\r\n  /** Get the current getValue\r\n   * @returns {string}\r\n   */\r\n  getValue() {\r\n    return this.input.value;\r\n  }\r\n  /** Get the input element\r\n   * @returns {Element}\r\n   */\r\n  getInputElement() {\r\n    return this.input;\r\n  }\r\n}\r\n\r\nexport default ol_ext_input_Base\r\n","import ol_ext_input_Base from './Base.js'\r\n\r\n/** Checkbox input\r\n * @constructor\r\n * @extends {ol_ext_input_Base}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element|string} [options.html] label content\r\n *  @param {string} [options.after] label garnish (placed after)\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n *  @param {boolean} [options.autoClose=true]\r\n *  @param {boolean} [options.visible=false] display the input\r\n */\r\nvar ol_ext_input_Checkbox = class olextinputCheckbox extends ol_ext_input_Base {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    var label = this.element = document.createElement('LABEL');\r\n    if (options.html instanceof Element)\r\n      label.appendChild(options.html);\r\n    else if (options.html !== undefined)\r\n      label.innerHTML = options.html;\r\n    label.className = ('ol-ext-check ol-ext-checkbox ' + (options.className || '')).trim();\r\n\r\n    if (this.input.parentNode)\r\n      this.input.parentNode.insertBefore(label, this.input);\r\n    label.appendChild(this.input);\r\n    label.appendChild(document.createElement('SPAN'));\r\n    if (options.after) {\r\n      label.appendChild(document.createTextNode(options.after));\r\n    }\r\n\r\n    // Handle change\r\n    this.input.addEventListener('change', function () {\r\n      this.dispatchEvent({ type: 'check', checked: this.input.checked, value: this.input.value });\r\n    }.bind(this));\r\n\r\n  }\r\n  isChecked() {\r\n    return this.input.checked;\r\n  }\r\n}\r\n\r\nexport default ol_ext_input_Checkbox\r\n","import ol_ext_input_Checkbox from './Checkbox.js'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Switch = class olextinputSwitch extends ol_ext_input_Checkbox {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    this.element.className = ('ol-ext-toggle-switch ' + (options.className || '')).trim();\r\n  }\r\n};\r\n  \r\nexport default ol_ext_input_Switch\r\n","import ol_ext_input_Checkbox from './Checkbox.js'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Radio = class olextinputRadio extends ol_ext_input_Checkbox {\r\n  constructor(options) {\r\n    options = options || {};\r\n\r\n    super(options);\r\n\r\n    this.element.className = ('ol-ext-check ol-ext-radio ' + (options.className || '')).trim();\r\n  }\r\n}\r\n  \r\nexport default ol_ext_input_Radio\r\n","/** Vanilla JS helper to manipulate DOM without jQuery\r\n * @see https://github.com/nefe/You-Dont-Need-jQuery\r\n * @see https://plainjs.com/javascript/\r\n * @see http://youmightnotneedjquery.com/\r\n */\r\nimport ol_ext_input_Checkbox from './input/Checkbox.js'\r\nimport ol_ext_input_Switch from './input/Switch.js'\r\nimport ol_ext_input_Radio from './input/Radio.js'\r\n\r\n/** @namespace ol.ext.element */\r\nvar ol_ext_element = {};\r\n\r\n/**\r\n * Create an element\r\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\r\n * @param {*} options\r\n *  @param {string} options.className className The element class name \r\n *  @param {Element} options.parent Parent to append the element as child\r\n *  @param {Element|string} [options.html] Content of the element (if text is not set)\r\n *  @param {string} [options.text] Text content (if html is not set)\r\n *  @param {Element|string} [options.options] when tagName = SELECT a list of options as key:value to add to the select\r\n *  @param {string} options.* Any other attribut to add to the element\r\n */\r\nol_ext_element.create = function (tagName, options) {\r\n  options = options || {};\r\n  var elt;\r\n  // Create text node\r\n  if (tagName === 'TEXT') {\r\n    elt = document.createTextNode(options.html||'');\r\n    if (options.parent) options.parent.appendChild(elt);\r\n  } else {\r\n    // Other element\r\n    elt = document.createElement(tagName);\r\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\r\n    for (var attr in options) {\r\n      switch (attr) {\r\n        case 'className': {\r\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\r\n          break;\r\n        }\r\n        case 'text': {\r\n          elt.innerText = options.text;\r\n          break;\r\n        }\r\n        case 'html': {\r\n          if (options.html instanceof Element) elt.appendChild(options.html)\r\n          else if (options.html!==undefined) elt.innerHTML = options.html;\r\n          break;\r\n        }\r\n        case 'parent': {\r\n          if (options.parent) options.parent.appendChild(elt);\r\n          break;\r\n        }\r\n        case 'options': {\r\n          if (/select/i.test(tagName)) {\r\n            for (var i in options.options) {\r\n              ol_ext_element.create('OPTION', {\r\n                html: i,\r\n                value: options.options[i],\r\n                parent: elt          \r\n              })\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'style': {\r\n          ol_ext_element.setStyle(elt, options.style);\r\n          break;\r\n        }\r\n        case 'change':\r\n        case 'click': {\r\n          ol_ext_element.addListener(elt, attr, options[attr]);\r\n          break;\r\n        }\r\n        case 'on': {\r\n          for (var e in options.on) {\r\n            ol_ext_element.addListener(elt, e, options.on[e]);\r\n          }\r\n          break;\r\n        }\r\n        case 'checked': {\r\n          elt.checked = !!options.checked;\r\n          break;\r\n        }\r\n        default: {\r\n          elt.setAttribute(attr, options[attr]);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return elt;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {boolean} options.checked\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createSwitch = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    type: 'checkbox',\r\n    on: options.on,\r\n    click: options.click,\r\n    change: options.change,\r\n    parent: options.parent\r\n  });\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  new ol_ext_input_Switch(opt);\r\n  return input;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {string} [options.name] input name\r\n *  @param {string} [options.type=checkbox] input type: radio or checkbox\r\n *  @param {string} options.value input value\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createCheck = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    name: options.name,\r\n    type: (options.type==='radio' ? 'radio' : 'checkbox'),\r\n    on: options.on,\r\n    parent: options.parent\r\n  });\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  if (options.type === 'radio') {\r\n    new ol_ext_input_Radio(opt);\r\n  } else {\r\n    new ol_ext_input_Checkbox(opt);\r\n  }\r\n  return input;\r\n};\r\n\r\n/** Set inner html or append a child element to an element\r\n * @param {Element} element\r\n * @param {Element|string} html Content of the element\r\n */\r\nol_ext_element.setHTML = function(element, html) {\r\n  if (html instanceof Element) element.appendChild(html)\r\n  else if (html!==undefined) element.innerHTML = html;\r\n};\r\n\r\n/** Append text into an elemnt\r\n * @param {Element} element\r\n * @param {string} text text content\r\n */\r\nol_ext_element.appendText = function(element, text) {\r\n  element.appendChild(document.createTextNode(text||''));\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.addListener = function (element, eventType, fn, useCapture ) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.addEventListener(e, fn, useCapture);\r\n  });\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.removeListener = function (element, eventType, fn) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.removeEventListener(e, fn);\r\n  });\r\n};\r\n\r\n/**\r\n * Show an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.show = function (element) {\r\n  element.style.display = '';\r\n};\r\n\r\n/**\r\n * Hide an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.hide = function (element) {\r\n  element.style.display = 'none';\r\n};\r\n\r\n/**\r\n * Test if an element is hihdden\r\n * @param {Element} element\r\n * @return {boolean}\r\n */\r\nol_ext_element.hidden = function (element) {\r\n  return ol_ext_element.getStyle(element, 'display') === 'none';\r\n};\r\n\r\n/**\r\n * Toggle an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.toggle = function (element) {\r\n  element.style.display = (element.style.display==='none' ? '' : 'none');\r\n};\r\n\r\n/** Set style of an element\r\n * @param {DOMElement} el the element\r\n * @param {*} st list of style\r\n */\r\nol_ext_element.setStyle = function(el, st) {\r\n  for (var s in st) {\r\n    switch (s) {\r\n      case 'top':\r\n      case 'left':\r\n      case 'bottom':\r\n      case 'right':\r\n      case 'minWidth':\r\n      case 'maxWidth':\r\n      case 'width':\r\n      case 'height': {\r\n        if (typeof(st[s]) === 'number') {\r\n          el.style[s] = st[s]+'px';\r\n        } else {\r\n          el.style[s] = st[s];\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        el.style[s] = st[s];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get style propertie of an element\r\n * @param {DOMElement} el the element\r\n * @param {string} styleProp Propertie name\r\n * @return {*} style value\r\n */\r\nol_ext_element.getStyle = function(el, styleProp) {\r\n  var value, defaultView = (el.ownerDocument || document).defaultView;\r\n  // W3C standard way:\r\n  if (defaultView && defaultView.getComputedStyle) {\r\n    // sanitize property name to css notation\r\n    // (hypen separated words eg. font-Size)\r\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\r\n  } else if (el.currentStyle) { // IE\r\n    // sanitize property name to camelCase\r\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\r\n      return letter.toUpperCase();\r\n    });\r\n    value = el.currentStyle[styleProp];\r\n    // convert other units to pixels on IE\r\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \r\n      return (function(value) {\r\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\r\n        el.runtimeStyle.left = el.currentStyle.left;\r\n        el.style.left = value || 0;\r\n        value = el.style.pixelLeft + \"px\";\r\n        el.style.left = oldLeft;\r\n        el.runtimeStyle.left = oldRsLeft;\r\n        return value;\r\n      })(value);\r\n    }\r\n  }\r\n  if (/px$/.test(value)) return parseInt(value);\r\n  return value;\r\n};\r\n\r\n/** Get outerHeight of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerHeight = function(elt) {\r\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\r\n};\r\n\r\n/** Get outerWidth of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerWidth = function(elt) {\r\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @return {*} \r\n */\r\nol_ext_element.offsetRect = function(elt) {\r\n  var rect = elt.getBoundingClientRect();\r\n  return {\r\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\r\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\r\n    height: rect.height || (rect.bottom - rect.top),\r\n    width: rect.width || (rect.right - rect.left)\r\n  }\r\n};\r\n\r\n/** Get element offset \r\n * @param {ELement} elt\r\n * @returns {Object} top/left offset\r\n */\r\nol_ext_element.getFixedOffset = function(elt) {\r\n  var offset = {\r\n    left:0,\r\n    top:0\r\n  };\r\n  var getOffset = function(parent) {\r\n    if (!parent) return offset;\r\n    // Check position when transform\r\n    if (ol_ext_element.getStyle(parent, 'position') === 'absolute'\r\n      && ol_ext_element.getStyle(parent, 'transform') !== \"none\") {\r\n      var r = parent.getBoundingClientRect();\r\n      offset.left += r.left; \r\n      offset.top += r.top; \r\n      return offset;\r\n    }\r\n    return getOffset(parent.offsetParent)\r\n  }\r\n  return getOffset(elt.offsetParent)\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @param {boolean} fixed get fixed position\r\n * @return {Object} \r\n */\r\nol_ext_element.positionRect = function(elt, fixed) {\r\n  var gleft = 0;\r\n  var gtop = 0;\r\n\r\n  var getRect = function( parent ) {\r\n    if (parent) {\r\n      gleft += parent.offsetLeft;\r\n      gtop += parent.offsetTop;\r\n      return getRect(parent.offsetParent);\r\n    } else {\r\n      var r = {\r\n        top: elt.offsetTop + gtop,\r\n        left: elt.offsetLeft + gleft\r\n      };\r\n      if (fixed) {\r\n        r.top -= (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0);\r\n        r.left -= (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0);\r\n      }\r\n      r.bottom = r.top + elt.offsetHeight;\r\n      r.right = r.top + elt.offsetWidth;\r\n      return r;\r\n    }\r\n  }; \r\n  return getRect(elt.offsetParent);\r\n}\r\n\r\n/** Make a div scrollable without scrollbar.\r\n * On touch devices the default behavior is preserved\r\n * @param {DOMElement} elt\r\n * @param {*} options\r\n *  @param {function} [options.onmove] a function that takes a boolean indicating that the div is scrolling\r\n *  @param {boolean} [options.vertical=false] \r\n *  @param {boolean} [options.animate=true] add kinetic to scroll\r\n *  @param {boolean} [options.mousewheel=false] enable mousewheel to scroll\r\n *  @param {boolean} [options.minibar=false] add a mini scrollbar to the parent element (only vertical scrolling)\r\n * @returns {Object} an object with a refresh function\r\n */\r\nol_ext_element.scrollDiv = function(elt, options) {\r\n  options = options || {};\r\n  var pos = false;\r\n  var speed = 0;\r\n  var d, dt = 0;\r\n\r\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\r\n  //var page = options.vertical ? 'pageY' : 'pageX';\r\n  var page = options.vertical ? 'screenY' : 'screenX';\r\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\r\n  var moving = false;\r\n  // Factor scale content / container\r\n  var scale, isbar;\r\n\r\n  // Update the minibar\r\n  var updateCounter = 0;\r\n  var updateMinibar = function() {\r\n    if (scrollbar) {\r\n      updateCounter++;\r\n      setTimeout(updateMinibarDelay);\r\n    }\r\n  }\r\n  var updateMinibarDelay = function() {\r\n    if (scrollbar) {\r\n      updateCounter--;\r\n      // Prevent multi call\r\n      if (updateCounter) return;\r\n      // Container height\r\n      var pheight = elt.clientHeight;\r\n      // Content height\r\n      var height = elt.scrollHeight;\r\n      // Set scrollbar value\r\n      scale = pheight / height;\r\n      scrollbar.style.height = scale * 100 + '%';\r\n      scrollbar.style.top = (elt.scrollTop / height * 100) + '%';\r\n      scrollContainer.style.height = pheight + 'px';\r\n      // No scroll\r\n      if (pheight > height - .5) scrollContainer.classList.add('ol-100pc');\r\n      else scrollContainer.classList.remove('ol-100pc');\r\n    }\r\n  }\r\n  \r\n  // Handle pointer down\r\n  var onPointerDown = function(e) {\r\n    // Prevent scroll\r\n    if (e.target.classList.contains('ol-noscroll')) return;\r\n    // Start scrolling\r\n    moving = false;\r\n    pos = e[page];\r\n    dt = new Date();\r\n    elt.classList.add('ol-move');\r\n    // Prevent elt dragging\r\n    e.preventDefault();\r\n    // Listen scroll\r\n    window.addEventListener('pointermove', onPointerMove);\r\n    ol_ext_element.addListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  }\r\n\r\n  // Register scroll\r\n  var onPointerMove = function(e) {\r\n    if (pos !== false) {\r\n      var delta = (isbar ? -1/scale : 1) * (pos - e[page]);\r\n      moving = moving || Math.round(delta)\r\n      elt[scroll] += delta;\r\n      d = new Date();\r\n      if (d-dt) {\r\n        speed = (speed + delta / (d - dt))/2;\r\n      }\r\n      pos = e[page];\r\n      dt = d;\r\n      // Tell we are moving\r\n      if (delta) onmove(true);\r\n    } else {\r\n      moving = true;\r\n    }\r\n  };\r\n  \r\n  // Animate scroll\r\n  var animate = function(to) {\r\n    var step = (to>0) ? Math.min(100, to/2) : Math.max(-100, to/2);\r\n    to -= step;\r\n    elt[scroll] += step;\r\n    if (-1 < to && to < 1) {\r\n      if (moving) setTimeout(function() { elt.classList.remove('ol-move'); });\r\n      else elt.classList.remove('ol-move');\r\n      moving = false;\r\n      onmove(false);\r\n    } else {\r\n      setTimeout(function() {\r\n        animate(to);\r\n      }, 40);\r\n    }\r\n  }\r\n  \r\n  // Initialize scroll container for minibar\r\n  var scrollContainer, scrollbar;\r\n  if (options.vertical && options.minibar) {\r\n    var init = function(b) {\r\n      // only once\r\n      elt.removeEventListener('pointermove', init);\r\n      elt.parentNode.classList.add('ol-miniscroll');\r\n      scrollbar = ol_ext_element.create('DIV');\r\n      scrollContainer = ol_ext_element.create('DIV', {\r\n        className: 'ol-scroll',\r\n        html: scrollbar\r\n      });\r\n      elt.parentNode.insertBefore(scrollContainer, elt);\r\n      // Move scrollbar\r\n      scrollbar.addEventListener('pointerdown', function(e) {\r\n        isbar = true;\r\n        onPointerDown(e)\r\n      });\r\n      // Handle mousewheel\r\n      if (options.mousewheel) {\r\n        ol_ext_element.addListener(scrollContainer, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n        ol_ext_element.addListener(scrollbar, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n      }\r\n      // Update on enter\r\n      elt.parentNode.addEventListener('pointerenter', updateMinibar);\r\n      // Update on resize\r\n      window.addEventListener('resize', updateMinibar);\r\n      // Update\r\n      if (b!==false) updateMinibar();\r\n    };\r\n    // Allready inserted in the DOM\r\n    if (elt.parentNode) init(false);\r\n    // or wait when ready\r\n    else elt.addEventListener('pointermove', init);\r\n    // Update on scroll\r\n    elt.addEventListener('scroll', function() {\r\n      updateMinibar();\r\n    });\r\n  }\r\n\r\n  // Enable scroll\r\n  elt.style['touch-action'] = 'none';\r\n  elt.style['overflow'] = 'hidden';\r\n  elt.classList.add('ol-scrolldiv');\r\n  \r\n  // Start scrolling\r\n  ol_ext_element.addListener(elt, ['pointerdown'], function(e) {\r\n    isbar = false;\r\n    onPointerDown(e)\r\n  });\r\n\r\n  // Prevet click when moving...\r\n  elt.addEventListener('click', function(e) {\r\n    if (elt.classList.contains('ol-move')) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }, true);\r\n\r\n  // Stop scrolling\r\n  var onPointerUp = function(e) {\r\n    dt = new Date() - dt;\r\n    if (dt>100 || isbar) {\r\n      // User stop: no speed\r\n      speed = 0;\r\n    } else if (dt>0) {\r\n      // Calculate new speed\r\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\r\n    }\r\n    animate(options.animate===false ? 0 : speed*200);\r\n    pos = false;\r\n    speed = 0;\r\n    dt = 0;\r\n    // Add class to handle click (on iframe / double-click)\r\n    if (!elt.classList.contains('ol-move')) {\r\n      elt.classList.add('ol-hasClick')\r\n      setTimeout(function() { elt.classList.remove('ol-hasClick'); }, 500);\r\n    } else {\r\n      elt.classList.remove('ol-hasClick');\r\n    }\r\n    isbar = false;\r\n    window.removeEventListener('pointermove', onPointerMove)\r\n    ol_ext_element.removeListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  };\r\n\r\n  // Handle mousewheel\r\n  var onMouseWheel = function(e) {\r\n    var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\r\n    elt.classList.add('ol-move');\r\n    elt[scroll] -= delta*30;\r\n    elt.classList.remove('ol-move');\r\n    return false;\r\n  }\r\n  if (options.mousewheel) { // && !elt.classList.contains('ol-touch')) {\r\n    ol_ext_element.addListener(elt, \r\n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n      onMouseWheel\r\n    );\r\n  }\r\n\r\n  return { \r\n    refresh: updateMinibar\r\n  }\r\n};\r\n\r\n/** Dispatch an event to an Element \r\n * @param {string} eventName\r\n * @param {Element} element\r\n */\r\nol_ext_element.dispatchEvent = function (eventName, element) {\r\n  var event;\r\n  try {\r\n    event = new CustomEvent(eventName);\r\n  } catch(e) {\r\n    // Try customevent on IE\r\n    event = document.createEvent(\"CustomEvent\");\r\n    event.initCustomEvent(eventName, true, true, {});\r\n  }\r\n  element.dispatchEvent(event);\r\n};\r\n\r\nexport default ol_ext_element\r\n","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport BaseObject from './Object.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport Event from './events/Event.js';\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length',\n};\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n * @template T\n */\nexport class CollectionEvent extends Event {\n  /**\n   * @param {import(\"./CollectionEventType.js\").default} type Type.\n   * @param {T} element Element.\n   * @param {number} index The index of the added or removed element.\n   */\n  constructor(type, element, index) {\n    super(type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {T}\n     * @api\n     */\n    this.element = element;\n\n    /**\n     * The index of the added or removed element.\n     * @type {number}\n     * @api\n     */\n    this.index = index;\n  }\n}\n\n/***\n * @template T\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types|'change:length', import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").OnSignature<'add'|'remove', CollectionEvent<T>, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types|\n *     'change:length'|'add'|'remove',Return>} CollectionOnSignature\n */\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nclass Collection extends BaseObject {\n  /**\n   * @param {Array<T>} [array] Array.\n   * @param {Options} [options] Collection options.\n   */\n  constructor(array, options) {\n    super();\n\n    /***\n     * @type {CollectionOnSignature<T, import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {CollectionOnSignature<T, import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {CollectionOnSignature<T, void>}\n     */\n    this.un;\n\n    options = options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = array ? array : [];\n\n    if (this.unique_) {\n      for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n  }\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  clear() {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  }\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  extend(arr) {\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  }\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  forEach(f) {\n    const array = this.array_;\n    for (let i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  }\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  getArray() {\n    return this.array_;\n  }\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  item(index) {\n    return this.array_[index];\n  }\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  getLength() {\n    return this.get(Property.LENGTH);\n  }\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  insertAt(index, elem) {\n    if (index < 0 || index > this.getLength()) {\n      throw new Error('Index out of bounds: ' + index);\n    }\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem, index)\n    );\n  }\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  pop() {\n    return this.removeAt(this.getLength() - 1);\n  }\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  push(elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    const n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  }\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  remove(elem) {\n    const arr = this.array_;\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  removeAt(index) {\n    if (index < 0 || index >= this.getLength()) {\n      return undefined;\n    }\n    const prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.REMOVE, prev, index)\n      )\n    );\n    return prev;\n  }\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  setAt(index, elem) {\n    const n = this.getLength();\n    if (index >= n) {\n      this.insertAt(index, elem);\n      return;\n    }\n    if (index < 0) {\n      throw new Error('Index out of bounds: ' + index);\n    }\n    if (this.unique_) {\n      this.assertUnique_(elem, index);\n    }\n    const prev = this.array_[index];\n    this.array_[index] = elem;\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.REMOVE, prev, index)\n      )\n    );\n    this.dispatchEvent(\n      /** @type {CollectionEvent<T>} */ (\n        new CollectionEvent(CollectionEventType.ADD, elem, index)\n      )\n    );\n  }\n\n  /**\n   * @private\n   */\n  updateLength_() {\n    this.set(Property.LENGTH, this.array_.length);\n  }\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number} [except] Optional index to ignore.\n   */\n  assertUnique_(elem, except) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== except) {\n        throw new AssertionError(58);\n      }\n    }\n  }\n}\n\nexport default Collection;\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove',\n};\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nclass Disposable {\n  constructor() {\n    /**\n     * The object has already been disposed.\n     * @type {boolean}\n     * @protected\n     */\n    this.disposed = false;\n  }\n\n  /**\n   * Clean up.\n   */\n  dispose() {\n    if (!this.disposed) {\n      this.disposed = true;\n      this.disposeInternal();\n    }\n  }\n\n  /**\n   * Extension point for disposable objects.\n   * @protected\n   */\n  disposeInternal() {}\n}\n\nexport default Disposable;\n","/**\n * @module ol/Feature\n */\nimport BaseObject from './Object.js';\nimport EventType from './events/EventType.js';\nimport {assert} from './asserts.js';\nimport {listen, unlistenByKey} from './events.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types|'change:geometry', import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types\n *     |'change:geometry', Return>} FeatureOnSignature\n */\n\n/***\n * @template Geometry\n * @typedef {Object<string, *> & { geometry?: Geometry }} ObjectWithGeometry\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object~BaseObject} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature.js';\n * import Polygon from 'ol/geom/Polygon.js';\n * import Point from 'ol/geom/Point.js';\n *\n * const feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon',\n * });\n *\n * // get the polygon geometry\n * const poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * const point = feature.getGeometry();\n * ```\n *\n * @api\n * @template {import(\"./geom/Geometry.js\").default} [Geometry=import(\"./geom/Geometry.js\").default]\n */\nclass Feature extends BaseObject {\n  /**\n   * @param {Geometry|ObjectWithGeometry<Geometry>} [geometryOrProperties]\n   *     You may pass a Geometry object directly, or an object literal containing\n   *     properties. If you pass an object literal, you may include a Geometry\n   *     associated with a `geometry` key.\n   */\n  constructor(geometryOrProperties) {\n    super();\n\n    /***\n     * @type {FeatureOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {FeatureOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {FeatureOnSignature<void>}\n     */\n    this.un;\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    this.addChangeListener(this.geometryName_, this.handleGeometryChanged_);\n\n    if (geometryOrProperties) {\n      if (\n        typeof (\n          /** @type {?} */ (geometryOrProperties).getSimplifiedGeometry\n        ) === 'function'\n      ) {\n        const geometry = /** @type {Geometry} */ (geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        const properties = geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature<Geometry>} The clone.\n   * @api\n   */\n  clone() {\n    const clone = /** @type {Feature<Geometry>} */ (\n      new Feature(this.hasProperties() ? this.getProperties() : null)\n    );\n    clone.setGeometryName(this.getGeometryName());\n    const geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(/** @type {Geometry} */ (geometry.clone()));\n    }\n    const style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  }\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {Geometry|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  getGeometry() {\n    return /** @type {Geometry|undefined} */ (this.get(this.geometryName_));\n  }\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id_;\n  }\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  getGeometryName() {\n    return this.geometryName_;\n  }\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike|undefined} The feature style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  getStyleFunction() {\n    return this.styleFunction_;\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChange_() {\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChanged_() {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    const geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(\n        geometry,\n        EventType.CHANGE,\n        this.handleGeometryChange_,\n        this\n      );\n    }\n    this.changed();\n  }\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {Geometry|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  setGeometry(geometry) {\n    this.set(this.geometryName_, geometry);\n  }\n\n  /**\n   * Set the style for the feature to override the layer style.  This can be a\n   * single style object, an array of styles, or a function that takes a\n   * resolution and returns an array of styles. To unset the feature style, call\n   * `setStyle()` without arguments or a falsey value.\n   * @param {import(\"./style/Style.js\").StyleLike} [style] Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setStyle(style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  }\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setId(id) {\n    this.id_ = id;\n    this.changed();\n  }\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  setGeometryName(name) {\n    this.removeChangeListener(this.geometryName_, this.handleGeometryChanged_);\n    this.geometryName_ = name;\n    this.addChangeListener(this.geometryName_, this.handleGeometryChanged_);\n    this.handleGeometryChanged_();\n  }\n}\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  }\n  /**\n   * @type {Array<import(\"./style/Style.js\").default>}\n   */\n  let styles;\n  if (Array.isArray(obj)) {\n    styles = obj;\n  } else {\n    assert(typeof (/** @type {?} */ (obj).getZIndex) === 'function', 41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n    const style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n    styles = [style];\n  }\n  return function () {\n    return styles;\n  };\n}\nexport default Feature;\n","/**\n * @module ol/Image\n */\nimport EventType from './events/EventType.js';\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\nimport {IMAGE_DECODE} from './has.js';\nimport {getHeight} from './extent.js';\nimport {listenOnce, unlistenByKey} from './events.js';\n\n/**\n * A function that takes an {@link module:ol/Image~ImageWrapper} for the image and a\n * `{string}` for the src as arguments. It is supposed to make it so the\n * underlying image {@link module:ol/Image~ImageWrapper#getImage} is assigned the\n * content specified by the src. If not specified, the default is\n *\n *     function(image, src) {\n *       image.getImage().src = src;\n *     }\n *\n * Providing a custom `imageLoadFunction` can be useful to load images with\n * post requests or - in general - through XHR requests, where the src of the\n * image element would be set to a data URI when the content is loaded.\n *\n * @typedef {function(ImageWrapper, string): void} LoadFunction\n * @api\n */\n\nclass ImageWrapper extends ImageBase {\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {LoadFunction} imageLoadFunction Image load function.\n   * @param {CanvasRenderingContext2D} [context] Canvas context. When provided, the image will be\n   *    drawn into the context's canvas, and `getImage()` will return the canvas once the image\n   *    has finished loading.\n   */\n  constructor(\n    extent,\n    resolution,\n    pixelRatio,\n    src,\n    crossOrigin,\n    imageLoadFunction,\n    context\n  ) {\n    super(extent, resolution, pixelRatio, ImageState.IDLE);\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = ImageState.IDLE;\n\n    /**\n     * @private\n     * @type {LoadFunction}\n     */\n    this.imageLoadFunction_ = imageLoadFunction;\n  }\n\n  /**\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  getImage() {\n    if (\n      this.state == ImageState.LOADED &&\n      this.context_ &&\n      !(this.image_ instanceof HTMLCanvasElement)\n    ) {\n      const canvas = this.context_.canvas;\n      canvas.width = this.image_.width;\n      canvas.height = this.image_.height;\n      this.context_.drawImage(this.image_, 0, 0);\n      this.image_ = this.context_.canvas;\n    }\n    return this.image_;\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = ImageState.ERROR;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    if (this.resolution === undefined) {\n      this.resolution = getHeight(this.extent) / this.image_.height;\n    }\n    this.state = ImageState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @api\n   */\n  load() {\n    if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.imageLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n   */\n  setImage(image) {\n    this.image_ = image;\n    this.resolution = getHeight(this.extent) / this.image_.height;\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n/**\n * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image element.\n * @param {function():any} loadHandler Load callback function.\n * @param {function():any} errorHandler Error callback function.\n * @return {function():void} Callback to stop listening.\n */\nexport function listenImage(image, loadHandler, errorHandler) {\n  const img = /** @type {HTMLImageElement} */ (image);\n  let listening = true;\n  let decoding = false;\n  let loaded = false;\n\n  const listenerKeys = [\n    listenOnce(img, EventType.LOAD, function () {\n      loaded = true;\n      if (!decoding) {\n        loadHandler();\n      }\n    }),\n  ];\n\n  if (img.src && IMAGE_DECODE) {\n    decoding = true;\n    img\n      .decode()\n      .then(function () {\n        if (listening) {\n          loadHandler();\n        }\n      })\n      .catch(function (error) {\n        if (listening) {\n          if (loaded) {\n            loadHandler();\n          } else {\n            errorHandler();\n          }\n        }\n      });\n  } else {\n    listenerKeys.push(listenOnce(img, EventType.ERROR, errorHandler));\n  }\n\n  return function unlisten() {\n    listening = false;\n    listenerKeys.forEach(unlistenByKey);\n  };\n}\n\nexport default ImageWrapper;\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4,\n};\n","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenImage} from './Image.js';\n\nclass ImageTile extends Tile {\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"./Tile.js\").Options} [options] Tile options.\n   */\n  constructor(tileCoord, state, src, crossOrigin, tileLoadFunction, options) {\n    super(tileCoord, state, options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    this.key = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n  }\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  getImage() {\n    return this.image_;\n  }\n\n  /**\n   * Sets an HTML image element for this tile (may be a Canvas or preloaded Image).\n   * @param {HTMLCanvasElement|HTMLImageElement} element Element.\n   */\n  setImage(element) {\n    this.image_ = element;\n    this.state = TileState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    const image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   *\n   * To retry loading tiles on failed requests, use a custom `tileLoadFunction`\n   * that checks for error status codes and reloads only when the status code is\n   * 408, 429, 500, 502, 503 and 504, and only when not too many retries have been\n   * made already:\n   *\n   * ```js\n   * const retryCodes = [408, 429, 500, 502, 503, 504];\n   * const retries = {};\n   * source.setTileLoadFunction((tile, src) => {\n   *   const image = tile.getImage();\n   *   fetch(src)\n   *     .then((response) => {\n   *       if (retryCodes.includes(response.status)) {\n   *         retries[src] = (retries[src] || 0) + 1;\n   *         if (retries[src] <= 3) {\n   *           setTimeout(() => tile.load(), retries[src] * 1000);\n   *         }\n   *         return Promise.reject();\n   *       }\n   *       return response.blob();\n   *     })\n   *     .then((blob) => {\n   *       const imageUrl = URL.createObjectURL(blob);\n   *       image.src = imageUrl;\n   *       setTimeout(() => URL.revokeObjectURL(imageUrl), 5000);\n   *     })\n   *     .catch(() => tile.setState(3)); // error\n   * });\n   * ```\n   *\n   * @api\n   */\n  load() {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.tileLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  const ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nclass Kinetic {\n  /**\n   * @param {number} decay Rate of decay (must be negative).\n   * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n   * @param {number} delay Delay to consider to calculate the kinetic\n   *     initial values (milliseconds).\n   */\n  constructor(decay, minVelocity, delay) {\n    /**\n     * @private\n     * @type {number}\n     */\n    this.decay_ = decay;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minVelocity_ = minVelocity;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.delay_ = delay;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.points_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.angle_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  begin() {\n    this.points_.length = 0;\n    this.angle_ = 0;\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   */\n  update(x, y) {\n    this.points_.push(x, y, Date.now());\n  }\n\n  /**\n   * @return {boolean} Whether we should do kinetic animation.\n   */\n  end() {\n    if (this.points_.length < 6) {\n      // at least 2 points are required (i.e. there must be at least 6 elements\n      // in the array)\n      return false;\n    }\n    const delay = Date.now() - this.delay_;\n    const lastIndex = this.points_.length - 3;\n    if (this.points_[lastIndex + 2] < delay) {\n      // the last tracked point is too old, which means that the user stopped\n      // panning before releasing the map\n      return false;\n    }\n\n    // get the first point which still falls into the delay time\n    let firstIndex = lastIndex - 3;\n    while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n      firstIndex -= 3;\n    }\n\n    const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n    // we don't want a duration of 0 (divide by zero)\n    // we also make sure the user panned for a duration of at least one frame\n    // (1/60s) to compute sane displacement values\n    if (duration < 1000 / 60) {\n      return false;\n    }\n\n    const dx = this.points_[lastIndex] - this.points_[firstIndex];\n    const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n    this.angle_ = Math.atan2(dy, dx);\n    this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n    return this.initialVelocity_ > this.minVelocity_;\n  }\n\n  /**\n   * @return {number} Total distance travelled (pixels).\n   */\n  getDistance() {\n    return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n  }\n\n  /**\n   * @return {number} Angle of the kinetic panning animation (radians).\n   */\n  getAngle() {\n    return this.angle_;\n  }\n}\n\nexport default Kinetic;\n","/**\n * @module ol/MapBrowserEventHandler\n */\n\nimport EventType from './events/EventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport PointerEventType from './pointer/EventType.js';\nimport Target from './events/Target.js';\nimport {PASSIVE_EVENT_LISTENERS} from './has.js';\nimport {listen, unlistenByKey} from './events.js';\n\nclass MapBrowserEventHandler extends Target {\n  /**\n   * @param {import(\"./Map.js\").default} map The map with the viewport to listen to events on.\n   * @param {number} [moveTolerance] The minimal distance the pointer must travel to trigger a move.\n   */\n  constructor(map, moveTolerance) {\n    super(map);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./Map.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {any}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * Emulate dblclick and singleclick. Will be true when only one pointer is active.\n     * @type {boolean}\n     */\n    this.emulateClicks_ = false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance === undefined ? 1 : moveTolerance;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {PointerEvent|null}\n     * @private\n     */\n    this.down_ = null;\n\n    const element = this.map_.getViewport();\n\n    /**\n     * @type {Array<PointerEvent>}\n     * @private\n     */\n    this.activePointers_ = [];\n\n    /**\n     * @type {!Object<number, Event>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    this.element_ = element;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(\n      element,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_,\n      this\n    );\n\n    /**\n     * @type {PointerEvent}\n     * @private\n     */\n    this.originalPointerMoveEvent_;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(\n      element,\n      PointerEventType.POINTERMOVE,\n      this.relayMoveEvent_,\n      this\n    );\n\n    /**\n     * @private\n     */\n    this.boundHandleTouchMove_ = this.handleTouchMove_.bind(this);\n\n    this.element_.addEventListener(\n      EventType.TOUCHMOVE,\n      this.boundHandleTouchMove_,\n      PASSIVE_EVENT_LISTENERS ? {passive: false} : false\n    );\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  emulateClick_(pointerEvent) {\n    let newEvent = new MapBrowserEvent(\n      MapBrowserEventType.CLICK,\n      this.map_,\n      pointerEvent\n    );\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserEvent(\n        MapBrowserEventType.DBLCLICK,\n        this.map_,\n        pointerEvent\n      );\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(() => {\n        this.clickTimeoutId_ = undefined;\n        const newEvent = new MapBrowserEvent(\n          MapBrowserEventType.SINGLECLICK,\n          this.map_,\n          pointerEvent\n        );\n        this.dispatchEvent(newEvent);\n      }, 250);\n    }\n  }\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  updateActivePointers_(pointerEvent) {\n    const event = pointerEvent;\n    const id = event.pointerId;\n\n    if (\n      event.type == MapBrowserEventType.POINTERUP ||\n      event.type == MapBrowserEventType.POINTERCANCEL\n    ) {\n      delete this.trackedTouches_[id];\n      for (const pointerId in this.trackedTouches_) {\n        if (this.trackedTouches_[pointerId].target !== event.target) {\n          // Some platforms assign a new pointerId when the target changes.\n          // If this happens, delete one tracked pointer. If there is more\n          // than one tracked pointer for the old target, it will be cleared\n          // by subsequent POINTERUP events from other pointers.\n          delete this.trackedTouches_[pointerId];\n          break;\n        }\n      }\n    } else if (\n      event.type == MapBrowserEventType.POINTERDOWN ||\n      event.type == MapBrowserEventType.POINTERMOVE\n    ) {\n      this.trackedTouches_[id] = event;\n    }\n    this.activePointers_ = Object.values(this.trackedTouches_);\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerUp_(pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserEvent(\n      MapBrowserEventType.POINTERUP,\n      this.map_,\n      pointerEvent,\n      undefined,\n      undefined,\n      this.activePointers_\n    );\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.preventDefault().\n    if (\n      this.emulateClicks_ &&\n      !newEvent.defaultPrevented &&\n      !this.dragging_ &&\n      this.isMouseActionButton_(pointerEvent)\n    ) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_.length === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  isMouseActionButton_(pointerEvent) {\n    return pointerEvent.button === 0;\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerDown_(pointerEvent) {\n    this.emulateClicks_ = this.activePointers_.length === 0;\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserEvent(\n      MapBrowserEventType.POINTERDOWN,\n      this.map_,\n      pointerEvent,\n      undefined,\n      undefined,\n      this.activePointers_\n    );\n    this.dispatchEvent(newEvent);\n\n    this.down_ = new PointerEvent(pointerEvent.type, pointerEvent);\n    Object.defineProperty(this.down_, 'target', {\n      writable: false,\n      value: pointerEvent.target,\n    });\n\n    if (this.dragListenerKeys_.length === 0) {\n      const doc = this.map_.getOwnerDocument();\n      this.dragListenerKeys_.push(\n        listen(\n          doc,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_,\n          this\n        ),\n        listen(doc, MapBrowserEventType.POINTERUP, this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(\n          this.element_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_,\n          this\n        )\n      );\n      if (this.element_.getRootNode && this.element_.getRootNode() !== doc) {\n        this.dragListenerKeys_.push(\n          listen(\n            this.element_.getRootNode(),\n            MapBrowserEventType.POINTERUP,\n            this.handlePointerUp_,\n            this\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerMove_(pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.updateActivePointers_(pointerEvent);\n      this.dragging_ = true;\n      const newEvent = new MapBrowserEvent(\n        MapBrowserEventType.POINTERDRAG,\n        this.map_,\n        pointerEvent,\n        this.dragging_,\n        undefined,\n        this.activePointers_\n      );\n      this.dispatchEvent(newEvent);\n    }\n  }\n\n  /**\n   * Wrap and relay a pointermove event.\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  relayMoveEvent_(pointerEvent) {\n    this.originalPointerMoveEvent_ = pointerEvent;\n    const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(\n      new MapBrowserEvent(\n        MapBrowserEventType.POINTERMOVE,\n        this.map_,\n        pointerEvent,\n        dragging\n      )\n    );\n  }\n\n  /**\n   * Flexible handling of a `touch-action: none` css equivalent: because calling\n   * `preventDefault()` on a `pointermove` event does not stop native page scrolling\n   * and zooming, we also listen for `touchmove` and call `preventDefault()` on it\n   * when an interaction (currently `DragPan` handles the event.\n   * @param {TouchEvent} event Event.\n   * @private\n   */\n  handleTouchMove_(event) {\n    // Due to https://github.com/mpizenberg/elm-pep/issues/2, `this.originalPointerMoveEvent_`\n    // may not be initialized yet when we get here on a platform without native pointer events.\n    const originalEvent = this.originalPointerMoveEvent_;\n    if (\n      (!originalEvent || originalEvent.defaultPrevented) &&\n      (typeof event.cancelable !== 'boolean' || event.cancelable === true)\n    ) {\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  isMoving_(pointerEvent) {\n    return (\n      this.dragging_ ||\n      Math.abs(pointerEvent.clientX - this.down_.clientX) >\n        this.moveTolerance_ ||\n      Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_\n    );\n  }\n\n  /**\n   * Clean up.\n   */\n  disposeInternal() {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    this.element_.removeEventListener(\n      EventType.TOUCHMOVE,\n      this.boundHandleTouchMove_\n    );\n\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    this.element_ = null;\n    super.disposeInternal();\n  }\n}\n\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/TileQueue\n */\nimport EventType from './events/EventType.js';\nimport PriorityQueue, {DROP} from './structs/PriorityQueue.js';\nimport TileState from './TileState.js';\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\nclass TileQueue extends PriorityQueue {\n  /**\n   * @param {PriorityFunction} tilePriorityFunction Tile priority function.\n   * @param {function(): ?} tileChangeCallback Function called on each tile change event.\n   */\n  constructor(tilePriorityFunction, tileChangeCallback) {\n    super(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      function (element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function (element) {\n        return /** @type {import(\"./Tile.js\").default} */ (element[0]).getKey();\n      }\n    );\n\n    /** @private */\n    this.boundHandleTileChange_ = this.handleTileChange.bind(this);\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n  }\n\n  /**\n   * @param {Array} element Element.\n   * @return {boolean} The element was added to the queue.\n   */\n  enqueue(element) {\n    const added = super.enqueue(element);\n    if (added) {\n      const tile = element[0];\n      tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n    }\n    return added;\n  }\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  getTilesLoading() {\n    return this.tilesLoading_;\n  }\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleTileChange(event) {\n    const tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    const state = tile.getState();\n    if (\n      state === TileState.LOADED ||\n      state === TileState.ERROR ||\n      state === TileState.EMPTY\n    ) {\n      if (state !== TileState.ERROR) {\n        tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n      }\n      const tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  }\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  loadMoreTiles(maxTotalLoading, maxNewLoads) {\n    let newLoads = 0;\n    let state, tile, tileKey;\n    while (\n      this.tilesLoading_ < maxTotalLoading &&\n      newLoads < maxNewLoads &&\n      this.getCount() > 0\n    ) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n  }\n}\n\nexport default TileQueue;\n\n/**\n * @param {import('./Map.js').FrameState} frameState Frame state.\n * @param {import(\"./Tile.js\").default} tile Tile.\n * @param {string} tileSourceKey Tile source key.\n * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n * @param {number} tileResolution Tile resolution.\n * @return {number} Tile priority.\n */\nexport function getTilePriority(\n  frameState,\n  tile,\n  tileSourceKey,\n  tileCenter,\n  tileResolution\n) {\n  // Filter out tiles at higher zoom levels than the current zoom level, or that\n  // are outside the visible extent.\n  if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n    return DROP;\n  }\n  if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n    return DROP;\n  }\n  // Prioritize the highest zoom level tiles closest to the focus.\n  // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n  // Within a zoom level, tiles are prioritized by the distance in pixels between\n  // the center of the tile and the center of the viewport.  The factor of 65536\n  // means that the prioritization should behave as desired for tiles up to\n  // 65536 * Math.log(2) = 45426 pixels from the focus.\n  const center = frameState.viewState.center;\n  const deltaX = tileCenter[0] - center[0];\n  const deltaY = tileCenter[1] - center[1];\n  return (\n    65536 * Math.log(tileResolution) +\n    Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution\n  );\n}\n","/**\n * @module ol/Map\n */\nimport BaseObject from './Object.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport CompositeMapRenderer from './renderer/Composite.js';\nimport EventType from './events/EventType.js';\nimport Layer from './layer/Layer.js';\nimport LayerGroup, {GroupEvent} from './layer/Group.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport PointerEventType from './pointer/EventType.js';\nimport RenderEventType from './render/EventType.js';\nimport TileQueue, {getTilePriority} from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {DEVICE_PIXEL_RATIO, PASSIVE_EVENT_LISTENERS} from './has.js';\nimport {TRUE} from './functions.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n} from './transform.js';\nimport {assert} from './asserts.js';\nimport {\n  clone,\n  createOrUpdateEmpty,\n  equals as equalsExtent,\n  getForViewAndSize,\n  isEmpty,\n} from './extent.js';\nimport {defaults as defaultControls} from './control/defaults.js';\nimport {defaults as defaultInteractions} from './interaction/defaults.js';\nimport {equals} from './array.js';\nimport {fromUserCoordinate, toUserCoordinate} from './proj.js';\nimport {getUid} from './util.js';\nimport {hasArea} from './size.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {removeNode} from './dom.js';\nimport {warn} from './console.js';\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate Animate.\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform CoordinateToPixelTransform.\n * @property {import(\"rbush\").default} declutterTree DeclutterTree.\n * @property {null|import(\"./extent.js\").Extent} extent Extent.\n * @property {import(\"./extent.js\").Extent} [nextExtent] Next extent during an animation series.\n * @property {number} index Index.\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray LayerStatesArray.\n * @property {number} layerIndex LayerIndex.\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform PixelToCoordinateTransform.\n * @property {Array<PostRenderFunction>} postRenderFunctions PostRenderFunctions.\n * @property {import(\"./size.js\").Size} size Size.\n * @property {TileQueue} tileQueue TileQueue.\n * @property {!Object<string, Object<string, boolean>>} usedTiles UsedTiles.\n * @property {Array<number>} viewHints ViewHints.\n * @property {!Object<string, Object<string, boolean>>} wantedTiles WantedTiles.\n * @property {string} mapId The id of the map.\n * @property {Object<string, boolean>} renderTargets Identifiers of previously rendered elements.\n */\n\n/**\n * @typedef {function(Map, ?FrameState): any} PostRenderFunction\n */\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default<import(\"./source/Source\").default>): boolean} [layerFilter] Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer~Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in css pixels. Pixels\n * inside the radius around the given position will be checked for features.\n * @property {boolean} [checkWrapped=true] Check-Wrapped Will check for wrapped geometries inside the range of\n *   +/- 1 world width. Works only if a projection is used that can be wrapped.\n */\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls] Controls.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions] Interactions.\n * @property {HTMLElement|Document} keyboardEventTarget KeyboardEventTarget.\n * @property {Collection<import(\"./Overlay.js\").default>} overlays Overlays.\n * @property {Object<string, *>} values Values.\n */\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:layergroup'|'change:size'|'change:target'|'change:view'} MapObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *    import(\"./Observable\").OnSignature<MapObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./MapBrowserEventType\").Types, import(\"./MapBrowserEvent\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./MapEventType\").Types, import(\"./MapEvent\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./render/EventType\").MapRenderEventTypes, import(\"./render/Event\").default, Return> &\n *    import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|MapObjectEventTypes|\n *      import(\"./MapBrowserEventType\").Types|import(\"./MapEventType\").Types|\n *      import(\"./render/EventType\").MapRenderEventTypes, Return>} MapEventHandler\n */\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control/defaults.defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction/defaults.defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered. If passed by element, the container can be in a secondary document.\n * **Note:** CSS `transform` support for the target element is limited to `scale`.\n * @property {View|Promise<import(\"./View.js\").ViewOptions>} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n/**\n * @param {import(\"./layer/Base.js\").default} layer Layer.\n */\nfunction removeLayerMapProperty(layer) {\n  if (layer instanceof Layer) {\n    layer.setMapInternal(null);\n    return;\n  }\n  if (layer instanceof LayerGroup) {\n    layer.getLayers().forEach(removeLayerMapProperty);\n  }\n}\n\n/**\n * @param {import(\"./layer/Base.js\").default} layer Layer.\n * @param {Map} map Map.\n */\nfunction setLayerMapProperty(layer, map) {\n  if (layer instanceof Layer) {\n    layer.setMapInternal(map);\n    return;\n  }\n  if (layer instanceof LayerGroup) {\n    const layers = layer.getLayers().getArray();\n    for (let i = 0, ii = layers.length; i < ii; ++i) {\n      setLayerMapProperty(layers[i], map);\n    }\n  }\n}\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map.js';\n *     import View from 'ol/View.js';\n *     import TileLayer from 'ol/layer/Tile.js';\n *     import OSM from 'ol/source/OSM.js';\n *\n *     const map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1,\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM(),\n *         }),\n *       ],\n *       target: 'map',\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile~TileLayer} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~LayerGroup}\n * is a subclass of {@link module:ol/layer/Base~BaseLayer}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires import(\"./render/Event.js\").default#precompose\n * @fires import(\"./render/Event.js\").default#postcompose\n * @fires import(\"./render/Event.js\").default#rendercomplete\n * @api\n */\nclass Map extends BaseObject {\n  /**\n   * @param {MapOptions} [options] Map options.\n   */\n  constructor(options) {\n    super();\n\n    options = options || {};\n\n    /***\n     * @type {MapEventHandler<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {MapEventHandler<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {MapEventHandler<void>}\n     */\n    this.un;\n\n    const optionsInternal = createOptionsInternal(options);\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.renderComplete_;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.loaded_ = true;\n\n    /** @private */\n    this.boundHandleBrowserEvent_ = this.handleBrowserEvent.bind(this);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ =\n      options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ =\n      options.pixelRatio !== undefined\n        ? options.pixelRatio\n        : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {*}\n     */\n    this.postRenderTimeoutHandle_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = this.animationDelay_.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className =\n      'ol-viewport' + ('ontouchstart' in window ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.style.position = 'absolute';\n    this.overlayContainer_.style.zIndex = '0';\n    this.overlayContainer_.style.width = '100%';\n    this.overlayContainer_.style.height = '100%';\n    this.overlayContainer_.style.pointerEvents = 'none';\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.style.position = 'absolute';\n    this.overlayContainerStopEvent_.style.zIndex = '0';\n    this.overlayContainerStopEvent_.style.width = '100%';\n    this.overlayContainerStopEvent_.style.height = '100%';\n    this.overlayContainerStopEvent_.style.pointerEvents = 'none';\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.moveTolerance_ = options.moveTolerance;\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.targetChangeHandlerKeys_ = null;\n\n    /**\n     * @private\n     * @type {HTMLElement|null}\n     */\n    this.targetElement_ = null;\n\n    /**\n     * @type {ResizeObserver}\n     */\n    this.resizeObserver_ = new ResizeObserver(() => this.updateSize());\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || defaultControls();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions =\n      optionsInternal.interactions ||\n      defaultInteractions({\n        onFocusOnly: true,\n      });\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default|null}\n     * @private\n     */\n    this.renderer_ = null;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this)\n    );\n\n    this.addChangeListener(\n      MapProperty.LAYERGROUP,\n      this.handleLayerGroupChanged_\n    );\n    this.addChangeListener(MapProperty.VIEW, this.handleViewChanged_);\n    this.addChangeListener(MapProperty.SIZE, this.handleSizeChanged_);\n    this.addChangeListener(MapProperty.TARGET, this.handleTargetChanged_);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    const map = this;\n    if (options.view && !(options.view instanceof View)) {\n      options.view.then(function (viewOptions) {\n        map.setView(new View(viewOptions));\n      });\n    }\n\n    this.controls.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./control/Control.js\").default>} event CollectionEvent\n       */\n      (event) => {\n        event.element.setMap(this);\n      }\n    );\n\n    this.controls.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./control/Control.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(null);\n      }\n    );\n\n    this.interactions.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./interaction/Interaction.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(this);\n      }\n    );\n\n    this.interactions.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./interaction/Interaction.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        event.element.setMap(null);\n      }\n    );\n\n    this.overlays_.addEventListener(\n      CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./Overlay.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        this.addOverlayInternal_(event.element);\n      }\n    );\n\n    this.overlays_.addEventListener(\n      CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent<import(\"./Overlay.js\").default>} event CollectionEvent.\n       */\n      (event) => {\n        const id = event.element.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }\n    );\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       */\n      (control) => {\n        control.setMap(this);\n      }\n    );\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       */\n      (interaction) => {\n        interaction.setMap(this);\n      }\n    );\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n  }\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  addControl(control) {\n    this.getControls().push(control);\n  }\n\n  /**\n   * Add the given interaction to the map. If you want to add an interaction\n   * at another point of the collection use `getInteractions()` and the methods\n   * available on {@link module:ol/Collection~Collection}. This can be used to\n   * stop the event propagation from the handleEvent function. The interactions\n   * get to handle the events in the reverse order of this collection.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  addInteraction(interaction) {\n    this.getInteractions().push(interaction);\n  }\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  addLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  }\n\n  /**\n   * @param {import(\"./layer/Group.js\").GroupEvent} event The layer add event.\n   * @private\n   */\n  handleLayerAdd_(event) {\n    setLayerMapProperty(event.layer, this);\n  }\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  addOverlay(overlay) {\n    this.getOverlays().push(overlay);\n  }\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  addOverlayInternal_(overlay) {\n    const id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  }\n\n  /**\n   *\n   * Clean up.\n   */\n  disposeInternal() {\n    this.controls.clear();\n    this.interactions.clear();\n    this.overlays_.clear();\n    this.resizeObserver_.disconnect();\n    this.setTarget(null);\n    super.disposeInternal();\n  }\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(import(\"./Feature.js\").FeatureLike, import(\"./layer/Layer.js\").default<import(\"./source/Source\").default>, import(\"./geom/SimpleGeometry.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature~Feature feature} or\n   *     {@link module:ol/render/Feature~RenderFeature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer~Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template T\n   * @api\n   */\n  forEachFeatureAtPixel(pixel, callback, options) {\n    if (!this.frameState_ || !this.renderer_) {\n      return;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    options = options !== undefined ? options : {};\n    const hitTolerance =\n      options.hitTolerance !== undefined ? options.hitTolerance : 0;\n    const layerFilter =\n      options.layerFilter !== undefined ? options.layerFilter : TRUE;\n    const checkWrapped = options.checkWrapped !== false;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate,\n      this.frameState_,\n      hitTolerance,\n      checkWrapped,\n      callback,\n      null,\n      layerFilter,\n      null\n    );\n  }\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * an empty array if none were found.\n   * @api\n   */\n  getFeaturesAtPixel(pixel, options) {\n    const features = [];\n    this.forEachFeatureAtPixel(\n      pixel,\n      function (feature) {\n        features.push(feature);\n      },\n      options\n    );\n    return features;\n  }\n\n  /**\n   * Get all layers from all layer groups.\n   * @return {Array<import(\"./layer/Layer.js\").default>} Layers.\n   * @api\n   */\n  getAllLayers() {\n    const layers = [];\n    function addLayersFrom(layerGroup) {\n      layerGroup.forEach(function (layer) {\n        if (layer instanceof LayerGroup) {\n          addLayersFrom(layer.getLayers());\n        } else {\n          layers.push(layer);\n        }\n      });\n    }\n    addLayersFrom(this.getLayers());\n    return layers;\n  }\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through the `layerFilter` option.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions} [options] Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @api\n   */\n  hasFeatureAtPixel(pixel, options) {\n    if (!this.frameState_ || !this.renderer_) {\n      return false;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    options = options !== undefined ? options : {};\n    const layerFilter =\n      options.layerFilter !== undefined ? options.layerFilter : TRUE;\n    const hitTolerance =\n      options.hitTolerance !== undefined ? options.hitTolerance : 0;\n    const checkWrapped = options.checkWrapped !== false;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate,\n      this.frameState_,\n      hitTolerance,\n      checkWrapped,\n      layerFilter,\n      null\n    );\n  }\n\n  /**\n   * Returns the coordinate in user projection for a browser event.\n   * @param {MouseEvent} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  getEventCoordinate(event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {MouseEvent} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   */\n  getEventCoordinateInternal(event) {\n    return this.getCoordinateFromPixelInternal(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {UIEvent|{clientX: number, clientY: number}} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  getEventPixel(event) {\n    const viewport = this.viewport_;\n    const viewportPosition = viewport.getBoundingClientRect();\n    const viewportSize = this.getSize();\n    const scaleX = viewportPosition.width / viewportSize[0];\n    const scaleY = viewportPosition.height / viewportSize[1];\n    const eventPosition =\n      //FIXME Are we really calling this with a TouchEvent anywhere?\n      'changedTouches' in event\n        ? /** @type {TouchEvent} */ (event).changedTouches[0]\n        : /** @type {MouseEvent} */ (event);\n\n    return [\n      (eventPosition.clientX - viewportPosition.left) / scaleX,\n      (eventPosition.clientY - viewportPosition.top) / scaleY,\n    ];\n  }\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  getTarget() {\n    return /** @type {HTMLElement|string|undefined} */ (\n      this.get(MapProperty.TARGET)\n    );\n  }\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  getTargetElement() {\n    return this.targetElement_;\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * user projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  getCoordinateFromPixel(pixel) {\n    return toUserCoordinate(\n      this.getCoordinateFromPixelInternal(pixel),\n      this.getView().getProjection()\n    );\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   */\n  getCoordinateFromPixelInternal(pixel) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    }\n    return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n  }\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  getControls() {\n    return this.controls;\n  }\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  getOverlays() {\n    return this.overlays_;\n  }\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  getOverlayById(id) {\n    const overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  }\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  getInteractions() {\n    return this.interactions;\n  }\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  getLayerGroup() {\n    return /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP));\n  }\n\n  /**\n   * Clear any existing layers and add layers to the map.\n   * @param {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>} layers The layers to be added to the map.\n   * @api\n   */\n  setLayers(layers) {\n    const group = this.getLayerGroup();\n    if (layers instanceof Collection) {\n      group.setLayers(layers);\n      return;\n    }\n\n    const collection = group.getLayers();\n    collection.clear();\n    collection.extend(layers);\n  }\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  getLayers() {\n    const layers = this.getLayerGroup().getLayers();\n    return layers;\n  }\n\n  /**\n   * @return {boolean} Layers have sources that are still loading.\n   */\n  getLoadingOrNotReady() {\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const state = layerStatesArray[i];\n      if (!state.visible) {\n        continue;\n      }\n      const renderer = state.layer.getRenderer();\n      if (renderer && !renderer.ready) {\n        return true;\n      }\n      const source = state.layer.getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the user\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  getPixelFromCoordinate(coordinate) {\n    const viewCoordinate = fromUserCoordinate(\n      coordinate,\n      this.getView().getProjection()\n    );\n    return this.getPixelFromCoordinateInternal(viewCoordinate);\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   */\n  getPixelFromCoordinateInternal(coordinate) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    }\n    return applyTransform(\n      frameState.coordinateToPixelTransform,\n      coordinate.slice(0, 2)\n    );\n  }\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default|null} Renderer\n   */\n  getRenderer() {\n    return this.renderer_;\n  }\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  getSize() {\n    return /** @type {import(\"./size.js\").Size|undefined} */ (\n      this.get(MapProperty.SIZE)\n    );\n  }\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  getView() {\n    return /** @type {View} */ (this.get(MapProperty.VIEW));\n  }\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  getViewport() {\n    return this.viewport_;\n  }\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  getOverlayContainer() {\n    return this.overlayContainer_;\n  }\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  getOverlayContainerStopEvent() {\n    return this.overlayContainerStopEvent_;\n  }\n\n  /**\n   * @return {!Document} The document where the map is displayed.\n   */\n  getOwnerDocument() {\n    const targetElement = this.getTargetElement();\n    return targetElement ? targetElement.ownerDocument : document;\n  }\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  getTilePriority(tile, tileSourceKey, tileCenter, tileResolution) {\n    return getTilePriority(\n      this.frameState_,\n      tile,\n      tileSourceKey,\n      tileCenter,\n      tileResolution\n    );\n  }\n\n  /**\n   * @param {UIEvent} browserEvent Browser event.\n   * @param {string} [type] Type.\n   */\n  handleBrowserEvent(browserEvent, type) {\n    type = type || browserEvent.type;\n    const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  }\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  handleMapBrowserEvent(mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    const originalEvent = /** @type {PointerEvent} */ (\n      mapBrowserEvent.originalEvent\n    );\n    const eventType = originalEvent.type;\n    if (\n      eventType === PointerEventType.POINTERDOWN ||\n      eventType === EventType.WHEEL ||\n      eventType === EventType.KEYDOWN\n    ) {\n      const doc = this.getOwnerDocument();\n      const rootNode = this.viewport_.getRootNode\n        ? this.viewport_.getRootNode()\n        : doc;\n      const target = /** @type {Node} */ (originalEvent.target);\n      if (\n        // Abort if the target is a child of the container for elements whose events are not meant\n        // to be handled by map interactions.\n        this.overlayContainerStopEvent_.contains(target) ||\n        // Abort if the event target is a child of the container that is no longer in the page.\n        // It's possible for the target to no longer be in the page if it has been removed in an\n        // event listener, this might happen in a Control that recreates it's content based on\n        // user interaction either manually or via a render in something like https://reactjs.org/\n        !(rootNode === doc ? doc.documentElement : rootNode).contains(target)\n      ) {\n        return;\n      }\n    }\n    mapBrowserEvent.frameState = this.frameState_;\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      const interactionsArray = this.getInteractions().getArray().slice();\n      for (let i = interactionsArray.length - 1; i >= 0; i--) {\n        const interaction = interactionsArray[i];\n        if (\n          interaction.getMap() !== this ||\n          !interaction.getActive() ||\n          !this.getTargetElement()\n        ) {\n          continue;\n        }\n        const cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont || mapBrowserEvent.propagationStopped) {\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handlePostRender() {\n    const frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    const tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      let maxTotalLoading = this.maxTilesLoading_;\n      let maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        const hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING]) {\n          const lowOnFrameBudget = Date.now() - frameState.time > 8;\n          maxTotalLoading = lowOnFrameBudget ? 0 : 8;\n          maxNewLoads = lowOnFrameBudget ? 0 : 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n\n    if (frameState && this.renderer_ && !frameState.animate) {\n      if (this.renderComplete_ === true) {\n        if (this.hasListener(RenderEventType.RENDERCOMPLETE)) {\n          this.renderer_.dispatchRenderEvent(\n            RenderEventType.RENDERCOMPLETE,\n            frameState\n          );\n        }\n        if (this.loaded_ === false) {\n          this.loaded_ = true;\n          this.dispatchEvent(\n            new MapEvent(MapEventType.LOADEND, this, frameState)\n          );\n        }\n      } else if (this.loaded_ === true) {\n        this.loaded_ = false;\n        this.dispatchEvent(\n          new MapEvent(MapEventType.LOADSTART, this, frameState)\n        );\n      }\n    }\n\n    const postRenderFunctions = this.postRenderFunctions_;\n    for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  }\n\n  /**\n   * @private\n   */\n  handleSizeChanged_() {\n    if (this.getView() && !this.getView().getAnimating()) {\n      this.getView().resolveConstraints(0);\n    }\n\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleTargetChanged_() {\n    if (this.mapBrowserEventHandler_) {\n      for (let i = 0, ii = this.targetChangeHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.targetChangeHandlerKeys_[i]);\n      }\n      this.targetChangeHandlerKeys_ = null;\n      this.viewport_.removeEventListener(\n        EventType.CONTEXTMENU,\n        this.boundHandleBrowserEvent_\n      );\n      this.viewport_.removeEventListener(\n        EventType.WHEEL,\n        this.boundHandleBrowserEvent_\n      );\n      this.mapBrowserEventHandler_.dispose();\n      this.mapBrowserEventHandler_ = null;\n      removeNode(this.viewport_);\n    }\n\n    if (this.targetElement_) {\n      this.resizeObserver_.unobserve(this.targetElement_);\n      const rootNode = this.targetElement_.getRootNode();\n      if (rootNode instanceof ShadowRoot) {\n        this.resizeObserver_.unobserve(rootNode.host);\n      }\n    }\n\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    const target = this.getTarget();\n    const targetElement =\n      typeof target === 'string' ? document.getElementById(target) : target;\n    this.targetElement_ = targetElement;\n    if (!targetElement) {\n      if (this.renderer_) {\n        clearTimeout(this.postRenderTimeoutHandle_);\n        this.postRenderTimeoutHandle_ = undefined;\n        this.postRenderFunctions_.length = 0;\n        this.renderer_.dispose();\n        this.renderer_ = null;\n      }\n      if (this.animationDelayKey_) {\n        cancelAnimationFrame(this.animationDelayKey_);\n        this.animationDelayKey_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n      if (!this.renderer_) {\n        this.renderer_ = new CompositeMapRenderer(this);\n      }\n\n      this.mapBrowserEventHandler_ = new MapBrowserEventHandler(\n        this,\n        this.moveTolerance_\n      );\n      for (const key in MapBrowserEventType) {\n        this.mapBrowserEventHandler_.addEventListener(\n          MapBrowserEventType[key],\n          this.handleMapBrowserEvent.bind(this)\n        );\n      }\n      this.viewport_.addEventListener(\n        EventType.CONTEXTMENU,\n        this.boundHandleBrowserEvent_,\n        false\n      );\n      this.viewport_.addEventListener(\n        EventType.WHEEL,\n        this.boundHandleBrowserEvent_,\n        PASSIVE_EVENT_LISTENERS ? {passive: false} : false\n      );\n\n      const keyboardEventTarget = !this.keyboardEventTarget_\n        ? targetElement\n        : this.keyboardEventTarget_;\n      this.targetChangeHandlerKeys_ = [\n        listen(\n          keyboardEventTarget,\n          EventType.KEYDOWN,\n          this.handleBrowserEvent,\n          this\n        ),\n        listen(\n          keyboardEventTarget,\n          EventType.KEYPRESS,\n          this.handleBrowserEvent,\n          this\n        ),\n      ];\n      const rootNode = targetElement.getRootNode();\n      if (rootNode instanceof ShadowRoot) {\n        this.resizeObserver_.observe(rootNode.host);\n      }\n      this.resizeObserver_.observe(targetElement);\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  }\n\n  /**\n   * @private\n   */\n  handleTileChange_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewPropertyChanged_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewChanged_() {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    const view = this.getView();\n    if (view) {\n      this.updateViewportSize_();\n\n      this.viewPropertyListenerKey_ = listen(\n        view,\n        ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_,\n        this\n      );\n      this.viewChangeListenerKey_ = listen(\n        view,\n        EventType.CHANGE,\n        this.handleViewPropertyChanged_,\n        this\n      );\n\n      view.resolveConstraints(0);\n    }\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleLayerGroupChanged_() {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    const layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.handleLayerAdd_(new GroupEvent('addlayer', layerGroup));\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(layerGroup, ObjectEventType.PROPERTYCHANGE, this.render, this),\n        listen(layerGroup, EventType.CHANGE, this.render, this),\n        listen(layerGroup, 'addlayer', this.handleLayerAdd_, this),\n        listen(layerGroup, 'removelayer', this.handleLayerRemove_, this),\n      ];\n    }\n    this.render();\n  }\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  isRendered() {\n    return !!this.frameState_;\n  }\n\n  /**\n   * @private\n   */\n  animationDelay_() {\n    this.animationDelayKey_ = undefined;\n    this.renderFrame_(Date.now());\n  }\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  renderSync() {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  }\n\n  /**\n   * Redraws all text after new fonts have loaded\n   */\n  redrawText() {\n    const layerStates = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStates.length; i < ii; ++i) {\n      const layer = layerStates[i].layer;\n      if (layer.hasRenderer()) {\n        layer.getRenderer().handleFontsChanged();\n      }\n    }\n  }\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  render() {\n    if (this.renderer_ && this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  }\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  removeControl(control) {\n    return this.getControls().remove(control);\n  }\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  removeInteraction(interaction) {\n    return this.getInteractions().remove(interaction);\n  }\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  removeLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  }\n\n  /**\n   * @param {import(\"./layer/Group.js\").GroupEvent} event The layer remove event.\n   * @private\n   */\n  handleLayerRemove_(event) {\n    removeLayerMapProperty(event.layer);\n  }\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  removeOverlay(overlay) {\n    return this.getOverlays().remove(overlay);\n  }\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  renderFrame_(time) {\n    const size = this.getSize();\n    const view = this.getView();\n    const previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    let frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      const viewHints = view.getHints(\n        this.frameState_ ? this.frameState_.viewHints : undefined\n      );\n      const viewState = view.getState();\n      frameState = {\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        declutterTree: null,\n        extent: getForViewAndSize(\n          viewState.center,\n          viewState.resolution,\n          viewState.rotation,\n          size\n        ),\n        index: this.frameIndex_++,\n        layerIndex: 0,\n        layerStatesArray: this.getLayerGroup().getLayerStatesArray(),\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {},\n        mapId: getUid(this),\n        renderTargets: {},\n      };\n      if (viewState.nextCenter && viewState.nextResolution) {\n        const rotation = isNaN(viewState.nextRotation)\n          ? viewState.rotation\n          : viewState.nextRotation;\n\n        frameState.nextExtent = getForViewAndSize(\n          viewState.nextCenter,\n          viewState.nextResolution,\n          rotation,\n          size\n        );\n      }\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(\n        this.postRenderFunctions_,\n        frameState.postRenderFunctions\n      );\n\n      if (previousFrameState) {\n        const moveStart =\n          !this.previousExtent_ ||\n          (!isEmpty(this.previousExtent_) &&\n            !equalsExtent(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState)\n          );\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      const idle =\n        this.previousExtent_ &&\n        !frameState.viewHints[ViewHint.ANIMATING] &&\n        !frameState.viewHints[ViewHint.INTERACTING] &&\n        !equalsExtent(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(\n          new MapEvent(MapEventType.MOVEEND, this, frameState)\n        );\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    this.renderComplete_ =\n      this.hasListener(MapEventType.LOADSTART) ||\n      this.hasListener(MapEventType.LOADEND) ||\n      this.hasListener(RenderEventType.RENDERCOMPLETE)\n        ? !this.tileQueue_.getTilesLoading() &&\n          !this.tileQueue_.getCount() &&\n          !this.getLoadingOrNotReady()\n        : undefined;\n\n    if (!this.postRenderTimeoutHandle_) {\n      this.postRenderTimeoutHandle_ = setTimeout(() => {\n        this.postRenderTimeoutHandle_ = undefined;\n        this.handlePostRender();\n      }, 0);\n    }\n  }\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  setLayerGroup(layerGroup) {\n    const oldLayerGroup = this.getLayerGroup();\n    if (oldLayerGroup) {\n      this.handleLayerRemove_(new GroupEvent('removelayer', oldLayerGroup));\n    }\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  }\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  setSize(size) {\n    this.set(MapProperty.SIZE, size);\n  }\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string} [target] The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  setTarget(target) {\n    this.set(MapProperty.TARGET, target);\n  }\n\n  /**\n   * Set the view for this map.\n   * @param {View|Promise<import(\"./View.js\").ViewOptions>} view The view that controls this map.\n   * It is also possible to pass a promise that resolves to options for constructing a view.  This\n   * alternative allows view properties to be resolved by sources or other components that load\n   * view-related metadata.\n   * @observable\n   * @api\n   */\n  setView(view) {\n    if (!view || view instanceof View) {\n      this.set(MapProperty.VIEW, view);\n      return;\n    }\n    this.set(MapProperty.VIEW, new View());\n\n    const map = this;\n    view.then(function (viewOptions) {\n      map.setView(new View(viewOptions));\n    });\n  }\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  updateSize() {\n    const targetElement = this.getTargetElement();\n\n    let size = undefined;\n    if (targetElement) {\n      const computedStyle = getComputedStyle(targetElement);\n      const width =\n        targetElement.offsetWidth -\n        parseFloat(computedStyle['borderLeftWidth']) -\n        parseFloat(computedStyle['paddingLeft']) -\n        parseFloat(computedStyle['paddingRight']) -\n        parseFloat(computedStyle['borderRightWidth']);\n      const height =\n        targetElement.offsetHeight -\n        parseFloat(computedStyle['borderTopWidth']) -\n        parseFloat(computedStyle['paddingTop']) -\n        parseFloat(computedStyle['paddingBottom']) -\n        parseFloat(computedStyle['borderBottomWidth']);\n      if (!isNaN(width) && !isNaN(height)) {\n        size = [width, height];\n        if (\n          !hasArea(size) &&\n          !!(\n            targetElement.offsetWidth ||\n            targetElement.offsetHeight ||\n            targetElement.getClientRects().length\n          )\n        ) {\n          warn(\n            \"No map visible because the map container's width or height are 0.\"\n          );\n        }\n      }\n    }\n\n    const oldSize = this.getSize();\n    if (size && (!oldSize || !equals(size, oldSize))) {\n      this.setSize(size);\n      this.updateViewportSize_();\n    }\n  }\n\n  /**\n   * Recomputes the viewport size and save it on the view object (if any)\n   * @private\n   */\n  updateViewportSize_() {\n    const view = this.getView();\n    if (view) {\n      let size = undefined;\n      const computedStyle = getComputedStyle(this.viewport_);\n      if (computedStyle.width && computedStyle.height) {\n        size = [\n          parseInt(computedStyle.width, 10),\n          parseInt(computedStyle.height, 10),\n        ];\n      }\n      view.setViewportSize(size);\n    }\n  }\n}\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n  /**\n   * @type {HTMLElement|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget =\n      typeof options.keyboardEventTarget === 'string'\n        ? document.getElementById(options.keyboardEventTarget)\n        : options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  const values = {};\n\n  const layerGroup =\n    options.layers &&\n    typeof (/** @type {?} */ (options.layers).getLayers) === 'function'\n      ? /** @type {LayerGroup} */ (options.layers)\n      : new LayerGroup({\n          layers:\n            /** @type {Collection<import(\"./layer/Base.js\").default>|Array<import(\"./layer/Base.js\").default>} */ (\n              options.layers\n            ),\n        });\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] =\n    options.view instanceof View ? options.view : new View();\n\n  /** @type {Collection<import(\"./control/Control.js\").default>} */\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.controls).getArray) === 'function',\n        47\n      ); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = options.controls;\n    }\n  }\n\n  /** @type {Collection<import(\"./interaction/Interaction\").default>} */\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.interactions).getArray) ===\n          'function',\n        48\n      ); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = options.interactions;\n    }\n  }\n\n  /** @type {Collection<import(\"./Overlay.js\").default>} */\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(\n        typeof (/** @type {?} */ (options.overlays).getArray) === 'function',\n        49\n      ); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values,\n  };\n}\nexport default Map;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map browser event.\n * @template {UIEvent} EVENT\n */\nclass MapBrowserEvent extends MapEvent {\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./Map.js\").default} map Map.\n   * @param {EVENT} originalEvent Original event.\n   * @param {boolean} [dragging] Is the map currently being dragged?\n   * @param {import(\"./Map.js\").FrameState} [frameState] Frame state.\n   * @param {Array<PointerEvent>} [activePointers] Active pointers.\n   */\n  constructor(type, map, originalEvent, dragging, frameState, activePointers) {\n    super(type, map, frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {EVENT}\n     * @api\n     */\n    this.originalEvent = originalEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {?import(\"./pixel.js\").Pixel}\n     */\n    this.pixel_ = null;\n\n    /**\n     * The coordinate in the user projection corresponding to the original browser event.\n     * @type {?import(\"./coordinate.js\").Coordinate}\n     */\n    this.coordinate_ = null;\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = dragging !== undefined ? dragging : false;\n\n    /**\n     * @type {Array<PointerEvent>|undefined}\n     */\n    this.activePointers = activePointers;\n  }\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original event.\n   * @type {import(\"./pixel.js\").Pixel}\n   * @api\n   */\n  get pixel() {\n    if (!this.pixel_) {\n      this.pixel_ = this.map.getEventPixel(this.originalEvent);\n    }\n    return this.pixel_;\n  }\n  set pixel(pixel) {\n    this.pixel_ = pixel;\n  }\n\n  /**\n   * The coordinate corresponding to the original browser event.  This will be in the user\n   * projection if one is set.  Otherwise it will be in the view projection.\n   * @type {import(\"./coordinate.js\").Coordinate}\n   * @api\n   */\n  get coordinate() {\n    if (!this.coordinate_) {\n      this.coordinate_ = this.map.getCoordinateFromPixel(this.pixel);\n    }\n    return this.coordinate_;\n  }\n  set coordinate(coordinate) {\n    this.coordinate_ = coordinate;\n  }\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @api\n   */\n  preventDefault() {\n    super.preventDefault();\n    if ('preventDefault' in this.originalEvent) {\n      /** @type {UIEvent} */ (this.originalEvent).preventDefault();\n    }\n  }\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @api\n   */\n  stopPropagation() {\n    super.stopPropagation();\n    if ('stopPropagation' in this.originalEvent) {\n      /** @type {UIEvent} */ (this.originalEvent).stopPropagation();\n    }\n  }\n}\n\nexport default MapBrowserEvent;\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel',\n};\n\n/***\n * @typedef {'singleclick'|'click'|'dblclick'|'pointerdrag'|'pointermove'} Types\n */\n","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/Map~Map} for which events trigger a map event.\n */\nclass MapEvent extends Event {\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./Map.js\").default} map Map.\n   * @param {?import(\"./Map.js\").FrameState} [frameState] Frame state.\n   */\n  constructor(type, map, frameState) {\n    super(type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./Map.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./Map.js\").FrameState}\n     * @api\n     */\n    this.frameState = frameState !== undefined ? frameState : null;\n  }\n}\n\nexport default MapEvent;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend',\n\n  /**\n   * Triggered when loading of additional map data (tiles, images, features) starts.\n   * @event module:ol/MapEvent~MapEvent#loadstart\n   * @api\n   */\n  LOADSTART: 'loadstart',\n\n  /**\n   * Triggered when loading of additional map data has completed.\n   * @event module:ol/MapEvent~MapEvent#loadend\n   * @api\n   */\n  LOADEND: 'loadend',\n};\n\n/***\n * @typedef {'postrender'|'movestart'|'moveend'|'loadstart'|'loadend'} Types\n */\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view',\n};\n","/**\n * @module ol/Object\n */\nimport Event from './events/Event.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport {getUid} from './util.js';\nimport {isEmpty} from './obj.js';\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport class ObjectEvent extends Event {\n  /**\n   * @param {string} type The event type.\n   * @param {string} key The property name.\n   * @param {*} oldValue The old value for `key`.\n   */\n  constructor(type, key, oldValue) {\n    super(type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n  }\n}\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *    import(\"./Observable\").OnSignature<import(\"./ObjectEventType\").Types, ObjectEvent, Return> &\n *    import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|import(\"./ObjectEventType\").Types, Return>} ObjectOnSignature\n */\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable~Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nclass BaseObject extends Observable {\n  /**\n   * @param {Object<string, *>} [values] An object with key-value pairs.\n   */\n  constructor(values) {\n    super();\n\n    /***\n     * @type {ObjectOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ObjectOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ObjectOnSignature<void>}\n     */\n    this.un;\n\n    // Call {@link module:ol/util.getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {Object<string, *>}\n     */\n    this.values_ = null;\n\n    if (values !== undefined) {\n      this.setProperties(values);\n    }\n  }\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  get(key) {\n    let value;\n    if (this.values_ && this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  }\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  getKeys() {\n    return (this.values_ && Object.keys(this.values_)) || [];\n  }\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  getProperties() {\n    return (this.values_ && Object.assign({}, this.values_)) || {};\n  }\n\n  /**\n   * @return {boolean} The object has properties.\n   */\n  hasProperties() {\n    return !!this.values_;\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  notify(key, oldValue) {\n    let eventType;\n    eventType = `change:${key}`;\n    if (this.hasListener(eventType)) {\n      this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    }\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    if (this.hasListener(eventType)) {\n      this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    }\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {import(\"./events.js\").Listener} listener Listener.\n   */\n  addChangeListener(key, listener) {\n    this.addEventListener(`change:${key}`, listener);\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {import(\"./events.js\").Listener} listener Listener.\n   */\n  removeChangeListener(key, listener) {\n    this.removeEventListener(`change:${key}`, listener);\n  }\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean} [silent] Update without triggering an event.\n   * @api\n   */\n  set(key, value, silent) {\n    const values = this.values_ || (this.values_ = {});\n    if (silent) {\n      values[key] = value;\n    } else {\n      const oldValue = values[key];\n      values[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean} [silent] Update without triggering an event.\n   * @api\n   */\n  setProperties(values, silent) {\n    for (const key in values) {\n      this.set(key, values[key], silent);\n    }\n  }\n\n  /**\n   * Apply any properties from another object without triggering events.\n   * @param {BaseObject} source The source object.\n   * @protected\n   */\n  applyProperties(source) {\n    if (!source.values_) {\n      return;\n    }\n    Object.assign(this.values_ || (this.values_ = {}), source.values_);\n  }\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean} [silent] Unset without triggering an event.\n   * @api\n   */\n  unset(key, silent) {\n    if (this.values_ && key in this.values_) {\n      const oldValue = this.values_[key];\n      delete this.values_[key];\n      if (isEmpty(this.values_)) {\n        this.values_ = null;\n      }\n      if (!silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n}\n\nexport default BaseObject;\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange',\n};\n\n/**\n * @typedef {'propertychange'} Types\n */\n","/**\n * @module ol/Observable\n */\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport {listen, listenOnce, unlistenByKey} from './events.js';\n\n/***\n * @template {string} Type\n * @template {Event|import(\"./events/Event.js\").default} EventClass\n * @template Return\n * @typedef {(type: Type, listener: (event: EventClass) => ?) => Return} OnSignature\n */\n\n/***\n * @template {string} Type\n * @template Return\n * @typedef {(type: Type[], listener: (event: Event|import(\"./events/Event\").default) => ?) => Return extends void ? void : Return[]} CombinedOnSignature\n */\n\n/**\n * @typedef {'change'|'error'} EventTypes\n */\n\n/***\n * @template Return\n * @typedef {OnSignature<EventTypes, import(\"./events/Event.js\").default, Return> & CombinedOnSignature<EventTypes, Return>} ObservableOnSignature\n */\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").default\n * @api\n */\nclass Observable extends EventTarget {\n  constructor() {\n    super();\n\n    this.on =\n      /** @type {ObservableOnSignature<import(\"./events\").EventsKey>} */ (\n        this.onInternal\n      );\n\n    this.once =\n      /** @type {ObservableOnSignature<import(\"./events\").EventsKey>} */ (\n        this.onceInternal\n      );\n\n    this.un = /** @type {ObservableOnSignature<void>} */ (this.unInternal);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n  }\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  changed() {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  getRevision() {\n    return this.revision_;\n  }\n\n  /**\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Event key.\n   * @protected\n   */\n  onInternal(type, listener) {\n    if (Array.isArray(type)) {\n      const len = type.length;\n      const keys = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    }\n    return listen(this, /** @type {string} */ (type), listener);\n  }\n\n  /**\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Event key.\n   * @protected\n   */\n  onceInternal(type, listener) {\n    let key;\n    if (Array.isArray(type)) {\n      const len = type.length;\n      key = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        key[i] = listenOnce(this, type[i], listener);\n      }\n    } else {\n      key = listenOnce(this, /** @type {string} */ (type), listener);\n    }\n    /** @type {Object} */ (listener).ol_key = key;\n    return key;\n  }\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type Type.\n   * @param {function((Event|import(\"./events/Event\").default)): ?} listener Listener.\n   * @protected\n   */\n  unInternal(type, listener) {\n    const key = /** @type {Object} */ (listener).ol_key;\n    if (key) {\n      unByKey(key);\n    } else if (Array.isArray(type)) {\n      for (let i = 0, ii = type.length; i < ii; ++i) {\n        this.removeEventListener(type[i], listener);\n      }\n    } else {\n      this.removeEventListener(type, listener);\n    }\n  }\n}\n\n/**\n * Listen for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.on;\n\n/**\n * Listen once for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n *     called with an array of event types as the first argument, the return\n *     will be an array of keys.\n * @api\n */\nObservable.prototype.once;\n\n/**\n * Unlisten for a certain type of event.\n * @function\n * @param {string|Array<string>} type The event type or array of event types.\n * @param {function((Event|import(\"./events/Event\").default)): ?} listener The listener function.\n * @api\n */\nObservable.prototype.un;\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\nexport default Observable;\n","/**\n * @module ol/Tile\n */\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport TileState from './TileState.js';\nimport {abstract} from './util.js';\nimport {easeIn} from './easing.js';\n\n/**\n * A function that takes an {@link module:ol/Tile~Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState.js';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   const xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     const data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string): void} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~TileSource} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection~Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {boolean} [interpolate=false] Use interpolated values when resampling.  By default,\n * the nearest neighbor is used when resampling.\n * @api\n */\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nclass Tile extends EventTarget {\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {Options} [options] Tile options.\n   */\n  constructor(tileCoord, state, options) {\n    super();\n\n    options = options ? options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {import(\"./TileState.js\").default}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ =\n      options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n    /**\n     * @type {boolean}\n     */\n    this.interpolate = !!options.interpolate;\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Called by the tile cache when the tile is removed from the cache due to expiry\n   */\n  release() {\n    if (this.state === TileState.ERROR) {\n      // to remove the `change` listener on this tile in `ol/TileQueue#handleTileChange`\n      this.setState(TileState.EMPTY);\n    }\n  }\n\n  /**\n   * @return {string} Key.\n   */\n  getKey() {\n    return this.key + '/' + this.tileCoord;\n  }\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  getInterimTile() {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    let tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        // Show tile immediately instead of fading it in after loading, because\n        // the interim tile is in place already\n        this.transition_ = 0;\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  }\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  refreshInterimChain() {\n    if (!this.interimTile) {\n      return;\n    }\n\n    let tile = this.interimTile;\n\n    /**\n     * @type {Tile}\n     */\n    let prev = this;\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  }\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  getTileCoord() {\n    return this.tileCoord;\n  }\n\n  /**\n   * @return {import(\"./TileState.js\").default} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @api\n   */\n  setState(state) {\n    if (this.state !== TileState.ERROR && this.state > state) {\n      throw new Error('Tile load sequence violation');\n    }\n    this.state = state;\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  load() {\n    abstract();\n  }\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  getAlpha(id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    let start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    const delta = time - start + 1000 / 60; // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  }\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  inTransition(id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  }\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  endTransition(id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  }\n}\n\nexport default Tile;\n","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nclass TileCache extends LRUCache {\n  clear() {\n    while (this.getCount() > 0) {\n      this.pop().release();\n    }\n    super.clear();\n  }\n\n  /**\n   * @param {!Object<string, boolean>} usedTiles Used tiles.\n   */\n  expireCache(usedTiles) {\n    while (this.canExpireCache()) {\n      const tile = this.peekLast();\n      if (tile.getKey() in usedTiles) {\n        break;\n      } else {\n        this.pop().release();\n      }\n    }\n  }\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  pruneExceptNewestZ() {\n    if (this.getCount() === 0) {\n      return;\n    }\n    const key = this.peekFirstKey();\n    const tileCoord = fromKey(key);\n    const z = tileCoord[0];\n    this.forEach((tile) => {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.release();\n      }\n    });\n  }\n}\n\nexport default TileCache;\n","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nclass TileRange {\n  /**\n   * @param {number} minX Minimum X.\n   * @param {number} maxX Maximum X.\n   * @param {number} minY Minimum Y.\n   * @param {number} maxY Maximum Y.\n   */\n  constructor(minX, maxX, minY, maxY) {\n    /**\n     * @type {number}\n     */\n    this.minX = minX;\n\n    /**\n     * @type {number}\n     */\n    this.maxX = maxX;\n\n    /**\n     * @type {number}\n     */\n    this.minY = minY;\n\n    /**\n     * @type {number}\n     */\n    this.maxY = maxY;\n  }\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @return {boolean} Contains tile coordinate.\n   */\n  contains(tileCoord) {\n    return this.containsXY(tileCoord[1], tileCoord[2]);\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Contains.\n   */\n  containsTileRange(tileRange) {\n    return (\n      this.minX <= tileRange.minX &&\n      tileRange.maxX <= this.maxX &&\n      this.minY <= tileRange.minY &&\n      tileRange.maxY <= this.maxY\n    );\n  }\n\n  /**\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @return {boolean} Contains coordinate.\n   */\n  containsXY(x, y) {\n    return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Equals.\n   */\n  equals(tileRange) {\n    return (\n      this.minX == tileRange.minX &&\n      this.minY == tileRange.minY &&\n      this.maxX == tileRange.maxX &&\n      this.maxY == tileRange.maxY\n    );\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   */\n  extend(tileRange) {\n    if (tileRange.minX < this.minX) {\n      this.minX = tileRange.minX;\n    }\n    if (tileRange.maxX > this.maxX) {\n      this.maxX = tileRange.maxX;\n    }\n    if (tileRange.minY < this.minY) {\n      this.minY = tileRange.minY;\n    }\n    if (tileRange.maxY > this.maxY) {\n      this.maxY = tileRange.maxY;\n    }\n  }\n\n  /**\n   * @return {number} Height.\n   */\n  getHeight() {\n    return this.maxY - this.minY + 1;\n  }\n\n  /**\n   * @return {import(\"./size.js\").Size} Size.\n   */\n  getSize() {\n    return [this.getWidth(), this.getHeight()];\n  }\n\n  /**\n   * @return {number} Width.\n   */\n  getWidth() {\n    return this.maxX - this.minX + 1;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Intersects.\n   */\n  intersects(tileRange) {\n    return (\n      this.minX <= tileRange.maxX &&\n      this.maxX >= tileRange.minX &&\n      this.minY <= tileRange.maxY &&\n      this.maxY >= tileRange.minY\n    );\n  }\n}\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange} [tileRange] TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  }\n  return new TileRange(minX, maxX, minY, maxY);\n}\n\nexport default TileRange;\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation',\n};\n","/**\n * @module ol/View\n */\nimport BaseObject from './Object.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {\n  METERS_PER_UNIT,\n  createProjection,\n  disableCoordinateWarning,\n  fromUserCoordinate,\n  fromUserExtent,\n  getUserProjection,\n  toUserCoordinate,\n  toUserExtent,\n} from './proj.js';\nimport {VOID} from './functions.js';\nimport {\n  add as addCoordinate,\n  equals as coordinatesEqual,\n  equals,\n  rotate as rotateCoordinate,\n} from './coordinate.js';\nimport {assert} from './asserts.js';\nimport {none as centerNone, createExtent} from './centerconstraint.js';\nimport {clamp, modulo} from './math.js';\nimport {\n  createMinMaxResolution,\n  createSnapToPower,\n  createSnapToResolutions,\n} from './resolutionconstraint.js';\nimport {\n  createSnapToN,\n  createSnapToZero,\n  disable,\n  none as rotationNone,\n} from './rotationconstraint.js';\nimport {easeOut, inAndOut} from './easing.js';\nimport {\n  getCenter,\n  getForViewAndSize,\n  getHeight,\n  getWidth,\n  isEmpty,\n} from './extent.js';\nimport {linearFindNearest} from './array.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter] Source center.\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter] Target center.\n * @property {number} [sourceResolution] Source resolution.\n * @property {number} [targetResolution] Target resolution.\n * @property {number} [sourceRotation] Source rotation.\n * @property {number} [targetRotation] Target rotation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Anchor.\n * @property {number} start Start.\n * @property {number} duration Duration.\n * @property {boolean} complete Complete.\n * @property {function(number):number} easing Easing.\n * @property {function(boolean):void} callback Callback.\n */\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center Center.\n * @property {import(\"./resolutionconstraint.js\").Type} resolution Resolution.\n * @property {import(\"./rotationconstraint.js\").Type} rotation Rotation.\n */\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [nearest=false] If the view `constrainResolution` option is `true`,\n * get the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing.inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean):void} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. If a user projection is not set, the coordinate system for the center is\n * specified with the `projection` option. Layer sources will not be fetched if this\n * is not set, but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * view, in other words, nothing outside of this extent can be visible on the map.\n * @property {boolean} [constrainOnlyCenter=false] If true, the extent\n * constraint will only apply to the view center and not the whole extent.\n * @property {boolean} [smoothExtentConstraint=true] If true, the extent\n * constraint will be applied smoothly, i.e. allow the view to go slightly outside\n * of the given `extent`.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {boolean} [multiWorld=false] If `false` the view is constrained so\n * only one world is visible, and you cannot pan off the edge.  If `true` the map\n * may show multiple worlds at low zoom levels.  Only used if the `projection` is\n * global.  Note that if `extent` is also provided it is given precedence.\n * @property {boolean} [constrainResolution=false] If true, the view will always\n * animate to the closest zoom level after an interaction; false means\n * intermediary zoom levels are allowed.\n * @property {boolean} [smoothResolutionConstraint=true] If true, the resolution\n * min/max values will be applied smoothly, i. e. allow the view to exceed slightly\n * the given resolution or zoom bounds.\n * @property {boolean} [showFullExtent=false] Allow the view to be zoomed out to\n * show the full configured extent. By default, when a view is configured with an\n * extent, users will not be able to zoom out so the viewport exceeds the extent in\n * either dimension. This means the full extent may not be visible if the viewport\n * is taller or wider than the aspect ratio of the configured extent. If\n * showFullExtent is true, the user will be able to zoom out so that the viewport\n * exceeds the height or width of the configured extent, but not both, allowing the\n * full extent to be shown.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions that determine the\n * zoom levels if specified. The index in the array corresponds to the zoom level,\n * therefore the resolution values have to be in descending order. It also constrains\n * the resolution by the minimum and maximum value. If set the `maxResolution`,\n * `minResolution`, `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view.\n * @property {number} [zoomFactor=2] The zoom factor used to compute the\n * corresponding resolution.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in css pixels).\n * If the map viewport is partially covered with other content (overlays) along\n * its edges, this setting allows to shift the center of the viewport away from\n * that content. The order of the values is top, right, bottom, left.\n */\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remain fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing.inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center Center.\n * @property {import(\"./proj/Projection.js\").default} projection Projection.\n * @property {number} resolution Resolution.\n * @property {import(\"./coordinate.js\").Coordinate} [nextCenter] The next center during an animation series.\n * @property {number} [nextResolution] The next resolution during an animation series.\n * @property {number} [nextRotation] The next rotation during an animation series.\n * @property {number} rotation Rotation.\n * @property {number} zoom Zoom.\n */\n\n/**\n * Like {@link import(\"./Map.js\").FrameState}, but just `viewState` and `extent`.\n * @typedef {Object} ViewStateAndExtent\n * @property {State} viewState View state.\n * @property {import(\"./extent.js\").Extent} extent Extent.\n */\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:center'|'change:resolution'|'change:rotation'} ViewObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return> &\n *   import(\"./Observable\").OnSignature<ViewObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|ViewObjectEventTypes, Return>} ViewOnSignature\n */\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * A View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Web Mercator (EPSG:3857).\n *\n * ### The view states\n *\n * A View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * The `zoom` state is actually not saved on the view: all computations\n * internally use the `resolution` state. Still, the `setZoom` and `getZoom`\n * methods are available, as well as `getResolutionForZoom` and\n * `getZoomForResolution` to switch from one system to the other.\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view, but any constraint defined in the constructor will\n * be applied along the way.\n *\n * A View object can have a *resolution constraint*, a *rotation constraint*\n * and a *center constraint*.\n *\n * The *resolution constraint* typically restricts min/max values and\n * snaps to specific resolutions. It is determined by the following\n * options: `resolutions`, `maxResolution`, `maxZoom` and `zoomFactor`.\n * If `resolutions` is set, the other three options are ignored. See\n * documentation for each option for more information. By default, the view\n * only has a min/max restriction and allow intermediary zoom levels when\n * pinch-zooming for example.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default rotation is allowed and its value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the view center is not constrained at all.\n *\n * ### Changing the view state\n *\n * It is important to note that `setZoom`, `setResolution`, `setCenter` and\n * `setRotation` are subject to the above mentioned constraints. As such, it\n * may sometimes not be possible to know in advance the resulting state of the\n * View. For example, calling `setResolution(10)` does not guarantee that\n * `getResolution()` will return `10`.\n *\n * A consequence of this is that, when applying a delta on the view state, one\n * should use `adjustCenter`, `adjustRotation`, `adjustZoom` and `adjustResolution`\n * rather than the corresponding setters. This will let view do its internal\n * computations. Besides, the `adjust*` methods also take an `anchor`\n * argument which allows specifying an origin for the transformation.\n *\n * ### Interacting with the view\n *\n * View constraints are usually only applied when the view is *at rest*, meaning that\n * no interaction or animation is ongoing. As such, if the user puts the view in a\n * state that is not equivalent to a constrained one (e.g. rotating the view when\n * the snap angle is 0), an animation will be triggered at the interaction end to\n * put back the view to a stable state;\n *\n * @api\n */\nclass View extends BaseObject {\n  /**\n   * @param {ViewOptions} [options] View options.\n   */\n  constructor(options) {\n    super();\n\n    /***\n     * @type {ViewOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {ViewOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {ViewOnSignature<void>}\n     */\n    this.un;\n\n    options = Object.assign({}, options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    /**\n     * @private\n     * @type {import(\"./size.js\").Size}\n     */\n    this.viewportSize_ = [100, 100];\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate|undefined}\n     */\n    this.targetCenter_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetResolution_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetRotation_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate}\n     */\n    this.nextCenter_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.nextResolution_;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.nextRotation_;\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate|undefined}\n     */\n    this.cancelAnchor_ = undefined;\n\n    if (options.projection) {\n      disableCoordinateWarning();\n    }\n    if (options.center) {\n      options.center = fromUserCoordinate(options.center, this.projection_);\n    }\n    if (options.extent) {\n      options.extent = fromUserExtent(options.extent, this.projection_);\n    }\n\n    this.applyOptions_(options);\n  }\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  applyOptions_(options) {\n    const properties = Object.assign({}, options);\n    for (const key in ViewProperty) {\n      delete properties[key];\n    }\n    this.setProperties(properties, true);\n\n    const resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @type {Array<number>|undefined}\n     * @private\n     */\n    this.padding_ = options.padding;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    const centerConstraint = createCenterConstraint(options);\n    const resolutionConstraint = resolutionConstraintInfo.constraint;\n    const rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint,\n    };\n\n    this.setRotation(options.rotation !== undefined ? options.rotation : 0);\n    this.setCenterInternal(\n      options.center !== undefined ? options.center : null\n    );\n    if (options.resolution !== undefined) {\n      this.setResolution(options.resolution);\n    } else if (options.zoom !== undefined) {\n      this.setZoom(options.zoom);\n    }\n  }\n\n  /**\n   * Padding (in css pixels).\n   * If the map viewport is partially covered with other content (overlays) along\n   * its edges, this setting allows to shift the center of the viewport away from that\n   * content. The order of the values in the array is top, right, bottom, left.\n   * The default is no padding, which is equivalent to `[0, 0, 0, 0]`.\n   * @type {Array<number>|undefined}\n   * @api\n   */\n  get padding() {\n    return this.padding_;\n  }\n  set padding(padding) {\n    let oldPadding = this.padding_;\n    this.padding_ = padding;\n    const center = this.getCenterInternal();\n    if (center) {\n      const newPadding = padding || [0, 0, 0, 0];\n      oldPadding = oldPadding || [0, 0, 0, 0];\n      const resolution = this.getResolution();\n      const offsetX =\n        (resolution / 2) *\n        (newPadding[3] - oldPadding[3] + oldPadding[1] - newPadding[1]);\n      const offsetY =\n        (resolution / 2) *\n        (newPadding[0] - oldPadding[0] + oldPadding[2] - newPadding[2]);\n      this.setCenterInternal([center[0] + offsetX, center[1] - offsetY]);\n    }\n  }\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  getUpdatedOptions_(newOptions) {\n    const options = this.getProperties();\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenterInternal();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return Object.assign({}, options, newOptions);\n  }\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  animate(var_args) {\n    if (this.isDef() && !this.getAnimating()) {\n      this.resolveConstraints(0);\n    }\n    const args = new Array(arguments.length);\n    for (let i = 0; i < args.length; ++i) {\n      let options = arguments[i];\n      if (options.center) {\n        options = Object.assign({}, options);\n        options.center = fromUserCoordinate(\n          options.center,\n          this.getProjection()\n        );\n      }\n      if (options.anchor) {\n        options = Object.assign({}, options);\n        options.anchor = fromUserCoordinate(\n          options.anchor,\n          this.getProjection()\n        );\n      }\n      args[i] = options;\n    }\n    this.animateInternal.apply(this, args);\n  }\n\n  /**\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation options.\n   */\n  animateInternal(var_args) {\n    let animationCount = arguments.length;\n    let callback;\n    if (\n      animationCount > 1 &&\n      typeof arguments[animationCount - 1] === 'function'\n    ) {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n\n    let i = 0;\n    for (; i < animationCount && !this.isDef(); ++i) {\n      // if view properties are not yet set, shortcut to the final state\n      const state = arguments[i];\n      if (state.center) {\n        this.setCenterInternal(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      } else if (state.resolution) {\n        this.setResolution(state.resolution);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n    }\n    if (i === animationCount) {\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n\n    let start = Date.now();\n    let center = this.targetCenter_.slice();\n    let resolution = this.targetResolution_;\n    let rotation = this.targetRotation_;\n    const series = [];\n    for (; i < animationCount; ++i) {\n      const options = /** @type {AnimationOptions} */ (arguments[i]);\n\n      const animation = {\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut,\n        callback: callback,\n      };\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center.slice();\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.getResolutionForZoom(options.zoom);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        const delta =\n          modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  }\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  getAnimating() {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  }\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  getInteracting() {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  }\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  cancelAnimations() {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    let anchor;\n    for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n      const series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n      if (!anchor) {\n        for (let j = 0, jj = series.length; j < jj; ++j) {\n          const animation = series[j];\n          if (!animation.complete) {\n            anchor = animation.anchor;\n            break;\n          }\n        }\n      }\n    }\n    this.animations_.length = 0;\n    this.cancelAnchor_ = anchor;\n    this.nextCenter_ = null;\n    this.nextResolution_ = NaN;\n    this.nextRotation_ = NaN;\n  }\n\n  /**\n   * Update all animations.\n   */\n  updateAnimations_() {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    const now = Date.now();\n    let more = false;\n    for (let i = this.animations_.length - 1; i >= 0; --i) {\n      const series = this.animations_[i];\n      let seriesComplete = true;\n      for (let j = 0, jj = series.length; j < jj; ++j) {\n        const animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        const elapsed = now - animation.start;\n        let fraction =\n          animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        const progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          const x0 = animation.sourceCenter[0];\n          const y0 = animation.sourceCenter[1];\n          const x1 = animation.targetCenter[0];\n          const y1 = animation.targetCenter[1];\n          this.nextCenter_ = animation.targetCenter;\n          const x = x0 + progress * (x1 - x0);\n          const y = y0 + progress * (y1 - y0);\n          this.targetCenter_ = [x, y];\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          const resolution =\n            progress === 1\n              ? animation.targetResolution\n              : animation.sourceResolution +\n                progress *\n                  (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            const size = this.getViewportSize_(this.getRotation());\n            const constrainedResolution = this.constraints_.resolution(\n              resolution,\n              0,\n              size,\n              true\n            );\n            this.targetCenter_ = this.calculateCenterZoom(\n              constrainedResolution,\n              animation.anchor\n            );\n          }\n          this.nextResolution_ = animation.targetResolution;\n          this.targetResolution_ = resolution;\n          this.applyTargetState_(true);\n        }\n        if (\n          animation.sourceRotation !== undefined &&\n          animation.targetRotation !== undefined\n        ) {\n          const rotation =\n            progress === 1\n              ? modulo(animation.targetRotation + Math.PI, 2 * Math.PI) -\n                Math.PI\n              : animation.sourceRotation +\n                progress *\n                  (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            const constrainedRotation = this.constraints_.rotation(\n              rotation,\n              true\n            );\n            this.targetCenter_ = this.calculateCenterRotate(\n              constrainedRotation,\n              animation.anchor\n            );\n          }\n          this.nextRotation_ = animation.targetRotation;\n          this.targetRotation_ = rotation;\n        }\n        this.applyTargetState_(true);\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        this.nextCenter_ = null;\n        this.nextResolution_ = NaN;\n        this.nextRotation_ = NaN;\n        const callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(\n        this.updateAnimations_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  calculateCenterRotate(rotation, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  }\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  calculateCenterZoom(resolution, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    const currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      const x =\n        anchor[0] -\n        (resolution * (anchor[0] - currentCenter[0])) / currentResolution;\n      const y =\n        anchor[1] -\n        (resolution * (anchor[1] - currentCenter[1])) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  }\n\n  /**\n   * Returns the current viewport size.\n   * @private\n   * @param {number} [rotation] Take into account the rotation of the viewport when giving the size\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  getViewportSize_(rotation) {\n    const size = this.viewportSize_;\n    if (rotation) {\n      const w = size[0];\n      const h = size[1];\n      return [\n        Math.abs(w * Math.cos(rotation)) + Math.abs(h * Math.sin(rotation)),\n        Math.abs(w * Math.sin(rotation)) + Math.abs(h * Math.cos(rotation)),\n      ];\n    }\n    return size;\n  }\n\n  /**\n   * Stores the viewport size on the view. The viewport size is not read every time from the DOM\n   * to avoid performance hit and layout reflow.\n   * This should be done on map size change.\n   * Note: the constraints are not resolved during an animation to avoid stopping it\n   * @param {import(\"./size.js\").Size} [size] Viewport size; if undefined, [100, 100] is assumed\n   */\n  setViewportSize(size) {\n    this.viewportSize_ = Array.isArray(size) ? size.slice() : [100, 100];\n    if (!this.getAnimating()) {\n      this.resolveConstraints(0);\n    }\n  }\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  getCenter() {\n    const center = this.getCenterInternal();\n    if (!center) {\n      return center;\n    }\n    return toUserCoordinate(center, this.getProjection());\n  }\n\n  /**\n   * Get the view center without transforming to user projection.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   */\n  getCenterInternal() {\n    return /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (\n      this.get(ViewProperty.CENTER)\n    );\n  }\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  getConstraints() {\n    return this.constraints_;\n  }\n\n  /**\n   * @return {boolean} Resolution constraint is set\n   */\n  getConstrainResolution() {\n    return this.get('constrainResolution');\n  }\n\n  /**\n   * @param {Array<number>} [hints] Destination array.\n   * @return {Array<number>} Hint.\n   */\n  getHints(hints) {\n    if (hints !== undefined) {\n      hints[0] = this.hints_[0];\n      hints[1] = this.hints_[1];\n      return hints;\n    }\n    return this.hints_.slice();\n  }\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size. If not provided, the size\n   * of the map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  calculateExtent(size) {\n    const extent = this.calculateExtentInternal(size);\n    return toUserExtent(extent, this.getProjection());\n  }\n\n  /**\n   * @param {import(\"./size.js\").Size} [size] Box pixel size. If not provided,\n   * the map's last known viewport size will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  calculateExtentInternal(size) {\n    size = size || this.getViewportSizeMinusPadding_();\n    const center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (\n      this.getCenterInternal()\n    );\n    assert(center, 1); // The view center is not defined\n    const resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    const rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  }\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  getMaxResolution() {\n    return this.maxResolution_;\n  }\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  getMinResolution() {\n    return this.minResolution_;\n  }\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  getMaxZoom() {\n    return /** @type {number} */ (\n      this.getZoomForResolution(this.minResolution_)\n    );\n  }\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  setMaxZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  }\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  getMinZoom() {\n    return /** @type {number} */ (\n      this.getZoomForResolution(this.maxResolution_)\n    );\n  }\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  setMinZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  }\n\n  /**\n   * Set whether the view should allow intermediary zoom levels.\n   * @param {boolean} enabled Whether the resolution is constrained.\n   * @api\n   */\n  setConstrainResolution(enabled) {\n    this.applyOptions_(this.getUpdatedOptions_({constrainResolution: enabled}));\n  }\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  getProjection() {\n    return this.projection_;\n  }\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  getResolution() {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  }\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  getResolutionForExtent(extent, size) {\n    return this.getResolutionForExtentInternal(\n      fromUserExtent(extent, this.getProjection()),\n      size\n    );\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size} [size] Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   */\n  getResolutionForExtentInternal(extent, size) {\n    size = size || this.getViewportSizeMinusPadding_();\n    const xResolution = getWidth(extent) / size[0];\n    const yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  }\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number} [power] Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  getResolutionForValueFunction(power) {\n    power = power || 2;\n    const maxResolution = this.getConstrainedResolution(this.maxResolution_);\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function (value) {\n        const resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      }\n    );\n  }\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  getRotation() {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  }\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number} [power] Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  getValueForResolutionFunction(power) {\n    const logPower = Math.log(power || 2);\n    const maxResolution = this.getConstrainedResolution(this.maxResolution_);\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / logPower;\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function (resolution) {\n        const value = Math.log(maxResolution / resolution) / logPower / max;\n        return value;\n      }\n    );\n  }\n\n  /**\n   * Returns the size of the viewport minus padding.\n   * @private\n   * @param {number} [rotation] Take into account the rotation of the viewport when giving the size\n   * @return {import(\"./size.js\").Size} Viewport size reduced by the padding.\n   */\n  getViewportSizeMinusPadding_(rotation) {\n    let size = this.getViewportSize_(rotation);\n    const padding = this.padding_;\n    if (padding) {\n      size = [\n        size[0] - padding[1] - padding[3],\n        size[1] - padding[0] - padding[2],\n      ];\n    }\n    return size;\n  }\n\n  /**\n   * @return {State} View state.\n   */\n  getState() {\n    const projection = this.getProjection();\n    const resolution = this.getResolution();\n    const rotation = this.getRotation();\n    let center = /** @type {import(\"./coordinate.js\").Coordinate} */ (\n      this.getCenterInternal()\n    );\n    const padding = this.padding_;\n    if (padding) {\n      const reducedSize = this.getViewportSizeMinusPadding_();\n      center = calculateCenterOn(\n        center,\n        this.getViewportSize_(),\n        [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],\n        resolution,\n        rotation\n      );\n    }\n    return {\n      center: center.slice(0),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      nextCenter: this.nextCenter_,\n      nextResolution: this.nextResolution_,\n      nextRotation: this.nextRotation_,\n      rotation: rotation,\n      zoom: this.getZoom(),\n    };\n  }\n\n  /**\n   * @return {ViewStateAndExtent} Like `FrameState`, but just `viewState` and `extent`.\n   */\n  getViewStateAndExtent() {\n    return {\n      viewState: this.getState(),\n      extent: this.calculateExtent(),\n    };\n  }\n\n  /**\n   * Get the current zoom level. This method may return non-integer zoom levels\n   * if the view does not constrain the resolution, or if an interaction or\n   * animation is underway.\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  getZoom() {\n    let zoom;\n    const resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  }\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  getZoomForResolution(resolution) {\n    let offset = this.minZoom_ || 0;\n    let max, zoomFactor;\n    if (this.resolutions_) {\n      const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  }\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  getResolutionForZoom(zoom) {\n    if (this.resolutions_) {\n      if (this.resolutions_.length <= 1) {\n        return 0;\n      }\n      const baseLevel = clamp(\n        Math.floor(zoom),\n        0,\n        this.resolutions_.length - 2\n      );\n      const zoomFactor =\n        this.resolutions_[baseLevel] / this.resolutions_[baseLevel + 1];\n      return (\n        this.resolutions_[baseLevel] /\n        Math.pow(zoomFactor, clamp(zoom - baseLevel, 0, 1))\n      );\n    }\n    return (\n      this.maxResolution_ / Math.pow(this.zoomFactor_, zoom - this.minZoom_)\n    );\n  }\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions} [options] Options.\n   * @api\n   */\n  fit(geometryOrExtent, options) {\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    let geometry;\n    assert(\n      Array.isArray(geometryOrExtent) ||\n        typeof (/** @type {?} */ (geometryOrExtent).getSimplifiedGeometry) ===\n          'function',\n      24\n    ); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent), 25); // Cannot fit empty extent provided as `geometry`\n      const extent = fromUserExtent(geometryOrExtent, this.getProjection());\n      geometry = polygonFromExtent(extent);\n    } else if (geometryOrExtent.getType() === 'Circle') {\n      const extent = fromUserExtent(\n        geometryOrExtent.getExtent(),\n        this.getProjection()\n      );\n      geometry = polygonFromExtent(extent);\n      geometry.rotate(this.getRotation(), getCenter(extent));\n    } else {\n      const userProjection = getUserProjection();\n      if (userProjection) {\n        geometry = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (\n          geometryOrExtent\n            .clone()\n            .transform(userProjection, this.getProjection())\n        );\n      } else {\n        geometry = geometryOrExtent;\n      }\n    }\n\n    this.fitInternal(geometry, options);\n  }\n\n  /**\n   * Calculate rotated extent\n   * @param {import(\"./geom/SimpleGeometry.js\").default} geometry The geometry.\n   * @return {import(\"./extent\").Extent} The rotated extent for the geometry.\n   */\n  rotatedExtentForGeometry(geometry) {\n    const rotation = this.getRotation();\n    const cosAngle = Math.cos(rotation);\n    const sinAngle = Math.sin(-rotation);\n    const coords = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    let minRotX = +Infinity;\n    let minRotY = +Infinity;\n    let maxRotX = -Infinity;\n    let maxRotY = -Infinity;\n    for (let i = 0, ii = coords.length; i < ii; i += stride) {\n      const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n    return [minRotX, minRotY, maxRotX, maxRotY];\n  }\n\n  /**\n   * @param {import(\"./geom/SimpleGeometry.js\").default} geometry The geometry.\n   * @param {FitOptions} [options] Options.\n   */\n  fitInternal(geometry, options) {\n    options = options || {};\n    let size = options.size;\n    if (!size) {\n      size = this.getViewportSizeMinusPadding_();\n    }\n    const padding =\n      options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    const nearest = options.nearest !== undefined ? options.nearest : false;\n    let minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.getResolutionForZoom(options.maxZoom);\n    } else {\n      minResolution = 0;\n    }\n\n    const rotatedExtent = this.rotatedExtentForGeometry(geometry);\n\n    // calculate resolution\n    let resolution = this.getResolutionForExtentInternal(rotatedExtent, [\n      size[0] - padding[1] - padding[3],\n      size[1] - padding[0] - padding[2],\n    ]);\n    resolution = isNaN(resolution)\n      ? minResolution\n      : Math.max(resolution, minResolution);\n    resolution = this.getConstrainedResolution(resolution, nearest ? 0 : 1);\n\n    // calculate center\n    const rotation = this.getRotation();\n    const sinAngle = Math.sin(rotation);\n    const cosAngle = Math.cos(rotation);\n    const centerRot = getCenter(rotatedExtent);\n    centerRot[0] += ((padding[1] - padding[3]) / 2) * resolution;\n    centerRot[1] += ((padding[0] - padding[2]) / 2) * resolution;\n    const centerX = centerRot[0] * cosAngle - centerRot[1] * sinAngle;\n    const centerY = centerRot[1] * cosAngle + centerRot[0] * sinAngle;\n    const center = this.getConstrainedCenter([centerX, centerY], resolution);\n    const callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animateInternal(\n        {\n          resolution: resolution,\n          center: center,\n          duration: options.duration,\n          easing: options.easing,\n        },\n        callback\n      );\n    } else {\n      this.targetResolution_ = resolution;\n      this.targetCenter_ = center;\n      this.applyTargetState_(false, true);\n      animationCallback(callback, true);\n    }\n  }\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  centerOn(coordinate, size, position) {\n    this.centerOnInternal(\n      fromUserCoordinate(coordinate, this.getProjection()),\n      size,\n      position\n    );\n  }\n\n  /**\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   */\n  centerOnInternal(coordinate, size, position) {\n    this.setCenterInternal(\n      calculateCenterOn(\n        coordinate,\n        size,\n        position,\n        this.getResolution(),\n        this.getRotation()\n      )\n    );\n  }\n\n  /**\n   * Calculates the shift between map and viewport center.\n   * @param {import(\"./coordinate.js\").Coordinate} center Center.\n   * @param {number} resolution Resolution.\n   * @param {number} rotation Rotation.\n   * @param {import(\"./size.js\").Size} size Size.\n   * @return {Array<number>|undefined} Center shift.\n   */\n  calculateCenterShift(center, resolution, rotation, size) {\n    let centerShift;\n    const padding = this.padding_;\n    if (padding && center) {\n      const reducedSize = this.getViewportSizeMinusPadding_(-rotation);\n      const shiftedCenter = calculateCenterOn(\n        center,\n        size,\n        [reducedSize[0] / 2 + padding[3], reducedSize[1] / 2 + padding[0]],\n        resolution,\n        rotation\n      );\n      centerShift = [\n        center[0] - shiftedCenter[0],\n        center[1] - shiftedCenter[1],\n      ];\n    }\n    return centerShift;\n  }\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  isDef() {\n    return !!this.getCenterInternal() && this.getResolution() !== undefined;\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   * @api\n   */\n  adjustCenter(deltaCoordinates) {\n    const center = toUserCoordinate(this.targetCenter_, this.getProjection());\n    this.setCenter([\n      center[0] + deltaCoordinates[0],\n      center[1] + deltaCoordinates[1],\n    ]);\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   */\n  adjustCenterInternal(deltaCoordinates) {\n    const center = this.targetCenter_;\n    this.setCenterInternal([\n      center[0] + deltaCoordinates[0],\n      center[1] + deltaCoordinates[1],\n    ]);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  adjustResolution(ratio, anchor) {\n    anchor = anchor && fromUserCoordinate(anchor, this.getProjection());\n    this.adjustResolutionInternal(ratio, anchor);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  adjustResolutionInternal(ratio, anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const size = this.getViewportSize_(this.getRotation());\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_ * ratio,\n      0,\n      size,\n      isMoving\n    );\n\n    if (anchor) {\n      this.targetCenter_ = this.calculateCenterZoom(newResolution, anchor);\n    }\n\n    this.targetResolution_ *= ratio;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Adds a value to the view zoom level, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom level.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  adjustZoom(delta, anchor) {\n    this.adjustResolution(Math.pow(this.zoomFactor_, -delta), anchor);\n  }\n\n  /**\n   * Adds a value to the view rotation, optionally using an anchor. Any rotation\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The rotation center.\n   * @api\n   */\n  adjustRotation(delta, anchor) {\n    if (anchor) {\n      anchor = fromUserCoordinate(anchor, this.getProjection());\n    }\n    this.adjustRotationInternal(delta, anchor);\n  }\n\n  /**\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The rotation center.\n   */\n  adjustRotationInternal(delta, anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const newRotation = this.constraints_.rotation(\n      this.targetRotation_ + delta,\n      isMoving\n    );\n    if (anchor) {\n      this.targetCenter_ = this.calculateCenterRotate(newRotation, anchor);\n    }\n    this.targetRotation_ += delta;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the center of the current view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  setCenter(center) {\n    this.setCenterInternal(\n      center ? fromUserCoordinate(center, this.getProjection()) : center\n    );\n  }\n\n  /**\n   * Set the center using the view projection (not the user projection).\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   */\n  setCenterInternal(center) {\n    this.targetCenter_ = center;\n    this.applyTargetState_();\n  }\n\n  /**\n   * @param {import(\"./ViewHint.js\").default} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  setHint(hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  }\n\n  /**\n   * Set the resolution for this view. Any resolution constraint will apply.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  setResolution(resolution) {\n    this.targetResolution_ = resolution;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the rotation for this view. Any rotation constraint will apply.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  setRotation(rotation) {\n    this.targetRotation_ = rotation;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Zoom to a specific zoom level. Any resolution constrain will apply.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  setZoom(zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  }\n\n  /**\n   * Recompute rotation/resolution/center based on target values.\n   * Note: we have to compute rotation first, then resolution and center considering that\n   * parameters can influence one another in case a view extent constraint is present.\n   * @param {boolean} [doNotCancelAnims] Do not cancel animations.\n   * @param {boolean} [forceMoving] Apply constraints as if the view is moving.\n   * @private\n   */\n  applyTargetState_(doNotCancelAnims, forceMoving) {\n    const isMoving =\n      this.getAnimating() || this.getInteracting() || forceMoving;\n\n    // compute rotation\n    const newRotation = this.constraints_.rotation(\n      this.targetRotation_,\n      isMoving\n    );\n    const size = this.getViewportSize_(newRotation);\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_,\n      0,\n      size,\n      isMoving\n    );\n    const newCenter = this.constraints_.center(\n      this.targetCenter_,\n      newResolution,\n      size,\n      isMoving,\n      this.calculateCenterShift(\n        this.targetCenter_,\n        newResolution,\n        newRotation,\n        size\n      )\n    );\n\n    if (this.get(ViewProperty.ROTATION) !== newRotation) {\n      this.set(ViewProperty.ROTATION, newRotation);\n    }\n    if (this.get(ViewProperty.RESOLUTION) !== newResolution) {\n      this.set(ViewProperty.RESOLUTION, newResolution);\n      this.set('zoom', this.getZoom(), true);\n    }\n    if (\n      !newCenter ||\n      !this.get(ViewProperty.CENTER) ||\n      !equals(this.get(ViewProperty.CENTER), newCenter)\n    ) {\n      this.set(ViewProperty.CENTER, newCenter);\n    }\n\n    if (this.getAnimating() && !doNotCancelAnims) {\n      this.cancelAnimations();\n    }\n    this.cancelAnchor_ = undefined;\n  }\n\n  /**\n   * If any constraints need to be applied, an animation will be triggered.\n   * This is typically done on interaction end.\n   * Note: calling this with a duration of 0 will apply the constrained values straight away,\n   * without animation.\n   * @param {number} [duration] The animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  resolveConstraints(duration, resolutionDirection, anchor) {\n    duration = duration !== undefined ? duration : 200;\n    const direction = resolutionDirection || 0;\n\n    const newRotation = this.constraints_.rotation(this.targetRotation_);\n    const size = this.getViewportSize_(newRotation);\n    const newResolution = this.constraints_.resolution(\n      this.targetResolution_,\n      direction,\n      size\n    );\n    const newCenter = this.constraints_.center(\n      this.targetCenter_,\n      newResolution,\n      size,\n      false,\n      this.calculateCenterShift(\n        this.targetCenter_,\n        newResolution,\n        newRotation,\n        size\n      )\n    );\n\n    if (duration === 0 && !this.cancelAnchor_) {\n      this.targetResolution_ = newResolution;\n      this.targetRotation_ = newRotation;\n      this.targetCenter_ = newCenter;\n      this.applyTargetState_();\n      return;\n    }\n\n    anchor = anchor || (duration === 0 ? this.cancelAnchor_ : undefined);\n    this.cancelAnchor_ = undefined;\n\n    if (\n      this.getResolution() !== newResolution ||\n      this.getRotation() !== newRotation ||\n      !this.getCenterInternal() ||\n      !equals(this.getCenterInternal(), newCenter)\n    ) {\n      if (this.getAnimating()) {\n        this.cancelAnimations();\n      }\n\n      this.animateInternal({\n        rotation: newRotation,\n        center: newCenter,\n        resolution: newResolution,\n        duration: duration,\n        easing: easeOut,\n        anchor: anchor,\n      });\n    }\n  }\n\n  /**\n   * Notify the View that an interaction has started.\n   * The view state will be resolved to a stable one if needed\n   * (depending on its constraints).\n   * @api\n   */\n  beginInteraction() {\n    this.resolveConstraints(0);\n\n    this.setHint(ViewHint.INTERACTING, 1);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number} [duration] Animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   * @api\n   */\n  endInteraction(duration, resolutionDirection, anchor) {\n    anchor = anchor && fromUserCoordinate(anchor, this.getProjection());\n    this.endInteractionInternal(duration, resolutionDirection, anchor);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number} [duration] Animation duration in ms.\n   * @param {number} [resolutionDirection] Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate} [anchor] The origin of the transformation.\n   */\n  endInteractionInternal(duration, resolutionDirection, anchor) {\n    if (!this.getInteracting()) {\n      return;\n    }\n    this.setHint(ViewHint.INTERACTING, -1);\n    this.resolveConstraints(duration, resolutionDirection, anchor);\n  }\n\n  /**\n   * Get a valid position for the view center according to the current constraints.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} targetCenter Target center position.\n   * @param {number} [targetResolution] Target resolution. If not supplied, the current one will be used.\n   * This is useful to guess a valid center position at a different zoom level.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Valid center position.\n   */\n  getConstrainedCenter(targetCenter, targetResolution) {\n    const size = this.getViewportSize_(this.getRotation());\n    return this.constraints_.center(\n      targetCenter,\n      targetResolution || this.getResolution(),\n      size\n    );\n  }\n\n  /**\n   * Get a valid zoom level according to the current view constraints.\n   * @param {number|undefined} targetZoom Target zoom.\n   * @param {number} [direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid zoom level.\n   */\n  getConstrainedZoom(targetZoom, direction) {\n    const targetRes = this.getResolutionForZoom(targetZoom);\n    return this.getZoomForResolution(\n      this.getConstrainedResolution(targetRes, direction)\n    );\n  }\n\n  /**\n   * Get a valid resolution according to the current view constraints.\n   * @param {number|undefined} targetResolution Target resolution.\n   * @param {number} [direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid resolution.\n   */\n  getConstrainedResolution(targetResolution, direction) {\n    direction = direction || 0;\n    const size = this.getViewportSize_(this.getRotation());\n\n    return this.constraints_.resolution(targetResolution, direction, size);\n  }\n}\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function () {\n    callback(returnValue);\n  }, 0);\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    const smooth =\n      options.smoothExtentConstraint !== undefined\n        ? options.smoothExtentConstraint\n        : true;\n    return createExtent(options.extent, options.constrainOnlyCenter, smooth);\n  }\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  if (options.multiWorld !== true && projection.isGlobal()) {\n    const extent = projection.getExtent().slice();\n    extent[0] = -Infinity;\n    extent[2] = Infinity;\n    return createExtent(extent, false, false);\n  }\n\n  return centerNone;\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom =\n    options.minZoom !== undefined ? options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom =\n    options.maxZoom !== undefined ? options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor =\n    options.zoomFactor !== undefined ? options.zoomFactor : defaultZoomFactor;\n\n  const multiWorld =\n    options.multiWorld !== undefined ? options.multiWorld : false;\n\n  const smooth =\n    options.smoothResolutionConstraint !== undefined\n      ? options.smoothResolutionConstraint\n      : true;\n\n  const showFullExtent =\n    options.showFullExtent !== undefined ? options.showFullExtent : false;\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  const projExtent = projection.getExtent();\n  let constrainOnlyCenter = options.constrainOnlyCenter;\n  let extent = options.extent;\n  if (!multiWorld && !extent && projection.isGlobal()) {\n    constrainOnlyCenter = false;\n    extent = projExtent;\n  }\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution =\n      resolutions[maxZoom] !== undefined\n        ? resolutions[maxZoom]\n        : resolutions[resolutions.length - 1];\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToResolutions(\n        resolutions,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    } else {\n      resolutionConstraint = createMinMaxResolution(\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    }\n  } else {\n    // calculate the default min and max resolution\n    const size = !projExtent\n      ? // use an extent that can fit the whole world if need be\n        (360 * METERS_PER_UNIT.degrees) / projection.getMetersPerUnit()\n      : Math.max(getWidth(projExtent), getHeight(projExtent));\n\n    const defaultMaxResolution =\n      size / DEFAULT_TILE_SIZE / Math.pow(defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution =\n      defaultMaxResolution /\n      Math.pow(defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom =\n      minZoom +\n      Math.floor(\n        Math.log(maxResolution / minResolution) / Math.log(zoomFactor)\n      );\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToPower(\n        zoomFactor,\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    } else {\n      resolutionConstraint = createMinMaxResolution(\n        maxResolution,\n        minResolution,\n        smooth,\n        !constrainOnlyCenter && extent,\n        showFullExtent\n      );\n    }\n  }\n  return {\n    constraint: resolutionConstraint,\n    maxResolution: maxResolution,\n    minResolution: minResolution,\n    minZoom: minZoom,\n    zoomFactor: zoomFactor,\n  };\n}\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation =\n    options.enableRotation !== undefined ? options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    }\n    return rotationNone;\n  }\n  return disable;\n}\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {import(\"./size.js\").Size} size Box pixel size.\n * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @return {import(\"./coordinate.js\").Coordinate} Shifted center.\n */\nfunction calculateCenterOn(coordinate, size, position, resolution, rotation) {\n  // calculate rotated position\n  const cosAngle = Math.cos(-rotation);\n  let sinAngle = Math.sin(-rotation);\n  let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  rotX += (size[0] / 2 - position[0]) * resolution;\n  rotY += (position[1] - size[1] / 2) * resolution;\n\n  // go back to original angle\n  sinAngle = -sinAngle; // go back to original rotation\n  const centerX = rotX * cosAngle - rotY * sinAngle;\n  const centerY = rotY * cosAngle + rotX * sinAngle;\n\n  return [centerX, centerY];\n}\n\nexport default View;\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1,\n};\n"],"names":["earcut","data","holeIndices","dim","minX","minY","maxX","maxY","x","y","invSize","hasHoles","length","outerLen","outerNode","linkedList","triangles","next","prev","eliminateHoles","i","Math","max","earcutLinked","start","end","clockwise","last","signedArea","insertNode","equals","removeNode","filterPoints","again","p","steiner","area","ear","pass","indexCurve","stop","isEarHashed","isEar","push","cureLocalIntersections","splitEarcut","a","b","c","ax","bx","cx","ay","by","cy","x0","y0","x1","y1","pointInTriangle","minZ","zOrder","maxZ","prevZ","n","nextZ","z","intersects","locallyInside","isValidDiagonal","splitPolygon","len","list","queue","getLeftmost","sort","compareX","eliminateHole","hole","bridge","findHoleBridge","bridgeReverse","m","hx","hy","qx","Infinity","tan","mx","my","tanMin","abs","sectorContainsSector","sortLinked","q","e","tail","numMerges","pSize","qSize","inSize","leftmost","px","py","intersectsPolygon","middleInside","r","p1","p2","q1","q2","o1","sign","o2","o3","o4","onSegment","min","num","inside","a2","Node","b2","an","bp","this","sum","j","module","exports","deviation","polygonArea","trianglesArea","flatten","result","vertices","holes","dimensions","holeIndex","d","ol_control_LayerSwitcher","constructor","options","element","className","switcherClass","super","target","self","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","_layerGroup","layerGroup","getLayers","onchangeCheck","displayInLayerSwitcher","classList","add","collapsed","button","type","parent","addEventListener","toggle","dispatchEvent","contains","preventDefault","overflow","mouseover","remove","minibar","noScroll","topv","click","botv","_noScroll","panel_","panelContainer_","html","wheelDelta","detail","stopPropagation","header_","set","drawDelay","selection","setTimeout","mbar","mousewheel","vertical","on","refresh","bind","layer","get","setMap","map","drawPanel","_listener","moveend","viewChange","size","change","getLayerGroup","show","hide","isOpen","setHeader","dir","height","h","hp","dh","offsetTop","top","li","querySelectorAll","lh","round","_setLayerForLI","listeners","setLayerOpacity","setLayerVisibility","key","querySelector","style","left","getOpacity","checked","getVisible","_clearLayerForLI","forEach","l","_getLayerForLI","testLayerVisibility","getPanel","getMap","drawPanel_","dragging_","scrollTop","drawList","switchLayerVisibility","layers","setVisible","res","getView","getResolution","zoom","getZoom","getMaxResolution","getMinResolution","getMinZoom","getMaxZoom","ex0","getExtent","ex","calculateExtent","getSize","dragOrdering_","pageY","dragElt","group","elt","currentTarget","parentNode","panel","pageY0","touches","changedTouches","drop","isSelected","getSelection","collection","getArray","removeAt","insertAt","selectLayer","document","move","innerHTML","position","offsetLeft","opacity","width","elementFromPoint","clientX","clientY","tagName","dragOpacity_","pageX","delta","nextElementSibling","setOpacity","ul","setVisibility","onInfo","zoomExtent","fit","removeLayer","getLength","call","createLi","_selectedLayer","layer_buttons","label","title","userSelect","tip","up","nb","plus","info","setprogress_","layerswitcher_progress","op","offsetX","ul2","getLayerClass","getFeatures","silent","item","loaded","loading","draw","toFixed","getSource","prototype","down","window","ol","ext","input","ol_ext_input_Base","ol_Object","tout","createElement","setAttribute","undefined","step","appendChild","disabled","val","value","hidden","display","clearTimeout","_listenDrag","cback","handle","moving","listen","removeEventListener","setValue","v","Event","getValue","getInputElement","ol_ext_input_Checkbox","Element","trim","insertBefore","after","createTextNode","isChecked","ol_ext_input_Switch","ol_ext_input_Radio","ol_ext_element","attr","test","innerText","text","create","setStyle","addListener","opt","Object","assign","name","eventType","fn","useCapture","split","getStyle","el","st","s","styleProp","defaultView","ownerDocument","getComputedStyle","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","offsetHeight","offsetWidth","rect","getBoundingClientRect","pageYOffset","documentElement","body","pageXOffset","scrollLeft","bottom","right","offset","getOffset","offsetParent","fixed","gleft","gtop","getRect","scale","isbar","scrollContainer","scrollbar","pos","speed","dt","onmove","page","scroll","updateCounter","updateMinibar","updateMinibarDelay","pheight","clientHeight","scrollHeight","onPointerDown","Date","onPointerMove","onPointerUp","animate","to","init","onMouseWheel","removeListener","eventName","event","CustomEvent","createEvent","initCustomEvent","Property","LENGTH","CollectionEvent","index","Collection","array","once","un","unique_","unique","array_","ii","assertUnique_","updateLength_","clear","pop","extend","arr","f","elem","Error","splice","setAt","except","ADD","REMOVE","Disposable","disposed","dispose","disposeInternal","Feature","geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","addChangeListener","handleGeometryChanged_","geometry","setGeometry","properties","setProperties","clone","hasProperties","getProperties","setGeometryName","getGeometryName","getGeometry","getId","getStyleFunction","handleGeometryChange_","changed","createStyleFunction","setId","id","removeChangeListener","obj","styles","Array","isArray","listenImage","image","loadHandler","errorHandler","img","listening","decoding","listenerKeys","src","decode","then","catch","error","IDLE","LOADING","LOADED","ERROR","EMPTY","ImageTile","tileCoord","state","crossOrigin","tileLoadFunction","crossOrigin_","src_","image_","Image","unlisten_","tileLoadFunction_","getImage","setImage","unlistenImage_","handleImageError_","getBlankImage","handleImageLoad_","naturalWidth","naturalHeight","load","ctx","fillStyle","fillRect","canvas","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","begin","update","now","lastIndex","firstIndex","duration","dx","dy","atan2","sqrt","getDistance","getAngle","MapBrowserEventHandler","Target","moveTolerance","map_","clickTimeoutId_","emulateClicks_","dragListenerKeys_","moveTolerance_","down_","getViewport","activePointers_","trackedTouches_","element_","pointerdownListenerKey_","handlePointerDown_","originalPointerMoveEvent_","relayedListenerKey_","relayMoveEvent_","boundHandleTouchMove_","handleTouchMove_","EventType","passive","emulateClick_","pointerEvent","newEvent","MapBrowserEvent","MapBrowserEventType","updateActivePointers_","pointerId","values","handlePointerUp_","defaultPrevented","isMouseActionButton_","PointerEvent","defineProperty","writable","doc","getOwnerDocument","handlePointerMove_","getRootNode","isMoving_","dragging","originalEvent","cancelable","TileQueue","PriorityQueue","tilePriorityFunction","tileChangeCallback","apply","getKey","boundHandleTileChange_","handleTileChange","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","enqueue","added","tile","getTilesLoading","getState","TileState","tileKey","loadMoreTiles","maxTotalLoading","maxNewLoads","newLoads","getCount","dequeue","getTilePriority","frameState","tileSourceKey","tileCenter","tileResolution","wantedTiles","center","viewState","deltaX","deltaY","log","removeLayerMapProperty","Layer","setMapInternal","setLayerMapProperty","Map","optionsInternal","createOptionsInternal","renderComplete_","loaded_","boundHandleBrowserEvent_","handleBrowserEvent","maxTilesLoading_","maxTilesLoading","pixelRatio_","pixelRatio","postRenderTimeoutHandle_","animationDelayKey_","animationDelay_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","frameState_","previousExtent_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","overlayContainer_","zIndex","pointerEvents","overlayContainerStopEvent_","mapBrowserEventHandler_","keyboardEventTarget_","keyboardEventTarget","targetChangeHandlerKeys_","targetElement_","resizeObserver_","ResizeObserver","updateSize","controls","interactions","onFocusOnly","overlays_","overlays","overlayIdIndex_","renderer_","postRenderFunctions_","tileQueue_","handleTileChange_","MapProperty","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","view","View","viewOptions","setView","CollectionEventType","addOverlayInternal_","toString","control","interaction","addControl","getControls","addInteraction","getInteractions","addLayer","handleLayerAdd_","addOverlay","overlay","getOverlays","disconnect","setTarget","forEachFeatureAtPixel","pixel","callback","coordinate","getCoordinateFromPixelInternal","hitTolerance","layerFilter","checkWrapped","forEachFeatureAtCoordinate","getFeaturesAtPixel","features","feature","getAllLayers","addLayersFrom","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","getCoordinateFromPixel","getEventPixel","getEventCoordinateInternal","viewport","viewportPosition","viewportSize","scaleX","scaleY","eventPosition","getTarget","getTargetElement","toUserCoordinate","getProjection","pixelToCoordinateTransform","slice","getOverlayById","setLayers","getLoadingOrNotReady","layerStatesArray","getLayerStatesArray","visible","renderer","getRenderer","ready","source","getPixelFromCoordinate","viewCoordinate","fromUserCoordinate","getPixelFromCoordinateInternal","coordinateToPixelTransform","getOverlayContainer","getOverlayContainerStopEvent","targetElement","browserEvent","mapBrowserEvent","handleMapBrowserEvent","rootNode","interactionsArray","getActive","cont","handleEvent","propagationStopped","handlePostRender","tileQueue","isEmpty","hints","viewHints","ViewHint","lowOnFrameBudget","time","reprioritize","hasListener","dispatchRenderEvent","MapEvent","MapEventType","postRenderFunctions","getAnimating","resolveConstraints","render","unobserve","ShadowRoot","host","getElementById","Composite","observe","cancelAnimationFrame","handleViewPropertyChanged_","updateViewportSize_","ObjectEventType","Group","handleLayerRemove_","isRendered","renderFrame_","renderSync","redrawText","layerStates","hasRenderer","handleFontsChanged","requestAnimationFrame","removeControl","removeInteraction","removeOverlay","previousFrameState","isDef","getHints","declutterTree","resolution","rotation","layerIndex","usedTiles","mapId","renderTargets","nextCenter","nextResolution","isNaN","nextRotation","nextExtent","renderFrame","moveStart","idle","setLayerGroup","oldLayerGroup","setSize","computedStyle","parseFloat","getClientRects","oldSize","setViewportSize","activePointers","pixel_","coordinate_","SINGLECLICK","CLICK","DBLCLICK","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","POSTRENDER","MOVESTART","MOVEEND","LOADSTART","LOADEND","LAYERGROUP","SIZE","TARGET","VIEW","ObjectEvent","oldValue","BaseObject","values_","hasOwnProperty","getKeys","keys","notify","listener","applyProperties","unset","PROPERTYCHANGE","Observable","revision_","getRevision","onInternal","onceInternal","ol_key","unInternal","unByKey","Tile","interimTile","transition_","transition","transitionStarts_","interpolate","release","setState","getInterimTile","refreshInterimChain","getTileCoord","getAlpha","inTransition","endTransition","TileCache","expireCache","canExpireCache","peekLast","pruneExceptNewestZ","peekFirstKey","TileRange","containsXY","containsTileRange","tileRange","getHeight","getWidth","createOrUpdate","CENTER","RESOLUTION","ROTATION","DEFAULT_MIN_ZOOM","hints_","animations_","updateAnimationKey_","projection_","createProjection","projection","viewportSize_","targetCenter_","targetResolution_","targetRotation_","nextCenter_","nextResolution_","nextRotation_","cancelAnchor_","disableCoordinateWarning","fromUserExtent","applyOptions_","ViewProperty","resolutionConstraintInfo","createResolutionConstraint","maxResolution_","maxResolution","minResolution_","minResolution","zoomFactor_","zoomFactor","resolutions_","resolutions","padding_","padding","minZoom_","minZoom","centerConstraint","createCenterConstraint","resolutionConstraint","constraint","rotationConstraint","createRotationConstraint","constraints_","setRotation","setCenterInternal","setResolution","setZoom","oldPadding","getCenterInternal","newPadding","offsetY","getUpdatedOptions_","newOptions","getRotation","var_args","args","arguments","anchor","animateInternal","animationCount","animationCallback","series","animation","complete","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","getResolutionForZoom","sourceRotation","PI","targetRotation","isNoopAnimation","setHint","updateAnimations_","getInteracting","cancelAnimations","jj","NaN","more","seriesComplete","elapsed","fraction","progress","getViewportSize_","constrainedResolution","calculateCenterZoom","applyTargetState_","constrainedRotation","calculateCenterRotate","filter","Boolean","currentCenter","currentResolution","w","cos","sin","getCenter","getConstraints","getConstrainResolution","calculateExtentInternal","toUserExtent","getViewportSizeMinusPadding_","getZoomForResolution","setMaxZoom","maxZoom","setMinZoom","setConstrainResolution","enabled","constrainResolution","getResolutions","getResolutionForExtent","getResolutionForExtentInternal","xResolution","yResolution","getResolutionForValueFunction","power","getConstrainedResolution","pow","getValueForResolutionFunction","logPower","reducedSize","calculateCenterOn","getViewStateAndExtent","nearest","baseLevel","floor","geometryOrExtent","getType","rotate","userProjection","getUserProjection","transform","fitInternal","rotatedExtentForGeometry","cosAngle","sinAngle","coords","getFlatCoordinates","stride","getStride","minRotX","minRotY","maxRotX","maxRotY","rotX","rotY","rotatedExtent","centerRot","centerX","centerY","getConstrainedCenter","centerOn","centerOnInternal","calculateCenterShift","centerShift","shiftedCenter","adjustCenter","deltaCoordinates","setCenter","adjustCenterInternal","adjustResolution","ratio","adjustResolutionInternal","isMoving","newResolution","adjustZoom","adjustRotation","adjustRotationInternal","newRotation","hint","doNotCancelAnims","forceMoving","newCenter","resolutionDirection","direction","beginInteraction","endInteraction","endInteractionInternal","getConstrainedZoom","targetZoom","targetRes","returnValue","smooth","smoothExtentConstraint","constrainOnlyCenter","multiWorld","isGlobal","defaultMaxZoom","defaultZoomFactor","smoothResolutionConstraint","showFullExtent","projExtent","METERS_PER_UNIT","getMetersPerUnit","defaultMaxResolution","defaultMinResolution","enableRotation","constrainRotation","ANIMATING","INTERACTING"],"sourceRoot":""}