{"version":3,"sources":["webpack:///./node_modules/ol-ext/control/LayerSwitcher.js","webpack:///./node_modules/ol-ext/control/Timeline.js","webpack:///./node_modules/ol-ext/util/input/Base.js","webpack:///./node_modules/ol-ext/util/input/Checkbox.js","webpack:///./node_modules/ol-ext/util/input/Switch.js","webpack:///./node_modules/ol-ext/util/input/Radio.js","webpack:///./node_modules/ol-ext/util/element.js","webpack:///./node_modules/mgrs/mgrs.js","webpack:///./node_modules/ol-ext/util/ext.js"],"names":["ol_control_LayerSwitcher","options","element","self","this","dcount","show_progress","oninfo","onextent","hasextent","extent","hastrash","trash","reordering","_layers","_layerGroup","layerGroup","getLayers","onchangeCheck","displayInLayerSwitcher","target","create","className","switcherClass","collapsed","classList","add","button","type","parent","addEventListener","e","toggle","dispatchEvent","contains","preventDefault","overflow","mouseover","remove","minibar","noScroll","topv","click","botv","_noScroll","panel_","panelContainer_","html","addListener","Math","max","min","wheelDelta","detail","stopPropagation","header_","call","set","drawDelay","selection","setTimeout","mbar","scrollDiv","mousewheel","vertical","on","refresh","bind","prototype","tip","up","down","info","plus","layer","get","setMap","map","drawPanel","_listener","i","moveend","viewChange","size","change","getLayerGroup","show","hide","isOpen","setHeader","setHTML","dir","hidden","setStyle","height","h","outerHeight","hp","dh","offsetTop","top","li","querySelectorAll","lh","getStyle","round","_setLayerForLI","listeners","push","setLayerOpacity","setLayerVisibility","key","querySelector","style","left","getOpacity","checked","getVisible","_clearLayerForLI","forEach","l","_getLayerForLI","testLayerVisibility","getPanel","getMap","drawPanel_","dragging_","scrollTop","drawList","switchLayerVisibility","layers","setVisible","res","getView","getResolution","zoom","getZoom","getMaxResolution","getMinResolution","getMinZoom","getMaxZoom","ex0","getExtent","ex","calculateExtent","getSize","dragOrdering_","pageY","dragElt","group","elt","currentTarget","parentNode","start","panel","pageY0","touches","length","changedTouches","stop","drop","isSelected","getSelection","collection","getArray","removeAt","j","insertAt","selectLayer","removeListener","document","move","abs","innerHTML","position","offsetLeft","opacity","width","outerWidth","offsetRect","elementFromPoint","clientX","clientY","tagName","dragOpacity_","x","pageX","delta","nextElementSibling","setOpacity","ul","setVisibility","onInfo","zoomExtent","fit","removeLayer","getLength","createLi","_selectedLayer","layer_buttons","d","label","title","unselectable","userSelect","nb","p","setprogress_","layerswitcher_progress","op","offsetX","ul2","getLayerClass","getFeatures","silent","item","loaded","loading","draw","toFixed","getSource","ol_control_Timeline","zoomButton","_scrollDiv","_buttons","addButton","handleClick","_intervalDiv","_select","scrollListener","_setScrollLeft","clearTimeout","date","getDate","dateStart","dateEnd","scrollTimeout","onmove","b","_moving","_tline","_scrollLeft","maxWidth","minDate","Infinity","maxDate","graduation","minZoom","maxZoom","setInterval","interval","getHTML","_getHTML","getFeatureDate","_getFeatureDate","endFeatureDate","_endFeatureDate","setFeatures","features","source","undefined","test","parseFloat","feature","isCollapsed","collapse","_features","_source","Array","first","d2","tline","f","Date","isNaN","end","sort","a","div","_minDate","_maxDate","isFinite","scale","_scale","_drawTime","line","lineHeight","fdiv","t","img","ondragstart","minWidth","pos","_nbline","setDate","anim","_getOffsetFromDate","_getDateFromOffset","offset","scrollLeft","_getScrollLeft","dt","month","dmonth","tdiv","dx","heigth","year","getFullYear","setFullYear","String","dyear","setMonth","toLocaleDateString","dday","day","offdate","getMonth","indexOf","roundDate","stick","_roundTo","r","getStartDate","getEndDate","window","ol","ext","input","ol_ext_input_Base","ol_Object","tout","createElement","setAttribute","step","appendChild","disabled","val","value","display","_listenDrag","cback","handle","moving","listen","removeEventListener","setValue","v","Event","getValue","getInputElement","ol_ext_input_Checkbox","Element","trim","insertBefore","after","createTextNode","isChecked","ol_ext_input_Switch","ol_ext_input_Radio","ol_ext_element","attr","innerText","text","opt","Object","assign","name","console","log","eventType","fn","useCapture","split","el","st","s","styleProp","defaultView","ownerDocument","getComputedStyle","replace","toLowerCase","getPropertyValue","currentStyle","str","letter","toUpperCase","oldLeft","oldRsLeft","runtimeStyle","pixelLeft","parseInt","offsetHeight","offsetWidth","rect","getBoundingClientRect","pageYOffset","documentElement","body","pageXOffset","bottom","right","getOffset","offsetParent","fixed","gleft","gtop","getRect","isbar","scrollContainer","scrollbar","speed","page","scroll","updateCounter","updateMinibar","updateMinibarDelay","pheight","clientHeight","scrollHeight","onPointerDown","onPointerMove","onPointerUp","animate","to","init","onMouseWheel","eventName","event","CustomEvent","createEvent","initCustomEvent","NUM_100K_SETS","SET_ORIGIN_COLUMN_LETTERS","SET_ORIGIN_ROW_LETTERS","A","I","O","V","Z","forward","ll","accuracy","encode","LLtoUTM","lat","lon","inverse","mgrs","bbox","UTMtoLL","decode","toPoint","degToRad","deg","PI","radToDeg","rad","LongOrigin","eccPrimeSquared","N","T","C","M","LongOriginRad","ZoneNumber","Lat","Long","eccSquared","k0","LatRad","LongRad","floor","sqrt","sin","tan","cos","UTMEasting","UTMNorthing","northing","easting","zoneNumber","zoneLetter","getLetterDesignator","utm","N1","T1","C1","R1","D","mu","phi1Rad","e1","y","pow","result","topRight","LetterDesignator","seasting","snorthing","get100kID","substr","setParm","get100kSetForZone","setColumn","setRow","getLetter100kID","column","row","parm","index","colOrigin","charCodeAt","rowOrigin","colInt","rowInt","rollover","twoLetter","fromCharCode","mgrsString","testChar","hunK","sb","charAt","substring","east100k","getEastingFromChar","north100k","getNorthingFromChar","getMinNorthing","remainder","accuracyBonus","sepEastingString","sepNorthingString","sep","sepEasting","sepNorthing","curCol","eastingValue","rewindMarker","n","curRow","northingValue","ol_ext_inherits","child","constructor","inherits","NodeList","removeChild"],"mappings":"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","file":"js/chunk-54000d26.d1b91c86.js","sourcesContent":["/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \r\n  released under the CeCILL-B license (French BSD license)\r\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\r\n*/\r\nimport ol_ext_inherits from '../util/ext'\r\nimport {unByKey as ol_Observable_unByKey} from 'ol/Observable'\r\nimport ol_control_Control from 'ol/control/Control'\r\nimport ol_layer_Tile from 'ol/layer/Tile'\r\nimport ol_layer_Vector from 'ol/layer/Vector'\r\nimport ol_layer_VectorTile from 'ol/layer/VectorTile'\r\n// ol < 6 compatibility VectorImage is not defined\r\n// import ol_layer_VectorImage from 'ol/layer/VectorImage'\r\nimport ol_layer_Image from 'ol/layer/Image'\r\nimport ol_layer_Heatmap from 'ol/layer/Heatmap'\r\nimport {intersects as ol_extent_intersects} from 'ol/extent'\r\n\r\nimport ol_ext_element from '../util/element'\r\n\r\n/** Layer Switcher Control.\r\n * @fires select\r\n * @fires drawlist\r\n * @fires toggle\r\n * @fires reorder-start\r\n * @fires reorder-end\r\n * @fires layer:visible\r\n * @fires layer:opacity\r\n * \r\n * @constructor\r\n * @extends {ol_control_Control}\r\n * @param {Object=} options\r\n *  @param {boolean} options.selection enable layer selection when click on the title\r\n *  @param {function} options.displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\r\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\r\n *  @param {boolean} options.mouseover show the panel on mouseover, default false\r\n *  @param {boolean} options.reordering allow layer reordering, default true\r\n *  @param {boolean} options.trash add a trash button to delete the layer, default false\r\n *  @param {function} options.oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\r\n *  @param {boolean} options.extent add an extent button to zoom to the extent of the layer\r\n *  @param {function} options.onextent callback when click on extent, default fits view to extent\r\n *  @param {number} options.drawDelay delay in ms to redraw the layer (usefull to prevent flickering when manipulating the layers)\r\n *  @param {boolean} options.collapsed collapse the layerswitcher at beginning, default true\r\n *  @param {ol.layer.Group} options.layerGroup a layer group to display in the switcher, default display all layers of the map\r\n *  @param {boolean} options.noScroll prevent handle scrolling, default false\r\n *  @param {function} options.onchangeCheck optional callback on click on checkbox, you can call this method for doing operations after check/uncheck a layer\r\n *\r\n * Layers attributes that control the switcher\r\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\r\n *\t- displayInLayerSwitcher {boolean} display the layer in switcher, default true\r\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\r\n */\r\nvar ol_control_LayerSwitcher = function(options) {\r\n  options = options || {};\r\n  var self = this;\r\n  this.dcount = 0;\r\n  this.show_progress = options.show_progress;\r\n  this.oninfo = (typeof (options.oninfo) == \"function\" ? options.oninfo: null);\r\n  this.onextent = (typeof (options.onextent) == \"function\" ? options.onextent: null);\r\n  this.hasextent = options.extent || options.onextent;\r\n  this.hastrash = options.trash;\r\n  this.reordering = (options.reordering!==false);\r\n  this._layers = [];\r\n  this._layerGroup = (options.layerGroup && options.layerGroup.getLayers) ? options.layerGroup : null;\r\n  this.onchangeCheck = (typeof (options.onchangeCheck) == \"function\" ? options.onchangeCheck : null);\r\n\r\n  // displayInLayerSwitcher\r\n  if (typeof(options.displayInLayerSwitcher) === 'function') {\r\n    this.displayInLayerSwitcher = options.displayInLayerSwitcher;\r\n  }\r\n\r\n  var element;\r\n  if (options.target) {\r\n    element = ol_ext_element.create('DIV', {\r\n      className: options.switcherClass || \"ol-layerswitcher\"\r\n    });\r\n  } else {\r\n    element = ol_ext_element.create('DIV', {\r\n      className: (options.switcherClass || \"ol-layerswitcher\") +' ol-unselectable ol-control'\r\n    });\r\n    if (options.collapsed !== false) element.classList.add('ol-collapsed'); \r\n    else element.classList.add('ol-forceopen'); \r\n  \r\n    this.button = ol_ext_element.create('BUTTON', {\r\n      type: 'button',\r\n      parent: element\r\n    });\r\n    this.button.addEventListener('touchstart', function(e){\r\n      element.classList.toggle('ol-forceopen');\r\n      element.classList.add('ol-collapsed');\r\n      self.dispatchEvent({ type: 'toggle', collapsed: element.classList.contains('ol-collapsed') });\r\n      e.preventDefault(); \r\n      self.overflow();\r\n    });\r\n    this.button.addEventListener('click', function() {\r\n      element.classList.toggle('ol-forceopen');\r\n      element.classList.add('ol-collapsed'); \r\n      self.dispatchEvent({ type: 'toggle', collapsed: !element.classList.contains('ol-forceopen') });\r\n      self.overflow();\r\n    });\r\n\r\n    if (options.mouseover) {\r\n      element.addEventListener ('mouseleave', function(){ \r\n        element.classList.add(\"ol-collapsed\"); \r\n        self.dispatchEvent({ type: 'toggle', collapsed: true });\r\n      });\r\n      element.addEventListener ('mouseover', function(){ \r\n        element.classList.remove(\"ol-collapsed\"); \r\n        self.dispatchEvent({ type: 'toggle', collapsed: false });\r\n      });\r\n    }\r\n\r\n    if (options.minibar) options.noScroll = true;\r\n    if (!options.noScroll) {\r\n      this.topv = ol_ext_element.create('DIV', {\r\n        className: 'ol-switchertopdiv',\r\n        parent: element,\r\n        click: function() {\r\n          self.overflow(\"+50%\");\r\n        }\r\n      });\r\n\r\n      this.botv = ol_ext_element.create('DIV', {\r\n        className: 'ol-switcherbottomdiv',\r\n        parent: element,\r\n        click: function() {\r\n          self.overflow(\"-50%\");\r\n        }\r\n      });\r\n    }\r\n    this._noScroll = options.noScroll;\r\n  }\r\n\r\n  this.panel_ = ol_ext_element.create ('UL', {\r\n    className: 'panel',\r\n  });\r\n  this.panelContainer_ = ol_ext_element.create ('DIV', {\r\n    className: 'panel-container',\r\n    html: this.panel_,\r\n    parent: element\r\n  });\r\n  // Handle mousewheel\r\n  if (!options.target && !options.noScroll) {\r\n    ol_ext_element.addListener (this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function(e) {\r\n      if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n      }\r\n    });\r\n  }\r\n\r\n  this.header_ = ol_ext_element.create('LI', {\r\n    className: 'ol-header',\r\n    parent: this.panel_\r\n  });\r\n\r\n  ol_control_Control.call (this, {\r\n    element: element,\r\n    target: options.target\r\n  });\r\n\r\n  this.set('drawDelay',options.drawDelay||0);\r\n  this.set('selection', options.selection);\r\n\r\n  if (options.minibar) {\r\n    // Wait init complete (for child classes)\r\n    setTimeout(function() {\r\n      var mbar = ol_ext_element.scrollDiv(this.panelContainer_, {\r\n        mousewheel: true, \r\n        vertical: true, \r\n        minibar: true\r\n      });\r\n      this.on(['drawlist', 'toggle'], function() {\r\n        mbar.refresh();\r\n      })\r\n    }.bind(this));\r\n  }\r\n};\r\nol_ext_inherits(ol_control_LayerSwitcher, ol_control_Control);\r\n\r\n/** List of tips for internationalization purposes\r\n*/\r\nol_control_LayerSwitcher.prototype.tip = {\r\n  up: \"up/down\",\r\n  down: \"down\",\r\n  info: \"informations...\",\r\n  extent: \"zoom to extent\",\r\n  trash: \"remove layer\",\r\n  plus: \"expand/shrink\"\r\n};\r\n\r\n/** Test if a layer should be displayed in the switcher\r\n * @param {ol.layer} layer\r\n * @return {boolean} true if the layer is displayed\r\n */\r\nol_control_LayerSwitcher.prototype.displayInLayerSwitcher = function(layer) {\r\n  return (layer.get('displayInLayerSwitcher')!==false);\r\n};\r\n\r\n/**\r\n * Set the map instance the control is associated with.\r\n * @param {_ol_Map_} map The map instance.\r\n */\r\nol_control_LayerSwitcher.prototype.setMap = function(map) {\r\n  ol_control_Control.prototype.setMap.call(this, map);\r\n  this.drawPanel();\r\n  \r\n  if (this._listener) {\r\n    for (var i in this._listener) ol_Observable_unByKey(this._listener[i]);\r\n  }\r\n  this._listener = null;\r\n\r\n  // Get change (new layer added or removed)\r\n  if (map) {\r\n    this._listener = {\r\n      moveend: map.on('moveend', this.viewChange.bind(this)),\r\n      size: map.on('change:size', this.overflow.bind(this))\r\n    }\r\n    // Listen to a layer group\r\n    if (this._layerGroup) {\r\n      this._listener.change = this._layerGroup.getLayers().on('change:length', this.drawPanel.bind(this));\r\n    } else  {\r\n      //Listen to all layers\r\n      this._listener.change = map.getLayerGroup().getLayers().on('change:length', this.drawPanel.bind(this));\r\n    }\r\n  }\r\n};\r\n\r\n/** Show control\r\n */\r\nol_control_LayerSwitcher.prototype.show = function() {\r\n  this.element.classList.add('ol-forceopen');\r\n  this.overflow();\r\n  self.dispatchEvent({ type: 'toggle', collapsed: false });\r\n};\r\n\r\n/** Hide control\r\n */\r\nol_control_LayerSwitcher.prototype.hide = function() {\r\n  this.element.classList.remove('ol-forceopen');\r\n  this.overflow();\r\n  self.dispatchEvent({ type: 'toggle', collapsed: true });\r\n};\r\n\r\n/** Toggle control\r\n */\r\nol_control_LayerSwitcher.prototype.toggle = function() {\r\n  this.element.classList.toggle(\"ol-forceopen\");\r\n  this.overflow();\r\n};\r\n\r\n/** Is control open\r\n * @return {boolean}\r\n */\r\nol_control_LayerSwitcher.prototype.isOpen = function() {\r\n  return this.element.classList.contains(\"ol-forceopen\");\r\n};\r\n\r\n/** Add a custom header\r\n * @param {Element|string} html content html\r\n */\r\nol_control_LayerSwitcher.prototype.setHeader = function(html) {\r\n  ol_ext_element.setHTML(this.header_, html);\r\n};\r\n\r\n/** Calculate overflow and add scrolls\r\n * @param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.overflow = function(dir) {\t\r\n  if (this.button && !this._noScroll) {\r\n    // Nothing to show\r\n    if (ol_ext_element.hidden(this.panel_)) {\r\n      ol_ext_element.setStyle(this.element, { height: 'auto' });\r\n      return;\r\n    }\r\n    // Calculate offset\r\n    var h = ol_ext_element.outerHeight(this.element);\r\n    var hp = ol_ext_element.outerHeight(this.panel_);\r\n    var dh = this.button.offsetTop + ol_ext_element.outerHeight(this.button);\r\n    //var dh = this.button.position().top + this.button.outerHeight(true);\r\n\r\n    var top = this.panel_.offsetTop - dh;\r\n    if (hp > h-dh) {\r\n      // Bug IE: need to have an height defined\r\n      ol_ext_element.setStyle(this.element, { height: '100%' });\r\n      var li = this.panel_.querySelectorAll('li.visible .li-content')[0];\r\n      var lh = li ? 2 * ol_ext_element.getStyle(li, 'height') : 0;\r\n      switch (dir) {\r\n        case 1: top += lh; break;\r\n        case -1: top -= lh; break;\r\n        case \"+50%\": top += Math.round(h/2); break;\r\n        case \"-50%\": top -= Math.round(h/2); break;\r\n        default: break;\r\n      }\r\n      // Scroll div\r\n      if (top+hp <= h-3*dh/2) {\r\n        top = h-3*dh/2-hp;\r\n        ol_ext_element.hide(this.botv);\r\n      } else {\r\n        ol_ext_element.show(this.botv);\r\n      }\r\n      if (top >= 0) {\r\n        top = 0;\r\n        ol_ext_element.hide(this.topv);\r\n      } else {\r\n        ol_ext_element.show(this.topv);\r\n      }\r\n      // Scroll ?\r\n      ol_ext_element.setStyle(this.panel_, { top: top+\"px\" });\r\n      return true;\r\n    } else {\r\n      ol_ext_element.setStyle(this.element, { height: \"auto\" });\r\n      ol_ext_element.setStyle(this.panel_, { top: 0 });\r\n      ol_ext_element.hide(this.botv);\r\n      ol_ext_element.hide(this.topv);\r\n      return false;\r\n    }\r\n  }\r\n  else return false;\r\n};\r\n\r\n/** Set the layer associated with a li\r\n * @param {Element} li\r\n * @param {ol.layer} layer\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype._setLayerForLI = function(li, layer) {\r\n  var listeners = [];\r\n  if (layer.getLayers) {\r\n    listeners.push(layer.getLayers().on('change:length', this.drawPanel.bind(this)));\r\n  }\r\n  if (li) {\r\n    // Handle opacity change\r\n    listeners.push(layer.on('change:opacity', (function() {\r\n      this.setLayerOpacity(layer, li);\r\n    }).bind(this)));\r\n    // Handle visibility chage\r\n    listeners.push(layer.on('change:visible', (function() {\r\n      this.setLayerVisibility(layer, li);\r\n    }).bind(this)));\r\n  }\r\n  // Other properties\r\n  listeners.push(layer.on('propertychange', (function(e) {\r\n    if (e.key === 'displayInLayerSwitcher'\r\n      || e.key === 'openInLayerSwitcher') {\r\n      this.drawPanel(e);\r\n    }\r\n  }).bind(this)));\r\n  this._layers.push({ li:li, layer:layer, listeners: listeners });\r\n};\r\n\r\n/** Set opacity for a layer\r\n * @param {ol.layer.Layer} layer\r\n * @param {Element} li the list element\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.setLayerOpacity = function(layer, li) {\r\n  var i = li.querySelector('.layerswitcher-opacity-cursor')\r\n  if (i) i.style.left = (layer.getOpacity()*100)+\"%\"\r\n  this.dispatchEvent({ type: 'layer:opacity', layer: layer });\r\n};\r\n\r\n/** Set visibility for a layer\r\n * @param {ol.layer.Layer} layer\r\n * @param {Element} li the list element\r\n * @api\r\n */\r\nol_control_LayerSwitcher.prototype.setLayerVisibility = function(layer, li) {\r\n  var i = li.querySelector('.ol-visibility');\r\n  if (i) i.checked = layer.getVisible();\r\n  if (layer.getVisible()) li.classList.add('ol-visible');\r\n  else li.classList.remove('ol-visible');\r\n  this.dispatchEvent({ type: 'layer:visible', layer: layer });\r\n};\r\n\r\n/** Clear layers associated with li\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype._clearLayerForLI = function() {\r\n  this._layers.forEach(function (li) {\r\n    li.listeners.forEach(function(l) {\r\n      ol_Observable_unByKey(l);\r\n    });\r\n  })\r\n  this._layers = [];\r\n};\r\n\r\n/** Get the layer associated with a li\r\n * @param {Element} li\r\n * @return {ol.layer}\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype._getLayerForLI = function(li) {\r\n  for (var i=0, l; l=this._layers[i]; i++) {\r\n    if (l.li===li) return l.layer;\r\n  }\r\n  return null;\r\n};\r\n\r\n/**\r\n * On view change hide layer depending on resolution / extent\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.viewChange = function() {\r\n  this.panel_.querySelectorAll('li').forEach( function(li) {\r\n    var l = this._getLayerForLI(li);\r\n    if (l) {\r\n      if (this.testLayerVisibility(l)) li.classList.remove('ol-layer-hidden');\r\n      else li.classList.add('ol-layer-hidden');\r\n    }\r\n  }.bind(this));\r\n};\r\n\r\n/** Get control panel\r\n * @api\r\n */\r\nol_control_LayerSwitcher.prototype.getPanel = function() {\r\n  return this.panelContainer_;\r\n};\r\n\r\n/** Draw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\r\n * @api\r\n */\r\nol_control_LayerSwitcher.prototype.drawPanel = function() {\r\n  if (!this.getMap()) return;\r\n  var self = this;\r\n  // Multiple event simultaneously / draw once => put drawing in the event queue\r\n  this.dcount++;\r\n  setTimeout (function(){ self.drawPanel_(); }, this.get('drawDelay') || 0);\r\n};\r\n\r\n/** Delayed draw panel control \r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.drawPanel_ = function() {\r\n  if (--this.dcount || this.dragging_) return;\r\n  var scrollTop = this.panelContainer_.scrollTop;\r\n\r\n  // Remove existing layers\r\n  this._clearLayerForLI();\r\n  this.panel_.querySelectorAll('li').forEach (function(li) {\r\n    if (!li.classList.contains('ol-header')) li.remove();\r\n  }.bind(this));\r\n  // Draw list\r\n  if (this._layerGroup) this.drawList (this.panel_, this._layerGroup.getLayers());\r\n  else if (this.getMap()) this.drawList (this.panel_, this.getMap().getLayers());\r\n\r\n  // Reset scrolltop\r\n  this.panelContainer_.scrollTop = scrollTop;\r\n};\r\n\r\n/** Change layer visibility according to the baselayer option\r\n * @param {ol.layer}\r\n * @param {Array<ol.layer>} related layers\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.switchLayerVisibility = function(l, layers) {\r\n  if (!l.get('baseLayer')) {\r\n    l.setVisible(!l.getVisible());\r\n  } else {\r\n    if (!l.getVisible()) l.setVisible(true);\r\n    layers.forEach(function(li) {\r\n      if (l!==li && li.get('baseLayer') && li.getVisible()) li.setVisible(false);\r\n    });\r\n  }\r\n};\r\n\r\n/** Check if layer is on the map (depending on resolution / zoom and extent)\r\n * @param {ol.layer}\r\n * @return {boolean}\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.testLayerVisibility = function(layer) {\r\n  if (!this.getMap()) return true;\r\n  var res = this.getMap().getView().getResolution();\r\n  var zoom = this.getMap().getView().getZoom();\r\n  // Calculate visibility on resolution or zoom\r\n  if (layer.getMaxResolution()<=res || layer.getMinResolution()>=res) {\r\n    return false;\r\n  } else if (layer.getMinZoom && (layer.getMinZoom()>=zoom || layer.getMaxZoom()<zoom)) {\r\n    return false;\r\n  } else {\r\n    // Check extent\r\n    var ex0 = layer.getExtent();\r\n    if (ex0) {\r\n      var ex = this.getMap().getView().calculateExtent(this.getMap().getSize());\r\n      return ol_extent_intersects(ex, ex0);\r\n    }\r\n    return true;\r\n  }\r\n};\r\n\r\n\r\n/** Start ordering the list\r\n*\t@param {event} e drag event\r\n*\t@private\r\n*/\r\nol_control_LayerSwitcher.prototype.dragOrdering_ = function(e) {\r\n  e.stopPropagation();\r\n  e.preventDefault();\r\n  // Get params\r\n  var self = this;\r\n  var elt = e.currentTarget.parentNode.parentNode;\r\n  var start = true;\r\n  var panel = this.panel_; \r\n  var pageY;\r\n  var pageY0 = e.pageY \r\n    || (e.touches && e.touches.length && e.touches[0].pageY) \r\n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\r\n  var target, dragElt;\r\n  var layer, group;\r\n  elt.parentNode.classList.add('drag');\r\n\r\n  // Stop ordering\r\n  function stop() {\r\n    if (target) {\r\n      // Get drag on parent\r\n      var drop = layer;\r\n      var isSelected = self.getSelection() === drop;\r\n      if (drop && target) {\r\n        var collection ;\r\n        if (group) collection = group.getLayers();\r\n        else collection = self._layerGroup ?  self._layerGroup.getLayers() : self.getMap().getLayers();\r\n        var layers = collection.getArray();\r\n        // Switch layers\r\n        for (var i=0; i<layers.length; i++) {\r\n          if (layers[i]==drop) {\r\n            collection.removeAt (i);\r\n            break;\r\n          }\r\n        }\r\n        for (var j=0; j<layers.length; j++) {\r\n          if (layers[j] === target) {\r\n            if (i>j) collection.insertAt (j,drop);\r\n            else collection.insertAt (j+1,drop);\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (isSelected) self.selectLayer(drop);\r\n      \r\n      self.dispatchEvent({ type: \"reorder-end\", layer: drop, group: group });\r\n    }\r\n    \r\n    elt.parentNode.querySelectorAll('li').forEach(function(li){\r\n      li.classList.remove('dropover');\r\n      li.classList.remove('dropover-after');\r\n      li.classList.remove('dropover-before');\r\n    });\r\n    elt.classList.remove(\"drag\");\r\n    elt.parentNode.classList.remove(\"drag\");\r\n    self.element.classList.remove('drag');\r\n    if (dragElt) dragElt.remove();\r\n\r\n    ol_ext_element.removeListener(document, 'mousemove touchmove', move);\r\n    ol_ext_element.removeListener(document, 'mouseup touchend touchcancel', stop);\r\n  }\r\n\r\n  // Ordering\r\n  function move(e) {\r\n    // First drag (more than 2 px) => show drag element (ghost)\r\n    pageY = e.pageY \r\n        || (e.touches && e.touches.length && e.touches[0].pageY) \r\n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\r\n    if (start && Math.abs(pageY0 - pageY) > 2) {\r\n      start = false;\r\n      elt.classList.add(\"drag\");\r\n      layer = self._getLayerForLI(elt);\r\n      target = false;\r\n      group = self._getLayerForLI(elt.parentNode.parentNode);\r\n      // Ghost div\r\n      dragElt = ol_ext_element.create('LI', { \r\n        className: 'ol-dragover',\r\n        html: elt.innerHTML,\r\n        style: { \r\n          position: \"absolute\", \r\n          \"z-index\": 10000, \r\n          left: elt.offsetLeft, \r\n          opacity: 0.5,\r\n          width: ol_ext_element.outerWidth(elt),\r\n          height: ol_ext_element.getStyle(elt,'height'),\r\n        },\r\n        parent: panel \r\n      });\r\n      self.element.classList.add('drag');\r\n      self.dispatchEvent({ type: \"reorder-start\", layer: layer, group: group });\r\n    }\r\n    // Start a new drag sequence\r\n    if (!start) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n\r\n      // Ghost div\r\n      ol_ext_element.setStyle(dragElt, { top: pageY - ol_ext_element.offsetRect(panel).top + panel.scrollTop +5 });\r\n      \r\n      var li;\r\n      if (!e.touches) {\r\n        li = e.target;\r\n      } else {\r\n        li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\r\n      }\r\n      if (li.classList.contains(\"ol-switcherbottomdiv\")) {\r\n        self.overflow(-1);\r\n      } else if (li.classList.contains(\"ol-switchertopdiv\")) {\r\n        self.overflow(1);\r\n      }\r\n      // Get associated li\r\n      while (li && li.tagName!=='LI') {\r\n        li = li.parentNode;\r\n      }\r\n      if (!li || !li.classList.contains('dropover')) {\r\n        elt.parentNode.querySelectorAll('li').forEach(function(li) {\r\n          li.classList.remove('dropover');\r\n          li.classList.remove('dropover-after');\r\n          li.classList.remove('dropover-before');\r\n        });\r\n      }\r\n      if (li && li.parentNode.classList.contains('drag') && li !== elt) {\r\n        target = self._getLayerForLI(li);\r\n        // Don't mix layer level\r\n        if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\r\n          li.classList.add(\"dropover\");\r\n          li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before');\r\n        } else {\r\n          target = false;\r\n        }\r\n        ol_ext_element.show(dragElt);\r\n      } else {\r\n        target = false;\r\n        if (li===elt) ol_ext_element.hide(dragElt);\r\n        else ol_ext_element.show(dragElt);\r\n      }\r\n      \r\n      if (!target) dragElt.classList.add(\"forbidden\");\r\n      else dragElt.classList.remove(\"forbidden\");\r\n    }\r\n  }\r\n\r\n  // Start ordering\r\n  ol_ext_element.addListener(document, 'mousemove touchmove', move);\r\n  ol_ext_element.addListener(document, 'mouseup touchend touchcancel', stop);\r\n};\r\n\r\n\r\n/** Change opacity on drag \r\n*\t@param {event} e drag event\r\n*\t@private\r\n*/\r\nol_control_LayerSwitcher.prototype.dragOpacity_ = function(e) {\r\n  e.stopPropagation();\r\n  e.preventDefault();\r\n  var self = this\r\n  // Register start params\r\n  var elt = e.target;\r\n  var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode);\r\n  if (!layer) return;\r\n  var x = e.pageX \r\n    || (e.touches && e.touches.length && e.touches[0].pageX) \r\n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\r\n  var start = ol_ext_element.getStyle (elt, 'left') - x;\r\n  self.dragging_ = true;\r\n\r\n  // stop dragging\r\n  function stop() {\r\n    ol_ext_element.removeListener(document, \"mouseup touchend touchcancel\", stop);\r\n    ol_ext_element.removeListener(document, \"mousemove touchmove\", move);\r\n    self.dragging_ = false;\r\n  }\r\n  // On draggin\r\n  function move(e) {\r\n    var x = e.pageX \r\n      || (e.touches && e.touches.length && e.touches[0].pageX) \r\n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\r\n    var delta = (start + x) / ol_ext_element.getStyle(elt.parentNode, 'width');\r\n    var opacity = Math.max (0, Math.min(1, delta));\r\n    ol_ext_element.setStyle (elt, { left: (opacity*100) + \"%\" });\r\n    elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity*100);\r\n    layer.setOpacity(opacity);\r\n  }\r\n  // Register move\r\n  ol_ext_element.addListener(document, \"mouseup touchend touchcancel\", stop);\r\n  ol_ext_element.addListener(document, \"mousemove touchmove\", move);\r\n};\r\n\r\n\r\n/** Render a list of layer\r\n * @param {Elemen} element to render\r\n * @layers {Array{ol.layer}} list of layer to show\r\n * @api stable\r\n * @private\r\n */\r\nol_control_LayerSwitcher.prototype.drawList = function(ul, collection) {\r\n  var self = this;\r\n  var layers = collection.getArray();\r\n\r\n  // Change layer visibility\r\n  var setVisibility = function(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    var l = self._getLayerForLI(this.parentNode.parentNode);\r\n    self.switchLayerVisibility(l, collection);\r\n    if (self.get('selection') && l.getVisible()) {\r\n      self.selectLayer(l);\r\n    }\r\n    if (self.onchangeCheck) {\r\n      self.onchangeCheck(l);\r\n    }\r\n  };\r\n  // Info button click\r\n  function onInfo(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault(); \r\n    var l = self._getLayerForLI(this.parentNode.parentNode);\r\n    self.oninfo(l); \r\n    self.dispatchEvent({ type: \"info\", layer: l });\r\n  }\r\n  // Zoom to extent button\r\n  function zoomExtent(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault(); \r\n    var l = self._getLayerForLI(this.parentNode.parentNode);\r\n    if (self.onextent) self.onextent(l); \r\n    else self.getMap().getView().fit (l.getExtent(), self.getMap().getSize()); \r\n    self.dispatchEvent({ type: \"extent\", layer: l });\r\n  }\r\n  // Remove a layer on trash click\r\n  function removeLayer(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    var li = this.parentNode.parentNode.parentNode.parentNode;\r\n    var layer, group = self._getLayerForLI(li);\r\n    // Remove the layer from a group or from a map\r\n    if (group) {\r\n      layer = self._getLayerForLI(this.parentNode.parentNode);\r\n      group.getLayers().remove(layer);\r\n      if (group.getLayers().getLength()==0 && !group.get('noSwitcherDelete')) {\r\n        removeLayer.call(li.querySelectorAll('.layerTrash')[0], e);\r\n      }\r\n    } else {\r\n      li = this.parentNode.parentNode;\r\n      self.getMap().removeLayer(self._getLayerForLI(li));\r\n    }\r\n  }\r\n\r\n  // Create a list for a layer\r\n  function createLi(layer) {\r\n    if (!this.displayInLayerSwitcher(layer)) {\r\n      this._setLayerForLI(null, layer);\r\n      return;\r\n    } \r\n\r\n    var li = ol_ext_element.create('LI', {\r\n      className: (layer.getVisible()?\"visible \":\" \")+(layer.get('baseLayer')?\"baselayer\":\"\"),\r\n      parent: ul\r\n    });\r\n    this._setLayerForLI(li, layer);\r\n    if (this._selectedLayer === layer) {\r\n      li.classList.add('ol-layer-select');\r\n    }\r\n\r\n    var layer_buttons = ol_ext_element.create('DIV', {\r\n      className: 'ol-layerswitcher-buttons',\r\n      parent: li\r\n    });\r\n\r\n    // Content div\r\n    var d = ol_ext_element.create('DIV', {\r\n      className: 'li-content',// + (this.testLayerVisibility(layer) ? '' : ' ol-layer-hidden'),\r\n      parent: li\r\n    });\r\n    \r\n    // Visibility\r\n    ol_ext_element.create('INPUT', {\r\n      type: layer.get('baseLayer') ? 'radio' : 'checkbox',\r\n      className: 'ol-visibility',\r\n      checked: layer.getVisible(),\r\n      click: setVisibility,\r\n      parent: d\r\n    });\r\n    // Label\r\n    var label = ol_ext_element.create('LABEL', {\r\n      title: layer.get('title') || layer.get('name'),\r\n      click: setVisibility,\r\n      unselectable: 'on',\r\n      style: {\r\n        userSelect: 'none'\r\n      },\r\n      parent: d\r\n    });\r\n    label.addEventListener('selectstart', function(){ return false; });\r\n    ol_ext_element.create('SPAN', {\r\n      html: layer.get('title') || layer.get('name'),\r\n      click: function(e) {\r\n        if (this.get('selection')) {\r\n          e.stopPropagation();\r\n          this.selectLayer(layer);\r\n        }\r\n      }.bind(this),\r\n      parent: label\r\n    });\r\n\r\n    //  up/down\r\n    if (this.reordering) {\r\n      if ( (i<layers.length-1 && (layer.get(\"allwaysOnTop\") || !layers[i+1].get(\"allwaysOnTop\")) )\r\n      || (i>0 && (!layer.get(\"allwaysOnTop\") || layers[i-1].get(\"allwaysOnTop\")) ) ) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerup ol-noscroll',\r\n          title: this.tip.up,\r\n          on: { 'mousedown touchstart': function(e) { self.dragOrdering_(e) } },\r\n          parent: layer_buttons\r\n        });\r\n      }\r\n    }\r\n\r\n    // Show/hide sub layers\r\n    if (layer.getLayers) {\r\n      var nb = 0;\r\n      layer.getLayers().forEach(function(l) {\r\n        if (self.displayInLayerSwitcher(l)) nb++;\r\n      });\r\n      if (nb) {\r\n        ol_ext_element.create('DIV', {\r\n          className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\r\n          title: this.tip.plus,\r\n          click: function() {\r\n            var l = self._getLayerForLI(this.parentNode.parentNode);\r\n            l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\") )\r\n          },\r\n          parent: layer_buttons\r\n        });\r\n      }\r\n    }\r\n\r\n    // Info button\r\n    if (this.oninfo) {\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerInfo',\r\n        title: this.tip.info,\r\n        click: onInfo,\r\n        parent: layer_buttons\r\n      });\r\n    }\r\n    // Layer remove\r\n    if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\r\n      ol_ext_element.create('DIV', {\r\n        className: 'layerTrash',\r\n        title: this.tip.trash,\r\n        click: removeLayer,\r\n        parent: layer_buttons\r\n      });\r\n    }\r\n    // Layer extent\r\n    if (this.hasextent && layers[i].getExtent()) {\r\n      var ex = layers[i].getExtent();\r\n      if (ex.length==4 && ex[0]<ex[2] && ex[1]<ex[3]) {\r\n        ol_ext_element.create('DIV', {\r\n          className: 'layerExtent',\r\n          title: this.tip.extent,\r\n          click: zoomExtent,\r\n          parent: layer_buttons  \r\n        });\r\n      }\r\n    }\r\n\r\n    // Progress\r\n    if (this.show_progress && layer instanceof ol_layer_Tile) {\r\n      var p = ol_ext_element.create('DIV', {\r\n        className: 'layerswitcher-progress',\r\n        parent: d\r\n      });\r\n      this.setprogress_(layer);\r\n      layer.layerswitcher_progress = ol_ext_element.create('DIV', { parent: p });\r\n    }\r\n\r\n    // Opacity\r\n    var opacity = ol_ext_element.create('DIV', {\r\n      className: 'layerswitcher-opacity',\r\n      // Click on the opacity line\r\n      click: function(e){\r\n        if (e.target !== this) return;\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        var op = Math.max ( 0, Math.min( 1, e.offsetX / ol_ext_element.getStyle(this, 'width')));\r\n        self._getLayerForLI(this.parentNode.parentNode).setOpacity(op);\r\n      },\r\n      parent: d\r\n    });\r\n    // Start dragging\r\n    ol_ext_element.create('DIV', {\r\n      className: 'layerswitcher-opacity-cursor ol-noscroll',\r\n      style: { left: (layer.getOpacity()*100)+\"%\" },\r\n      on: {\r\n        'mousedown touchstart': function(e) { self.dragOpacity_ (e); }\r\n      },\r\n      parent: opacity\r\n    });\r\n    // Percent\r\n    ol_ext_element.create('DIV', {\r\n      className: 'layerswitcher-opacity-label',\r\n      html: Math.round(layer.getOpacity()*100),\r\n      parent: d\r\n    });\r\n\r\n    // Layer group\r\n    if (layer.getLayers) {\r\n      li.classList.add('ol-layer-group');\r\n      if (layer.get(\"openInLayerSwitcher\") === true) {\r\n        var ul2 = ol_ext_element.create('UL', {\r\n          parent: li\r\n        });\r\n        this.drawList (ul2, layer.getLayers());\r\n      }\r\n    }\r\n    li.classList.add(this.getLayerClass(layer));\r\n\r\n    // Dispatch a dralist event to allow customisation\r\n    this.dispatchEvent({ type:'drawlist', layer:layer, li:li });\r\n  }\r\n\r\n  // Add the layer list\r\n  for (var i=layers.length-1; i>=0; i--) { \r\n    createLi.call(this, layers[i]); \r\n  }\r\n\r\n  this.viewChange();\r\n\r\n  if (ul === this.panel_) this.overflow();\r\n};\r\n\r\n/** Select a layer\r\n * @param {ol.layer.Layer} layer\r\n * @returns {string} the layer classname\r\n * @api\r\n */\r\nol_control_LayerSwitcher.prototype.getLayerClass = function(layer) {\r\n  if (!layer) return 'none';\r\n  if (layer.getLayers) return 'ol-layer-group';\r\n  if (layer instanceof ol_layer_Vector) return 'ol-layer-vector';\r\n  if (layer instanceof ol_layer_VectorTile) return 'ol-layer-vectortile';\r\n  if (layer instanceof ol_layer_Tile) return 'ol-layer-tile';\r\n  if (layer instanceof ol_layer_Image) return 'ol-layer-image';\r\n  if (layer instanceof ol_layer_Heatmap) return 'ol-layer-heatmap';\r\n  /* ol < 6 compatibility VectorImage is not defined */\r\n  // if (layer instanceof ol_layer_VectorImage) return 'ol-layer-vectorimage';\r\n  if (layer.getFeatures) return 'ol-layer-vectorimage';\r\n  /* */\r\n  return 'unknown';\r\n};\r\n\r\n/** Select a layer\r\n * @param {ol.layer.Layer} layer\r\n * @api\r\n */\r\nol_control_LayerSwitcher.prototype.selectLayer = function(layer, silent) {\r\n  if (!layer) {\r\n    if (!this.getMap()) return;\r\n    layer = this.getMap().getLayers().item(this.getMap().getLayers().getLength()-1)\r\n  }\r\n  this._selectedLayer = layer;\r\n  this.drawPanel();\r\n  if (!silent) this.dispatchEvent({ type: 'select', layer: layer });\r\n};\r\n\r\n/** Get selected layer\r\n * @returns {ol.layer.Layer}\r\n */\r\nol_control_LayerSwitcher.prototype.getSelection = function() {\r\n  return this._selectedLayer;\r\n};\r\n\r\n/** Handle progress bar for a layer\r\n*\t@private\r\n*/\r\nol_control_LayerSwitcher.prototype.setprogress_ = function(layer) {\r\n  if (!layer.layerswitcher_progress) {\r\n    var loaded = 0;\r\n    var loading = 0;\r\n    var draw = function() {\r\n      if (loading === loaded) {\r\n        loading = loaded = 0;\r\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: 0 });// layer.layerswitcher_progress.width(0);\r\n      } else {\r\n        ol_ext_element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' });// layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\r\n      }\r\n    }\r\n    layer.getSource().on('tileloadstart', function() {\r\n      loading++;\r\n      draw();\r\n    });\r\n    layer.getSource().on('tileloadend', function() {\r\n      loaded++;\r\n      draw();\r\n    });\r\n    layer.getSource().on('tileloaderror', function() {\r\n      loaded++;\r\n      draw();\r\n    });\r\n  }\r\n};\r\n\r\nexport default ol_control_LayerSwitcher\r\n","/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\r\nimport ol_ext_inherits from '../util/ext'\r\nimport ol_source_Vector from 'ol/source/Vector'\r\nimport ol_control_Control from 'ol/control/Control'\r\nimport ol_ext_element from '../util/element'\r\n\r\n/** Timeline control\r\n *\r\n * @constructor\r\n * @extends {ol.control.Control}\r\n * @fires select\r\n * @fires scroll\r\n * @fires collapse\r\n * @param {Object=} options Control options.\r\n *\t@param {String} options.className class of the control\r\n *\t@param {Array<ol.Feature>} options.features Features to show in the timeline\r\n *\t@param {ol.SourceImageOptions.vector} options.source class of the control\r\n *\t@param {Number} options.interval time interval length in ms or a text with a format d, h, mn, s (31 days = '31d'), default none\r\n *\t@param {String} options.maxWidth width of the time line in px, default 2000px\r\n *\t@param {String} options.minDate minimum date \r\n *\t@param {String} options.maxDate maximum date \r\n *\t@param {Number} options.minZoom Minimum zoom for the line, default .2\r\n *\t@param {Number} options.maxZoom Maximum zoom for the line, default 4\r\n *\t@param {boolean} options.zoomButton Are zoom buttons avaliable, default false\r\n *\t@param {function} options.getHTML a function that takes a feature and returns the html to display\r\n *\t@param {function} options.getFeatureDate a function that takes a feature and returns its date, default the date propertie\r\n *\t@param {function} options.endFeatureDate a function that takes a feature and returns its end date, default no end date\r\n *\t@param {String} options.graduation day|month to show month or day graduation, default show only years\r\n *\t@param {String} options.scrollTimeout Time in milliseconds to get a scroll event, default 15ms\r\n */\r\nvar ol_control_Timeline = function(options) {\r\n\r\n  var element = ol_ext_element.create('DIV', {\r\n    className: (options.className || '') + ' ol-timeline'\r\n      + (options.target ? '': ' ol-unselectable ol-control')\r\n      + (options.zoomButton ? ' ol-hasbutton':'')\r\n  });\r\n\r\n  // Initialize\r\n  ol_control_Control.call(this, {\r\n    element: element,\r\n    target: options.target\r\n  });\r\n\r\n  // Scroll div\r\n  this._scrollDiv = ol_ext_element.create('DIV', {\r\n    className: 'ol-scroll',\r\n    parent: this.element\r\n  });\r\n\r\n  // Add a button bar\r\n  this._buttons = ol_ext_element.create('DIV', {\r\n    className: 'ol-buttons',\r\n    parent: this.element\r\n  });\r\n  // Zoom buttons\r\n  if (options.zoomButton) {\r\n    // Zoom in\r\n    this.addButton({\r\n      className: 'ol-zoom-in',\r\n      handleClick: function(){\r\n        var zoom = this.get('zoom');\r\n        if (zoom>=1) {\r\n          zoom++;\r\n        } else {\r\n          zoom = Math.min(1, zoom + 0.1);\r\n        }\r\n        zoom = Math.round(zoom*100)/100;\r\n        this.refresh(zoom);\r\n      }.bind(this)\r\n    });\r\n    // Zoom out\r\n    this.addButton({\r\n      className: 'ol-zoom-out',\r\n      handleClick: function(){\r\n        var zoom = this.get('zoom');\r\n        if (zoom>1) {\r\n          zoom--;\r\n        } else {\r\n          zoom -= 0.1;\r\n        }\r\n        zoom = Math.round(zoom*100)/100;\r\n        this.refresh(zoom);\r\n      }.bind(this)\r\n    });\r\n  }\r\n\r\n  // Draw center date\r\n  this._intervalDiv = ol_ext_element.create('DIV', {\r\n    className: 'ol-center-date',\r\n    parent: this.element\r\n  });\r\n\r\n  // Remove selection\r\n  this.element.addEventListener('mouseover', function(){\r\n    if (this._select) this._select.elt.classList.remove('ol-select');\r\n  }.bind(this));\r\n\r\n  // Trigger scroll event\r\n  var scrollListener = null;\r\n  this._scrollDiv.addEventListener('scroll', function() {\r\n    this._setScrollLeft();\r\n    if (scrollListener) {\r\n      clearTimeout(scrollListener);\r\n      scrollListener = null;\r\n    }\r\n    scrollListener = setTimeout(function() {\r\n      this.dispatchEvent({ \r\n        type: 'scroll', \r\n        date: this.getDate(), \r\n        dateStart: this.getDate('start'), \r\n        dateEnd: this.getDate('end')\r\n      });\r\n    }.bind(this), options.scrollTimeout || 15);\r\n  }.bind(this));\r\n  // Magic to give \"live\" scroll events on touch devices\r\n  // this._scrollDiv.addEventListener('gesturechange', function() {});\r\n\r\n  // Scroll timeline\r\n  ol_ext_element.scrollDiv(this._scrollDiv, {\r\n    onmove: function(b) {\r\n      // Prevent selection on moving\r\n      this._moving = b; \r\n    }.bind(this)\r\n  });\r\n\r\n  this._tline = [];\r\n\r\n  // Parameters\r\n  this._scrollLeft = 0;\r\n  this.set('maxWidth', options.maxWidth || 2000);\r\n  this.set('minDate', options.minDate || Infinity);\r\n  this.set('maxDate', options.maxDate || -Infinity);\r\n  this.set('graduation', options.graduation);\r\n  this.set('minZoom', options.minZoom || .2);\r\n  this.set('maxZoom', options.maxZoom || 4);\r\n  this.setInterval(options.interval);\r\n  if (options.getHTML) this._getHTML =  options.getHTML;\r\n  if (options.getFeatureDate) this._getFeatureDate =  options.getFeatureDate;\r\n  if (options.endFeatureDate) this._endFeatureDate =  options.endFeatureDate;\r\n\r\n  // Feature source \r\n  this.setFeatures(options.features || options.source, options.zoom);\r\n};\r\nol_ext_inherits(ol_control_Timeline, ol_control_Control);\r\n\r\n/**\r\n * Set the map instance the control is associated with\r\n * and add interaction attached to it to this map.\r\n * @param {_ol_Map_} map The map instance.\r\n */\r\nol_control_Timeline.prototype.setMap = function(map) {\r\n  ol_control_Control.prototype.setMap.call(this, map);\r\n  this.refresh(this.get('zoom')||1, true);\r\n};\r\n\r\n/** Add a button on the timeline\r\n * @param {*} button\r\n *  @param {string} button.className\r\n *  @param {title} button.className\r\n *  @param {Element|string} button.html Content of the element\r\n *  @param {function} button.click a function called when the button is clicked\r\n */\r\nol_control_Timeline.prototype.addButton = function(button) {\r\n  this.element.classList.add('ol-hasbutton');\r\n  ol_ext_element.create('BUTTON', {\r\n    className: button.className || undefined,\r\n    title: button.title,\r\n    html : button.html,\r\n    click: button.handleClick,\r\n    parent: this._buttons\r\n  })\r\n};\r\n\r\n/** Set an interval\r\n * @param {number|string} length the interval length in ms or a farmatted text ie. end with y, 1d, h, mn, s (31 days = '31d'), default none\r\n */\r\nol_control_Timeline.prototype.setInterval = function(length) {\r\n  if (typeof(length)==='string') {\r\n    if (/s$/.test(length)) {\r\n      length = parseFloat(length) * 1000;\r\n    } else if (/mn$/.test(length)) {\r\n      length = parseFloat(length) * 1000 * 60;\r\n    } else if (/h$/.test(length)) {\r\n      length = parseFloat(length) * 1000 * 3600;\r\n    } else if (/d$/.test(length)) {\r\n      length = parseFloat(length) * 1000 * 3600 * 24;\r\n    } else if (/y$/.test(length)) {\r\n      length = parseFloat(length) * 1000 * 3600 * 24 * 365;\r\n    } else {\r\n      length = 0;\r\n    }\r\n  }\r\n  this.set('interval', length || 0);\r\n  if (length) this.element.classList.add('ol-interval');\r\n  else this.element.classList.remove('ol-interval');\r\n  this.refresh(this.get('zoom'));\r\n}\r\n\r\n/** Default html to show in the line\r\n * @param {ol.Feature} feature\r\n * @return {DOMElement|string}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._getHTML = function(feature) {\r\n  return feature.get('name') || '';\r\n};\r\n\r\n/** Default function to get the date of a feature, returns the date attribute\r\n * @param {ol.Feature} feature\r\n * @return {Data|string}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._getFeatureDate = function(feature) {\r\n  return (feature && feature.get) ? feature.get('date') : null;\r\n};\r\n\r\n/** Default function to get the end date of a feature, return undefined\r\n * @param {ol.Feature} feature\r\n * @return {Data|string}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._endFeatureDate = function(/* feature */) {\r\n  return undefined;\r\n};\r\n\r\n/** Is the line collapsed\r\n * @return {boolean}\r\n */\r\nol_control_Timeline.prototype.isCollapsed = function() {\r\n  return this.element.classList.contains('ol-collapsed');\r\n};\r\n\r\n/** Collapse the line\r\n * @param {boolean} b\r\n */\r\nol_control_Timeline.prototype.collapse = function(b) {\r\n  if (b) this.element.classList.add('ol-collapsed');\r\n  else this.element.classList.remove('ol-collapsed');\r\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\r\n};\r\n\r\n/** Collapse the line\r\n */\r\nol_control_Timeline.prototype.toggle = function() {\r\n  this.element.classList.toggle('ol-collapsed');\r\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\r\n};\r\n\r\n/** Set the features to display in the timeline\r\n * @param {Array<ol.Features>|ol.source.Vector} features An array of features or a vector source\r\n * @param {number} zoom zoom to draw the line default 1\r\n */\r\nol_control_Timeline.prototype.setFeatures = function(features, zoom) {\r\n  this._features = this._source = null;\r\n  if (features instanceof ol_source_Vector) this._source = features;\r\n  else if (features instanceof Array) this._features = features;\r\n  else this._features = [];\r\n  this.refresh(zoom);\r\n};\r\n\r\n/**\r\n * Get features\r\n * @return {Array<ol.Feature>}\r\n */\r\nol_control_Timeline.prototype.getFeatures = function() {\r\n  return this._features || this._source.getFeatures();\r\n}\r\n\r\n/**\r\n * Refresh the timeline with new data\r\n * @param {Number} zoom Zoom factor from 0.25 to 10, default 1\r\n */\r\nol_control_Timeline.prototype.refresh = function(zoom, first) {\r\n  if (!this.getMap()) return;\r\n  if (!zoom) zoom = this.get('zoom');\r\n  zoom = Math.min(this.get('maxZoom'), Math.max(this.get('minZoom'), zoom || 1));\r\n  this.set('zoom', zoom);\r\n  this._scrollDiv.innerHTML = '';\r\n  var features = this.getFeatures();\r\n  var d, d2;\r\n\r\n  // Get features sorted by date\r\n  var tline = this._tline = [];\r\n  features.forEach(function(f) {\r\n    if (d = this._getFeatureDate(f)) {\r\n      if (!(d instanceof Date)) {\r\n        d = new Date(d)\r\n      }\r\n      if (this._endFeatureDate) {\r\n        d2 = this._endFeatureDate(f);\r\n        if (!(d2 instanceof Date)) {\r\n          d2 = new Date(d2)\r\n        }\r\n      }\r\n      if (!isNaN(d)) {\r\n        tline.push({\r\n          date: d,\r\n          end: isNaN(d2) ? null : d2,\r\n          feature: f\r\n        });\r\n      }\r\n    }\r\n  }.bind(this));\r\n\r\n  tline.sort(function(a,b) { \r\n    return (a.date < b.date ? -1 : (a.date===b.date ? 0: 1))\r\n  });\r\n\r\n  // Draw\r\n  var div = ol_ext_element.create('DIV', {\r\n    parent: this._scrollDiv\r\n  });\r\n\r\n  // Calculate width\r\n  var min = this._minDate = Math.min(this.get('minDate'), tline.length ? tline[0].date : Infinity);\r\n  var max = this._maxDate = Math.max(this.get('maxDate'), tline.length ? tline[tline.length-1].date : -Infinity);\r\n  if (!isFinite(min)) this._minDate = min = new Date();\r\n  if (!isFinite(max)) this._maxDate = max = new Date();\r\n  var delta = (max-min);\r\n  var maxWidth = this.get('maxWidth');\r\n  var scale = this._scale = (delta > maxWidth ? maxWidth/delta : 1) * zoom;\r\n  // Leave 10px on right\r\n  min = this._minDate = this._minDate - 10/scale;\r\n  delta = (max-min) * scale;\r\n  ol_ext_element.setStyle(div, {\r\n    width: delta,\r\n    maxWidth: 'unset'\r\n  });\r\n\r\n  // Draw time's bar\r\n  this._drawTime(div, min, max, scale);\r\n\r\n  // Set interval\r\n  if (this.get('interval')) {\r\n    ol_ext_element.setStyle (this._intervalDiv, { width: this.get('interval') * scale });\r\n  } else {\r\n    ol_ext_element.setStyle (this._intervalDiv, { width: '' });\r\n  }\r\n\r\n  // Draw features\r\n  var line = [];\r\n  var lineHeight = ol_ext_element.getStyle(this._scrollDiv, 'lineHeight');\r\n  \r\n  // Wrapper\r\n  var fdiv = ol_ext_element.create('DIV', {\r\n      className: 'ol-features',\r\n      parent: div\r\n  });\r\n\r\n  // Add features on the line\r\n  tline.forEach(function(f) {\r\n    var d = f.date;\r\n    var t = f.elt = ol_ext_element.create('DIV', {\r\n      className: 'ol-feature',\r\n      style: {\r\n        left: Math.round((d-min)*scale),\r\n      },\r\n      html: this._getHTML(f.feature),\r\n      parent: fdiv\r\n    });\r\n    // Prevent image dragging\r\n    var img = t.querySelectorAll('img');\r\n    for (var i=0; i<img.length; i++) {\r\n      img[i].ondragstart = function(){ return false; };\r\n    }\r\n\r\n    // Calculate image width\r\n    if (f.end) {\r\n      ol_ext_element.setStyle(t, { \r\n        minWidth: (f.end-d) * scale, \r\n        width: (f.end-d) * scale, \r\n        maxWidth: 'unset'\r\n      });\r\n    }\r\n    var left = ol_ext_element.getStyle(t, 'left');\r\n    // Select on click\r\n    t.addEventListener('click', function() {\r\n      if (!this._moving) {\r\n        this.dispatchEvent({type: 'select', feature: f.feature });\r\n      }\r\n    }.bind(this));\r\n\r\n    // Find first free Y position\r\n    var pos, l;\r\n    for (pos=0; l=line[pos]; pos++) {\r\n      if (left > l) {\r\n        break;\r\n      }\r\n    }\r\n    line[pos] = left + ol_ext_element.getStyle(t, 'width');\r\n    ol_ext_element.setStyle(t, { top: pos*lineHeight });\r\n  }.bind(this));\r\n  this._nbline = line.length;\r\n\r\n  if (first) this.setDate(this._minDate, { anim: false, position: 'start' });\r\n  // Dispatch scroll event\r\n  this.dispatchEvent({ \r\n    type: 'scroll', \r\n    date: this.getDate(), \r\n    dateStart: this.getDate('start'), \r\n    dateEnd: this.getDate('end')\r\n  });\r\n};\r\n\r\n/** Get offset given a date\r\n * @param {Date} date\r\n * @return {number}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._getOffsetFromDate = function(date) {\r\n  return (date - this._minDate) * this._scale;\r\n};\r\n\r\n/** Get date given an offset\r\n * @param {Date} date\r\n * @return {number}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._getDateFromOffset = function(offset) {\r\n  return offset / this._scale + this._minDate;\r\n};\r\n\r\n/** Set the current position \r\n * @param {number} scrollLeft current position (undefined when scrolling)\r\n * @returns {number}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._setScrollLeft = function(scrollLeft) {\r\n  this._scrollLeft = scrollLeft;\r\n  if (scrollLeft !== undefined) {\r\n    this._scrollDiv.scrollLeft = scrollLeft;\r\n  }\r\n};\r\n\r\n/** Get the current position \r\n * @returns {number}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._getScrollLeft = function() {\r\n  // Unset when scrolling\r\n  if (this._scrollLeft === undefined) {\r\n    return this._scrollDiv.scrollLeft;\r\n  } else {\r\n    // St by user\r\n    return this._scrollLeft;\r\n  }\r\n};\r\n\r\n/**\r\n * Draw dates on line\r\n * @private\r\n */\r\nol_control_Timeline.prototype._drawTime = function(div, min, max, scale) {\r\n  // Times div\r\n  var tdiv = ol_ext_element.create('DIV', {\r\n    className: 'ol-times',\r\n    parent: div\r\n  });\r\n  var d, dt, month, dmonth;\r\n  var dx = ol_ext_element.getStyle(tdiv, 'left');\r\n  var heigth = ol_ext_element.getStyle(tdiv, 'height');\r\n  // Year\r\n  var year = (new Date(this._minDate)).getFullYear();\r\n  dt = ((new Date(0)).setFullYear(String(year)) - new Date(0).setFullYear(String(year-1))) * scale;\r\n  var dyear = Math.round(2*heigth/dt)+1;\r\n  while(true) {\r\n    d = new Date(0).setFullYear(year);\r\n    if (d > this._maxDate) break;\r\n    ol_ext_element.create('DIV', {\r\n      className: 'ol-time ol-year',\r\n      style: {\r\n        left: this._getOffsetFromDate(d) - dx\r\n      },\r\n      html: year,\r\n      parent: tdiv\r\n    });\r\n    year += dyear;\r\n  }\r\n  // Month\r\n  if (/day|month/.test(this.get('graduation'))) {\r\n    dt = ((new Date(0,0,1)).setFullYear(String(year)) - new Date(0,0,1).setFullYear(String(year-1))) * scale;\r\n    dmonth = Math.max(1, Math.round(12 / Math.round(dt/heigth/2)));\r\n    if (dmonth < 12) {\r\n      year = (new Date(this._minDate)).getFullYear();\r\n      month = dmonth+1;\r\n      while(true) {\r\n        d = new Date(0,0,1);\r\n        d.setFullYear(year);\r\n        d.setMonth(month-1);\r\n        if (d > this._maxDate) break;\r\n        ol_ext_element.create('DIV', {\r\n          className: 'ol-time ol-month',\r\n          style: {\r\n            left: this._getOffsetFromDate(d) - dx\r\n          },\r\n          html: d.toLocaleDateString(undefined, { month: 'short'}),\r\n          parent: tdiv\r\n        });\r\n        month += dmonth;\r\n        if (month > 12) {\r\n          year++;\r\n          month = dmonth+1;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // Day\r\n  if (this.get('graduation')==='day') {\r\n    dt = (new Date(0,1,1) - new Date(0,0,1)) * scale;\r\n    var dday = Math.max(1, Math.round(31 / Math.round(dt/heigth/2)));\r\n    if (dday < 31) {\r\n      year = (new Date(this._minDate)).getFullYear();\r\n      month = 0;\r\n      var day = dday;\r\n      while(true) {\r\n        d = new Date(0,0,1);\r\n        d.setFullYear(year);\r\n        d.setMonth(month);\r\n        d.setDate(day);\r\n        if (isNaN(d)) {\r\n          month++;\r\n          if (month>12) {\r\n            month = 1;\r\n            year++;\r\n          }\r\n          day = dday;\r\n        } else {\r\n          if (d > this._maxDate) break;\r\n          if (day>1) {\r\n            var offdate = this._getOffsetFromDate(d);\r\n            if (this._getOffsetFromDate(new Date(year, month+1, 1)) - offdate > heigth) {\r\n              ol_ext_element.create('DIV', {\r\n                className: 'ol-time ol-day',\r\n                style: {\r\n                  left: offdate - dx\r\n                },\r\n                html: day,\r\n                parent: tdiv\r\n              });\r\n            }\r\n          }\r\n          year = d.getFullYear();\r\n          month = d.getMonth();\r\n          day = d.getDate() + dday;\r\n          if (day > new Date(year, month+1, 0).getDate()) {\r\n            month++;\r\n            day = dday;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/** Center timeline on a date\r\n * @param {Date|String|ol.feature} feature a date or a feature with a date\r\n * @param {Object} options\r\n *  @param {boolean} options.anim animate scroll\r\n *  @param {string} options.position start, end or middle, default middle\r\n */\r\nol_control_Timeline.prototype.setDate = function(feature, options) {\r\n  var date;\r\n  options = options || {};\r\n  // It's a date\r\n  if (feature instanceof Date) {\r\n    date = feature;\r\n  } else {\r\n    // Get date from Feature\r\n    if (this.getFeatures().indexOf(feature) >= 0) {\r\n      date = this._getFeatureDate(feature);\r\n    }\r\n    if (date && !(date instanceof Date)) {\r\n      date = new Date(date);\r\n    }\r\n    if (!date || isNaN(date)) {\r\n      date = new Date(String(feature));\r\n    }\r\n  }\r\n  if (!isNaN(date)) {\r\n    if (options.anim === false) this._scrollDiv.classList.add('ol-move');\r\n    var scrollLeft = this._getOffsetFromDate(date);\r\n    if (options.position==='start') {\r\n      scrollLeft += ol_ext_element.outerWidth(this._scrollDiv)/2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n    } else if (options.position==='end') {\r\n      scrollLeft -= ol_ext_element.outerWidth(this._scrollDiv)/2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n    }\r\n    this._setScrollLeft(scrollLeft);\r\n    if (options.anim === false) this._scrollDiv.classList.remove('ol-move');\r\n    if (feature) {\r\n      for (var i=0, f; f = this._tline[i]; i++) {\r\n        if (f.feature === feature) {\r\n          f.elt.classList.add('ol-select');\r\n          this._select = f;\r\n        } else {\r\n          f.elt.classList.remove('ol-select');\r\n        }\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/** Get round date (sticked to mn, hour day or month)\r\n * @param {Date} d\r\n * @param {string} stick sticking option to stick date to: 'mn', 'hour', 'day', 'month', default no stick\r\n * @return {Date}\r\n */\r\nol_control_Timeline.prototype.roundDate = function(d, stick) {\r\n  switch (stick) {\r\n    case 'mn': {\r\n      return new Date(this._roundTo(d, 60*1000));\r\n    }\r\n    case 'hour': {\r\n      return new Date(this._roundTo(d, 60*60*1000));\r\n    }\r\n    case 'day': {\r\n      return new Date(this._roundTo(d, 24*60*60*1000));\r\n    }\r\n    case 'month': {\r\n      d = new Date(this._roundTo(d, 24*60*60*1000));\r\n      if (d.getDate() > 15) {\r\n        d = new Date(d.setMonth(d.getMonth() + 1));\r\n      }\r\n      d = d.setDate(1);\r\n      return new Date(d);\r\n    }\r\n    default: return new Date(d);\r\n  }\r\n};\r\n\r\n/** Get the date of the center\r\n * @param {string} position position to get 'start', 'end' or 'middle', default middle\r\n * @param {string} stick sticking option to stick date to: 'mn', 'hour', 'day', 'month', default no stick\r\n * @return {Date}\r\n */\r\nol_control_Timeline.prototype.getDate = function(position, stick) {\r\n  var pos;\r\n  if (!stick) stick = position;\r\n  switch (position) {\r\n    case 'start': {\r\n      if (this.get('interval')) {\r\n        pos = - ol_ext_element.getStyle(this._intervalDiv, 'width')/2 + ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n      } else {\r\n        pos = - ol_ext_element.outerWidth(this._scrollDiv)/2 + ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n      }\r\n      break;\r\n    }\r\n    case 'end': {\r\n      if (this.get('interval')) {\r\n        pos = ol_ext_element.getStyle(this._intervalDiv, 'width')/2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n      } else {\r\n        pos = ol_ext_element.outerWidth(this._scrollDiv)/2 - ol_ext_element.getStyle(this._scrollDiv, 'marginLeft')/2;\r\n      }\r\n      break;\r\n    }\r\n    default: {\r\n      pos = 0;\r\n      break;\r\n    }\r\n  }\r\n  var d = this._getDateFromOffset(this._getScrollLeft() + pos);\r\n  d = this.roundDate(d, stick);\r\n  return new Date(d);\r\n};\r\n\r\n/** Round number to \r\n * @param {number} d\r\n * @param {number} r\r\n * @return {number}\r\n * @private\r\n */\r\nol_control_Timeline.prototype._roundTo = function(d, r) {\r\n  return Math.round(d/r) * r;\r\n};\r\n\r\n/** Get the start date of the control\r\n * @return {Date}\r\n */\r\nol_control_Timeline.prototype.getStartDate = function() {\r\n  return new Date(this.get('minDate'));\r\n}\r\n\r\n/** Get the end date of the control\r\n * @return {Date}\r\n */\r\nol_control_Timeline.prototype.getEndDate = function() {\r\n  return new Date(this.get('maxDate'));\r\n}\r\n\r\nexport default ol_control_Timeline","/** Vanilla JS geographic inputs\r\n * color, size, width, font, symboles, dash, arrow, pattern\r\n */\r\nimport ol_ext_inherits from '../ext'\r\nimport ol_Object from 'ol/Object'\r\n\r\n/** @namespace  ol.ext.input\r\n */\r\n/*global ol*/\r\nif (window.ol) {\r\n  ol.ext.input = {};\r\n}\r\n\r\n/** Abstract base class; normally only used for creating subclasses and not instantiated in apps.    \r\n * @constructor\r\n * @extends {ol_Object}\r\n * @param {*} options\r\n *  @param {Element} [options.input] input element, if none create one\r\n *  @param {string} [options.type] input type, if no input\r\n *  @param {number} [options.min] input min, if no input\r\n *  @param {number} [options.max] input max, if no input\r\n *  @param {number} [options.step] input step, if no input\r\n *  @param {string|number} [options.val] input value\r\n *  @param {boolean} [options.checked] check input\r\n *  @param {boolean} [options.hidden] the input is display:none\r\n *  @param {boolean} [options.disabled] disable input\r\n *  @param {Element} [options.parent] parent element, if no input\r\n */\r\nvar ol_ext_input_Base = function(options) {\r\n  options = options || {};\r\n  \r\n  ol_Object.call(this);\r\n  \r\n  var input = this.input = options.input;\r\n  if (!input) {\r\n    input = this.input = document.createElement('INPUT');\r\n    if (options.type) input.setAttribute('type', options.type);\r\n    if (options.min !== undefined) input.setAttribute('min', options.min);\r\n    if (options.max !== undefined) input.setAttribute('max', options.max);\r\n    if (options.step !== undefined) input.setAttribute('step', options.step);\r\n    if (options.parent) options.parent.appendChild(input);\r\n  } \r\n  if (options.disabled) input.disabled = true;\r\n  if (options.checked !== undefined) input.checked = !!options.checked;\r\n  if (options.val !== undefined) input.value = options.val;\r\n  if (options.hidden) input.style.display = 'none';\r\n  input.addEventListener('focus', function() {\r\n    if (this.element) this.element.classList.add('ol-focus');\r\n  }.bind(this))\r\n  var tout;\r\n  input.addEventListener('focusout', function() {\r\n    if (this.element) {\r\n      if (tout) clearTimeout(tout);\r\n      tout = setTimeout(function() {\r\n        this.element.classList.remove('ol-focus');\r\n      }.bind(this), 0);\r\n    }\r\n  }.bind(this))\r\n};\r\nol_ext_inherits(ol_ext_input_Base, ol_Object);\r\n\r\n/** Listen to drag event\r\n * @param {Element} elt \r\n * @param {function} cback when draggin on the element\r\n * @private\r\n */\r\nol_ext_input_Base.prototype._listenDrag = function(elt, cback) {\r\n  var handle = function(e) {\r\n    this.moving = true;\r\n    var listen = function(e) {\r\n      if (e.type==='pointerup') {\r\n        document.removeEventListener('pointermove', listen);\r\n        document.removeEventListener('pointerup', listen);\r\n        document.removeEventListener('pointercancel', listen);\r\n        setTimeout(function() {\r\n          this.moving = false;\r\n        }.bind(this));\r\n      }\r\n      if (e.target === elt) cback(e);\r\n      e.stopPropagation();\r\n      e.preventDefault();\r\n    }.bind(this);\r\n    document.addEventListener('pointermove', listen, false);\r\n    document.addEventListener('pointerup', listen, false);\r\n    document.addEventListener('pointercancel', listen, false);\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n  }.bind(this)\r\n  elt.addEventListener('mousedown', handle, false);\r\n  elt.addEventListener('touchstart', handle, false);\r\n};\r\n\r\n/** Set the current value\r\n */\r\n ol_ext_input_Base.prototype.setValue = function(v) {\r\n  if (v !== undefined) this.input.value = v;\r\n  this.input.dispatchEvent(new Event('change'));\r\n};\r\n\r\n/** Get the current getValue\r\n * @returns {string}\r\n */\r\nol_ext_input_Base.prototype.getValue = function() {\r\n  return this.input.value;\r\n};\r\n\r\n/** Get the input element\r\n * @returns {Element}\r\n */\r\nol_ext_input_Base.prototype.getInputElement = function() {\r\n  return this.input;\r\n};\r\n\r\nexport default ol_ext_input_Base\r\n","import ol_ext_inherits from '../ext'\r\nimport ol_ext_input_Base from './Base'\r\n\r\n/** Checkbox input\r\n * @constructor\r\n * @extends {ol_ext_input_Base}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element|string} [options.html] label content\r\n *  @param {string} [options.after] label garnish (placed after)\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n *  @param {boolean} [options.autoClose=true]\r\n *  @param {boolean} [options.visible=false] display the input\r\n */\r\nvar ol_ext_input_Checkbox = function(options) {\r\n  options = options || {};\r\n\r\n  ol_ext_input_Base.call(this, options);\r\n\r\n  var label = this.element = document.createElement('LABEL');\r\n  if (options.html instanceof Element) label.appendChild(options.html)\r\n  else if (options.html !== undefined) label.innerHTML = options.html;\r\n  label.className = ('ol-ext-check ol-ext-checkbox '  + (options.className || '')).trim();\r\n\r\n  if (this.input.parentNode) this.input.parentNode.insertBefore(label, this.input);\r\n  label.appendChild(this.input);\r\n  label.appendChild(document.createElement('SPAN'));\r\n  if (options.after) {\r\n    label.appendChild(document.createTextNode(options.after));\r\n  }\r\n\r\n  // Handle change\r\n  this.input.addEventListener('change', function() {\r\n    this.dispatchEvent({ type: 'check', checked: this.input.checked, value: this.input.value });\r\n  }.bind(this));\r\n\r\n};\r\nol_ext_inherits(ol_ext_input_Checkbox, ol_ext_input_Base);\r\n  \r\nol_ext_input_Checkbox.prototype.isChecked = function () {\r\n  return this.input.checked;\r\n};\r\n\r\nexport default ol_ext_input_Checkbox\r\n","import ol_ext_inherits from '../ext'\r\nimport ol_ext_input_Checkbox from './Checkbox'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Switch = function(options) {\r\n  options = options || {};\r\n\r\n  ol_ext_input_Checkbox.call(this, options);\r\n\r\n  this.element.className = ('ol-ext-toggle-switch ' + (options.className || '')).trim();\r\n};\r\nol_ext_inherits(ol_ext_input_Switch, ol_ext_input_Checkbox);\r\n  \r\nexport default ol_ext_input_Switch\r\n","import ol_ext_inherits from '../ext'\r\nimport ol_ext_input_Checkbox from './Checkbox'\r\n\r\n/** Switch input\r\n * @constructor\r\n * @extends {ol_ext_input_Checkbox}\r\n * @fires check\r\n * @param {*} options\r\n *  @param {string} [options.className]\r\n *  @param {Element} [options.input] input element, if non create one\r\n *  @param {Element} [options.parent] parent element, if create an input\r\n */\r\nvar ol_ext_input_Radio = function(options) {\r\n  options = options || {};\r\n\r\n  ol_ext_input_Checkbox.call(this, options);\r\n\r\n  this.element.className = ('ol-ext-check ol-ext-radio ' + (options.className || '')).trim();\r\n};\r\nol_ext_inherits(ol_ext_input_Radio, ol_ext_input_Checkbox);\r\n  \r\nexport default ol_ext_input_Radio\r\n","/** Vanilla JS helper to manipulate DOM without jQuery\r\n * @see https://github.com/nefe/You-Dont-Need-jQuery\r\n * @see https://plainjs.com/javascript/\r\n * @see http://youmightnotneedjquery.com/\r\n */\r\nimport ol_ext_input_Checkbox from './input/Checkbox'\r\nimport ol_ext_input_Switch from './input/Switch'\r\nimport ol_ext_input_Radio from './input/Radio'\r\n\r\n/** @namespace ol.ext.element */\r\nvar ol_ext_element = {};\r\n\r\n/**\r\n * Create an element\r\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\r\n * @param {*} options\r\n *  @param {string} options.className className The element class name \r\n *  @param {Element} options.parent Parent to append the element as child\r\n *  @param {Element|string} [options.html] Content of the element (if text is not set)\r\n *  @param {string} [options.text] Text content (if html is not set)\r\n *  @param {Element|string} [options.options] when tagName = SELECT a list of options as key:value to add to the select\r\n *  @param {string} options.* Any other attribut to add to the element\r\n */\r\nol_ext_element.create = function (tagName, options) {\r\n  options = options || {};\r\n  var elt;\r\n  // Create text node\r\n  if (tagName === 'TEXT') {\r\n    elt = document.createTextNode(options.html||'');\r\n    if (options.parent) options.parent.appendChild(elt);\r\n  } else {\r\n    // Other element\r\n    elt = document.createElement(tagName);\r\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\r\n    for (var attr in options) {\r\n      switch (attr) {\r\n        case 'className': {\r\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\r\n          break;\r\n        }\r\n        case 'text': {\r\n          elt.innerText = options.text;\r\n          break;\r\n        }\r\n        case 'html': {\r\n          if (options.html instanceof Element) elt.appendChild(options.html)\r\n          else if (options.html!==undefined) elt.innerHTML = options.html;\r\n          break;\r\n        }\r\n        case 'parent': {\r\n          if (options.parent) options.parent.appendChild(elt);\r\n          break;\r\n        }\r\n        case 'options': {\r\n          if (/select/i.test(tagName)) {\r\n            for (var i in options.options) {\r\n              ol_ext_element.create('OPTION', {\r\n                html: i,\r\n                value: options.options[i],\r\n                parent: elt          \r\n              })\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case 'style': {\r\n          this.setStyle(elt, options.style);\r\n          break;\r\n        }\r\n        case 'change':\r\n        case 'click': {\r\n          ol_ext_element.addListener(elt, attr, options[attr]);\r\n          break;\r\n        }\r\n        case 'on': {\r\n          for (var e in options.on) {\r\n            ol_ext_element.addListener(elt, e, options.on[e]);\r\n          }\r\n          break;\r\n        }\r\n        case 'checked': {\r\n          elt.checked = !!options.checked;\r\n          break;\r\n        }\r\n        default: {\r\n          elt.setAttribute(attr, options[attr]);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return elt;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {boolean} options.checked\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createSwitch = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    type: 'checkbox',\r\n    on: options.on,\r\n    click: options.click,\r\n    change: options.change,\r\n    parent: options.parent\r\n  });\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  new ol_ext_input_Switch(opt);\r\n  return input;\r\n};\r\n\r\n/** Create a toggle switch input\r\n * @param {*} options\r\n *  @param {string|Element} options.html\r\n *  @param {string|Element} options.after\r\n *  @param {string} [options.name] input name\r\n *  @param {string} [options.type=checkbox] input type: radio or checkbox\r\n *  @param {string} options.value input value\r\n *  @param {*} [options.on] a list of actions\r\n *  @param {function} [options.click]\r\n *  @param {function} [options.change]\r\n *  @param {Element} options.parent\r\n */\r\nol_ext_element.createCheck = function (options) {\r\n  var input = ol_ext_element.create('INPUT', {\r\n    name: options.name,\r\n    type: (options.type==='radio' ? 'radio' : 'checkbox'),\r\n    on: options.on,\r\n    parent: options.parent\r\n  });\r\n  console.log(input)\r\n  var opt = Object.assign ({ input: input }, options || {});\r\n  if (options.type === 'radio') {\r\n    new ol_ext_input_Radio(opt);\r\n  } else {\r\n    new ol_ext_input_Checkbox(opt);\r\n  }\r\n  return input;\r\n};\r\n\r\n/** Set inner html or append a child element to an element\r\n * @param {Element} element\r\n * @param {Element|string} html Content of the element\r\n */\r\nol_ext_element.setHTML = function(element, html) {\r\n  if (html instanceof Element) element.appendChild(html)\r\n  else if (html!==undefined) element.innerHTML = html;\r\n};\r\n\r\n/** Append text into an elemnt\r\n * @param {Element} element\r\n * @param {string} text text content\r\n */\r\nol_ext_element.appendText = function(element, text) {\r\n  element.appendChild(document.createTextNode(text||''));\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.addListener = function (element, eventType, fn, useCapture ) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.addEventListener(e, fn, useCapture);\r\n  });\r\n};\r\n\r\n/**\r\n * Add a set of event listener to an element\r\n * @param {Element} element\r\n * @param {string|Array<string>} eventType\r\n * @param {function} fn\r\n */\r\nol_ext_element.removeListener = function (element, eventType, fn) {\r\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\r\n  eventType.forEach(function(e) {\r\n    element.removeEventListener(e, fn);\r\n  });\r\n};\r\n\r\n/**\r\n * Show an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.show = function (element) {\r\n  element.style.display = '';\r\n};\r\n\r\n/**\r\n * Hide an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.hide = function (element) {\r\n  element.style.display = 'none';\r\n};\r\n\r\n/**\r\n * Test if an element is hihdden\r\n * @param {Element} element\r\n * @return {boolean}\r\n */\r\nol_ext_element.hidden = function (element) {\r\n  return ol_ext_element.getStyle(element, 'display') === 'none';\r\n};\r\n\r\n/**\r\n * Toggle an element\r\n * @param {Element} element\r\n */\r\nol_ext_element.toggle = function (element) {\r\n  element.style.display = (element.style.display==='none' ? '' : 'none');\r\n};\r\n\r\n/** Set style of an element\r\n * @param {DOMElement} el the element\r\n * @param {*} st list of style\r\n */\r\nol_ext_element.setStyle = function(el, st) {\r\n  for (var s in st) {\r\n    switch (s) {\r\n      case 'top':\r\n      case 'left':\r\n      case 'bottom':\r\n      case 'right':\r\n      case 'minWidth':\r\n      case 'maxWidth':\r\n      case 'width':\r\n      case 'height': {\r\n        if (typeof(st[s]) === 'number') {\r\n          el.style[s] = st[s]+'px';\r\n        } else {\r\n          el.style[s] = st[s];\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        el.style[s] = st[s];\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Get style propertie of an element\r\n * @param {DOMElement} el the element\r\n * @param {string} styleProp Propertie name\r\n * @return {*} style value\r\n */\r\nol_ext_element.getStyle = function(el, styleProp) {\r\n  var value, defaultView = (el.ownerDocument || document).defaultView;\r\n  // W3C standard way:\r\n  if (defaultView && defaultView.getComputedStyle) {\r\n    // sanitize property name to css notation\r\n    // (hypen separated words eg. font-Size)\r\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\r\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\r\n  } else if (el.currentStyle) { // IE\r\n    // sanitize property name to camelCase\r\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\r\n      return letter.toUpperCase();\r\n    });\r\n    value = el.currentStyle[styleProp];\r\n    // convert other units to pixels on IE\r\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \r\n      return (function(value) {\r\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\r\n        el.runtimeStyle.left = el.currentStyle.left;\r\n        el.style.left = value || 0;\r\n        value = el.style.pixelLeft + \"px\";\r\n        el.style.left = oldLeft;\r\n        el.runtimeStyle.left = oldRsLeft;\r\n        return value;\r\n      })(value);\r\n    }\r\n  }\r\n  if (/px$/.test(value)) return parseInt(value);\r\n  return value;\r\n};\r\n\r\n/** Get outerHeight of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerHeight = function(elt) {\r\n  return elt.offsetHeight + ol_ext_element.getStyle(elt, 'marginBottom')\r\n};\r\n\r\n/** Get outerWidth of an elemen\r\n * @param {DOMElement} elt\r\n * @return {number}\r\n */\r\nol_ext_element.outerWidth = function(elt) {\r\n  return elt.offsetWidth + ol_ext_element.getStyle(elt, 'marginLeft')\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @return {*} \r\n */\r\nol_ext_element.offsetRect = function(elt) {\r\n  var rect = elt.getBoundingClientRect();\r\n  return {\r\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\r\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\r\n    height: rect.height || (rect.bottom - rect.top),\r\n    width: rect.width || (rect.right - rect.left)\r\n  }\r\n};\r\n\r\n/** Get element offset \r\n * @param {ELement} elt\r\n * @returns {Object} top/left offset\r\n */\r\nol_ext_element.getFixedOffset = function(elt) {\r\n  var offset = {\r\n    left:0,\r\n    top:0\r\n  };\r\n  var getOffset = function(parent) {\r\n    if (!parent) return offset;\r\n    // Check position when transform\r\n    if (ol_ext_element.getStyle(parent, 'position') === 'absolute'\r\n      && ol_ext_element.getStyle(parent, 'transform') !== \"none\") {\r\n      var r = parent.getBoundingClientRect();\r\n      offset.left += r.left; \r\n      offset.top += r.top; \r\n      return offset;\r\n    }\r\n    return getOffset(parent.offsetParent)\r\n  }\r\n  return getOffset(elt.offsetParent)\r\n};\r\n\r\n/** Get element offset rect\r\n * @param {DOMElement} elt\r\n * @param {boolean} fixed get fixed position\r\n * @return {Object} \r\n */\r\nol_ext_element.positionRect = function(elt, fixed) {\r\n  var gleft = 0;\r\n  var gtop = 0;\r\n\r\n  var getRect = function( parent ) {\r\n    if (parent) {\r\n      gleft += parent.offsetLeft;\r\n      gtop += parent.offsetTop;\r\n      return getRect(parent.offsetParent);\r\n    } else {\r\n      var r = {\r\n        top: elt.offsetTop + gtop,\r\n        left: elt.offsetLeft + gleft\r\n      };\r\n      if (fixed) {\r\n        r.top -= (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0);\r\n        r.left -= (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0);\r\n      }\r\n      r.bottom = r.top + elt.offsetHeight;\r\n      r.right = r.top + elt.offsetWidth;\r\n      return r;\r\n    }\r\n  }; \r\n  return getRect(elt.offsetParent);\r\n}\r\n\r\n/** Make a div scrollable without scrollbar.\r\n * On touch devices the default behavior is preserved\r\n * @param {DOMElement} elt\r\n * @param {*} options\r\n *  @param {function} [options.onmove] a function that takes a boolean indicating that the div is scrolling\r\n *  @param {boolean} [options.vertical=false] \r\n *  @param {boolean} [options.animate=true] add kinetic to scroll\r\n *  @param {boolean} [options.mousewheel=false] enable mousewheel to scroll\r\n *  @param {boolean} [options.minibar=false] add a mini scrollbar to the parent element (only vertical scrolling)\r\n * @returns {Object} an object with a refresh function\r\n */\r\nol_ext_element.scrollDiv = function(elt, options) {\r\n  options = options || {};\r\n  var pos = false;\r\n  var speed = 0;\r\n  var d, dt = 0;\r\n\r\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\r\n  //var page = options.vertical ? 'pageY' : 'pageX';\r\n  var page = options.vertical ? 'screenY' : 'screenX';\r\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\r\n  var moving = false;\r\n  // Factor scale content / container\r\n  var scale, isbar;\r\n\r\n  // Update the minibar\r\n  var updateCounter = 0;\r\n  var updateMinibar = function() {\r\n    if (scrollbar) {\r\n      updateCounter++;\r\n      setTimeout(updateMinibarDelay);\r\n    }\r\n  }\r\n  var updateMinibarDelay = function() {\r\n    if (scrollbar) {\r\n      updateCounter--;\r\n      // Prevent multi call\r\n      if (updateCounter) return;\r\n      // Container height\r\n      var pheight = elt.clientHeight;\r\n      // Content height\r\n      var height = elt.scrollHeight;\r\n      // Set scrollbar value\r\n      scale = pheight / height;\r\n      scrollbar.style.height = scale * 100 + '%';\r\n      scrollbar.style.top = (elt.scrollTop / height * 100) + '%';\r\n      scrollContainer.style.height = pheight + 'px';\r\n      // No scroll\r\n      if (pheight > height - .5) scrollContainer.classList.add('ol-100pc');\r\n      else scrollContainer.classList.remove('ol-100pc');\r\n    }\r\n  }\r\n  \r\n  // Handle pointer down\r\n  var onPointerDown = function(e) {\r\n    // Prevent scroll\r\n    if (e.target.classList.contains('ol-noscroll')) return;\r\n    // Start scrolling\r\n    moving = false;\r\n    pos = e[page];\r\n    dt = new Date();\r\n    elt.classList.add('ol-move');\r\n    // Prevent elt dragging\r\n    e.preventDefault();\r\n    // Listen scroll\r\n    window.addEventListener('pointermove', onPointerMove);\r\n    ol_ext_element.addListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  }\r\n\r\n  // Register scroll\r\n  var onPointerMove = function(e) {\r\n    moving = true;\r\n    if (pos !== false) {\r\n      var delta = (isbar ? -1/scale : 1) * (pos - e[page]);\r\n      elt[scroll] += delta;\r\n      d = new Date();\r\n      if (d-dt) {\r\n        speed = (speed + delta / (d - dt))/2;\r\n      }\r\n      pos = e[page];\r\n      dt = d;\r\n      // Tell we are moving\r\n      if (delta) onmove(true);\r\n    }\r\n  };\r\n  \r\n  // Animate scroll\r\n  var animate = function(to) {\r\n    var step = (to>0) ? Math.min(100, to/2) : Math.max(-100, to/2);\r\n    to -= step;\r\n    elt[scroll] += step;\r\n    if (-1 < to && to < 1) {\r\n      if (moving) setTimeout(function() { elt.classList.remove('ol-move'); });\r\n      else elt.classList.remove('ol-move');\r\n      moving = false;\r\n      onmove(false);\r\n    } else {\r\n      setTimeout(function() {\r\n        animate(to);\r\n      }, 40);\r\n    }\r\n  }\r\n  \r\n  // Initialize scroll container for minibar\r\n  var scrollContainer, scrollbar;\r\n  if (options.vertical && options.minibar) {\r\n    var init = function(b) {\r\n      // only once\r\n      elt.removeEventListener('pointermove', init);\r\n      elt.parentNode.classList.add('ol-miniscroll');\r\n      scrollbar = ol_ext_element.create('DIV');\r\n      scrollContainer = ol_ext_element.create('DIV', {\r\n        className: 'ol-scroll',\r\n        html: scrollbar\r\n      });\r\n      elt.parentNode.insertBefore(scrollContainer, elt);\r\n      // Move scrollbar\r\n      scrollbar.addEventListener('pointerdown', function(e) {\r\n        isbar = true;\r\n        onPointerDown(e)\r\n      });\r\n      // Handle mousewheel\r\n      if (options.mousewheel) {\r\n        ol_ext_element.addListener(scrollContainer, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n        ol_ext_element.addListener(scrollbar, \r\n          ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n          function(e) { onMouseWheel(e) }\r\n        );\r\n      }\r\n      // Update on enter\r\n      elt.parentNode.addEventListener('pointerenter', updateMinibar);\r\n      // Update on resize\r\n      window.addEventListener('resize', updateMinibar);\r\n      // Update\r\n      if (b!==false) updateMinibar();\r\n    };\r\n    // Allready inserted in the DOM\r\n    if (elt.parentNode) init(false);\r\n    // or wait when ready\r\n    else elt.addEventListener('pointermove', init);\r\n    // Update on scroll\r\n    elt.addEventListener('scroll', function() {\r\n      updateMinibar();\r\n    });\r\n  }\r\n\r\n  // Enable scroll\r\n  elt.style['touch-action'] = 'none';\r\n  elt.style['overflow'] = 'hidden';\r\n  elt.classList.add('ol-scrolldiv');\r\n  \r\n  // Start scrolling\r\n  ol_ext_element.addListener(elt, ['pointerdown'], function(e) {\r\n    isbar = false;\r\n    onPointerDown(e)\r\n  });\r\n\r\n  // Prevet click when moving...\r\n  elt.addEventListener('click', function(e) {\r\n    if (elt.classList.contains('ol-move')) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }, true);\r\n\r\n  // Stop scrolling\r\n  var onPointerUp = function(e) {\r\n    dt = new Date() - dt;\r\n    if (dt>100 || isbar) {\r\n      // User stop: no speed\r\n      speed = 0;\r\n    } else if (dt>0) {\r\n      // Calculate new speed\r\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\r\n    }\r\n    animate(options.animate===false ? 0 : speed*200);\r\n    pos = false;\r\n    speed = 0;\r\n    dt = 0;\r\n    // Add class to handle click (on iframe / double-click)\r\n    if (!elt.classList.contains('ol-move')) {\r\n      elt.classList.add('ol-hasClick')\r\n      setTimeout(function() { elt.classList.remove('ol-hasClick'); }, 500);\r\n    } else {\r\n      elt.classList.remove('ol-hasClick');\r\n    }\r\n    isbar = false;\r\n    window.removeEventListener('pointermove', onPointerMove)\r\n    ol_ext_element.removeListener(window, ['pointerup','pointercancel'], onPointerUp);\r\n  };\r\n\r\n  // Handle mousewheel\r\n  var onMouseWheel = function(e) {\r\n    var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\r\n    elt.classList.add('ol-move');\r\n    elt[scroll] -= delta*30;\r\n    elt.classList.remove('ol-move');\r\n    return false;\r\n  }\r\n  if (options.mousewheel) { // && !elt.classList.contains('ol-touch')) {\r\n    ol_ext_element.addListener(elt, \r\n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \r\n      onMouseWheel\r\n    );\r\n  }\r\n\r\n  return { \r\n    refresh: updateMinibar\r\n  }\r\n};\r\n\r\n/** Dispatch an event to an Element \r\n * @param {string} eventName\r\n * @param {Element} element\r\n */\r\nol_ext_element.dispatchEvent = function (eventName, element) {\r\n  var event;\r\n  try {\r\n    event = new CustomEvent(eventName);\r\n  } catch(e) {\r\n    // Try customevent on IE\r\n    event = document.createEvent(\"CustomEvent\");\r\n    event.initCustomEvent(eventName, true, true, {});\r\n  }\r\n  element.dispatchEvent(event);\r\n};\r\n\r\nexport default ol_ext_element\r\n","\n\n\n/**\n * UTM zones are grouped, and assigned to one of a group of 6\n * sets.\n *\n * {int} @private\n */\nvar NUM_100K_SETS = 6;\n\n/**\n * The column letters (for easting) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';\n\n/**\n * The row letters (for northing) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_ROW_LETTERS = 'AFAFAF';\n\nvar A = 65; // A\nvar I = 73; // I\nvar O = 79; // O\nvar V = 86; // V\nvar Z = 90; // Z\nexport default {\n  forward: forward,\n  inverse: inverse,\n  toPoint: toPoint\n};\n/**\n * Conversion of lat/lon to MGRS.\n *\n * @param {object} ll Object literal with lat and lon properties on a\n *     WGS84 ellipsoid.\n * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for\n *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.\n * @return {string} the MGRS string for the given location and accuracy.\n */\nexport function forward(ll, accuracy) {\n  accuracy = accuracy || 5; // default accuracy 1m\n  return encode(LLtoUTM({\n    lat: ll[1],\n    lon: ll[0]\n  }), accuracy);\n};\n\n/**\n * Conversion of MGRS to lat/lon.\n *\n * @param {string} mgrs MGRS string.\n * @return {array} An array with left (longitude), bottom (latitude), right\n *     (longitude) and top (latitude) values in WGS84, representing the\n *     bounding box for the provided MGRS reference.\n */\nexport function inverse(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];\n  }\n  return [bbox.left, bbox.bottom, bbox.right, bbox.top];\n};\n\nexport function toPoint(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat];\n  }\n  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];\n};\n/**\n * Conversion from degrees to radians.\n *\n * @private\n * @param {number} deg the angle in degrees.\n * @return {number} the angle in radians.\n */\nfunction degToRad(deg) {\n  return (deg * (Math.PI / 180.0));\n}\n\n/**\n * Conversion from radians to degrees.\n *\n * @private\n * @param {number} rad the angle in radians.\n * @return {number} the angle in degrees.\n */\nfunction radToDeg(rad) {\n  return (180.0 * (rad / Math.PI));\n}\n\n/**\n * Converts a set of Longitude and Latitude co-ordinates to UTM\n * using the WGS84 ellipsoid.\n *\n * @private\n * @param {object} ll Object literal with lat and lon properties\n *     representing the WGS84 coordinate to be converted.\n * @return {object} Object literal containing the UTM value with easting,\n *     northing, zoneNumber and zoneLetter properties, and an optional\n *     accuracy property in digits. Returns null if the conversion failed.\n */\nfunction LLtoUTM(ll) {\n  var Lat = ll.lat;\n  var Long = ll.lon;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var k0 = 0.9996;\n  var LongOrigin;\n  var eccPrimeSquared;\n  var N, T, C, A, M;\n  var LatRad = degToRad(Lat);\n  var LongRad = degToRad(Long);\n  var LongOriginRad;\n  var ZoneNumber;\n  // (int)\n  ZoneNumber = Math.floor((Long + 180) / 6) + 1;\n\n  //Make sure the longitude 180.00 is in Zone 60\n  if (Long === 180) {\n    ZoneNumber = 60;\n  }\n\n  // Special zone for Norway\n  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {\n    ZoneNumber = 32;\n  }\n\n  // Special zones for Svalbard\n  if (Lat >= 72.0 && Lat < 84.0) {\n    if (Long >= 0.0 && Long < 9.0) {\n      ZoneNumber = 31;\n    }\n    else if (Long >= 9.0 && Long < 21.0) {\n      ZoneNumber = 33;\n    }\n    else if (Long >= 21.0 && Long < 33.0) {\n      ZoneNumber = 35;\n    }\n    else if (Long >= 33.0 && Long < 42.0) {\n      ZoneNumber = 37;\n    }\n  }\n\n  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin\n  // in middle of\n  // zone\n  LongOriginRad = degToRad(LongOrigin);\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));\n  T = Math.tan(LatRad) * Math.tan(LatRad);\n  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);\n  A = Math.cos(LatRad) * (LongRad - LongOriginRad);\n\n  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));\n\n  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);\n\n  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));\n  if (Lat < 0.0) {\n    UTMNorthing += 10000000.0; //10000000 meter offset for\n    // southern hemisphere\n  }\n\n  return {\n    northing: Math.round(UTMNorthing),\n    easting: Math.round(UTMEasting),\n    zoneNumber: ZoneNumber,\n    zoneLetter: getLetterDesignator(Lat)\n  };\n}\n\n/**\n * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience\n * class where the Zone can be specified as a single string eg.\"60N\" which\n * is then broken down into the ZoneNumber and ZoneLetter.\n *\n * @private\n * @param {object} utm An object literal with northing, easting, zoneNumber\n *     and zoneLetter properties. If an optional accuracy property is\n *     provided (in meters), a bounding box will be returned instead of\n *     latitude and longitude.\n * @return {object} An object literal containing either lat and lon values\n *     (if no accuracy was provided), or top, right, bottom and left values\n *     for the bounding box calculated according to the provided accuracy.\n *     Returns null if the conversion failed.\n */\nfunction UTMtoLL(utm) {\n\n  var UTMNorthing = utm.northing;\n  var UTMEasting = utm.easting;\n  var zoneLetter = utm.zoneLetter;\n  var zoneNumber = utm.zoneNumber;\n  // check the ZoneNummber is valid\n  if (zoneNumber < 0 || zoneNumber > 60) {\n    return null;\n  }\n\n  var k0 = 0.9996;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var eccPrimeSquared;\n  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));\n  var N1, T1, C1, R1, D, M;\n  var LongOrigin;\n  var mu, phi1Rad;\n\n  // remove 500,000 meter offset for longitude\n  var x = UTMEasting - 500000.0;\n  var y = UTMNorthing;\n\n  // We must know somehow if we are in the Northern or Southern\n  // hemisphere, this is the only time we use the letter So even\n  // if the Zone letter isn't exactly correct it should indicate\n  // the hemisphere correctly\n  if (zoneLetter < 'N') {\n    y -= 10000000.0; // remove 10,000,000 meter offset used\n    // for southern hemisphere\n  }\n\n  // There are 60 zones with zone 1 being at West -180 to -174\n  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin\n  // in middle of\n  // zone\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  M = y / k0;\n  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));\n\n  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);\n  // double phi1 = ProjMath.radToDeg(phi1Rad);\n\n  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));\n  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);\n  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);\n  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);\n  D = x / (N1 * k0);\n\n  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);\n  lat = radToDeg(lat);\n\n  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);\n  lon = LongOrigin + radToDeg(lon);\n\n  var result;\n  if (utm.accuracy) {\n    var topRight = UTMtoLL({\n      northing: utm.northing + utm.accuracy,\n      easting: utm.easting + utm.accuracy,\n      zoneLetter: utm.zoneLetter,\n      zoneNumber: utm.zoneNumber\n    });\n    result = {\n      top: topRight.lat,\n      right: topRight.lon,\n      bottom: lat,\n      left: lon\n    };\n  }\n  else {\n    result = {\n      lat: lat,\n      lon: lon\n    };\n  }\n  return result;\n}\n\n/**\n * Calculates the MGRS letter designator for the given latitude.\n *\n * @private\n * @param {number} lat The latitude in WGS84 to get the letter designator\n *     for.\n * @return {char} The letter designator.\n */\nfunction getLetterDesignator(lat) {\n  //This is here as an error flag to show that the Latitude is\n  //outside MGRS limits\n  var LetterDesignator = 'Z';\n\n  if ((84 >= lat) && (lat >= 72)) {\n    LetterDesignator = 'X';\n  }\n  else if ((72 > lat) && (lat >= 64)) {\n    LetterDesignator = 'W';\n  }\n  else if ((64 > lat) && (lat >= 56)) {\n    LetterDesignator = 'V';\n  }\n  else if ((56 > lat) && (lat >= 48)) {\n    LetterDesignator = 'U';\n  }\n  else if ((48 > lat) && (lat >= 40)) {\n    LetterDesignator = 'T';\n  }\n  else if ((40 > lat) && (lat >= 32)) {\n    LetterDesignator = 'S';\n  }\n  else if ((32 > lat) && (lat >= 24)) {\n    LetterDesignator = 'R';\n  }\n  else if ((24 > lat) && (lat >= 16)) {\n    LetterDesignator = 'Q';\n  }\n  else if ((16 > lat) && (lat >= 8)) {\n    LetterDesignator = 'P';\n  }\n  else if ((8 > lat) && (lat >= 0)) {\n    LetterDesignator = 'N';\n  }\n  else if ((0 > lat) && (lat >= -8)) {\n    LetterDesignator = 'M';\n  }\n  else if ((-8 > lat) && (lat >= -16)) {\n    LetterDesignator = 'L';\n  }\n  else if ((-16 > lat) && (lat >= -24)) {\n    LetterDesignator = 'K';\n  }\n  else if ((-24 > lat) && (lat >= -32)) {\n    LetterDesignator = 'J';\n  }\n  else if ((-32 > lat) && (lat >= -40)) {\n    LetterDesignator = 'H';\n  }\n  else if ((-40 > lat) && (lat >= -48)) {\n    LetterDesignator = 'G';\n  }\n  else if ((-48 > lat) && (lat >= -56)) {\n    LetterDesignator = 'F';\n  }\n  else if ((-56 > lat) && (lat >= -64)) {\n    LetterDesignator = 'E';\n  }\n  else if ((-64 > lat) && (lat >= -72)) {\n    LetterDesignator = 'D';\n  }\n  else if ((-72 > lat) && (lat >= -80)) {\n    LetterDesignator = 'C';\n  }\n  return LetterDesignator;\n}\n\n/**\n * Encodes a UTM location as MGRS string.\n *\n * @private\n * @param {object} utm An object literal with easting, northing,\n *     zoneLetter, zoneNumber\n * @param {number} accuracy Accuracy in digits (1-5).\n * @return {string} MGRS string for the given UTM location.\n */\nfunction encode(utm, accuracy) {\n  // prepend with leading zeroes\n  var seasting = \"00000\" + utm.easting,\n    snorthing = \"00000\" + utm.northing;\n\n  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);\n}\n\n/**\n * Get the two letter 100k designator for a given UTM easting,\n * northing and zone number value.\n *\n * @private\n * @param {number} easting\n * @param {number} northing\n * @param {number} zoneNumber\n * @return the two letter 100k designator for the given UTM location.\n */\nfunction get100kID(easting, northing, zoneNumber) {\n  var setParm = get100kSetForZone(zoneNumber);\n  var setColumn = Math.floor(easting / 100000);\n  var setRow = Math.floor(northing / 100000) % 20;\n  return getLetter100kID(setColumn, setRow, setParm);\n}\n\n/**\n * Given a UTM zone number, figure out the MGRS 100K set it is in.\n *\n * @private\n * @param {number} i An UTM zone number.\n * @return {number} the 100k set the UTM zone is in.\n */\nfunction get100kSetForZone(i) {\n  var setParm = i % NUM_100K_SETS;\n  if (setParm === 0) {\n    setParm = NUM_100K_SETS;\n  }\n\n  return setParm;\n}\n\n/**\n * Get the two-letter MGRS 100k designator given information\n * translated from the UTM northing, easting and zone number.\n *\n * @private\n * @param {number} column the column index as it relates to the MGRS\n *        100k set spreadsheet, created from the UTM easting.\n *        Values are 1-8.\n * @param {number} row the row index as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM northing value. Values\n *        are from 0-19.\n * @param {number} parm the set block, as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM zone. Values are from\n *        1-60.\n * @return two letter MGRS 100k code.\n */\nfunction getLetter100kID(column, row, parm) {\n  // colOrigin and rowOrigin are the letters at the origin of the set\n  var index = parm - 1;\n  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);\n  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);\n\n  // colInt and rowInt are the letters to build to return\n  var colInt = colOrigin + column - 1;\n  var rowInt = rowOrigin + row;\n  var rollover = false;\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n    rollover = true;\n  }\n\n  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {\n    colInt++;\n  }\n\n  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {\n    colInt++;\n\n    if (colInt === I) {\n      colInt++;\n    }\n  }\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n    rollover = true;\n  }\n  else {\n    rollover = false;\n  }\n\n  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {\n    rowInt++;\n  }\n\n  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {\n    rowInt++;\n\n    if (rowInt === I) {\n      rowInt++;\n    }\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n  }\n\n  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);\n  return twoLetter;\n}\n\n/**\n * Decode the UTM parameters from a MGRS string.\n *\n * @private\n * @param {string} mgrsString an UPPERCASE coordinate string is expected.\n * @return {object} An object literal with easting, northing, zoneLetter,\n *     zoneNumber and accuracy (in meters) properties.\n */\nfunction decode(mgrsString) {\n\n  if (mgrsString && mgrsString.length === 0) {\n    throw (\"MGRSPoint coverting from nothing\");\n  }\n\n  var length = mgrsString.length;\n\n  var hunK = null;\n  var sb = \"\";\n  var testChar;\n  var i = 0;\n\n  // get Zone number\n  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {\n    if (i >= 2) {\n      throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n    }\n    sb += testChar;\n    i++;\n  }\n\n  var zoneNumber = parseInt(sb, 10);\n\n  if (i === 0 || i + 3 > length) {\n    // A good MGRS string has to be 4-5 digits long,\n    // ##AAA/#AAA at least.\n    throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n  }\n\n  var zoneLetter = mgrsString.charAt(i++);\n\n  // Should we check the zone letter here? Why not.\n  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {\n    throw (\"MGRSPoint zone letter \" + zoneLetter + \" not handled: \" + mgrsString);\n  }\n\n  hunK = mgrsString.substring(i, i += 2);\n\n  var set = get100kSetForZone(zoneNumber);\n\n  var east100k = getEastingFromChar(hunK.charAt(0), set);\n  var north100k = getNorthingFromChar(hunK.charAt(1), set);\n\n  // We have a bug where the northing may be 2000000 too low.\n  // How\n  // do we know when to roll over?\n\n  while (north100k < getMinNorthing(zoneLetter)) {\n    north100k += 2000000;\n  }\n\n  // calculate the char index for easting/northing separator\n  var remainder = length - i;\n\n  if (remainder % 2 !== 0) {\n    throw (\"MGRSPoint has to have an even number \\nof digits after the zone letter and two 100km letters - front \\nhalf for easting meters, second half for \\nnorthing meters\" + mgrsString);\n  }\n\n  var sep = remainder / 2;\n\n  var sepEasting = 0.0;\n  var sepNorthing = 0.0;\n  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;\n  if (sep > 0) {\n    accuracyBonus = 100000.0 / Math.pow(10, sep);\n    sepEastingString = mgrsString.substring(i, i + sep);\n    sepEasting = parseFloat(sepEastingString) * accuracyBonus;\n    sepNorthingString = mgrsString.substring(i + sep);\n    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;\n  }\n\n  easting = sepEasting + east100k;\n  northing = sepNorthing + north100k;\n\n  return {\n    easting: easting,\n    northing: northing,\n    zoneLetter: zoneLetter,\n    zoneNumber: zoneNumber,\n    accuracy: accuracyBonus\n  };\n}\n\n/**\n * Given the first letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the easting value that\n * should be added to the other, secondary easting value.\n *\n * @private\n * @param {char} e The first letter from a two-letter MGRS 100k zone.\n * @param {number} set The MGRS table set for the zone number.\n * @return {number} The easting value for the given letter and set.\n */\nfunction getEastingFromChar(e, set) {\n  // colOrigin is the letter at the origin of the set for the\n  // column\n  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);\n  var eastingValue = 100000.0;\n  var rewindMarker = false;\n\n  while (curCol !== e.charCodeAt(0)) {\n    curCol++;\n    if (curCol === I) {\n      curCol++;\n    }\n    if (curCol === O) {\n      curCol++;\n    }\n    if (curCol > Z) {\n      if (rewindMarker) {\n        throw (\"Bad character: \" + e);\n      }\n      curCol = A;\n      rewindMarker = true;\n    }\n    eastingValue += 100000.0;\n  }\n\n  return eastingValue;\n}\n\n/**\n * Given the second letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the northing value that\n * should be added to the other, secondary northing value. You have to\n * remember that Northings are determined from the equator, and the vertical\n * cycle of letters mean a 2000000 additional northing meters. This happens\n * approx. every 18 degrees of latitude. This method does *NOT* count any\n * additional northings. You have to figure out how many 2000000 meters need\n * to be added for the zone letter of the MGRS coordinate.\n *\n * @private\n * @param {char} n Second letter of the MGRS 100k zone\n * @param {number} set The MGRS table set number, which is dependent on the\n *     UTM zone number.\n * @return {number} The northing value for the given letter and set.\n */\nfunction getNorthingFromChar(n, set) {\n\n  if (n > 'V') {\n    throw (\"MGRSPoint given invalid Northing \" + n);\n  }\n\n  // rowOrigin is the letter at the origin of the set for the\n  // column\n  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);\n  var northingValue = 0.0;\n  var rewindMarker = false;\n\n  while (curRow !== n.charCodeAt(0)) {\n    curRow++;\n    if (curRow === I) {\n      curRow++;\n    }\n    if (curRow === O) {\n      curRow++;\n    }\n    // fixing a bug making whole application hang in this loop\n    // when 'n' is a wrong character\n    if (curRow > V) {\n      if (rewindMarker) { // making sure that this loop ends\n        throw (\"Bad character: \" + n);\n      }\n      curRow = A;\n      rewindMarker = true;\n    }\n    northingValue += 100000.0;\n  }\n\n  return northingValue;\n}\n\n/**\n * The function getMinNorthing returns the minimum northing value of a MGRS\n * zone.\n *\n * Ported from Geotrans' c Lattitude_Band_Value structure table.\n *\n * @private\n * @param {char} zoneLetter The MGRS zone to get the min northing for.\n * @return {number}\n */\nfunction getMinNorthing(zoneLetter) {\n  var northing;\n  switch (zoneLetter) {\n  case 'C':\n    northing = 1100000.0;\n    break;\n  case 'D':\n    northing = 2000000.0;\n    break;\n  case 'E':\n    northing = 2800000.0;\n    break;\n  case 'F':\n    northing = 3700000.0;\n    break;\n  case 'G':\n    northing = 4600000.0;\n    break;\n  case 'H':\n    northing = 5500000.0;\n    break;\n  case 'J':\n    northing = 6400000.0;\n    break;\n  case 'K':\n    northing = 7300000.0;\n    break;\n  case 'L':\n    northing = 8200000.0;\n    break;\n  case 'M':\n    northing = 9100000.0;\n    break;\n  case 'N':\n    northing = 0.0;\n    break;\n  case 'P':\n    northing = 800000.0;\n    break;\n  case 'Q':\n    northing = 1700000.0;\n    break;\n  case 'R':\n    northing = 2600000.0;\n    break;\n  case 'S':\n    northing = 3500000.0;\n    break;\n  case 'T':\n    northing = 4400000.0;\n    break;\n  case 'U':\n    northing = 5300000.0;\n    break;\n  case 'V':\n    northing = 6200000.0;\n    break;\n  case 'W':\n    northing = 7000000.0;\n    break;\n  case 'X':\n    northing = 7900000.0;\n    break;\n  default:\n    northing = -1.0;\n  }\n  if (northing >= 0.0) {\n    return northing;\n  }\n  else {\n    throw (\"Invalid zone letter: \" + zoneLetter);\n  }\n\n}\n","/** @namespace  ol.ext\r\n */\r\n/*global ol*/\r\nif (window.ol && !ol.ext) {\r\n  ol.ext = {};\r\n}\r\n\r\n/** Inherit the prototype methods from one constructor into another.\r\n * replace deprecated ol method\r\n *\r\n * @param {!Function} childCtor Child constructor.\r\n * @param {!Function} parentCtor Parent constructor.\r\n * @function module:ol.inherits\r\n * @api\r\n */\r\nvar ol_ext_inherits = function(child,parent) {\r\n  child.prototype = Object.create(parent.prototype);\r\n  child.prototype.constructor = child;\r\n};\r\n\r\n// Compatibilty with ol > 5 to be removed when v6 is out\r\nif (window.ol) {\r\n  if (!ol.inherits) ol.inherits = ol_ext_inherits;\r\n}\r\n\r\n/* IE Polyfill */\r\n// NodeList.forEach\r\nif (window.NodeList && !NodeList.prototype.forEach) {\r\n  NodeList.prototype.forEach = Array.prototype.forEach;\r\n}\r\n// Element.remove\r\nif (window.Element && !Element.prototype.remove) {\r\n  Element.prototype.remove = function() {\r\n    if (this.parentNode) this.parentNode.removeChild(this);\r\n  }\r\n}\r\n/* End Polyfill */\r\n\r\nexport { ol_ext_inherits }\r\nexport default ol_ext_inherits\r\n"],"sourceRoot":""}