"use strict";(globalThis["webpackChunk_openeo_web_editor"]=globalThis["webpackChunk_openeo_web_editor"]||[]).push([[7213,5839,2722,9409],{35254:(e,t,s)=>{s.d(t,{A:()=>i});const i={components:{FederationNotice:()=>s.e(2604).then(s.bind(s,52604)),FederationMissingNotice:()=>s.e(5363).then(s.bind(s,35363))},props:{federation:{type:Object,default:()=>({})}}}},69748:(e,t,s)=>{s.d(t,{A:()=>u});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component collections"},[t("SearchableList",{attrs:{data:e.collections,identifierKey:"id",summaryKey:"title",keywordsKey:"keywords",showKeywords:e.showKeywords,showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed,loadAdditionalData:e.loadAdditionalData,allowCopy:""},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(t){return[e._t("summary",null,null,t)]}},{key:"details",fn:function(s){return[t("Collection",{attrs:{data:s.item,mapOptions:e.mapOptions,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("collection-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("collection-end",null,null,t)]}},{key:"spatial-extents",fn:function(t){return[e._t("collection-spatial-extents",null,null,t)]}},{key:"temporal-extents",fn:function(t){return[e._t("collection-temporal-extents",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},a=[],r=s(86975),o=s(35254);const n={name:"Collections",components:{Collection:()=>r.A.loadAsyncComponent(Promise.all([s.e(156),s.e(2919),s.e(4432),s.e(9140),s.e(2281),s.e(3249)]).then(s.bind(s,3249))),SearchableList:()=>r.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152)))},mixins:[o.A],props:{collections:{type:Array,default:()=>[]},mapOptions:{type:Object,default:()=>({})},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"Collections"},collapsed:{type:Boolean,default:null},loadAdditionalData:{type:Function,default:null},showKeywords:{type:Boolean,default:!1},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},missing:{type:Array,default:null},...o.A.props},beforeCreate(){r.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,i,a,!1,null,null,null);const u=d.exports},90334:(e,t,s)=>{s.d(t,{A:()=>u});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component file-formats"},[t("SearchableList",{attrs:{data:e.fileFormats,summaryKey:"title",keywordsKey:"gis_data_types",showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(s){return[e._t("summary",(function(){return[t("strong",{staticClass:"inline"},[e._v(e._s(s.item.name))]),t("ul",{staticClass:"badges small inline"},[e.showAll&&"input"===s.item.type?t("li",{staticClass:"badge option1"},[e._v("Import")]):e._e(),e.showAll&&"output"===s.item.type?t("li",{staticClass:"badge option2"},[e._v("Export")]):e._e(),Array.isArray(s.item.gis_data_types)?e._l(s.item.gis_data_types,(function(s){return t("li",{key:s,staticClass:"badge gis"},[e._v(e._s(s))])})):e._e()],2),t("br"),t("small",[e._v(e._s(s.summary.summary))])]}),null,s)]}},{key:"details",fn:function(s){return[t("FileFormat",{attrs:{id:s.summary.identifier,format:s.item,type:s.item.type,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"badges",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("file-format-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("file-format-end",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},a=[],r=s(86975),o=s(35254);const n={name:"FileFormats",components:{SearchableList:()=>r.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152))),FileFormat:()=>r.A.loadAsyncComponent(s.e(3504).then(s.bind(s,13504)))},mixins:[o.A],props:{formats:{type:Object,default:()=>({})},showInput:{type:Boolean,default:!0},showOutput:{type:Boolean,default:!0},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"File Formats"},collapsed:{type:Boolean,default:null},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},missing:{type:Array,default:null},...o.A.props},computed:{showAll(){return this.showInput&&this.showOutput},typesToShow(){let e=[];return this.showInput&&e.push("input"),this.showOutput&&e.push("output"),e},fileFormats(){let e=[];for(let s of this.typesToShow)for(var t in this.formats[s]){let i=Object.assign({id:`${t}-${s}`,name:t,type:s},this.formats[s][t]);e.push(i)}return e}},beforeCreate(){r.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,i,a,!1,null,null,null);const u=d.exports},48312:(e,t,s)=>{s.d(t,{A:()=>u});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component processes"},[t("SearchableList",{attrs:{data:e.processes,keywordsKey:"categories",showKeywords:e.showCategories,showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed,loadAdditionalData:e.loadAdditionalData,allowCopy:""},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},e.missing?{key:"content-start",fn:function(){return[t("FederationMissingNotice",{attrs:{missing:e.missing,federation:e.federation}})]},proxy:!0}:null,{key:"summary",fn:function(t){return[e._t("summary",null,null,t)]}},{key:"details",fn:function(s){return[t("Process",{attrs:{process:s.item,provideDownload:e.provideDownload,processUrl:e.processUrl,showGraph:e.showGraph,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"before-description",fn:function(t){return[e._t("process-before-description",null,null,t)]}},{key:"end",fn:function(t){return[e._t("process-end",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},a=[],r=s(86975),o=s(35254);const n={name:"Processes",components:{Process:()=>r.A.loadAsyncComponent(s.e(6660).then(s.bind(s,34279))),SearchableList:()=>r.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152)))},mixins:[o.A],props:{processes:{type:Array,default:()=>[]},provideDownload:{type:Boolean,default:!0},processUrl:String,searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"Processes"},collapsed:{type:Boolean,default:null},showCategories:{type:Boolean,default:!1},showGraph:{type:Boolean,default:!1},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},loadAdditionalData:{type:Function,default:null},missing:{type:Array,default:null},...o.A.props},beforeCreate(){r.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,i,a,!1,null,null,null);const u=d.exports},9409:(e,t,s)=>{s.r(t),s.d(t,{default:()=>c});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component search-box",class:{compact:e.compact}},[t("span",{staticClass:"icon"},[e._v("ðŸ”Ž")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{type:"search",placeholder:e.placeholder,minlength:e.minLength,title:e.searchHint},domProps:{value:e.searchTerm},on:{input:function(t){t.target.composing||(e.searchTerm=t.target.value)}}})])},a=[];const r={name:"SearchBox",props:{value:{type:String,default:""},placeholder:{type:String,default:"Search"},minLength:{type:Number,default:1},compact:{type:Boolean,default:!1}},data(){return{searchTerm:this.value}},watch:{searchTerm(e,t){e.length<this.minLength&&(e=""),this.$emit("input",e)}},computed:{searchHint(){return this.minLength>1?`Searching requires at least ${this.minLength} characters.`:null}}},o=r;var n=s(81656),l=(0,n.A)(o,i,a,!1,null,null,null);const c=l.exports},91065:(e,t,s)=>{s.d(t,{A:()=>u});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component udf-runtimes"},[t("SearchableList",{attrs:{data:e.runtimes,summaryKey:"title",showSummaryOnExpand:!1,externalSearchTerm:e.searchTerm,externalHideDeprecated:e.hideDeprecated,deprecatedFilter:e.deprecatedFilter,externalHideExperimental:e.hideExperimental,experimentalFilter:e.experimentalFilter,sort:e.sort,offerDetails:e.offerDetails,heading:e.heading,collapsed:e.collapsed},on:{detailsToggled:e.detailsToggled},scopedSlots:e._u([{key:"heading",fn:function(t){return[e._t("heading",null,null,t)]}},{key:"summary",fn:function(s){return[e._t("summary",(function(){return[t("strong",{staticClass:"inline"},[e._v(e._s(s.summary.identifier))]),t("ul",{staticClass:"badges small inline"},["docker"===s.item.type||s.item.docker&&s.item.tags?[t("li",{staticClass:"badge docker"},[e._v("Docker")]),e._l(s.item.tags,(function(i){return t("li",{key:i,staticClass:"badge version",class:{default:i===s.item.default}},[e._v(e._s(i))])}))]:e._l(s.item.versions,(function(i,a){return t("li",{key:a,staticClass:"badge version",class:{default:a===s.item.default}},[e._v(e._s(a))])}))],2),t("br"),t("small",[e._v(e._s(s.summary.summary))])]}),null,s)]}},{key:"details",fn:function(s){return[t("UdfRuntime",{attrs:{id:s.summary.identifier,runtime:s.item,federation:e.federation},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"hidden"})]},proxy:!0},{key:"badges",fn:function(t){return[e._t("udf-runtime-badges",null,null,t)]}},{key:"before-description",fn:function(t){return[e._t("udf-runtime-before-description",null,null,t)]}}],null,!0)})]}}],null,!0)})],1)},a=[],r=s(86975),o=s(35254);const n={name:"UdfRuntimes",components:{SearchableList:()=>r.A.loadAsyncComponent(s.e(4152).then(s.bind(s,34152))),UdfRuntime:()=>r.A.loadAsyncComponent(s.e(3271).then(s.bind(s,33271)))},mixins:[o.A],props:{runtimes:{type:Object,default:()=>({})},searchTerm:{type:String,default:null},sort:{type:Boolean,default:!0},offerDetails:{type:Boolean,default:!0},heading:{type:String,default:"UDF Runtimes"},collapsed:{type:Boolean,default:null},hideDeprecated:{type:Boolean,default:!1},deprecatedFilter:{type:Boolean,default:!1},hideExperimental:{type:Boolean,default:!1},experimentalFilter:{type:Boolean,default:!1},...o.A.props},beforeCreate(){r.A.enableHtmlProps(this)},methods:{detailsToggled(...e){this.$emit("detailsToggled",...e)}}},l=n;var c=s(81656),d=(0,c.A)(l,i,a,!1,null,null,null);const u=d.exports},36107:(e,t,s)=>{s.d(t,{A:()=>g});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"discovery-toolbar"},[t("SearchBox",{model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),t("div",{staticClass:"filters"},[t("span",{staticClass:"label"},[e._v(" Show ")]),t("label",{staticClass:"show-deprecated",attrs:{title:"Show deprecated elements?"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.showDeprecated,expression:"showDeprecated"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showDeprecated)?e._i(e.showDeprecated,null)>-1:e.showDeprecated},on:{change:function(t){var s=e.showDeprecated,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,o=e._i(s,r);i.checked?o<0&&(e.showDeprecated=s.concat([r])):o>-1&&(e.showDeprecated=s.slice(0,o).concat(s.slice(o+1)))}else e.showDeprecated=a}}}),e._v(" deprecated ")]),t("label",{staticClass:"show-experimental",attrs:{title:"Show experimental elements?"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.showExperimental,expression:"showExperimental"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showExperimental)?e._i(e.showExperimental,null)>-1:e.showExperimental},on:{change:function(t){var s=e.showExperimental,i=t.target,a=!!i.checked;if(Array.isArray(s)){var r=null,o=e._i(s,r);i.checked?o<0&&(e.showExperimental=s.concat([r])):o>-1&&(e.showExperimental=s.slice(0,o).concat(s.slice(o+1)))}else e.showExperimental=a}}}),e._v(" experimental ")])]),t("div",{staticClass:"search-results"},[t("Collections",{staticClass:"category",attrs:{collections:e.collections,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsLoadCollection},on:{dragstart:function(t){return e.onDrag(t,"collection",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showCollectionInfo(s.id)}}},[t("strong",{attrs:{title:s.id}},[e._v(e._s(s.id))]),s.title?t("small",{attrs:{title:s.title}},[e._v(e._s(s.title))]):e._e()]),e.hasCollectionPreview(s)?t("button",{staticClass:"discovery-button",attrs:{type:"button",title:"View on map"},on:{click:function(t){return e.showCollectionPreview(s)}}},[t("i",{staticClass:"fas fa-map"})]):e._e()])]}}])}),t("Processes",{staticClass:"category",attrs:{processes:e.allProcesses,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:"true"},on:{dragstart:function(t){return e.onDrag(t,"process",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showProcess(s)}}},["user"===s.namespace?t("i",{staticClass:"custom-process fas fa-xs fa-sitemap",attrs:{title:"Custom Process"}}):"backend"!==s.namespace?t("i",{staticClass:"custom-process fas fa-xs fa-tag",attrs:{title:`Process from namespace '${s.namespace}'`}}):e._e(),t("strong",{attrs:{title:s.id}},[e._v(e._s(s.id))]),s.summary?t("small",{attrs:{title:s.summary}},[e._v(e._s(s.summary))]):e._e()])])]}}])}),e.hasUdfRuntimes?t("UdfRuntimes",{staticClass:"category",attrs:{runtimes:e.udfRuntimes,searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({summary:s,item:i}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsRunUdf},on:{dragstart:function(t){return e.onDrag(t,"udf",{runtime:s.identifier,version:i.default})}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showUdfInfo(s.identifier,i)}}},[t("strong",{attrs:{title:s.identifier}},[e._v(e._s(s.identifier)+" ("+e._s(i.default)+")")]),s.summary?t("small",{attrs:{title:s.summary}},[e._v(e._s(s.summary))]):e._e()])])]}}],null,!1,92063951)}):e._e(),t("FileFormats",{staticClass:"category",attrs:{formats:e.fileFormats,showInput:!1,heading:"Export File Formats",searchTerm:e.searchTerm,offerDetails:!1,collapsed:e.collapsed,hideDeprecated:!e.showDeprecated,hideExperimental:!e.showExperimental},scopedSlots:e._u([{key:"summary",fn:function({item:s}){return[t("div",{staticClass:"discovery-entity",attrs:{draggable:e.supportsSaveResult},on:{dragstart:function(t){return e.onDrag(t,"fileformat",s)}}},[t("div",{staticClass:"discovery-info",on:{click:function(t){return e.showFileFormatInfo(s)}}},[t("strong",{attrs:{title:s.name}},[e._v(e._s(s.name))]),s.title?t("small",{attrs:{title:s.title}},[e._v(e._s(s.title))]):e._e()])])]}}])})],1)],1)},a=[],r=s(61663),o=s(2566),n=s(69748),l=s(90334),c=s(48312),d=s(9409),u=s(91065);const p={name:"DiscoveryToolbar",mixins:[r.A],components:{Collections:n.A,FileFormats:l.A,Processes:c.A,SearchBox:d["default"],UdfRuntimes:u.A},props:{onAddProcess:{type:Function,required:!0},collectionPreview:{type:Boolean,default:!1},persist:{type:Boolean,default:!1}},data(){return{internalSearchTerm:"",collapsed:!0,showDeprecated:this.$config.showDeprecatedByDefault||!1,showExperimental:this.$config.showExperimentalByDefault||!1}},computed:{...o.A.mapState(["collections","udfRuntimes"]),...o.A.mapState("editor",["discoverySearchTerm"]),...o.A.mapGetters(["supports","fileFormats","processes"]),supportsLoadCollection(){return this.processes.has("load_collection")},supportsRunUdf(){return this.processes.has("run_udf")},supportsSaveResult(){return this.processes.has("save_result")},hasUdfRuntimes(){return o.A.size(this.udfRuntimes)},allProcesses(){return this.processes.all()},searchTerm:{get(){return this.persist?this.discoverySearchTerm:this.internalSearchTerm},set(e){this.persist?this.setDiscoverySearchTerm(e):this.internalSearchTerm=e}}},watch:{searchTerm:{immediate:!0,handler(e,t){!e&&t?this.collapsed=!0:e&&!t&&(this.collapsed=!1)}}},methods:{...o.A.mapMutations("editor",["setDiscoverySearchTerm","setModelDnD"]),...o.A.mapActions(["loadProcess"]),onDrag(e,t,s){let i=e=>this.setModelDnD({type:t,data:s,loading:e});"process"===t?(i(!0),this.loadProcess(s).then((()=>i(!1)))):i(!1)},showCollectionInfo(e){this.broadcast("showCollection",e)},hasCollectionPreview(e){return Boolean(this.collectionPreview&&o.A.getPreviewLinkFromSTAC(e))},showCollectionPreview(e){this.broadcast("showCollectionPreview",e)},showProcess(e){this.broadcast("showProcess",e)},showUdfInfo(e,t){this.broadcast("showModal","UdfRuntimeModal",{id:e,data:t,version:t.default})},showFileFormatInfo(e){let t={id:e.name,format:this.fileFormats.output[e.name],type:"output"};this.broadcast("showModal","FileFormatModal",t)}}},h=p;var m=s(81656),f=(0,m.A)(h,i,a,!1,null,"aacdf426",null);const g=f.exports},63036:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var i=function(){var e=this,t=e._self._c;return t("Tabs",{ref:"tabs",staticClass:"editor",attrs:{id:"customProcessContent",position:"bottom"}},[t("Tab",{attrs:{id:"visual",name:"Visual Model",icon:"fa-project-diagram",selected:!0,allowShow:e.canSwitchView},on:{show:e.showModel}},[t("VisualEditor",{ref:"graphBuilder",staticClass:"visualEditorTab",attrs:{editable:e.editable,parent:e.parent,parentSchema:e.parentSchema,value:e.modelValue,title:e.title,id:e.id+"_visual",showDiscoveryToolbar:e.showDiscoveryToolbar,showIntro:e.showIntro,defaultValue:e.defaultValue},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1),t("Tab",{attrs:{id:"source",name:"Code",icon:"fa-code",allowShow:e.canSwitchView},on:{show:e.showCode}},[t("TextEditor",{ref:"sourceEditor",staticClass:"textEditorTab",attrs:{editable:e.editable,value:e.codeValue,title:e.title,id:e.id+"_text",language:"processgraph"},on:{input:e.commit,error:e.onError},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[e._t("file-toolbar")]},proxy:!0},{key:"toolbar",fn:function(){return[e._t("toolbar")]},proxy:!0}],null,!0)})],1)],1)},a=[],r=s(2566),o=s(4615),n=s(58379),l=function(){var e=this,t=e._self._c;return t("div",{ref:"visualEditor",staticClass:"visualEditor"},[t("div",{staticClass:"sourceHeader"},[e.title?t("strong",[e._v(e._s(e.title))]):e._e(),t("div",{staticClass:"sourceToolbar"},[e.editable?t("span",{staticClass:"sepr"},[t("button",{attrs:{type:"button",title:"New script / Clear current script"},on:{click:e.confirmClear}},[t("i",{staticClass:"fas fa-file"})]),e._t("file-toolbar")],2):e._e(),e.editable?t("span",{staticClass:"sepr"},[t("button",{attrs:{type:"button",disabled:!e.canUndo,title:"Revert last change"},on:{click:function(t){return e.$refs.blocks.undo()}}},[t("i",{staticClass:"fas fa-undo-alt"})]),t("button",{attrs:{type:"button",disabled:!e.canRedo,title:"Redo last reverted change"},on:{click:function(t){return e.$refs.blocks.redo()}}},[t("i",{staticClass:"fas fa-redo-alt"})]),t("button",{attrs:{type:"button",disabled:!e.hasSelection,title:"Delete selected elements"},on:{click:function(t){return e.$refs.blocks.deleteSelected()}}},[t("i",{staticClass:"fas fa-trash"})])]):e._e(),e.editable?t("span",{staticClass:"sepr"},[e.parent?e._e():t("button",{attrs:{type:"button",title:"Edit Process Metadata"},on:{click:()=>e.editProcess(e.value)}},[t("i",{staticClass:"fas fa-edit"})]),t("button",{attrs:{type:"button",title:"Add Parameter"},on:{click:e.addParameter}},[t("i",{staticClass:"fas fa-parking"})]),e.supportsMath?t("button",{class:{highlightFormula:e.isMath},attrs:{type:"button",title:"Insert/Edit formula"},on:{click:e.showExpressionModal}},[t("i",{staticClass:"fas fa-square-root-alt"})]):e._e()]):e._e(),t("button",{class:{compactMode:e.compactMode},attrs:{type:"button",title:"Compact Mode"},on:{click:function(t){return e.$refs.blocks.toggleCompact()}}},[t("i",{staticClass:"fas fa-compress-arrows-alt"})]),t("button",{attrs:{type:"button",title:"Scale to perfect size"},on:{click:function(t){return e.$refs.blocks.perfectScale()}}},[t("i",{staticClass:"fas fa-arrows-alt"})]),t("FullscreenButton",{attrs:{element:()=>this.$refs.visualEditor},on:{changed:t=>{this.$refs.blocks.perfectScale(),e.isFullScreen=t}}}),e._t("toolbar")],2)]),t("div",{staticClass:"editorSplitter"},[(e.showDiscoveryToolbar||e.isFullScreen)&&e.editable?t("DiscoveryToolbar",{staticClass:"discoveryToolbar",attrs:{onAddProcess:e.insertProcess}}):e._e(),t("div",{staticClass:"graphBuilder",on:{drop:e.onDrop,dragover:e.allowDrop}},[e.showHelpOverlay?t("div",{staticClass:"model-overlay"},[t("h2",[e._v("Welcome!")]),t("p",[e._v(" What you are seeing in this area of the "+e._s(e.$config.appName)+" is the visual model builder. You can start building your model by dragging collections, processes etc. from the left area and dropping them here. ")]),t("p",[e._v(" Alternatively, you can also import existing processes into the model builder: "),t("ul",[e.canPaste?t("li",[e._v("Paste the JSON from your clipboard by clicking "),t("button",{attrs:{type:"button",title:"Paste from clipboard"},on:{click:e.paste}},[t("i",{staticClass:"fas fa-paste"})]),e._v(" or use "),t("kbd",[e._v("CTRL")]),e._v(" + "),t("kbd",[e._v("V")]),e._v(" (Windows, Linux) or "),t("kbd",[e._v("âŒ˜")]),e._v(" + "),t("kbd",[e._v("V")]),e._v(" (MacOS) when the model builder is in focus.")]):e._e(),t("li",[e._v("Drag and drop a JSON file from your computer")]),t("li",[e._v("Import a JSON file from your computer or another source such as the internet by clicking "),t("button",{attrs:{type:"button",title:"Import process from external source"},on:{click:e.importProcess}},[t("i",{staticClass:"fas fa-cloud-download-alt"})])])])]),e._m(0),t("p",[e._v("Once you start interacting with this area, this message will disappear.")])]):e._e(),t("ModelBuilder",{ref:"blocks",attrs:{editable:e.editable,id:e.id,processes:e.processes,collections:e.collections,parent:e.parent,parentSchema:e.parentSchema,value:e.value},on:{input:e.commit,error:e.errorHandler,showProcess:(t,s)=>e.broadcast("showProcess",{id:t,namespace:s}),showCollection:t=>e.broadcast("showCollection",t),showParameter:(t,s)=>e.broadcast("showProcessParameter",t,s),editParameter:e.editParameter,editArguments:e.openArgumentEditor,compactMode:e=>this.compactMode=e,selectionChanged:e.selectionChanged,historyChanged:e.historyChanged}})],1)],1)])},c=[function(){var e=this,t=e._self._c;return t("p",[e._v(" You can also import the processes from the Python and R client. You need to export your process to JSON first: "),t("ul",[t("li",[e._v("In Python use "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-python-client/cookbook/tricks.html#process-graph-export",target:"_blank"}},[t("code",[e._v("print(result.to_json())")])])]),t("li",[e._v("In R use "),t("a",{attrs:{href:"https://open-eo.github.io/openeo-r-client/reference/index.html",target:"_blank"}},[t("code",[e._v('toJSON(as(result, "Process"))')])])])]),e._v(" In both cases, "),t("code",[e._v("result")]),e._v(" is your last return value from a data cube process such as "),t("code",[e._v("save_result")]),e._v(". For more details, please read the corresponding chapter in the "),t("a",{attrs:{href:"https://openeo.org/documentation/1.0/cookbook/#output-process-as-json",target:"_blank"}},[e._v("openEO cookbook")]),e._v(". ")])}],d=s(4638),u=s(36107),p=s(61663),h=s(82574),m=s(31572),f=s(47067);const g={name:"VisualEditor",mixins:[p.A],components:{ModelBuilder:d["default"],DiscoveryToolbar:u.A,FullscreenButton:h.A},props:{id:String,editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},parent:{type:Object,default:null},parentSchema:{type:Object,default:null},showDiscoveryToolbar:{type:Boolean,default:!1},showIntro:{type:Boolean,default:!1},title:{type:String},defaultValue:{}},computed:{...r.A.mapState(["connection","collections"]),...r.A.mapGetters(["processes","supportsMath"]),...r.A.mapState("editor",["initialNode"]),...r.A.mapGetters("editor",["getModelNodeFromDnD"]),isMath(){return this.supportsMath&&this.processes.isMath(this.value)}},data(){return{showHelpOverlay:this.showIntro,canUndo:!1,canRedo:!1,canPaste:!1,compactMode:!1,hasSelection:!1,formula:null,isFullScreen:!1}},watch:{value:{immediate:!0,handler(e){if(e&&(this.showHelpOverlay=!1),this.initialNode&&r.A.isObject(e)&&r.A.isObject(e.process_graph))try{let t=this.initialNode;"1"==t&&r.A.size(e.process_graph)&&(t=Object.keys(e.process_graph)[0]),this.openArgumentEditorForNode(t)}catch(t){r.A.exception(this,t)}finally{this.setInitialNode(null)}}}},mounted(){this.canPaste=navigator&&navigator.clipboard&&"function"===typeof navigator.clipboard.readText},methods:{...r.A.mapMutations("editor",["setInitialNode","setModelDnD"]),commit(e){"undefined"!==typeof this.defaultValue&&r.A.isObject(e)&&0===r.A.size(e.process_graph)&&(e=this.defaultValue),this.$emit("input",e)},async paste(){this.canPaste||r.A.error(this,"error","Pasting is not supported by your browser.");try{const e=await navigator.clipboard.readText();let t=JSON.parse(e);await this.$refs.blocks.import(t)}catch(e){r.A.exception(this,e,"Paste Error")}},importProcess(){this.broadcast("importProcess")},errorHandler(e,t=null){r.A.exception(this,e,t)},selectionChanged(e,t){this.hasSelection=Boolean(e.filter((e=>e.$el.allowsDelete)).length||t.length)},historyChanged(e,t){this.canUndo=!!e[t-1],this.canRedo=!!e[t+1]},allowDrop(e){this.showHelpOverlay=!1,e.preventDefault()},async onDrop(e){const t=await this.getModelNodeFromDnD();if(t)return this.insertProcess(t,e.pageX,e.pageY),this.setModelDnD(),e.preventDefault();let s=e.dataTransfer.files;if(1===s.length){let t=e.dataTransfer.files[0];if("application/json"===t.type){var i=new FileReader;return i.onload=async e=>{try{let t=JSON.parse(e.target.result);await this.$refs.blocks.import(t)}catch(t){r.A.exception(this,t,"Parsing JSON file failed")}},i.onerror=e=>r.A.exception(this,e,"Reading JSON file failed"),i.readAsText(t,"UTF-8"),e.preventDefault()}}},getNameField(e=void 0,t="name"){return{value:e,name:t,description:"A unique identifier. Must contain only letters (`a`-`z`), digits (`0`-`9`) and underscores (`_`). `snake_case` is recommended.",label:"Name",schema:{type:"string",pattern:"^\\w+$"},default:null}},getDescriptionField(e=void 0,t=!1,s="description",i="Description"){return{value:e,name:s,description:"Provides a detailed description. CommonMark (Markdown) syntax can be used for rich text formatting.",label:i,optional:t,schema:{type:"string",subtype:"commonmark"}}},getOptionalField(e=void 0){return{value:e,name:"optional",label:"Optional",description:"Parameters by default are required. CHeck this option to make the parameter optional. For optional parameters a default value should be specified.",optional:!0,schema:{type:"boolean"},default:!1}},getDefaultField(e=void 0){return{value:e,name:"default",label:"Default Value",description:"This value is used whenever the user of this process did not specify a value for this parameter.",toggledBy:"optional",optional:!0,schema:{}}},getExperimentalField(e=void 0){return{value:e,name:"experimental",label:"Experimental",description:"Declares that this is experimental, which means that it is unstable and likely to change.",optional:!0,schema:{type:"boolean"},default:!1}},getDeprecatedField(e=void 0){return{value:e,name:"deprecated",label:"Deprecated",description:"Declares that this is deprecated with the potential to be removed in any of the next versions. It should be transitioned out of usage.",optional:!0,schema:{type:"boolean"},default:!1}},getSchemaField(e=void 0,t="schema",s="Data Types"){let i=e?"json-schema":"openeo-datatype";return{value:e,name:t,label:s,description:"Allowed data type(s) as JSON Schema.",schema:[{title:"Single data type",type:"object",subtype:i},{title:"Multiple data types",type:"array",minItems:2,items:{type:"object",subtype:i}}]}},editProcess(e){e=r.A.isObject(e)?e:{};let t=r.A.isObject(e.returns)?e.returns:{};var s=[this.getNameField(e.id,"id"),{value:e.summary,name:"summary",description:"A very short description of the process with usually less than 60 characters.",label:"Summary",optional:!0,schema:{type:"string"}},this.getDescriptionField(e.description,!0),{value:e.categories,name:"categories",label:"Categories",optional:!0,schema:{type:"array",items:{type:"string"}}},this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),{label:"Parameters",description:'The parameters can be edited directly in the "Visual Model" interface.',info:!0},this.getDescriptionField(t.description,!0,"returns_description","Return Value > Description"),this.getSchemaField(t.schema,"returns_schema","Return Value > Data Type"),{value:e.exceptions,name:"exceptions",description:"Declares exceptions (errors) that might occur during execution of this process. This list is just for informative purposes.\n\nThe keys of the object are the error codes, which should only consist of alphanumerical characters. `PascalCase` is recommended.",label:"Errors",optional:!0,schema:{type:"object",additionalProperties:{type:"object",required:["message"],properties:{message:{title:"Error Message",type:"string"},description:{title:"Description",type:"string",subtype:"commonmark"},http:{title:"HTTP Status Code",type:"integer",enum:[400,500,501]}}}}},{value:e.examples,name:"examples",label:"Examples",description:"Example calls for this process with specific values for the parameters (arguments) and the result (return value).",optional:!0,schema:{type:"array",items:{type:"object",required:["arguments"],properties:{title:{title:"Title",type:"string"},title:{title:"Description",type:"string",subtype:"commonmark"},arguments:{title:"Arguments",type:"object",default:{}},returns:{title:"Return Value"}}}}},{value:e.links,name:"links",label:"Links",description:"Links related to this process, e.g. additional documentation.",optional:!0,schema:{type:"array",items:{type:"object",required:["href","rel"],properties:{href:{title:"URL",type:"string"},rel:{title:"Relation",description:"For examples see [IANA relation types](https://www.iana.org/assignments/link-relations/link-relations.xhtml)",type:"string",default:"about"},title:{title:"Title",type:"string"},type:{title:"Media Type",description:"For examples see [IANA media types](https://www.iana.org/assignments/media-types/media-types.xhtml)",type:"string"}}}}}];this.broadcast("showDataForm","Edit Process",s,(async e=>{let t=r.A.pickFromObject(e,["id","summary","description","categories","experimental","deprecated","exception","examples","links"]);("string"===typeof t.description||r.A.isObject(t.schema))&&(t.returns={description:e.returns_description,schema:e.returns_schema});let s=this.$refs.blocks.export(!0),i=Object.assign({},s,t);const a={id:"",summary:"",description:"",categories:[],experimental:!1,deprecated:!1,examples:[],links:[],process_graph:{}};for(let o in a)r.A.equals(a[o],i[o])&&delete i[o];this.commit(i)}))},addParameter(){var e=[this.getNameField(),this.getDescriptionField(),this.getOptionalField(),this.getDefaultField(),this.getExperimentalField(),this.getDeprecatedField(),this.getSchemaField()];this.broadcast("showDataForm","Add Parameter",e,(async e=>{"string"===typeof e.name&&e.name.length>0&&await this.$refs.blocks.addPgParameter(e)}))},editParameter(e,t="Edit Parameter",s=null){var i=[this.getNameField(e.name),this.getDescriptionField(e.description),this.getOptionalField(e.optional),this.getDefaultField(e.default),this.getExperimentalField(e.experimental),this.getDeprecatedField(e.deprecated),this.getSchemaField(e.schema)];this.broadcast("showDataForm",t,i,s)},showExpressionModal(){let e=new f.A(this.value,this.processes,this.connection,!0);e.setCallbackParameters(this.$refs.blocks.getPgParameters().map((e=>e.spec)));try{e.parse();let t={process:e},s={save:this.insertNodes};this.broadcast("showModal","ExpressionModal",t,s)}catch(t){r.A.exception(this,t)}},openArgumentEditorForNode(e){let t=r.A.deepClone(this.value),s=t.process_graph[e],i=this.processes.get(s.process_id,s.namespace);Array.isArray(i.parameters)&&i.parameters.length>0&&this.openArgumentEditor(i.parameters.map((e=>new m.ProcessParameter(e))).filter((e=>e.isEditable())),s.arguments,i.id,!0,null,(e=>{Object.assign(s,{arguments:e}),this.commit(t)}))},openArgumentEditor(e,t,s="Edit",i=!0,a=null,r=null,o=null){let n={title:s,parameters:e,data:t,editable:i,selectParameterName:a,parent:o},l={};"function"===typeof r&&(l.save=r),this.broadcast("showModal","ParameterModal",n,l)},confirmClear(){var e=confirm("Do you really want to clear the existing model?");e&&this.clear()},clear(){this.$refs.blocks&&this.$refs.blocks.clear(),this.commit(null)},insertProcess(e,t=null,s=null){try{var i=this.$refs.blocks.getPositionForPageXY(t,s);let a=e.namespace;"backend"!==a&&"user"!==a||(a=null),this.$refs.blocks.addProcess(e.process_id,e.arguments,i,a)}catch(a){r.A.exception(this,a)}},async insertNodes(e,t=!1){return await this.$refs.blocks.import({process_graph:e},{clear:t})}}},v=g;var y=s(81656),b=(0,y.A)(v,l,c,!1,null,null,null);const w=b.exports;var S=s(57497);const A={name:"Editor",components:{VisualEditor:w,TextEditor:S.A,Tabs:o["default"],Tab:n["default"]},props:{id:{type:String,default:()=>`editor_${Date.now()}`},editable:{type:Boolean,default:!0},value:{type:Object,default:()=>null},title:{type:String},parent:{type:Object,default:null},parentSchema:{type:Object,default:null},showDiscoveryToolbar:{type:Boolean,default:!1},showIntro:{type:Boolean,default:!1},defaultValue:{}},watch:{value(){this.updateTab()}},data(){return{modelValue:null,codeValue:null,error:null}},mounted(){this.updateTab()},methods:{...r.A.mapActions(["loadProcess"]),showModel(){this.error=null,this.modelValue=this.value},showCode(){this.error=null,this.codeValue=this.value,this.$refs.sourceEditor.updateState()},updateTab(){"source"===this.$refs.tabs.getActiveTabId()?this.showCode():this.showModel()},commit(e){this.error=null,this.$emit("input",e)},onError(e){this.error=e},activeEditor(){return"source"===this.$refs.tabs.getActiveTabId()?this.$refs.sourceEditor:this.$refs.graphBuilder},async insertProcess(e){try{await this.loadProcess({id:e.process_id,namespace:e.namespace}),this.activeEditor().insertProcess(e)}catch(t){r.A.exception(this,t)}},canSwitchView(){return!this.editable||null===this.error||(r.A.exception(this,this.error,"Process Invalid Error"),!1)}}},x=A;var P=(0,y.A)(x,i,a,!1,null,null,null);const C=P.exports},18351:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Te});var i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"wrapper"}},[t("div",{class:{authenticated:e.isAuthenticated,appMode:Boolean(e.appMode)},attrs:{id:"ide"}},[t("header",{staticClass:"navbar"},[t("Logo"),t("ul",{attrs:{id:"menu"}},[t("li",[t("div",{staticClass:"menuItem",attrs:{title:"Start a guided tour"},on:{click:e.showHelp}},[t("i",{staticClass:"fas fa-question-circle fa-fw"}),e._v("Help")])]),t("li",[t("div",{staticClass:"menuItem",attrs:{title:"Start the process wizard"},on:{click:function(t){return e.showWizard()}}},[t("i",{staticClass:"fas fa-magic fa-fw"}),e._v("Wizard")])]),t("li",[t("div",{staticClass:"menuItem",attrs:{title:"Get server information"},on:{click:e.showServerInfo}},[t("i",{staticClass:"fas fa-info-circle fa-fw"}),e._v("Server")])]),t("li",[t("UserMenu")],1)])],1),t("Splitpanes",{staticClass:"default-theme",on:{resize:e.resized,"pane-maximize":e.resized}},[t("Pane",{attrs:{id:"discovery",size:e.splitpaneSizeH[0]}},[t("DiscoveryToolbar",{staticClass:"toolbar tour-ide-discovery",attrs:{onAddProcess:e.insertProcess,collectionPreview:!0,persist:!0}})],1),t("Pane",{attrs:{id:"workspace",size:e.splitpaneSizeH[1]}},[t("Splitpanes",{staticClass:"default-theme",attrs:{horizontal:""},on:{resize:e.resized,"pane-maximize":e.resized}},[t("Pane",{attrs:{id:"editor",size:e.splitpaneSizeV[0]}},[t("Editor",{ref:"editor",staticClass:"mainEditor tour-ide-editor",attrs:{id:"main",value:e.process,title:e.contextTitle,showIntro:""},on:{input:e.updateEditor},scopedSlots:e._u([{key:"file-toolbar",fn:function(){return[t("button",{attrs:{type:"button",title:"Import process from external source"},on:{click:e.importProcess}},[t("i",{staticClass:"fas fa-cloud-download-alt"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.saveSupported,expression:"saveSupported"}],attrs:{type:"button",disabled:!e.hasProcess,title:"Save to "+e.contextTitle},on:{click:e.saveProcess}},[t("i",{staticClass:"fas fa-save"})]),t("button",{attrs:{type:"button",disabled:!e.hasProcess,title:"Export into another programming language"},on:{click:e.exportCode}},[t("i",{staticClass:"fas fa-file-export"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.validateSupported,expression:"validateSupported"}],attrs:{type:"button",disabled:!e.hasProcess,title:"Validate process on server-side"},on:{click:e.validateProcess}},[t("i",{staticClass:"fas fa-tasks"})])]},proxy:!0}])})],1),t("Pane",{attrs:{id:"user",size:e.splitpaneSizeV[1]}},[e.isAuthenticated?t("UserWorkspace",{staticClass:"userContent tour-ide-workspace"}):t("div",{staticClass:"message info",attrs:{title:"Login is required to interact with the server."}},[t("i",{staticClass:"fas fa-sign-in-alt"}),t("span",{staticClass:"login-message"},[t("strong",[t("a",{on:{click:e.login}},[e._v("Log in")])]),e._v(" is required to interact with the server.")])])],1)],1)],1),t("Pane",{class:{empty:!e.showViewer},attrs:{id:"viewer",size:e.splitpaneSizeH[2]}},[t("Viewer",{staticClass:"tour-ide-viewer",on:{empty:e.onViewerEmpty}})],1)],1)],1)])},a=[],r=s(61663),o=s(2566),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"UserMenu"}},[t("div",{staticClass:"menuItem"},[e._m(0),t("div",{staticClass:"data"},[t("span",{staticClass:"name nowrap"},[t("i",{staticClass:"fas fa-user"}),e._v(" "+e._s(e.userName))]),e.budget?t("span",{staticClass:"credits nowrap"},[t("i",{staticClass:"fas fa-dollar-sign fa-fw"}),e._v(" "+e._s(e.budget))]):e._e(),e.hasStorage?t("span",{staticClass:"storage nowrap"},[t("i",{staticClass:"fas fa-database fa-fw"}),e._v(" "+e._s(e.storageUsedPercent)+"% used")]):e._e()])]),t("div",{staticClass:"dropdown"},[e.profileLink?t("a",{staticClass:"item",attrs:{href:e.profileLink.href,target:"_blank"}},[e._v("Welcome, "+e._s(e.userName)+"!")]):t("div",{staticClass:"item"},[e._v("Welcome, "+e._s(e.userName)+"!")]),e.isAuthenticated?[e.hasProfile?t("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.userDetails.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-user"}),e._v(" Profile")]):e._e(),e.settingsLink?t("a",{staticClass:"item",attrs:{href:e.settingsLink.href,target:"_blank"}},[t("i",{staticClass:"fas fa-user-edit"}),e._v(" "+e._s(e.settingsLink.title||"Edit Profile"))]):e._e(),t("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.logout.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" Logout")])]:[t("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-sign-in-alt"}),e._v(" Login")]),e.registerLink?t("a",{staticClass:"item",attrs:{href:e.registerLink.href,target:"_blank"}},[t("i",{staticClass:"fas fa-user-plus"}),e._v(" Register")]):e._e(),e.passwordLink?t("a",{staticClass:"item",attrs:{href:e.passwordLink.href,target:"_blank"}},[t("i",{staticClass:"fas fa-key"}),e._v(" Forgotten Password?")]):e._e()],e.$config.serverUrl?e._e():t("a",{staticClass:"item",on:{click:function(t){return t.preventDefault(),e.disconnect.apply(null,arguments)}}},[t("i",{staticClass:"fas fa-sign-out-alt"}),e._v(" Disconnect")]),e.userLinks.length>0?[t("hr"),e._l(e.userLinks,(function(s,i){return t("a",{key:i,staticClass:"item",attrs:{href:s.href,target:"_blank",rel:s.rel}},[e._v(e._s(s.title))])}))]:e._e(),e.budget||e.userInfo.default_plan||e.paymentLink?[t("hr"),t("div",{staticClass:"item"},[t("h4",[e._v("Billing")]),e.userInfo.default_plan?t("div",{staticClass:"secondary-text"},[e._v("Plan: "+e._s(e.userInfo.default_plan))]):e._e(),e.budget?t("div",{staticClass:"secondary-text"},[e._v("Budget: "+e._s(e.budget))]):e._e()]),e.paymentLink?t("a",{staticClass:"item",attrs:{href:e.paymentLink.href,target:"_blank"}},[t("i",{staticClass:"fas fa-credit-card"}),e._v(" "+e._s(e.paymentLink.title||"Recharge"))]):e._e()]:e._e(),e.hasStorage?[t("hr"),t("div",{staticClass:"item"},[t("h4",[e._v("Storage")]),t("div",{staticClass:"secondary-text nowrap"},[e._v("Used "+e._s(e.formatMegabyte(e.storageUsed))+" of "+e._s(e.formatMegabyte(e.userInfo.storage.quota))+".")]),t("div",{staticClass:"storagePercent"},[t("div",{staticClass:"used",style:"width: "+e.storageUsedPercent+"%"})])])]:e._e()],2)])},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"down"},[t("i",{staticClass:"fas fa-chevron-down"})])}];const c={name:"UserMenu",mixins:[r.A],computed:{...o.A.mapState(["userInfo","isAuthenticated"]),...o.A.mapGetters(["currency","capabilities"]),userLinks(){return o.A.friendlyLinks(this.userInfo.links,!0,["self","edit-form","payment","alternate"])},serverLinks(){return this.capabilities?this.capabilities.links():[]},registerLink(){return this.serverLinks.find((e=>"create-form"===e.rel))},passwordLink(){return this.serverLinks.find((e=>"recovery-form"===e.rel))},settingsLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find((e=>"edit-form"===e.rel)):void 0},paymentLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find((e=>"payment"===e.rel)):void 0},profileLink(){return Array.isArray(this.userInfo.links)?this.userInfo.links.find((e=>"alternate"===e.rel)):void 0},hasStorage(){return o.A.isObject(this.userInfo.storage)&&"number"===typeof this.userInfo.storage.quota&&"number"===typeof this.userInfo.storage.free},budget(){return o.A.formatBudget(this.userInfo.budget,this.currency)},profile(){return o.A.omitFromObject(this.userInfo,["budget","links","storage","default_plan"])},hasProfile(){return o.A.size(this.profile)>0},userName(){return"string"===typeof this.userInfo.name?this.userInfo.name:"string"===typeof this.userInfo.user_id?this.userInfo.user_id:this.isAuthenticated?"User":"Guest"},storageUsed(){return this.hasStorage?this.userInfo.storage.quota-this.userInfo.storage.free:null},storageUsedPercent(){return this.hasStorage?Math.round(this.storageUsed/this.userInfo.storage.quota*100):null}},methods:{...o.A.mapActions({logoutUser:"logout"}),...o.A.mapMutations("editor",{resetEditor:"reset"}),async logout(){await this.logoutUser(!1),o.A.ok(this,"Logout successful.")},async disconnect(){await this.logoutUser(!0),this.resetEditor(),window.history.pushState({},"","?")},login(){this.broadcast("showLogin")},userDetails(){this.broadcast("showDataModal",this.profile,"User Profile")},formatMegabyte(e){var t=1073741824;return e>t?Math.round(e/t)+" GB":Math.round(e/1048576)+" MB"}}},d=c;var u=s(81656),p=(0,u.A)(d,n,l,!1,null,"23c6ba20",null);const h=p.exports;var m=function(){var e=this,t=e._self._c;return t("Tabs",{ref:"tabs",attrs:{id:"userContent"}},[e.showJobs?t("Tab",{attrs:{id:"jobs",name:"Data Processing",icon:"fa-tasks"},on:{show:e.onShow,hide:e.onHide}},[t("JobPanel")],1):e._e(),e.showServices?t("Tab",{attrs:{id:"services",name:"Web Services",icon:"fa-cloud"},on:{show:e.onShow,hide:e.onHide}},[t("ServicePanel")],1):e._e(),e.showCustomProcesses?t("Tab",{attrs:{id:"customProcesses",name:"Custom Processes",icon:"fa-sitemap"},on:{show:e.onShow,hide:e.onHide}},[t("CustomProcessPanel")],1):e._e(),e.showFiles?t("Tab",{attrs:{id:"files",name:"Files",icon:"fa-file"},on:{show:e.onShow,hide:e.onHide}},[t("FilePanel")],1):e._e()],1)},f=[],g=s(4615),v=s(58379),y=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"FilePanel"},on:{dragenter:function(t){return e.dropZoneInfo(!0)},dragleave:function(t){return e.dropZoneInfo(!1)},drop:e.uploadFiles,dragover:e.allowDrop}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showUploadDropHint,expression:"showUploadDropHint"}],staticClass:"dropZone"},[e._v("To upload files, drop them here.")]),t("DataTable",{ref:"table",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(s){return[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Download"},on:{click:function(t){return e.downloadFile(s.row)}}},[t("i",{staticClass:"fas fa-download"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(t){return e.deleteFile(s.row)}}},[t("i",{staticClass:"fas fa-trash"})])]}}])},[t("template",{slot:"toolbar"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],staticClass:"upload"},[t("div",{staticClass:"percent",class:{active:this.uploadProgress>0}},[t("div",{staticClass:"used",class:{error:e.uploadErrored},style:"width: "+this.uploadProgress+"%; opacity: "+this.uploadFadeOut})]),t("div",{staticClass:"addFile"},[t("input",{ref:"uploadUserFile",staticClass:"uploadUserFile",attrs:{type:"file",name:"uploadUserFile",multiple:""},on:{change:e.uploadFiles}})])]),t("SyncButton",{attrs:{name:"files",sync:()=>e.updateData(!0)}})],1)],2)],1)},b=[],w=function(){var e=this,t=e._self._c;return t("div",{staticClass:"vue-component data-table"},[t("div",{staticClass:"menu"},[t("div",{staticClass:"toolbar"},[e._t("toolbar")],2),e.hasData?t("div",{staticClass:"filter"},[t("SearchBox",{attrs:{compact:!0},model:{value:e.filterValue,callback:function(t){e.filterValue=t},expression:"filterValue"}})],1):e._e()]),e.hasData?t("table",[t("thead",[t("tr",e._l(e.columns,(function(s,i){return t("th",{directives:[{name:"show",rawName:"v-show",value:!s.hide,expression:"!col.hide"}],key:s.name,class:e.thClasses(i),attrs:{title:e.thTitle(i)},on:{click:function(t){return e.enableSort(i)}}},[e._v(e._s(s.name))])})),0)]),t("tbody",[e._l(e.view,(function(s,i){return t("tr",{key:i},e._l(e.columns,(function(a,r){return t("td",{directives:[{name:"show",rawName:"v-show",value:!a.hide,expression:"!col.hide"}],key:`${a.name}_${i}`,class:[r,{edit:e.canEdit(a)}],attrs:{title:!!e.canEdit(a)&&"Double-click to change the value","data-value":!!a.stylable&&e.value(s,a,r)},on:{dblclick:function(t){return e.onDblClick(t,s,a,r)}}},[e._t(r,(function(){return[e.showEditField(s,a,r)?[t("form",{on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.saveEditField(t,s,a,r)}}},[t("input",{ref:"editField",refInFor:!0,attrs:{type:"text"},domProps:{value:e.value(s,a,r)},on:{blur:function(t){return e.saveEditField(t,s,a,r)},keyup:function(t){return e.resetEditFieldEsc(t,s,a,r)}}})])]:t("span",{domProps:{innerHTML:e._s(e.formattedValue(s,a,r))}})]}),{row:s,col:a,id:r})],2)})),0)})),e.hasData&&0==e.view.length?t("tr",{staticClass:"no-results"},[t("td",{attrs:{colspan:e.columnCount}},[e._v("No element matches your search criteria.")])]):e._e()],2)]):t("div",{staticClass:"no-data"},[e._v(e._s(e.noDataMessage))])])},S=[],A=s(86975),x=s(74870);const P={name:"DataTable",components:{SearchBox:()=>Promise.resolve().then(s.bind(s,9409))},props:{columns:{type:Object,default:()=>({})},data:{type:Array,default:()=>[]}},data(){return{view:[],filterValue:null,primaryKey:null,noDataMessage:"No data available.",editField:null,sortState:{id:null,direction:null}}},watch:{data(){this.updateView()},filterValue(){this.updateView()},sortState(){this.updateView()},columns:{immediate:!0,handler(){for(let e in this.columns){let t=this.columns[e].sort;if(["asc","desc"].includes(t)){this.enableSort(e,t);break}}}}},computed:{columnCount(){return Object.keys(this.columns).length},hasData(){return this.data.length>0},hasFilter(){return"string"===typeof this.filterValue&&this.filterValue.length>0}},beforeCreate(){A.A.enableHtmlProps(this)},created(){this.determinePrimaryKey()},methods:{canEdit(e){return"function"===typeof e.edit},showEditField(e,t,s){return this.canEdit(t)&&null!=this.editField&&this.editField[0]==e&&this.editField[1]==s},onDblClick(e,t,s,i){if(this.canEdit(s)){var a=this.value(t,s,i);if("boolean"===typeof a){var r=this.columns[i].edit;r(t)}else this.editField=[t,i],this.$nextTick((()=>this.$refs.editField[0].focus()));e.preventDefault(),e.stopPropagation()}},saveEditField(e,t,s,i){if(null!==this.editField&&this.canEdit(s)){var a=this.columns[i].edit;a(t,this.$refs.editField[0].value),this.editField=null,e.preventDefault(),e.stopPropagation()}},resetEditFieldEsc(e,t,s,i){"Escape"==e.key&&(this.editField=null)},determinePrimaryKey(){for(var e in this.columns)if(this.columns[e].primaryKey){this.primaryKey=e;break}},setNoData(e){"string"!=typeof e?A.A.isObject(e)&&("object"===typeof e.data&&"object"===typeof e.config&&"object"===typeof e.headers&&(e=e.data),A.A.isObject(e)&&"string"===typeof e.message)?this.noDataMessage=e.message:(console.warn(e),this.noDataMessage="Sorry, an unknown error has occured."):this.noDataMessage=e},value(e,t,s){var i;return i="object"===typeof e?e[s]:e,A.A.isObject(t)&&"function"===typeof t.computedValue&&(i=t.computedValue(e,i)),i},formattedValue(e,t,s){return this.format(this.value(e,t,s),t)},thClasses(e){let t=this.columns[e],s=[e];return!1!==t.sort&&(s.push("sortable"),this.sortState.id===e&&s.push("sort-"+this.sortState.direction)),s},thTitle(e){let t=this.columns[e];return!1!==t.sort?this.sortState.id===e&&"asc"===this.sortState.direction?"Click to sort column in descending order":"Click to sort column in ascending order":null},enableSort(e,t=null){!1!==this.columns[e].sort&&(null===t&&(t=this.sortState.id===e&&"asc"===this.sortState.direction?"desc":"asc"),this.sortState={id:e,direction:t})},sort(e){let t=this.sortState.id;if(null===t||!this.columns[t])return e;let s=this.columns[t];return!1===s.sort?e:e.slice(0).sort(((e,i)=>{let a="function"===typeof s.sortFn?s.sortFn:A.A.compareStringCaseInsensitive,r=a(e[t],i[t]);return"desc"===this.sortState.direction?-1*r:r}))},filter(e){if(!this.hasFilter)return e;var t=this.filterValue.toLowerCase();return e.filter((e=>{let s=[];for(var i in e){var a=this.columns[i];if(!("undefined"===typeof a||a.hasOwnProperty("filterable")&&!1===a.filterable)){var r=this.value(e,a,i);"number"!==typeof r&&"string"!==typeof r&&"boolean"!==typeof r||(r=r.toString(),s.push(r))}}return A.A.search(t,s)}))},clearFilter(){this.filterValue="",this.updateView()},updateView(){Array.isArray(this.data)?this.view=this.sort(this.filter(this.data)):this.view=[]},format(e,t){return"string"!==typeof t.format?"function"===typeof t.format?t.format.call(this,e,t):x.DataTypes.format(e):"function"===typeof x.Formatters["format"+t.format]?x.Formatters["format"+t.format](e,t):void console.warn(t.format+" is an invalid formatter.")}}},C=P;var _=(0,u.A)(C,w,S,!1,null,null,null);const k=_.exports,D=(e,t,s,i=!0)=>({components:{DataTable:k},data(){return{syncTimer:null,lastSyncTime:null}},mounted(){i&&this.updateData()},beforeDestroy(){this.stopSyncTimer()},computed:{...o.A.mapState(e,{data:e}),...o.A.mapGetters(e,["supportsList","supportsCreate","supportsRead","supportsUpdate","supportsDelete"])},methods:{...o.A.mapActions(e,["list","create","read","update","delete"]),getTable(){return this.$refs&&this.$refs.table?this.$refs.table:null},onShow(){this.updateData().catch((e=>o.A.exception(this,e,`Updating ${s} failed`))),this.startSyncTimer()},onHide(){this.stopSyncTimer()},startSyncTimer(){this.supportsList&&null===this.syncTimer&&(this.syncTimer=setInterval(this.updateData,this.getSyncInterval()))},stopSyncTimer(){null!==this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null)},getSyncInterval(){return 60*this.$config.dataRefreshInterval*1e3},async refreshElement(e,s=null){var i=Object.assign({},e);try{let t=await this.read({data:e});"function"===typeof s&&s(t,i)}catch(a){o.A.exception(this,a,"Load "+t+" error")}},async updateData(e=!1){var i=this.getTable(),a=Date.now()-this.getSyncInterval();if(!i||!e&&this.lastSyncTime>a)return!1;if(this.supportsList){var r=this.data.length>0;r||i.setNoData("Loading "+s+"..."),this.lastSyncTime=Date.now();try{let e=await this.list();return 0==e.length&&i.setNoData("Add your first "+t+" here..."),!0}catch(n){r?console.log(n):(o.A.exception(this,n),i.setNoData("Sorry, unable to load data from the server."))}}else i.setNoData("Sorry, listing stored "+s+" is not supported by the server.");return!1}}});var T=function(){var e=this,t=e._self._c;return t("button",{staticClass:"data-sync",attrs:{title:e.title},on:{click:e.update}},[!0===e.syncState?t("i",{staticClass:"fas fa-check"}):!1===e.syncState?t("i",{staticClass:"fas fa-times"}):t("i",{staticClass:"fas fa-sync"})])},F=[];const E={name:"SyncButton",props:{name:{type:String,required:!0},sync:{type:Function,required:!0}},data(){return{syncState:null}},computed:{title(){return"Refresh list of "+this.name}},methods:{async update(e){null===this.syncState&&(this.syncState=await this.sync(e),setTimeout((()=>this.syncState=null),3e3))}}},M=E;var z=(0,u.A)(M,T,F,!1,null,"b21f72c4",null);const R=z.exports,$={name:"FilePanel",mixins:[D("files","file","files")],components:{SyncButton:R},data(){return{columns:{path:{name:"Path",primaryKey:!0,sortFn:o.A.sortByPath,sort:"asc"},size:{name:"Size",format:"FileSize",filterable:!1},modified:{name:"Last modified",format:"Timestamp"},actions:{name:"Actions",filterable:!1,sort:!1}},uploadProgress:0,uploadProgressPerFile:[],uploadErrored:!1,uploadFadeOut:1,showUploadDropHint:0}},watch:{uploadProgressPerFile:{deep:!0,handler(){this.uploadProgress=this.uploadProgressPerFile.reduce(((e,t)=>e+t),0)/this.uploadProgressPerFile.length,this.uploadProgress>99.9999&&this.finishAllUploads()}}},methods:{allowDrop(e){this.supportsCreate&&(e.preventDefault(),e.stopPropagation())},dropZoneInfo(e){this.showUploadDropHint+=e?1:-1},uploadFiles(e){this.showUploadDropHint=0;var t=[];if(e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length?(t=e.dataTransfer.files,e.preventDefault(),e.stopPropagation()):e.target&&e.target.files&&e.target.files.length&&(t=e.target.files),this.supportsCreate)if(0!==t.length){this.uploadProgressPerFile=[],this.uploadProgress=0,this.uploadErrored=!1;for(let e=0;e<t.length;e++)this.uploadFile(t[e],e)}else o.A.info(this,"Please select files to upload.");else o.A.error(this,"Uploading files is not supported.")},async uploadFile(e,t){if(this.uploadProgressPerFile.push(0),"string"===typeof e.name)try{await this.create([e,null,e=>this.$set(this.uploadProgressPerFile,t,e)]),this.$set(this.uploadProgressPerFile,t,100),o.A.ok(this,"File upload completed.",e.name)}catch(s){console.error(s),o.A.exception(this,s,"Upload File Error: "+e.name)}},finishAllUploads(){this.$refs.uploadUserFile.value="";var e=setInterval((()=>{this.uploadFadeOut-=.05,this.uploadFadeOut<0&&(this.uploadProgress=0,this.uploadFadeOut=1,clearInterval(e))}),100)},downloadFile(e){e.downloadFile(e.path)},deleteFile(e){confirm(`Do you really want to delete the file "${e.path}"?`)&&this.delete({data:e}).catch((t=>o.A.exception(this,t,"Delete File Error: "+e.path)))}}},I=$;var N=(0,u.A)(I,y,b,!1,null,null,null);const L=N.exports;var O=function(){var e=this,t=e._self._c;return t("DataTable",{ref:"table",staticClass:"JobPanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(s){return[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(t){return e.showJobInfo(s.row)}}},[t("i",{staticClass:"fas fa-info"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsEstimate,expression:"supportsEstimate"}],attrs:{title:"Estimate"},on:{click:function(t){return e.estimateJob(s.row)}}},[t("i",{staticClass:"fas fa-file-invoice-dollar"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate,expression:"supportsUpdate"}],attrs:{title:"Edit metadata",disabled:!e.isJobInactive(s.row)},on:{click:function(t){return e.editMetadata(s.row)}}},[t("i",{staticClass:"fas fa-edit"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(t){return e.showInEditor(s.row)}}},[t("i",{staticClass:"fas fa-project-diagram"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(t){return e.deleteJob(s.row)}}},[t("i",{staticClass:"fas fa-trash"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsStart&&e.isJobInactive(s.row),expression:"supportsStart && isJobInactive(p.row)"}],attrs:{title:"Start processing"},on:{click:function(t){return e.queueJob(s.row)}}},[t("i",{staticClass:"fas fa-play-circle"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsStop&&e.isJobActive(s.row),expression:"supportsStop && isJobActive(p.row)"}],attrs:{title:"Cancel processing"},on:{click:function(t){return e.cancelJob(s.row)}}},[t("i",{staticClass:"fas fa-stop-circle"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDownloadResults&&e.mayHaveResults(s.row),expression:"supportsDownloadResults && mayHaveResults(p.row)"}],attrs:{title:"Download"},on:{click:function(t){return e.downloadResults(s.row)}}},[t("i",{staticClass:"fas fa-download"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDownloadResults&&e.mayHaveResults(s.row),expression:"supportsDownloadResults && mayHaveResults(p.row)"}],attrs:{title:"View results"},on:{click:function(t){return e.viewResults(s.row,!0)}}},[t("i",{staticClass:"fas fa-eye"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.canShare&&e.supports("downloadResults")&&e.mayHaveResults(s.row),expression:"canShare && supports('downloadResults') && mayHaveResults(p.row)"}],attrs:{title:"Export / Share"},on:{click:function(t){return e.shareResults(s.row)}}},[t("i",{staticClass:"fas fa-share"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDebug,expression:"supportsDebug"}],attrs:{title:"View logs"},on:{click:function(t){return e.showLogs(s.row)}}},[t("i",{staticClass:"fas fa-bug"})])]}}])},[t("template",{slot:"toolbar"},[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new job for batch processing",disabled:!this.hasProcess},on:{click:function(t){return e.createJobFromScript()}}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Create Batch Job")]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supports("computeResult"),expression:"supports('computeResult')"}],attrs:{title:"Run the process directly and view the results without storing them permanently",disabled:!this.hasProcess},on:{click:e.executeProcess}},[t("i",{staticClass:"fas fa-play"}),e._v(" Run now")]),e.supportsList?t("SyncButton",{attrs:{name:"batch jobs",sync:()=>e.updateData(!0)}}):e._e()],1)],2)},B=[],j=s(73902),U=s(99017);const V={methods:{getTitleField(e=null){return{name:"title",label:"Title",schema:{type:"string"},default:null,value:e,optional:!0}},getDescriptionField(e=null){return{name:"description",label:"Description",schema:{type:"string",subtype:"commonmark"},default:null,value:e,description:"CommonMark (Markdown) is allowed.",optional:!0}},getLogLevelField(e=void 0){return{name:"log_level",label:"Log level",schema:{type:"string",enum:["debug","info","warning","error"]},default:"info",value:e,description:"The minimum severity level for log entries that the back-end stores for the processing request.\n\ndebug (all logs) > info > warning > error (only errors)",optional:!0}},getBillingPlanField(e=void 0){return{name:"plan",label:"Billing plan",schema:{type:"string",subtype:"billing-plan"},value:e,optional:!0}},getBudgetField(e=null){return{name:"budget",label:"Budget limit",schema:{type:"number",subtype:"budget"},default:null,value:e,optional:!0}}}};var J=s(71321),H=s.n(J);const q=D("jobs","batch job","batch jobs"),W={name:"JobPanel",mixins:[q,r.A,V],components:{SyncButton:R},data(){return{watchers:{},jobUpdater:null}},mounted(){this.listen("replaceProcess",this.replaceProcess),this.listen("executeProcess",this.executeProcess),this.listen("startAndQueueProcess",this.startAndQueueProcess)},computed:{...o.A.mapState(["connection"]),...o.A.mapGetters(["supports","supportsBilling","supportsBillingPlans"]),...o.A.mapGetters("editor",["hasProcess"]),...o.A.mapState("editor",["process"]),columns(){return{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Batch Job",computedValue:e=>o.A.getResourceTitle(e),format:e=>o.A.formatIdOrTitle(e),edit:this.supportsUpdate?this.updateTitle:null},status:{name:"Status",stylable:!0},created:{name:"Submitted",format:"Timestamp",sort:"desc"},updated:{name:"Last update",format:"Timestamp"},actions:{name:"Actions",filterable:!1,sort:!1}}},supportsStart(){return this.supports("startJob")},supportsStop(){return this.supports("stopJob")},supportsEstimate(){return this.supports("estimateJob")},supportsDownloadResults(){return this.supports("downloadResults")},supportsDebug(){return this.supports("debugJob")},canShare(){return Array.isArray(this.$config.supportedBatchJobSharingServices)&&this.$config.supportedBatchJobSharingServices.length>0}},watch:{data:{handler:function(e){this.watchers={};for(let t of e)o.A.isActiveJobStatusCode(t.status)&&(this.watchers[t.id]=t)},deep:!0}},methods:{...o.A.mapActions("jobs",["queue","cancel"]),startSyncTimer(){q.methods.startSyncTimer.call(this);let e=()=>{this.executeWatchers();let t=5+5*Math.log2(o.A.size(this.watchers));this.jobUpdater=setTimeout(e,1e3*t)};e()},stopSyncTimer(){q.methods.stopSyncTimer.call(this),null!==this.jobUpdater&&clearTimeout(this.jobUpdater)},showInEditor(e){this.refreshElement(e,(e=>this.broadcast("editProcess",e)))},async startAndQueueProcess(e){let t=await this.createJob(this.process,e);await this.queueJob(t)},async executeProcess(){const e=async e=>{const t=await this.connection.computeResult(this.process,null,null,e);this.broadcast("viewSyncResult",t)};try{await(0,U.Kt)(this,e,"Run")}catch(t){t instanceof U.QJ?(0,U.Vz)(this,t):o.A.exception(this,t)}},jobCreated(e){var t=[];this.supports("estimateJob")&&t.push({text:"Estimate",action:()=>this.estimateJob(e)}),this.supports("startJob")&&t.push({text:"Start processing",action:()=>this.queueJob(e)}),this.supports("deleteJob")&&t.push({text:"Delete",action:()=>this.deleteJob(e)}),o.A.confirm(this,'Job "'+o.A.getResourceTitle(e)+'" created!',t)},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},async createJob(e,t){try{t=this.normalizeToDefaultData(t);let s=await this.create([e,t.title,t.description,t.plan,t.budget,{log_level:t.log_level}]);return this.jobCreated(s),s}catch(s){return o.A.exception(this,s,"Create Job Error: "+(t.title||"")),null}},createJobFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.getLogLevelField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null];this.broadcast("showDataForm","Create new batch job",e,(e=>this.createJob(this.process,e)))},async deleteJob(e){if(confirm(`Do you really want to delete the batch job "${o.A.getResourceTitle(e)}"?`))try{await this.delete({data:e}),this.broadcast("removeBatchJob",e.id)}catch(t){o.A.exception(this,t,"Delete Job Error: "+o.A.getResourceTitle(e))}},executeWatchers(){for(var e in this.watchers)this.refreshElement(this.watchers[e],((e,t)=>{if("finished"!==t.status&&"finished"===e.status){var s=[];this.supports("downloadResults")&&(s.push({text:"Download",action:()=>this.downloadResults(e)}),s.push({text:"View",action:()=>this.viewResults(e)})),o.A.confirm(this,'Job "'+o.A.getResourceTitle(e)+'" has finished!',s)}else"error"!==t.status&&"error"===e.status&&o.A.error(this,'Job "'+o.A.getResourceTitle(e)+'" has stopped due to an error or timeout.');t.status!==e.status&&this.broadcast("jobStatusUpdated",e,t)}))},showJobInfo(e){this.refreshElement(e,(async e=>{let t=null;if("finished"===e.status)try{t=await e.getResultsAsStac(),t=H().stac(t,!1)}catch(s){o.A.exception(this,s,"Load Results Error: "+o.A.getResourceTitle(e))}this.broadcast("showModal","JobInfoModal",{job:e.getAll(),result:t})}))},async estimateJob(e){try{let t=await e.estimateJob();this.broadcast("showModal","JobEstimateModal",{job:e.getAll(),estimate:t})}catch(t){o.A.exception(this,t,"Job Estimate Error: "+o.A.getResourceTitle(e))}},showLogs(e){this.broadcast("viewLogs",e)},replaceProcess(e,t){e instanceof j.Job&&(this.isJobActive(e)?o.A.error(this,"Can't update process while batch job is running."):this.updateJob(e,{process:t}))},editMetadata(e){this.refreshElement(e,(e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.getLogLevelField(e.log_level),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null];this.broadcast("showDataForm","Edit batch job",t,(t=>this.updateJob(e,t)))}))},updateTitle(e,t){this.updateJob(e,{title:t})},async updateJob(e,t){try{let s=await this.update({data:e,parameters:this.normalizeToDefaultData(t)});o.A.ok(this,'Job "'+o.A.getResourceTitle(s)+'" successfully updated.')}catch(s){o.A.exception(this,s,"Update Job Error: "+o.A.getResourceTitle(e))}},queueJob(e){this.refreshElement(e,(async t=>{if("finished"!==t.status||confirm(`The batch job "${o.A.getResourceTitle(t)}" has already finished with results. Queueing the job again may discard all previous results! Do you really want to queue it again?`))try{let t=await this.queue({data:e});o.A.ok(this,'Job "'+o.A.getResourceTitle(t)+'" successfully queued.')}catch(s){o.A.exception(this,s,"Queue Job Error: "+o.A.getResourceTitle(e))}}))},async cancelJob(e){if(confirm(`Do you really want to cancel the execution of batch job "${o.A.getResourceTitle(e)}"?`))try{let t=await this.cancel({data:e});o.A.ok(this,'Job "'+o.A.getResourceTitle(t)+'" successfully canceled.')}catch(t){o.A.exception(this,t,"Cancel Job Error: "+o.A.getResourceTitle(e))}},async viewResults(e){try{let t=await e.getResultsAsStac();t=H().stac(t,!1),this.broadcast("viewJobResults",t,e)}catch(t){o.A.exception(this,t,"View Result Error: "+o.A.getResourceTitle(e))}},async downloadResults(e){try{let t=await e.getResultsAsStac();if(t=H().stac(t,!1),0==o.A.size(t.assets))return void o.A.error(this,'No results available for job "'+o.A.getResourceTitle(e)+'".');this.broadcast("showModal","DownloadAssetsModal",{job:e,result:t})}catch(t){o.A.exception(this,t,"Download Result Error: "+o.A.getResourceTitle(e))}},async shareResults(e){if(this.canShare){let t,s,i=await e.getResultsAsStac();if(i=H().stac(i,!1),Array.isArray(i.links)&&(s=i.links.find((e=>"canonical"===e.rel)),s&&"string"===typeof s.href&&(t=s.href)),t){let a=i.properties?.title||e.title||s?.title;this.broadcast("showModal","ShareModal",{url:t,title:a,extra:i,context:e})}else o.A.error(this,"Sorry, this job has no public URL")}},mayHaveResults(e){return"string"!==typeof e.status||"finished"==e.status.toLowerCase()},isJobInactive(e){return!0!==o.A.isActiveJobStatusCode(e.status)},isJobActive(e){return!1!==o.A.isActiveJobStatusCode(e.status)}}},G=W;var K=(0,u.A)(G,O,B,!1,null,null,null);const Q=K.exports;var Y=function(){var e=this,t=e._self._c;return t("DataTable",{ref:"table",staticClass:"CustomProcessPanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(s){return[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(t){return e.processInfo(s.row)}}},[t("i",{staticClass:"fas fa-info"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(t){return e.showInEditor(s.row)}}},[t("i",{staticClass:"fas fa-project-diagram"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(t){return e.deleteProcess(s.row)}}},[t("i",{staticClass:"fas fa-trash"})])]}}])},[t("template",{slot:"toolbar"},[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new custom process",disabled:!this.hasProcess},on:{click:e.addProcessFromScript}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Add")]),t("SyncButton",{attrs:{name:"custom processes",sync:()=>e.updateData(!0)}})],1)],2)},Z=[];const X={name:"CustomProcessPanel",mixins:[D("userProcesses","custom process","custom processes",!1),r.A],components:{SyncButton:R},data(){return{columns:{id:{name:"ID",primaryKey:!0,sort:"asc"},summary:{name:"Summary"},actions:{name:"Actions",filterable:!1,sort:!1}}}},computed:{...o.A.mapState("editor",["process"]),...o.A.mapGetters(["processes"]),...o.A.mapGetters("editor",["hasProcess"])},mounted(){this.listen("replaceProcess",this.replaceProcess)},methods:{showInEditor(e){this.refreshElement(e,(e=>this.broadcast("editProcess",e)))},getIdField(e=void 0){return{value:e,name:"id",description:"A unique identifier. Must contain only letters (`a`-`z`), digits (`0`-`9`) and underscores (`_`). `snake_case` is recommended.",label:"Process ID",schema:{type:"string",pattern:"^\\w+$"},default:null}},addProcessFromScript(){let e=[];this.process.id?this.process.id.match("^\\w+$")?this.processes.has(this.process.id,"user")&&(e.push({label:"Warning!",description:"A process with the given name exists! If you click 'Save' below, you confirm that you want to override the existing process. If you don't want to override the existing process, please choose a different name below.",info:!0}),e.push(this.getIdField(this.process.id))):(e.push({label:"Please note...",description:"The given process name is invalid, please choose another one below.",info:!0}),e.push(this.getIdField(this.process.id))):e.push(this.getIdField());let t=e=>this.addProcess(this.normalize(this.process,e));e.length>0?this.broadcast("showDataForm","Store a new custom process",e,t):t()},normalize(e,t={}){return Object.assign({},"function"===typeof e.toJSON?e.toJSON():e,t)},addProcess(e){this.create([e.id,e]).catch((t=>o.A.exception(this,t,"Store Process Error"+(e.id?`: ${e.id}`:""))))},processInfo(e){this.broadcast("showProcess",e)},replaceProcess(e,t){e instanceof j.UserProcess&&this.updateMetadata(e,t)},async updateMetadata(e,t){try{let s=await this.update({data:e,parameters:this.normalize(e,t)});o.A.ok(this,'Process "'+o.A.getResourceTitle(s)+'" successfully updated.')}catch(s){o.A.exception(this,s,"Update Process Error"+(e.id?`: ${e.id}`:""))}},deleteProcess(e){confirm(`Do you really want to delete the process "${o.A.getResourceTitle(e)}"?`)&&this.delete({data:e}).catch((t=>o.A.exception(this,t,"Delete Process Error"+(e.id?`: ${e.id}`:""))))}}},ee=X;var te=(0,u.A)(ee,Y,Z,!1,null,null,null);const se=te.exports;var ie=function(){var e=this,t=e._self._c;return t("DataTable",{ref:"table",staticClass:"ServicePanel",attrs:{data:e.data,columns:e.columns},scopedSlots:e._u([{key:"actions",fn:function(s){return[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Details"},on:{click:function(t){return e.serviceInfo(s.row)}}},[t("i",{staticClass:"fas fa-info"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsUpdate,expression:"supportsUpdate"}],attrs:{title:"Edit metadata"},on:{click:function(t){return e.editMetadata(s.row)}}},[t("i",{staticClass:"fas fa-edit"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsRead,expression:"supportsRead"}],attrs:{title:"Edit process"},on:{click:function(t){return e.showInEditor(s.row)}}},[t("i",{staticClass:"fas fa-project-diagram"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDelete,expression:"supportsDelete"}],attrs:{title:"Delete"},on:{click:function(t){return e.deleteService(s.row)}}},[t("i",{staticClass:"fas fa-trash"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:s.row.enabled&&e.isMapServiceSupported(s.row.type),expression:"p.row.enabled && isMapServiceSupported(p.row.type)"}],attrs:{title:"View on map"},on:{click:function(t){return e.viewService(s.row)}}},[t("i",{staticClass:"fas fa-map"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:s.row.enabled&&e.canShare,expression:"p.row.enabled && canShare"}],attrs:{title:"Export / Share"},on:{click:function(t){return e.shareResults(s.row)}}},[t("i",{staticClass:"fas fa-share"})]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsDebug,expression:"supportsDebug"}],attrs:{title:"View logs"},on:{click:function(t){return e.showLogs(s.row)}}},[t("i",{staticClass:"fas fa-bug"})])]}}])},[t("template",{slot:"toolbar"},[t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsCreate,expression:"supportsCreate"}],attrs:{title:"Add new permanently stored web service",disabled:!this.hasProcess},on:{click:function(t){return e.createServiceFromScript()}}},[t("i",{staticClass:"fas fa-plus"}),e._v(" Create")]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.supportsQuickView,expression:"supportsQuickView"}],attrs:{title:"Quickly show the process on map without storing it permanently",disabled:!this.hasProcess},on:{click:function(t){return e.quickViewServiceFromScript()}}},[t("i",{staticClass:"fas fa-map"}),e._v(" Show on Map")]),t("SyncButton",{attrs:{name:"web services",sync:()=>e.updateData(!0)}})],1)],2)},ae=[],re=s(95353);const oe={name:"ServicePanel",mixins:[D("services","web service","web services"),r.A,V],components:{SyncButton:R},data(){return{createdQuickViews:{}}},computed:{...o.A.mapState("editor",["process"]),...o.A.mapGetters("editor",["hasProcess"]),...o.A.mapState(["serviceTypes"]),...o.A.mapGetters(["supports","supportsBilling","supportsBillingPlans"]),columns(){return{id:{name:"ID",primaryKey:!0,hide:!0},title:{name:"Web Service",computedValue:e=>o.A.getResourceTitle(e),format:e=>o.A.formatIdOrTitle(e),edit:this.supportsUpdate?this.updateTitle:null},type:{name:"Type",format:e=>"string"===typeof e?e.toUpperCase():e},enabled:{name:"Enabled",edit:this.supportsUpdate?this.toggleEnabled:null},created:{name:"Submitted",format:"Timestamp",sort:"desc"},actions:{name:"Actions",filterable:!1,sort:!1}}},canShare(){return Array.isArray(this.$config.supportedBatchJobSharingServices)&&this.$config.supportedBatchJobSharingServices.length>0},supportsDebug(){return this.supports("debugService")},supportsQuickView(){return this.supportsCreate&&this.supportsDelete&&null!==this.mapService},mapService(){for(let e in this.serviceTypes){if(!o.A.isMapServiceSupported(e))continue;let t=this.serviceTypes[e],s=Object.values(t.configuration).some((e=>!0===e.required));if(!s)return e}return null}},mounted(){this.listen("replaceProcess",this.replaceProcess),this.beforeLogoutListener({key:this.$options.name,listener:this.onExit})},beforeDestroy(){this.beforeLogoutListener({key:this.$options.name})},methods:{...(0,re.PY)(["beforeLogoutListener"]),async onExit(){let e=[];for(let t in this.createdQuickViews){let s=this.createdQuickViews[t];e.push(this.deleteService(s,!0))}await Promise.all(e),this.createdQuickViews={}},isMapServiceSupported(e){return o.A.isMapServiceSupported(e)},showInEditor(e){this.refreshElement(e,(e=>this.broadcast("editProcess",e)))},showLogs(e){this.broadcast("viewLogs",e)},serviceCreated(e){var t=[];this.isMapServiceSupported(e.type)&&t.push({text:"View on map",action:()=>this.viewService(e)}),this.supportsRead&&t.push({text:"Details",action:()=>this.serviceInfo(e)}),this.supportsDelete&&t.push({text:"Delete",action:()=>this.deleteService(e)}),o.A.confirm(this,"Web Service created!",t)},getServiceTypeField(e=void 0){return{name:"type",label:"Type",schema:{type:"string",subtype:"service-type"},value:e}},getEnabledField(e=!0){return{name:"enabled",label:"Enabled",schema:{type:"boolean"},default:!0,value:e,optional:!0}},getConfigField(e=void 0){return{name:"configuration",label:"Service Configuration",schema:{type:"object",subtype:"service-config"},value:e,optional:!0}},normalizeToDefaultData(e){return"undefined"===typeof e.title||"string"===typeof e.title&&0!==e.title.length||(e.title=null),"undefined"===typeof e.description||"string"===typeof e.description&&0!==e.description.length||(e.description=null),"undefined"!==typeof e.enabled&&"boolean"!==typeof e.enabled&&(e.enabled=!0),"undefined"===typeof e.configuration||o.A.isObject(e.configuration)||(e.configuration={}),"undefined"===typeof e.plan||"string"===typeof e.plan&&0!==e.plan.length||(e.plan=null),"undefined"!==typeof e.budget&&("number"!==typeof e.budget||e.budget<0)&&(e.budget=null),e},async createService(e,t,s=!1){t=this.normalizeToDefaultData(t);try{let i=await this.create([e,t.type,t.title,t.description,t.enabled,t.configuration,t.plan,t.budget,{log_level:t.log_level}]);return s||this.serviceCreated(i),i}catch(i){return o.A.exception(this,i,"Create Service Error: "+(t.title||"")),null}},createServiceFromScript(){var e=[this.getTitleField(),this.getDescriptionField(),this.getServiceTypeField(),this.getEnabledField(),this.getLogLevelField(),this.supportsBillingPlans?this.getBillingPlanField():null,this.supportsBilling?this.getBudgetField():null,this.getConfigField()];this.broadcast("showDataForm","Create new web service",e,(e=>this.createService(this.process,e)))},async quickViewServiceFromScript(){try{let e={title:"Quick view",type:this.mapService,enabled:!0},t=await this.createService(this.process,e,!0);t&&(this.createdQuickViews[t.id]=t,this.viewService(t,(()=>this.deleteService(t,!0))))}catch(e){o.A.exception(this,e,"Show on Map Error")}},editMetadata(e){this.refreshElement(e,(e=>{var t=[this.getTitleField(e.title),this.getDescriptionField(e.description),this.getEnabledField(e.enabled),this.getLogLevelField(e.log_level),this.supportsBillingPlans?this.getBillingPlanField(e.plan):null,this.supportsBilling?this.getBudgetField(e.budget):null,this.getConfigField(e.configuration)];this.broadcast("showDataForm","Edit web service",t,(t=>this.updateService(e,t)))}))},serviceInfo(e){this.refreshElement(e,(e=>{this.broadcast("showModal","ServiceInfoModal",{service:e.getAll()})}))},replaceProcess(e,t){e instanceof j.Service&&this.updateService(e,{process:t})},updateTitle(e,t){this.updateService(e,{title:t})},toggleEnabled(e){this.updateService(e,{enabled:!e.enabled})},async updateService(e,t){try{let s=await this.update({data:e,parameters:this.normalizeToDefaultData(t)});o.A.ok(this,'Service "'+o.A.getResourceTitle(s)+'" successfully updated.')}catch(s){o.A.exception(this,s,"Update Service Error: "+o.A.getResourceTitle(e))}},async deleteService(e,t=!1){if(t||confirm(`Do you really want to delete the service "${o.A.getResourceTitle(e)}"?`))try{await this.delete({data:e}),this.broadcast("removeWebService",e.id),delete this.createdQuickViews[e.id]}catch(s){t?console.error(s):o.A.exception(this,s,"Delete Service Error: "+o.A.getResourceTitle(e))}},viewService(e,t=null){this.refreshElement(e,(e=>this.broadcast("viewWebService",e,t)))},async shareResults(e){this.canShare&&this.refreshElement(e,(t=>{e.enabled?t.url?this.broadcast("showModal","ShareModal",{url:t.url,title:t.title,context:t}):o.A.error(this,"Sorry, this service has no public URL."):o.A.error(this,"Sorry, only enabled services can be shared.")}))}}},ne=oe;var le=(0,u.A)(ne,ie,ae,!1,null,null,null);const ce=le.exports,de={name:"UserWorkspace",components:{FilePanel:L,JobPanel:Q,CustomProcessPanel:se,ServicePanel:ce,Tabs:g["default"],Tab:v["default"]},computed:{...o.A.mapGetters(["supports"]),showJobs(){return this.supports("listJobs")||this.supports("createJob")||this.supports("computeResult")},showServices(){return this.supports("listServices")||this.supports("createService")},showCustomProcesses(){return this.supports("listUserProcesses")||this.supports("setUserProcess")},showFiles(){return this.supports("listFiles")||this.supports("uploadFile")}},methods:{onShow(e){e.$children.length&&"function"===typeof e.$children[0].onShow&&e.$children[0].onShow()},onHide(e){e.$children.length&&"function"===typeof e.$children[0].onHide&&e.$children[0].onHide()}}},ue=de;var pe=(0,u.A)(ue,m,f,!1,null,null,null);const he=pe.exports;var me=function(){var e=this,t=e._self._c;return t("div",{staticClass:"viewerContainer",on:{drop:e.onDrop,dragover:e.allowDrop}},[t("Tabs",{ref:"tabs",attrs:{id:"viewerTabs",allowTabRename:""},on:{empty:e.onTabsEmpty},scopedSlots:e._u([{key:"empty",fn:function(){return[e._v("Nothing to show right now...")]},proxy:!0},{key:"dynamic",fn:function({tab:s}){return[e.logViewerIcons.includes(s.icon)?t("LogViewer",{attrs:{data:s.data},on:{mounted:e.onMounted,options:e.onOptionsChanged}}):s.data.component?t(s.data.component,e._g(e._b({tag:"component",on:{mounted:e.onMounted,options:e.onOptionsChanged}},"component",s.data.props,!1),s.data.events)):"fa-map"===s.icon?t("MapViewer",{attrs:{data:s.data,removableLayers:e.isCollectionPreview(s.data)},on:{mounted:e.onMounted,options:e.onOptionsChanged}}):t("div",{staticClass:"unsupported"},[e._v(" Sorry, the viewer doesn't support showing this type of data. "),e.isFormat(s.data)?[e._v(" Instead, you can download the data by clicking the link below."),t("br"),t("a",{attrs:{href:s.data.getUrl(),download:""}},[e._v("Download")])]:e._e()],2)]}}])})],1)},fe=[],ge=s(6765);const ve={name:"Viewer",mixins:[r.A],components:{Tabs:g["default"],DataViewer:()=>s.e(8396).then(s.bind(s,58396)),TableViewer:()=>Promise.all([s.e(7237),s.e(1426),s.e(8363),s.e(3592)]).then(s.bind(s,51001)),ImageViewer:()=>s.e(4285).then(s.bind(s,94285)),LogViewer:()=>s.e(887).then(s.bind(s,20887)),MapViewer:()=>Promise.all([s.e(1160),s.e(5983),s.e(1323),s.e(5624),s.e(1189),s.e(6617),s.e(5640),s.e(2559),s.e(2365),s.e(3800),s.e(3291),s.e(3876),s.e(9882),s.e(7237),s.e(1426),s.e(8363),s.e(4368)]).then(s.bind(s,13324))},mounted(){this.listen("viewSyncResult",this.showSyncResults),this.listen("viewJobResults",this.showJobResults),this.listen("viewWebService",this.showWebService),this.listen("showCollectionPreview",(e=>this.showCollectionPreview(e).catch((e=>o.A.exception(this,e,"Failed loading collection."))))),this.listen("viewLogs",this.showLogs),this.listen("removeWebService",this.closeTabWithLogs),this.listen("removeBatchJob",this.closeTabWithLogs),this.listen("addToMapChooser",this.addToMapChooser),this.appMode&&this.showAppMode()},data(){return{tabTitleCounter:{},tabIdCounter:0,logViewerIcons:["fa-bug","fa-bomb","fa-tasks"],options:null}},computed:{...o.A.mapState(["connection"]),...o.A.mapState("editor",["appMode","formatRegistry"]),...o.A.mapGetters("editor",["getModelNodeFromDnD"]),nextTabId(){return`viewer~${this.tabIdCounter}`}},methods:{...o.A.mapActions(["describeCollection"]),...o.A.mapMutations("editor",["setViewerOptions","setModelDnD"]),showAppMode(){if("service"===this.appMode.resultType){console.log(this.appMode);const e=new j.Service(this.connection,"app");e.title=this.appMode.title,e.url=this.appMode.resultUrl,e.type=this.appMode.service,e.enabled=!0,console.log(e),this.showWebService(e)}else if(this.showJobResults(this.appMode.data,null,this.appMode.title),"string"===typeof this.appMode.expires){const e=x.Formatters.formatTimestamp(this.appMode.expires);o.A.info(this,`The shared data is available until ${e}`)}},isCollectionPreview(e){return e instanceof j.Service&&o.A.isObject(e.attributes)&&!0===e.attributes.preview},isFormat(e){return e instanceof ge.yL},async showCollectionPreview(e){if("string"===typeof e)try{e=await this.describeCollection(e)}catch(a){return void o.A.error(this,"Sorry, can't load collection '"+e+"'.")}let t=o.A.getPreviewLinkFromSTAC(e);t||o.A.error(this,"No visualizations found for collection");let s=new j.Service(null,`collection-preview~${e.id}`);s.url=t.href,s.type=t.rel.toLowerCase(),s.attributes={preview:!0,bbox:o.A.extentToBBox(e.extent.spatial.bbox[0])},"wmts"===t.rel.toLowerCase()&&("string"===typeof t["wmts:layer"]?s.attributes.layers=[t["wmts:layer"]]:Array.isArray(t["wmts:layer"])&&(s.attributes.layers=t["wmts:layer"]),s.attributes.dimensions=t["wmts:dimensions"]);let i=o.A.getResourceTitle(e,!0);this.showMapViewer(s,s.id,i,!0)},showWebService(e,t=null){this.showMapViewer(e,e.id,null,!0,t)},showLogs(e,t="Logs",s=!0,i="fa-bug"){let a=Array.isArray(e)?t:o.A.getResourceTitle(e,"Logs"),r=Array.isArray(e)?null:`logs~${e.id}`;if(r){let e=this.$refs.tabs.getTab(r);if(e)return void this.$refs.tabs.selectTab(e)}this.$refs.tabs.addTab(a,i,e,r,s,!0,(e=>this.onShow(e)),(e=>this.onHide(e)))},closeTabWithLogs(e){this.closeTab(e),this.closeTab(`logs~${e}`)},closeTab(e){let t=this.$refs.tabs.getTab(e);t&&this.$refs.tabs.closeTab(t)},showSyncResults(e){let t=this.makeTitle("Result"),s=this.formatRegistry.createFilesFromBlob(e.data);s.forEach((e=>e.download())),this.showViewer(s,t).catch((e=>o.A.exception(this,e))).finally((()=>{Array.isArray(e.logs)&&e.logs.length>0&&this.showLogs(e.logs,t,!1)}))},showJobResults(e,t=null,s=null){null===s&&(s=e.title?e.title:e.properties&&e.properties.title?e.properties.title:o.A.getResourceTitle(t,!0));let i=e.id;t&&t.id&&(i=t.id);let a=this.formatRegistry.createFilesFromSTAC(e,t);0!==a.length?a.length>5&&!o.A.confirmOpenAll(a)||this.showViewer(a,s,(e=>`${i}-${e.getUrl()}`),!0).catch((e=>o.A.exception(this,e))):o.A.error(this,'No results available for "'+s+'".')},showMapViewer(e,t=null,s=null,i=!1,a=null){if(s||(s=o.A.getResourceTitle(e,!0)),t){if(i){let e=this.$refs.tabs.getTab(t);if(e)return this.$refs.tabs.selectTab(e)}}else if(t=this.nextTabId,this.tabIdCounter++,i)throw new Error("Tabs without id can't be re-used");this.$refs.tabs.addTab(s,"fa-map",e,t,!0,!0,(e=>this.onShow(e)),(e=>this.onHide(e)),a)},addToMapChooser({asset:e,context:t}){const s=this.$refs.tabs.tabs.filter((e=>"fa-map"===e.icon)),i=["New Map",...s.map((e=>e.name))];this.broadcast("showListModal","Select a map to add the data to",i,[{callback:async(i,a)=>{const r=this.formatRegistry.createFileFromAsset(e,t);if(await r.loadData(this.connection),0===a)this.showViewer([r],r.title).catch((e=>o.A.exception(this,e)));else{const e=s[a-1];this.$refs.tabs.selectTab(e),e.$children[0].addGeoTiff(r,r.title)}return!0}}])},async showViewer(e,t=null,s=null,i=!1){if(!Array.isArray(e))return;let a;for(let n of e)try{let e=n.getContext();if(a="function"===typeof s?s(n):!s&&e?e.id:s,i){if(!a)throw new Error("Tabs without id can't be re-used");let e=this.$refs.tabs.getTab(a);if(e)return void this.$refs.tabs.selectTab(e)}n.title?t=n.title:!t&&e?t=o.A.getResourceTitle(e,!0):t||(t=this.makeTitle("Untitled")),await n.loadData(this.connection),this.$refs.tabs.addTab(t,n.icon,n,a,!0,!0,(e=>this.onShow(e)),(e=>this.onHide(e)))}catch(r){o.A.exception(this,r,"Viewer Error"),n.download()}},callChildFunction(e,t,...s){if("function"===typeof e[t]){let i=e[t](...s);i instanceof Promise&&i.catch((e=>o.A.exception(this,e)))}},async onDrop(e){const t=await this.getModelNodeFromDnD();if(this.setModelDnD(),"load_collection"===t.process_id){e.preventDefault();let i=o.A.isObject(t.arguments)?t.arguments.id:null;try{await this.showCollectionPreview(i)}catch(s){o.A.exception(this,s,`Failed loading collection '${i}'.`)}}},allowDrop(e){e.preventDefault()},onShow(e){this.callChildFunction(e,"onShow")},onMounted(e){this.callChildFunction(e,"onShow"),this.setViewerOptions()},onHide(e){this.callChildFunction(e,"onHide")},onTabsEmpty(e){this.$emit("empty",e),this.setViewerOptions()},onOptionsChanged(e){this.setViewerOptions(e)},uniqueTitle(e){return this.tabTitleCounter[e]?(this.tabTitleCounter[e]++,e+" ("+this.tabTitleCounter[e]+")"):(this.tabTitleCounter[e]=1,e)},makeTitle(e,t,s=!0){return e?s?this.uniqueTitle(e):e:this.uniqueTitle(t)}}},ye=ve;var be=(0,u.A)(ye,me,fe,!1,null,null,null);const we=be.exports;var Se=s(63036),Ae=s(44263),xe=s(36107),Pe=s(31572),Ce=s(44304);const _e={name:"IDE",mixins:[r.A],components:{DiscoveryToolbar:xe.A,Editor:Se["default"],Logo:Ae.A,Viewer:we,UserMenu:h,UserWorkspace:he,Splitpanes:Ce.S,Pane:Ce.Z},data(){return{showViewer:!1,resizeListener:null,userInfoUpdater:null}},computed:{...o.A.mapState(["connection","isAuthenticated"]),...o.A.mapState("editor",["appMode","context","process","collectionPreview","openWizard","openWizardProps"]),...o.A.mapGetters(["title","apiVersion","supports"]),...o.A.mapGetters("editor",["hasProcess"]),...o.A.mapGetters("jobs",{supportsJobUpdate:"supportsUpdate"}),...o.A.mapGetters("services",{supportsServiceUpdate:"supportsUpdate"}),...o.A.mapGetters("userProcesses",{supportsUserProcessUpdate:"supportsUpdate"}),contextTitle(){return null!==this.context?o.A.getResourceTitle(this.context,!0):""},saveSupported(){return null!==this.context&&(this.context instanceof j.Job&&this.supportsJobUpdate||this.context instanceof j.Service&&this.supportsServiceUpdate||this.context instanceof j.UserProcess&&this.supportsUserProcessUpdate)},hasProcess(){return o.A.size(this.process)>0},validateSupported(){return this.supports("validateProcess")},splitpaneSizeH(){return this.appMode?this.process?[0,50,50]:[0,0,100]:this.showViewer?[20,40,40]:[25,75,0]},splitpaneSizeV(){return this.appMode?[100,0]:this.isAuthenticated?[50,50]:[99,1]}},async mounted(){this.listen("showDataForm",this.showDataForm),this.listen("editProcess",this.editProcess),this.listen("showLogin",this.login),this.listen("importProcess",this.importProcess),this.resizeListener=e=>this.resized(e),window.addEventListener("resize",this.resizeListener),this.isAuthenticated&&(this.userInfoUpdater=setInterval((()=>this.describeAccount().catch((e=>console.error(e)))),60*this.$config.dataRefreshInterval*1e3)),this.broadcast("title",this.title),this.collectionPreview&&this.$nextTick((()=>{this.broadcast("showCollectionPreview",this.collectionPreview),this.setCollectionPreview(null)})),this.openWizard&&this.showWizard(this.openWizard,this.openWizardProps)},beforeDestroy(){null!==this.resizeListener&&window.removeEventListener("resize",this.resizeListener),null!==this.userInfoUpdater&&clearInterval(this.userInfoUpdater)},methods:{...o.A.mapActions(["describeAccount"]),...o.A.mapMutations(["discoveryCompleted"]),...o.A.mapMutations("editor",["setContext","setProcess","setCollectionPreview"]),resized(e){this.broadcast("windowResized",e)},onViewerEmpty(e){this.showViewer=!e},login(){this.discoveryCompleted(!1)},importProcess(){let e={save:this.updateEditor};this.broadcast("showModal","ImportProcessModal",{},e)},saveProcess(){this.broadcast("replaceProcess",this.context,this.process)},async exportCode(){this.broadcast("showModal","ExportCodeModal")},showWizard(e=null,t={}){if(this.hasProcess){var s=confirm("Starting the wizard may clear the existing model.\r\nDo you really want to continue?");if(!s)return}this.broadcast("showModal","WizardModal",{preselectUsecase:e,options:t})},async validateProcess(){if(!this.validateSupported)return o.A.error(this,"Server doesn't support validation");if(!this.hasProcess)return o.A.info(this,"Nothing to validate...");try{let e=await this.connection.validateProcess(this.process);e.length>0?(e.forEach((e=>e.level="error")),this.broadcast("viewLogs",e,"Validation Result","fa-tasks")):o.A.ok(this,"The process is valid")}catch(e){o.A.exception(this,e,"Validation rejected")}},updateEditor(e){null===e&&this.setContext(null),this.setProcess(e||null)},editProcess(e){this.setContext(e)},insertProcess(e){this.$refs.editor.insertProcess(e)},showServerInfo(){this.broadcast("showModal","ServerInfoModal")},showHelp(){this.broadcast("showTour","ide")},showDataForm(e,t,s=null,i=null){var a="function"===typeof s,r={},o=[];for(let c of t)null!==c&&(o.push(new Pe.ProcessParameter(c)),r[c.name]=c.value);let n={title:e,parameters:o,data:r,editable:a},l={};"function"===typeof s&&(l.save=s),"function"===typeof i&&(l.closed=i),this.broadcast("showModal","ParameterModal",n,l)}}},ke=_e;var De=(0,u.A)(ke,i,a,!1,null,null,null);const Te=De.exports},99017:(e,t,s)=>{s.d(t,{Kt:()=>l,QJ:()=>r,Vz:()=>o});var i=s(73902),a=s(2566);class r extends Error{constructor(e,t=null,s=null,i=!0,a=!0){super(e,{cause:s}),this.title=t,this.close=i,this.isError=a}}function o(e,t){t instanceof r&&(t.isError?a.A.error(e,t.message,t.title):a.A.ok(e,t.message,t.title))}let n={};async function l(e,t,s){n[s]?n[s]++:n[s]=1;const o=new i.AbortController,l=Object.assign({},e.$config.snotifyDefaults,{timeout:0,type:"async",buttons:[{text:"Cancel",action:()=>{o.abort()}}]});let c;const d=`${s} #${n[s]}`;try{const s="Processing in progress, please wait...",i=()=>new Promise((()=>{}));c=e.$snotify.async(s,d,i,l),await t(o)}catch(u){if(axios.isCancel(u))throw new r("Cancelled successfully",d,u,!1,!1);if("string"!==typeof u.message||!a.A.isObject(u.response)||![400,500].includes(u.response.status))throw new r(u.message,d,u,!1);e.broadcast("viewLogs",[{id:u.id,code:u.code,level:"error",message:u.message,links:u.links||[]}]),a.A.error(e,`${s} failed. Please see the logs for details.`,d)}finally{c&&e.$snotify.remove(c.id,!0)}}},16125:(e,t,s)=>{s.d(t,{A:()=>o});var i=s(14894),a=s(2566);class r extends i.BaseProcess{constructor(e,t){super(e),this.exporter=t}async execute(e){await this.exporter.generateFunction(e)}}class o extends i.ProcessGraph{constructor(e,t,s){super(a.A.isObject(e)?e:{},t),this.connection=s,this.code=[],this.fnCounter=1,this.allowEmpty(),this.fillUndefinedParameters()}createProcessGraphInstance(e){let t=new o(e,this.processRegistry,this.getJsonSchemaValidator());return this.copyProcessGraphInstanceProperties(t)}copyProcessGraphInstanceProperties(e){return e=super.copyProcessGraphInstanceProperties(e),e.connection=this.connection,e}createProcessInstance(e){return new r(e,this)}isKeyword(e){return this.getKeywords().includes(e.toLowerCase())}getKeywords(){return[]}comment(){}generateImports(){}generateConnection(){}generateAuthentication(){}generateBuilder(){}generateMetadata(){}generateMissingParameter(){}async generateFunction(){}generateFunctionParams(e){return e.map((e=>"undefined"!==typeof e.default?`${e.name} = ${this.e(e.default)}`:e.name))}async generateCallback(){}generateResult(){}makeNull(){return"null"}makeBoolean(e){return e?"true":"false"}makeArray(e){return`[${e.join(", ")}]`}makeObject(e){let t=a.A.mapObject(e,((e,t)=>`${this.makeString(t)}: ${e}`));return`{${t.join(", ")}}`}makeString(e){return JSON.stringify(e)}makeNumber(e){return e}e(e){return null===e?this.makeNull():"boolean"===typeof e?this.makeBoolean(e):"number"===typeof e?this.makeNumber(e):"string"===typeof e?this.makeString(e):Array.isArray(e)?this.makeArray(e.map((e=>this.e(e)))):a.A.isObject(e)?this.makeObject(a.A.mapObjectValues(e,(e=>this.e(e)))):"function"===typeof e?e():this.makeNull()}generateMetadata(){let e=!1;for(let t in this.process){if("process_graph"===t)continue;let s=this.process[t];Array.isArray(s)&&0===s.length||("string"===typeof s&&0===s.length||("boolean"!==typeof s||s)&&(e||(this.newLine(),this.comment("Set the metadata for the process"),e=!0),this.generateMetadataEntry(t,s)))}}async resolveArguments(e,t,s){let i=Array.isArray(e)?[]:{};for(let r in e){let n=e[r];if(!s||!s(r,n))if(a.A.isObject(n)){if(n.from_node){i[r]=()=>this.var(n.from_node,this.varPrefix());continue}if(n.from_parameter){i[r]=()=>this.var(n.from_parameter);continue}if(n instanceof o){let e=await t(r);i[r]=()=>e;continue}i[r]=await this.resolveArguments(n,t,s)}else Array.isArray(n)?i[r]=await this.resolveArguments(n,t,s):i[r]=n}return i}async resolveCallback(e,t){let s;if("load_collection"===e.process_id){let i=e.getArgument("properties");s=i[t]}else s=e.getArgument(t);let i=s.getCallbackParameters();await s.execute(i);let a=this.var(`${t}${this.fnCounter++}`,"fn_"),r=await this.generateCallback(s,i,a);return r||a}async generateArguments(e,t=!1,s=null){let i=await this.resolveArguments(e.arguments,(async t=>await this.resolveCallback(e,t)),s);return t&&(i=this.orderArguments(e,i)),i}orderArguments(e,t){let s=e.getProcessGraph().getProcess(e);if(s&&Array.isArray(s.parameters)){let e=s.parameters.map((e=>"undefined"!==typeof t[e.name]?t[e.name]:e.optional?void 0:null)),i=!1;for(let t=e.length-1;t>=0;t--)"undefined"===typeof e[t]?i?e[t]=null:e.pop():i=!0;return e}}varPrefix(){return this.getParent()?"data":"datacube"}var(e,t="var"){return e=String(e),this.isKeyword(e)?`${e}_`:e.match(/^[a-z_]\w*$/)?e:t+e.replace(/[^\w]+/g,"_")}getTab(){return"\t"}addCode(e,t="",s=0){if("string"!==typeof e)return;let i=this.getTab().repeat(s),a=e.trim().split(/\r\n|\r|\n/g);for(let r of a)this.code.push(`${i}${t}${r}\n`)}newLine(e=1){for(let t=0;t<e;t++)this.addCode("")}getServerUrl(){return this.connection.getUrl()}async toCode(e=!1){this.code=[],e||(this.comment("Import required packages"),this.generateImports(),this.newLine(),this.comment("Connect to the back-end"),this.generateConnection(),this.generateAuthentication(),this.newLine(),this.generateBuilder(),this.generateMetadata(),this.newLine());let t=this.getProcessParameters();if(t.length>0){this.comment("ToDo: Here you need to set values for the parameters");for(let e of t)this.generateMissingParameter(e);this.newLine()}return await this.execute(),e||(this.newLine(),this.comment("The process can be executed synchronously (see below), as batch job or as web service now")),this.generateResult(this.getResultNode(),e),this.code.join("").trim()}async execute(){return await this.validate(),this.reset(),await this.executeNodes(this.getStartNodes()),this.getResultNode()}isMath(){return"undefined"===typeof this._isMath&&(this._isMath=this.processRegistry.isMath(this)),this._isMath}}},47067:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(2566),a=s(16125),r=s(73902);const o=["abstract","arguments","await","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","eval","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","let","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with","yield","builder","connection","formula","openeo","result"];class n extends a.A{constructor(e,t,s,i=!1){super(e,t,s),this.generateFormula=i}createProcessGraphInstance(e){let t=new n(e,this.processRegistry,this.getJsonSchemaValidator(),this.generateFormula);return this.copyProcessGraphInstanceProperties(t)}parse(){this.parsed||super.parse()}getKeywords(){return o}comment(e){this.addCode(e,"// ")}generateImports(){this.addCode("import { OpenEO, Formula } from '@openeo/js-client';")}generateConnection(){this.addCode(`let connection = await OpenEO.connect('${this.getServerUrl()}');`)}generateAuthentication(){this.comment("ToDo: Here you need to add your authentication steps")}generateBuilder(){this.addCode("let builder = await connection.buildProcess();")}generateMetadataEntry(e,t){this.addCode(`builder.${e} = ${this.e(t)};`)}async generateFunction(e){let t=e.getParent()?"this":"builder",s=this.var(e.id,this.varPrefix()),a=await this.generateArguments(e,!e.namespace);if(this.comment(e.description),i.A.isObject(a)){let i=e.namespace?`${e.process_id}@${e.namespace}`:e.process_id;this.addCode(`let ${s} = ${t}.process("${i}", ${this.e(a)});`)}else this.addCode(`let ${s} = ${t}.${e.process_id}(${a.map((e=>this.e(e))).join(", ")});`)}generateMissingParameter(e){this.comment(e.description);let t=this.var(e.name,"param"),s="undefined"!==typeof e.default?e.default:null;this.addCode(`let ${t} = ${this.e(s)};`)}async generateCallback(e,t,s){if(this.generateFormula&&e&&e.isMath()){let t=e.toFormulaString(),s=JSON.stringify(t);return`new Formula(${s})`}{let i=this.generateFunctionParams(t);this.newLine(),this.addCode(`let ${s} = function(${i.join(", ")}) {`),this.addCode(await e.toCode(!0),"",1),this.addCode("}")}}generateResult(e,t){if(!e)return;let s=this.var(e.id,this.varPrefix());t?this.addCode(`return ${s};`):this.addCode(`let result = await connection.computeResult(${s});`)}toFormulaString(){return this.isMath()?this.nodeToFormula(this.getResultNode()):""}getArrayElementPlaceholder(e){if("array_element"===e.process_id&&"parameter"===e.getArgumentType("data")){let t=e.getRawArgument("data").from_parameter,s=this.getCallbackParameters().findIndex((e=>e.name===t));if(s>=0)return"$".repeat(s+1)+(e.getArgument("label")||e.getArgument("index"))}return null}nodeToFormula(e,t=null){if("array_element"===e.process_id){let t=this.getArrayElementPlaceholder(e);if(t)return t}let s=r.Formula.reverseOperatorMapping[e.process_id],a=this.processRegistry.get(e.process_id),o="undefined"!==typeof r.Formula.arrayOperatorMapping[e.process_id],n=t=>{if(i.A.isObject(t))if(t.from_node){let i=e.getProcessGraph().getNode(t.from_node);t=i?this.nodeToFormula(i,s):"#"+t.from_node}else{if(!t.from_parameter)throw new Error("Objects not allowed");t=t.from_parameter}return t},l=[],c=Array.isArray(a.parameters)?a.parameters:[];for(let i of c){let t=n(e.getRawArgument(i.name));if(o&&Array.isArray(t)&&"data"===i.name){l=t.map((e=>n(e)));break}if("undefined"!==typeof t)l.push(t);else{if("undefined"===typeof i.default)throw new Error('Argument for parameter "'+i.name+'" missing');l.push(i.default)}}if(o&&(l=l.filter((e=>null!==e))),s){let e=["/","*"],i=["-","+"],a=l.map((e=>e<0?"("+e+")":e)).join(s);return!t||i.includes(t)&&i.includes(s)||"^"===s||i.includes(t)&&e.includes(s)?a:"("+a+")"}return e.process_id+"("+l.join(", ")+")"}}},44304:(e,t,s)=>{s.d(t,{S:()=>w,Z:()=>k});var i=Object.defineProperty,a=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,c=(e,t,s)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,d=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&c(e,s,t[s]);if(o)for(var s of o(t))l.call(t,s)&&c(e,s,t[s]);return e},u=(e,t)=>a(e,r(t)),p=(e,t)=>{var s={};for(var i in e)n.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&o)for(var i of o(e))t.indexOf(i)<0&&l.call(e,i)&&(s[i]=e[i]);return s};function h(e,t,s,i,a,r,o,n){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=s,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),o?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):a&&(l=n?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}const m={name:"splitpanes",props:{horizontal:{type:Boolean},pushOtherPanes:{type:Boolean,default:!0},dblClickSplitter:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean}},provide(){return{requestUpdate:this.requestUpdate,onPaneAdd:this.onPaneAdd,onPaneRemove:this.onPaneRemove,onPaneClick:this.onPaneClick}},data:()=>({container:null,ready:!1,panes:[],touch:{mouseDown:!1,dragging:!1,activeSplitter:null},splitterTaps:{splitter:null,timeoutId:null}}),computed:{panesCount(){return this.panes.length},indexedPanes(){return this.panes.reduce(((e,t)=>(e[t.id]=t)&&e),{})}},methods:{updatePaneComponents(){this.panes.forEach((e=>{e.update&&e.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[e.id].size}%`})}))},bindEvents(){document.addEventListener("mousemove",this.onMouseMove,{passive:!1}),document.addEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.addEventListener("touchmove",this.onMouseMove,{passive:!1}),document.addEventListener("touchend",this.onMouseUp))},unbindEvents(){document.removeEventListener("mousemove",this.onMouseMove,{passive:!1}),document.removeEventListener("mouseup",this.onMouseUp),"ontouchstart"in window&&(document.removeEventListener("touchmove",this.onMouseMove,{passive:!1}),document.removeEventListener("touchend",this.onMouseUp))},onMouseDown(e,t){this.bindEvents(),this.touch.mouseDown=!0,this.touch.activeSplitter=t},onMouseMove(e){this.touch.mouseDown&&(e.preventDefault(),this.touch.dragging=!0,this.calculatePanesSize(this.getCurrentMouseDrag(e)),this.$emit("resize",this.panes.map((e=>({min:e.min,max:e.max,size:e.size})))))},onMouseUp(){this.touch.dragging&&this.$emit("resized",this.panes.map((e=>({min:e.min,max:e.max,size:e.size})))),this.touch.mouseDown=!1,setTimeout((()=>{this.touch.dragging=!1,this.unbindEvents()}),100)},onSplitterClick(e,t){"ontouchstart"in window&&(e.preventDefault(),this.dblClickSplitter&&(this.splitterTaps.splitter===t?(clearTimeout(this.splitterTaps.timeoutId),this.splitterTaps.timeoutId=null,this.onSplitterDblClick(e,t),this.splitterTaps.splitter=null):(this.splitterTaps.splitter=t,this.splitterTaps.timeoutId=setTimeout((()=>{this.splitterTaps.splitter=null}),500)))),this.touch.dragging||this.$emit("splitter-click",this.panes[t])},onSplitterDblClick(e,t){let s=0;this.panes=this.panes.map(((e,i)=>(e.size=i===t?e.max:e.min,i!==t&&(s+=e.min),e))),this.panes[t].size-=s,this.$emit("pane-maximize",this.panes[t])},onPaneClick(e,t){this.$emit("pane-click",this.indexedPanes[t])},getCurrentMouseDrag(e){const t=this.container.getBoundingClientRect(),{clientX:s,clientY:i}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:s-t.left,y:i-t.top}},getCurrentDragPercentage(e){e=e[this.horizontal?"y":"x"];const t=this.container[this.horizontal?"clientHeight":"clientWidth"];return this.rtl&&!this.horizontal&&(e=t-e),100*e/t},calculatePanesSize(e){const t=this.touch.activeSplitter;let s={prevPanesSize:this.sumPrevPanesSize(t),nextPanesSize:this.sumNextPanesSize(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const i=0+(this.pushOtherPanes?0:s.prevPanesSize),a=100-(this.pushOtherPanes?0:s.nextPanesSize),r=Math.max(Math.min(this.getCurrentDragPercentage(e),a),i);let o=[t,t+1],n=this.panes[o[0]]||null,l=this.panes[o[1]]||null;const c=n.max<100&&r>=n.max+s.prevPanesSize,d=l.max<100&&r<=100-(l.max+this.sumNextPanesSize(t+1));if(c||d)c?(n.size=n.max,l.size=Math.max(100-n.max-s.prevPanesSize-s.nextPanesSize,0)):(n.size=Math.max(100-l.max-s.prevPanesSize-this.sumNextPanesSize(t+1),0),l.size=l.max);else{if(this.pushOtherPanes){const e=this.doPushOtherPanes(s,r);if(!e)return;({sums:s,panesToResize:o}=e),n=this.panes[o[0]]||null,l=this.panes[o[1]]||null}null!==n&&(n.size=Math.min(Math.max(r-s.prevPanesSize-s.prevReachedMinPanes,n.min),n.max)),null!==l&&(l.size=Math.min(Math.max(100-r-s.nextPanesSize-s.nextReachedMinPanes,l.min),l.max))}},doPushOtherPanes(e,t){const s=this.touch.activeSplitter,i=[s,s+1];return t<e.prevPanesSize+this.panes[i[0]].min&&(i[0]=this.findPrevExpandedPane(s).index,e.prevReachedMinPanes=0,i[0]<s&&this.panes.forEach(((t,a)=>{a>i[0]&&a<=s&&(t.size=t.min,e.prevReachedMinPanes+=t.min)})),e.prevPanesSize=this.sumPrevPanesSize(i[0]),void 0===i[0])?(e.prevReachedMinPanes=0,this.panes[0].size=this.panes[0].min,this.panes.forEach(((t,i)=>{i>0&&i<=s&&(t.size=t.min,e.prevReachedMinPanes+=t.min)})),this.panes[i[1]].size=100-e.prevReachedMinPanes-this.panes[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-this.panes[i[1]].min&&(i[1]=this.findNextExpandedPane(s).index,e.nextReachedMinPanes=0,i[1]>s+1&&this.panes.forEach(((t,a)=>{a>s&&a<i[1]&&(t.size=t.min,e.nextReachedMinPanes+=t.min)})),e.nextPanesSize=this.sumNextPanesSize(i[1]-1),void 0===i[1])?(e.nextReachedMinPanes=0,this.panes[this.panesCount-1].size=this.panes[this.panesCount-1].min,this.panes.forEach(((t,i)=>{i<this.panesCount-1&&i>=s+1&&(t.size=t.min,e.nextReachedMinPanes+=t.min)})),this.panes[i[0]].size=100-e.prevPanesSize-e.nextReachedMinPanes-this.panes[this.panesCount-1].min-e.nextPanesSize,null):{sums:e,panesToResize:i}},sumPrevPanesSize(e){return this.panes.reduce(((t,s,i)=>t+(i<e?s.size:0)),0)},sumNextPanesSize(e){return this.panes.reduce(((t,s,i)=>t+(i>e+1?s.size:0)),0)},findPrevExpandedPane(e){const t=[...this.panes].reverse().find((t=>t.index<e&&t.size>t.min));return t||{}},findNextExpandedPane(e){const t=this.panes.find((t=>t.index>e+1&&t.size>t.min));return t||{}},checkSplitpanesNodes(){const e=Array.from(this.container.children);e.forEach((e=>{const t=e.classList.contains("splitpanes__pane"),s=e.classList.contains("splitpanes__splitter");if(!t&&!s)return e.parentNode.removeChild(e),void console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed.")}))},addSplitter(e,t,s=!1){const i=e-1,a=document.createElement("div");a.classList.add("splitpanes__splitter"),s||(a.onmousedown=e=>this.onMouseDown(e,i),"undefined"!==typeof window&&"ontouchstart"in window&&(a.ontouchstart=e=>this.onMouseDown(e,i)),a.onclick=e=>this.onSplitterClick(e,i+1)),this.dblClickSplitter&&(a.ondblclick=e=>this.onSplitterDblClick(e,i+1)),t.parentNode.insertBefore(a,t)},removeSplitter(e){e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.parentNode.removeChild(e)},redoSplitters(){const e=Array.from(this.container.children);e.forEach((e=>{e.className.includes("splitpanes__splitter")&&this.removeSplitter(e)}));let t=0;e.forEach((e=>{e.className.includes("splitpanes__pane")&&(!t&&this.firstSplitter?this.addSplitter(t,e,!0):t&&this.addSplitter(t,e),t++)}))},requestUpdate(e){var t=e,{target:s}=t,i=p(t,["target"]);const a=this.indexedPanes[s._uid];Object.entries(i).forEach((([e,t])=>a[e]=t))},onPaneAdd(e){let t=-1;Array.from(e.$el.parentNode.children).some((s=>(s.className.includes("splitpanes__pane")&&t++,s===e.$el)));const s=parseFloat(e.minSize),i=parseFloat(e.maxSize);this.panes.splice(t,0,{id:e._uid,index:t,min:isNaN(s)?0:s,max:isNaN(i)?100:i,size:null===e.size?null:parseFloat(e.size),givenSize:e.size,update:e.update}),this.panes.forEach(((e,t)=>e.index=t)),this.ready&&this.$nextTick((()=>{this.redoSplitters(),this.resetPaneSizes({addedPane:this.panes[t]}),this.$emit("pane-add",{index:t,panes:this.panes.map((e=>({min:e.min,max:e.max,size:e.size})))})}))},onPaneRemove(e){const t=this.panes.findIndex((t=>t.id===e._uid)),s=this.panes.splice(t,1)[0];this.panes.forEach(((e,t)=>e.index=t)),this.$nextTick((()=>{this.redoSplitters(),this.resetPaneSizes({removedPane:u(d({},s),{index:t})}),this.$emit("pane-remove",{removed:s,panes:this.panes.map((e=>({min:e.min,max:e.max,size:e.size})))})}))},resetPaneSizes(e={}){e.addedPane||e.removedPane?this.panes.some((e=>null!==e.givenSize||e.min||e.max<100))?this.equalizeAfterAddOrRemove(e):this.equalize():this.initialPanesSizing(),this.ready&&this.$emit("resized",this.panes.map((e=>({min:e.min,max:e.max,size:e.size}))))},equalize(){const e=100/this.panesCount;let t=0,s=[],i=[];this.panes.forEach((a=>{a.size=Math.max(Math.min(e,a.max),a.min),t-=a.size,a.size>=a.max&&s.push(a.id),a.size<=a.min&&i.push(a.id)})),t>.1&&this.readjustSizes(t,s,i)},initialPanesSizing(){this.panesCount;let e=100,t=[],s=[],i=0;this.panes.forEach((a=>{e-=a.size,null!==a.size&&i++,a.size>=a.max&&t.push(a.id),a.size<=a.min&&s.push(a.id)}));let a=100;e>.1&&(this.panes.forEach((t=>{null===t.size&&(t.size=Math.max(Math.min(e/(this.panesCount-i),t.max),t.min)),a-=t.size})),a>.1&&this.readjustSizes(e,t,s))},equalizeAfterAddOrRemove({addedPane:e,removedPane:t}={}){let s=100/this.panesCount,i=0,a=[],r=[];e&&null!==e.givenSize&&(s=(100-e.givenSize)/(this.panesCount-1)),this.panes.forEach((e=>{i-=e.size,e.size>=e.max&&a.push(e.id),e.size<=e.min&&r.push(e.id)})),Math.abs(i)<.1||(this.panes.forEach((t=>{e&&null!==e.givenSize&&e.id===t.id||(t.size=Math.max(Math.min(s,t.max),t.min)),i-=t.size,t.size>=t.max&&a.push(t.id),t.size<=t.min&&r.push(t.id)})),i>.1&&this.readjustSizes(i,a,r))},readjustSizes(e,t,s){let i;i=e>0?e/(this.panesCount-t.length):e/(this.panesCount-s.length),this.panes.forEach(((a,r)=>{if(e>0&&!t.includes(a.id)){const t=Math.max(Math.min(a.size+i,a.max),a.min),s=t-a.size;e-=s,a.size=t}else if(!s.includes(a.id)){const t=Math.max(Math.min(a.size+i,a.max),a.min),s=t-a.size;e-=s,a.size=t}a.update({[this.horizontal?"height":"width"]:`${this.indexedPanes[a.id].size}%`})})),Math.abs(e)>.1&&this.$nextTick((()=>{this.ready&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")}))}},watch:{panes:{deep:!0,immediate:!1,handler(){this.updatePaneComponents()}},horizontal(){this.updatePaneComponents()},firstSplitter(){this.redoSplitters()},dblClickSplitter(e){const t=[...this.container.querySelectorAll(".splitpanes__splitter")];t.forEach(((t,s)=>{t.ondblclick=e?e=>this.onSplitterDblClick(e,s):void 0}))}},beforeDestroy(){this.ready=!1},mounted(){this.container=this.$refs.container,this.checkSplitpanesNodes(),this.redoSplitters(),this.resetPaneSizes(),this.$emit("ready"),this.ready=!0},render(e){return e("div",{ref:"container",class:["splitpanes","splitpanes--"+(this.horizontal?"horizontal":"vertical"),{"splitpanes--dragging":this.touch.dragging}]},this.$slots.default)}};let f,g;const v={};var y=h(m,f,g,!1,b,null,null,null);function b(e){for(let t in v)this[t]=v[t]}var w=function(){return y.exports}(),S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"splitpanes__pane",style:e.style,on:{click:function(t){return e.onPaneClick(t,e._uid)}}},[e._t("default")],2)},A=[];const x={name:"pane",inject:["requestUpdate","onPaneAdd","onPaneRemove","onPaneClick"],props:{size:{type:[Number,String],default:null},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},data:()=>({style:{}}),mounted(){this.onPaneAdd(this)},beforeDestroy(){this.onPaneRemove(this)},methods:{update(e){this.style=e}},computed:{sizeNumber(){return this.size||0===this.size?parseFloat(this.size):null},minSizeNumber(){return parseFloat(this.minSize)},maxSizeNumber(){return parseFloat(this.maxSize)}},watch:{sizeNumber(e){this.requestUpdate({target:this,size:e})},minSizeNumber(e){this.requestUpdate({target:this,min:e})},maxSizeNumber(e){this.requestUpdate({target:this,max:e})}}},P={};var C=h(x,S,A,!1,_,null,null,null);function _(e){for(let t in P)this[t]=P[t]}var k=function(){return C.exports}()}}]);
//# sourceMappingURL=7213.b9b23bf2.js.map